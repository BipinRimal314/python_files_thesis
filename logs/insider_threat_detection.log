2025-11-03 14:24:03 - utils - INFO - Utility functions loaded successfully
2025-11-03 14:25:39 - utils - INFO - Utility functions loaded successfully
2025-11-03 14:29:44 - utils - INFO - Utility functions loaded successfully
2025-11-03 14:29:56 - utils - INFO - Utility functions loaded successfully
2025-11-03 14:30:20 - utils - INFO - Utility functions loaded successfully
2025-11-03 14:30:29 - utils - INFO - Utility functions loaded successfully
2025-11-03 14:30:39 - utils - INFO - Utility functions loaded successfully
2025-11-03 14:30:48 - utils - INFO - Utility functions loaded successfully
2025-11-03 14:33:23 - utils - INFO - Utility functions loaded successfully
2025-11-03 14:33:49 - utils - INFO - Utility functions loaded successfully
2025-11-03 14:33:51 - utils - INFO - ================================================================================
2025-11-03 14:33:51 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-11-03 14:33:51 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-11-03 14:33:51 - utils - INFO - ================================================================================
2025-11-03 14:33:51 - utils - INFO - No arguments provided. Running full pipeline...
2025-11-03 14:33:51 - utils - INFO - 
================================================================================
2025-11-03 14:33:51 - utils - INFO - STARTING FULL PIPELINE EXECUTION
2025-11-03 14:33:51 - utils - INFO - ================================================================================

2025-11-03 14:33:51 - utils - INFO - 
================================================================================
                          STAGE 1: DATA PREPROCESSING                           
================================================================================

2025-11-03 14:33:51 - utils - INFO - 
================================================================================
                          DATA PREPROCESSING PIPELINE                           
================================================================================

2025-11-03 14:33:51 - utils - INFO - Starting data loading process...
2025-11-03 14:33:51 - utils - INFO - Loading CMU-CERT dataset...
2025-11-03 14:33:51 - utils - WARNING - File not found: /Users/bipinrimal/Downloads/Thesis_work/data/raw/logon.csv
2025-11-03 14:33:51 - utils - INFO - Loaded device: 407908 records
2025-11-03 14:33:53 - utils - INFO - Loaded file: 434769 records
2025-11-03 14:33:58 - utils - INFO - Loaded email: 1975101 records
2025-11-03 14:35:06 - utils - INFO - Loaded http: 23845079 records
2025-11-03 14:35:06 - utils - WARNING - File not found: /Users/bipinrimal/Downloads/Thesis_work/data/raw/psychometric.csv
2025-11-03 14:35:06 - utils - INFO - Merging all log sources...
2025-11-03 14:35:06 - utils - INFO - Preprocessing device data...
2025-11-03 14:35:07 - utils - INFO - Parsed datetime column: date
2025-11-03 14:35:07 - utils - INFO - Cleaning dataframe with 407908 rows
2025-11-03 14:35:07 - utils - INFO - Removed 0 duplicate rows
2025-11-03 14:35:08 - utils - INFO - Pseudonymized column: user
2025-11-03 14:35:08 - utils - INFO - Pseudonymized column: pc
2025-11-03 14:35:08 - utils - INFO - Device data processed: 407908 records
2025-11-03 14:35:08 - utils - INFO - Preprocessing file data...
2025-11-03 14:35:09 - utils - INFO - Parsed datetime column: date
2025-11-03 14:35:09 - utils - INFO - Cleaning dataframe with 434769 rows
2025-11-03 14:35:10 - utils - INFO - Removed 0 duplicate rows
2025-11-03 14:35:10 - utils - INFO - Pseudonymized column: user
2025-11-03 14:35:10 - utils - INFO - Pseudonymized column: pc
2025-11-03 14:35:11 - utils - INFO - File data processed: 434769 records
2025-11-03 14:35:11 - utils - INFO - Preprocessing email data...
2025-11-03 14:35:17 - utils - INFO - Parsed datetime column: date
2025-11-03 14:35:17 - utils - INFO - Cleaning dataframe with 1975101 rows
2025-11-03 14:35:19 - utils - INFO - Removed 0 duplicate rows
2025-11-03 14:35:21 - utils - INFO - Pseudonymized column: from
2025-11-03 14:35:23 - utils - INFO - Email data processed: 1975101 records
2025-11-03 14:35:23 - utils - INFO - Preprocessing HTTP data...
2025-11-03 14:35:56 - utils - INFO - Parsed datetime column: date
2025-11-03 14:35:59 - utils - INFO - Cleaning dataframe with 23845079 rows
2025-11-03 14:36:48 - utils - INFO - Removed 0 duplicate rows
2025-11-03 14:37:09 - utils - INFO - Pseudonymized column: user
2025-11-03 14:38:33 - utils - INFO - Pseudonymized column: pc
2025-11-03 14:39:10 - utils - INFO - HTTP data processed: 23845079 records
2025-11-03 14:58:00 - utils - INFO - All logs merged: 26662857 total records
2025-11-03 14:58:11 - utils - INFO - Filtering users with < 10 activities...
2025-11-03 15:03:47 - utils - INFO - Filtered 1975101 records from low-activity users
2025-11-03 15:03:47 - utils - INFO - Remaining: 24687756 records from 1000 users
2025-11-03 15:03:47 - utils - INFO - Adding ground truth labels...
2025-11-03 15:17:14 - utils - INFO - Handled missing values using strategy: fill_mode
2025-11-03 15:24:46 - utils - INFO - Saved dataframe to /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv
2025-11-03 15:24:46 - utils - INFO - Processed data saved to processed_unified_logs.csv
2025-11-03 15:24:46 - utils - INFO - Preprocessing pipeline completed successfully!
2025-11-03 15:24:46 - utils - INFO - Final dataset: 24687756 records, 33 features
2025-11-03 15:24:46 - utils - INFO - ✓ Stage 1 completed: 24687756 records processed
2025-11-03 15:24:46 - utils - INFO - 
================================================================================
                          STAGE 2: FEATURE ENGINEERING                          
================================================================================

2025-11-03 15:24:46 - utils - INFO - 
================================================================================
                          FEATURE ENGINEERING PIPELINE                          
================================================================================

2025-11-03 15:24:46 - utils - INFO - Creating temporal features...
2025-11-03 15:31:57 - utils - INFO - Temporal features created
2025-11-03 15:31:58 - utils - INFO - Creating user aggregated features with window: 1D
2025-11-03 15:49:13 - utils - INFO - Created 11 aggregated features
2025-11-03 15:53:21 - utils - INFO - Creating behavioral ratio features...
2025-11-03 15:53:22 - utils - INFO - Behavioral ratio features created
2025-11-03 15:53:22 - utils - INFO - Creating statistical features per user...
2025-11-03 15:53:22 - utils - INFO - Created 70 statistical features
2025-11-03 15:53:28 - utils - INFO - Scaling features (fit=True)...
2025-11-03 15:53:28 - utils - INFO - Scaled 84 features
2025-11-03 15:53:28 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/feature_scaler.pkl
2025-11-03 15:53:28 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/label_encoders.pkl
2025-11-03 15:53:28 - utils - INFO - Feature engineering artifacts saved
2025-11-03 15:53:28 - utils - INFO - Feature engineering completed: 337561 samples, 84 features
2025-11-03 15:55:31 - utils - INFO - Creating sequences with length=30, stride=5
2025-11-03 18:21:23 - utils - INFO - Utility functions loaded successfully
2025-11-03 18:21:27 - utils - INFO - ================================================================================
2025-11-03 18:21:27 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-11-03 18:21:27 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-11-03 18:21:27 - utils - INFO - ================================================================================
2025-11-03 18:21:27 - utils - INFO - 
================================================================================
                          STAGE 2: FEATURE ENGINEERING                          
================================================================================

2025-11-03 18:26:12 - utils - INFO - Loaded dataframe from /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv
2025-11-03 18:26:12 - utils - INFO - 
================================================================================
                          FEATURE ENGINEERING PIPELINE                          
================================================================================

2025-11-03 18:26:12 - utils - INFO - Creating temporal features...
2025-11-03 18:26:41 - utils - INFO - Temporal features created
2025-11-03 18:26:41 - utils - INFO - Creating user aggregated features with window: 1D
2025-11-03 18:32:17 - utils - INFO - Created 11 aggregated features
2025-11-03 18:32:43 - utils - INFO - Creating behavioral ratio features...
2025-11-03 18:32:43 - utils - INFO - Behavioral ratio features created
2025-11-03 18:32:43 - utils - INFO - Creating statistical features per user...
2025-11-03 18:32:44 - utils - INFO - Created 70 statistical features
2025-11-03 18:32:46 - utils - INFO - Scaling features (fit=True)...
2025-11-03 18:32:46 - utils - INFO - Scaled 84 features
2025-11-03 18:32:46 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/feature_scaler.pkl
2025-11-03 18:32:46 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/label_encoders.pkl
2025-11-03 18:32:46 - utils - INFO - Feature engineering artifacts saved
2025-11-03 18:32:46 - utils - INFO - Feature engineering completed: 337561 samples, 84 features
2025-11-03 18:32:59 - utils - INFO - Creating sequences with length=30, stride=5
2025-11-03 18:57:15 - utils - INFO - Created 4932147 sequences from 1000 users
2025-11-03 19:01:01 - utils - INFO - ✓ Stage 2 completed: 337561 feature vectors, 4932147 sequences
2025-11-03 19:22:49 - utils - INFO - Utility functions loaded successfully
2025-11-03 19:22:52 - utils - INFO - ================================================================================
2025-11-03 19:22:52 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-11-03 19:22:52 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-11-03 19:22:52 - utils - INFO - ================================================================================
2025-11-03 19:22:52 - utils - INFO - 
================================================================================
                            STAGE 3: MODEL TRAINING                             
================================================================================

2025-11-03 19:22:52 - utils - INFO - 
>>> Training Isolation Forest...
2025-11-03 19:22:52 - utils - INFO - 
================================================================================
                           ISOLATION FOREST TRAINING                            
================================================================================

2025-11-03 19:22:52 - utils - ERROR - Engineered features not found. Run feature_engineering.py first.
2025-11-03 19:22:52 - utils - ERROR - ✗ Isolation Forest training failed: cannot unpack non-iterable NoneType object
2025-11-03 19:22:52 - utils - INFO - 
>>> Training LSTM Autoencoder...
2025-11-03 19:22:52 - utils - INFO - 
================================================================================
                           LSTM AUTOENCODER TRAINING                            
================================================================================

2025-11-03 19:22:52 - utils - ERROR - Sequence data not found. Run feature_engineering.py first.
2025-11-03 19:22:52 - utils - ERROR - ✗ LSTM Autoencoder training failed: cannot unpack non-iterable NoneType object
2025-11-03 19:22:52 - utils - INFO - 
>>> Training Deep Clustering...
2025-11-03 19:22:52 - utils - INFO - 
================================================================================
                            DEEP CLUSTERING TRAINING                            
================================================================================

2025-11-03 19:22:52 - utils - ERROR - Engineered features not found. Run feature_engineering.py first.
2025-11-03 19:22:52 - utils - ERROR - ✗ Deep Clustering training failed: cannot unpack non-iterable NoneType object
2025-11-03 19:22:52 - utils - INFO - 
✓ Stage 3 completed: 0 models trained
2025-11-03 19:24:07 - utils - INFO - Utility functions loaded successfully
2025-11-03 19:26:15 - utils - INFO - Utility functions loaded successfully
2025-11-03 19:26:20 - utils - INFO - ================================================================================
2025-11-03 19:26:20 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-11-03 19:26:20 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-11-03 19:26:20 - utils - INFO - ================================================================================
2025-11-03 19:26:20 - utils - INFO - 
================================================================================
                            STAGE 3: MODEL TRAINING                             
================================================================================

2025-11-03 19:26:20 - utils - INFO - 
>>> Training Isolation Forest...
2025-11-03 19:26:20 - utils - INFO - 
================================================================================
                           ISOLATION FOREST TRAINING                            
================================================================================

2025-11-03 19:26:20 - utils - ERROR - Engineered features not found. Run feature_engineering.py first.
2025-11-03 19:26:20 - utils - ERROR - ✗ Isolation Forest training failed: cannot unpack non-iterable NoneType object
2025-11-03 19:26:20 - utils - INFO - 
>>> Training LSTM Autoencoder...
2025-11-03 19:26:20 - utils - INFO - 
================================================================================
                           LSTM AUTOENCODER TRAINING                            
================================================================================

2025-11-03 19:26:20 - utils - ERROR - Sequence data not found. Run feature_engineering.py first.
2025-11-03 19:26:20 - utils - ERROR - ✗ LSTM Autoencoder training failed: cannot unpack non-iterable NoneType object
2025-11-03 19:26:20 - utils - INFO - 
>>> Training Deep Clustering...
2025-11-03 19:26:20 - utils - INFO - 
================================================================================
                            DEEP CLUSTERING TRAINING                            
================================================================================

2025-11-03 19:26:20 - utils - ERROR - Engineered features not found. Run feature_engineering.py first.
2025-11-03 19:26:20 - utils - ERROR - ✗ Deep Clustering training failed: cannot unpack non-iterable NoneType object
2025-11-03 19:26:20 - utils - INFO - 
✓ Stage 3 completed: 0 models trained
2025-11-03 19:27:43 - utils - INFO - Loaded dataframe from /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv
2025-11-03 19:27:43 - utils - INFO - 
================================================================================
                          FEATURE ENGINEERING PIPELINE                          
================================================================================

2025-11-03 19:27:43 - utils - INFO - Creating temporal features...
2025-11-03 19:28:04 - utils - INFO - Temporal features created
2025-11-03 19:28:04 - utils - INFO - Creating user aggregated features with window: 1D
2025-11-03 19:31:25 - utils - INFO - Utility functions loaded successfully
2025-11-03 19:31:25 - utils - INFO - 
================================================================================
                           ISOLATION FOREST TRAINING                            
================================================================================

2025-11-03 19:31:25 - utils - ERROR - Engineered features not found. Run feature_engineering.py first.
2025-11-03 19:32:22 - utils - INFO - Created 11 aggregated features
2025-11-03 19:32:39 - utils - INFO - Creating behavioral ratio features...
2025-11-03 19:32:39 - utils - INFO - Behavioral ratio features created
2025-11-03 19:32:39 - utils - INFO - Creating statistical features per user...
2025-11-03 19:32:39 - utils - INFO - Created 70 statistical features
2025-11-03 19:32:41 - utils - INFO - Scaling features (fit=True)...
2025-11-03 19:32:42 - utils - INFO - Scaled 84 features
2025-11-03 19:32:42 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/feature_scaler.pkl
2025-11-03 19:32:42 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/label_encoders.pkl
2025-11-03 19:32:42 - utils - INFO - Feature engineering artifacts saved
2025-11-03 19:32:42 - utils - INFO - Feature engineering completed: 337561 samples, 84 features
2025-11-03 19:33:06 - utils - INFO - Saved dataframe to /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_features.csv
2025-11-03 19:33:06 - utils - INFO - Creating sequences with length=30, stride=5
2025-11-03 19:33:29 - utils - INFO - Utility functions loaded successfully
2025-11-03 19:33:29 - utils - INFO - 
================================================================================
                           ISOLATION FOREST TRAINING                            
================================================================================

2025-11-03 19:33:31 - utils - INFO - Loaded dataframe from /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_features.csv
2025-11-03 19:33:31 - utils - INFO - Initialized Isolation Forest with params: {'n_estimators': 100, 'max_samples': 'auto', 'contamination': 0.01, 'max_features': 1.0, 'bootstrap': False, 'n_jobs': -1, 'random_state': 42, 'verbose': 0}
2025-11-03 19:33:31 - utils - INFO - Data split: Train=236292, Val=50634, Test=50635
2025-11-03 19:33:31 - utils - INFO - Training Isolation Forest...
2025-11-03 19:33:32 - utils - INFO - Isolation Forest training completed
2025-11-03 19:33:32 - utils - INFO - Evaluating Isolation Forest...
2025-11-03 19:33:32 - utils - INFO - 
============================================================
2025-11-03 19:33:32 - utils - INFO - Isolation Forest Performance Metrics
2025-11-03 19:33:32 - utils - INFO - ============================================================
2025-11-03 19:33:32 - utils - INFO - Accuracy:  0.9905
2025-11-03 19:33:32 - utils - INFO - Precision: 0.0000
2025-11-03 19:33:32 - utils - INFO - Recall:    0.0000
2025-11-03 19:33:32 - utils - INFO - F1-Score:  0.0000
2025-11-03 19:33:32 - utils - INFO - AUC-ROC:   nan
2025-11-03 19:33:32 - utils - INFO - ============================================================

2025-11-03 19:33:32 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest.pkl
2025-11-03 19:33:32 - utils - INFO - Isolation Forest model saved to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest.pkl
2025-11-03 19:33:32 - utils - INFO - Isolation Forest training and evaluation completed!
2025-11-03 19:34:44 - utils - INFO - Utility functions loaded successfully
2025-11-03 19:34:44 - utils - INFO - 
================================================================================
                            DEEP CLUSTERING TRAINING                            
================================================================================

2025-11-03 19:34:45 - utils - INFO - Loaded dataframe from /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_features.csv
2025-11-03 19:34:46 - utils - INFO - Data split: Train=236292, Val=50634, Test=50635
2025-11-03 19:34:46 - utils - INFO - Initialized Deep Clustering Model with input_dim=84
2025-11-03 19:34:46 - utils - INFO - Training deep clustering model...
2025-11-03 19:34:46 - utils - INFO - Initializing cluster centers with k-means...
2025-11-03 19:34:46 - utils - INFO - Building encoder network...
2025-11-03 19:34:46 - utils - INFO - Encoder architecture:
2025-11-03 19:34:46 - utils - INFO - Model: "Encoder"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┓
┃ Layer (type)                         ┃ Output Shape                ┃         Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━┩
│ input_layer (InputLayer)             │ (None, 84)                  │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ encoder_dense_0 (Dense)              │ (None, 128)                 │          10,880 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout (Dropout)                    │ (None, 128)                 │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ encoder_dense_1 (Dense)              │ (None, 64)                  │           8,256 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout_1 (Dropout)                  │ (None, 64)                  │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ encoder_dense_2 (Dense)              │ (None, 32)                  │           2,080 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout_2 (Dropout)                  │ (None, 32)                  │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ encoding (Dense)                     │ (None, 32)                  │           1,056 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ l2_normalize (Lambda)                │ (None, 32)                  │               0 │
└──────────────────────────────────────┴─────────────────────────────┴─────────────────┘
 Total params: 22,272 (87.00 KB)
 Trainable params: 22,272 (87.00 KB)
 Non-trainable params: 0 (0.00 B)

2025-11-03 19:34:50 - utils - INFO - Initialized 5 cluster centers
2025-11-03 19:34:50 - utils - INFO - Building deep clustering model...
2025-11-03 19:34:50 - utils - INFO - Deep clustering model built
2025-11-03 19:34:50 - utils - INFO - Compiling deep clustering model...
2025-11-03 19:34:54 - utils - INFO - Epoch 0/100, Loss: 0.0039
2025-11-03 19:55:03 - utils - INFO - Utility functions loaded successfully
2025-11-03 19:55:03 - utils - INFO - 
================================================================================
                            DEEP CLUSTERING TRAINING                            
================================================================================

2025-11-03 19:55:05 - utils - INFO - Loaded dataframe from /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_features.csv
2025-11-03 19:55:05 - utils - INFO - Data split: Train=236292, Val=50634, Test=50635
2025-11-03 19:55:05 - utils - INFO - Initialized Deep Clustering Model with input_dim=84
2025-11-03 19:55:05 - utils - INFO - Training deep clustering model...
2025-11-03 19:55:05 - utils - INFO - Initializing cluster centers with k-means...
2025-11-03 19:55:05 - utils - INFO - Building encoder network...
2025-11-03 19:55:05 - utils - INFO - Encoder architecture:
2025-11-03 19:55:05 - utils - INFO - Model: "Encoder"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┓
┃ Layer (type)                         ┃ Output Shape                ┃         Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━┩
│ input_layer (InputLayer)             │ (None, 84)                  │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ encoder_dense_0 (Dense)              │ (None, 128)                 │          10,880 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout (Dropout)                    │ (None, 128)                 │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ encoder_dense_1 (Dense)              │ (None, 64)                  │           8,256 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout_1 (Dropout)                  │ (None, 64)                  │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ encoder_dense_2 (Dense)              │ (None, 32)                  │           2,080 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout_2 (Dropout)                  │ (None, 32)                  │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ encoding (Dense)                     │ (None, 32)                  │           1,056 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ l2_normalize (Lambda)                │ (None, 32)                  │               0 │
└──────────────────────────────────────┴─────────────────────────────┴─────────────────┘
 Total params: 22,272 (87.00 KB)
 Trainable params: 22,272 (87.00 KB)
 Non-trainable params: 0 (0.00 B)

2025-11-03 19:55:09 - utils - INFO - Initialized 5 cluster centers
2025-11-03 19:55:09 - utils - INFO - Building deep clustering model...
2025-11-03 19:55:09 - utils - INFO - Deep clustering model built
2025-11-03 19:55:09 - utils - INFO - Compiling deep clustering model...
2025-11-03 19:55:12 - utils - INFO - Epoch 0/100, Loss: 0.0066
2025-11-03 19:59:14 - utils - INFO - Created 4932147 sequences from 1000 users
2025-11-03 20:04:23 - utils - INFO - Utility functions loaded successfully
2025-11-03 20:04:29 - utils - INFO - ================================================================================
2025-11-03 20:04:29 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-11-03 20:04:29 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-11-03 20:04:29 - utils - INFO - ================================================================================
2025-11-03 20:04:29 - utils - INFO - No arguments provided. Running full pipeline...
2025-11-03 20:04:29 - utils - INFO - 
================================================================================
2025-11-03 20:04:29 - utils - INFO - STARTING FULL PIPELINE EXECUTION
2025-11-03 20:04:29 - utils - INFO - ================================================================================

2025-11-03 20:04:29 - utils - INFO - 
================================================================================
                          STAGE 1: DATA PREPROCESSING                           
================================================================================

2025-11-03 20:04:29 - utils - INFO - 
================================================================================
                          DATA PREPROCESSING PIPELINE                           
================================================================================

2025-11-03 20:04:29 - utils - INFO - Starting data loading process...
2025-11-03 20:04:29 - utils - INFO - Loading CMU-CERT dataset...
2025-11-03 20:04:29 - utils - WARNING - File not found: /Users/bipinrimal/Downloads/Thesis_work/data/raw/logon.csv
2025-11-03 20:04:29 - utils - INFO - Loaded device: 407908 records
2025-11-03 20:04:30 - utils - INFO - Loaded file: 434769 records
2025-11-03 20:04:35 - utils - INFO - Loaded email: 1975101 records
2025-11-03 20:04:40 - utils - ERROR - Error loading http: Error tokenizing data. C error: Calling read(nbytes) on source failed. Try engine='python'.
2025-11-03 20:04:40 - utils - WARNING - File not found: /Users/bipinrimal/Downloads/Thesis_work/data/raw/psychometric.csv
2025-11-03 20:04:40 - utils - INFO - Merging all log sources...
2025-11-03 20:04:40 - utils - INFO - Preprocessing device data...
2025-11-03 20:04:40 - utils - INFO - Parsed datetime column: date
2025-11-03 20:04:40 - utils - INFO - Cleaning dataframe with 407908 rows
2025-11-03 20:04:40 - utils - INFO - Removed 0 duplicate rows
2025-11-03 20:04:41 - utils - INFO - Pseudonymized column: user
2025-11-03 20:04:41 - utils - INFO - Pseudonymized column: pc
2025-11-03 20:04:41 - utils - INFO - Device data processed: 407908 records
2025-11-03 20:04:41 - utils - INFO - Preprocessing file data...
2025-11-03 20:04:48 - utils - INFO - Utility functions loaded successfully
2025-11-03 20:04:50 - utils - INFO - ================================================================================
2025-11-03 20:04:50 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-11-03 20:04:50 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-11-03 20:04:50 - utils - INFO - ================================================================================
2025-11-03 20:04:50 - utils - INFO - 
================================================================================
                            STAGE 3: MODEL TRAINING                             
================================================================================

2025-11-03 20:04:50 - utils - INFO - 
>>> Training Isolation Forest...
2025-11-03 20:04:50 - utils - INFO - 
================================================================================
                           ISOLATION FOREST TRAINING                            
================================================================================

2025-11-03 20:04:52 - utils - INFO - Loaded dataframe from /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_features.csv
2025-11-03 20:04:52 - utils - INFO - Initialized Isolation Forest with params: {'n_estimators': 100, 'max_samples': 'auto', 'contamination': 0.01, 'max_features': 1.0, 'bootstrap': False, 'n_jobs': -1, 'random_state': 42, 'verbose': 0}
2025-11-03 20:04:52 - utils - INFO - Data split: Train=236292, Val=50634, Test=50635
2025-11-03 20:04:52 - utils - INFO - Training Isolation Forest...
2025-11-03 20:04:52 - utils - INFO - Isolation Forest training completed
2025-11-03 20:04:52 - utils - INFO - Evaluating Isolation Forest...
2025-11-03 20:04:52 - utils - INFO - 
============================================================
2025-11-03 20:04:52 - utils - INFO - Isolation Forest Performance Metrics
2025-11-03 20:04:52 - utils - INFO - ============================================================
2025-11-03 20:04:52 - utils - INFO - Accuracy:  0.9905
2025-11-03 20:04:52 - utils - INFO - Precision: 0.0000
2025-11-03 20:04:52 - utils - INFO - Recall:    0.0000
2025-11-03 20:04:52 - utils - INFO - F1-Score:  0.0000
2025-11-03 20:04:52 - utils - INFO - AUC-ROC:   nan
2025-11-03 20:04:52 - utils - INFO - ============================================================

2025-11-03 20:04:52 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest.pkl
2025-11-03 20:04:52 - utils - INFO - Isolation Forest model saved to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest.pkl
2025-11-03 20:04:53 - utils - INFO - Isolation Forest training and evaluation completed!
2025-11-03 20:04:53 - utils - INFO - ✓ Isolation Forest training completed
2025-11-03 20:04:53 - utils - INFO - 
>>> Training LSTM Autoencoder...
2025-11-03 20:04:53 - utils - INFO - 
================================================================================
                           LSTM AUTOENCODER TRAINING                            
================================================================================

2025-11-03 20:04:54 - utils - ERROR - Sequence data not found. Run feature_engineering.py first.
2025-11-03 20:04:54 - utils - ERROR - ✗ LSTM Autoencoder training failed: cannot unpack non-iterable NoneType object
2025-11-03 20:04:54 - utils - INFO - 
>>> Training Deep Clustering...
2025-11-03 20:04:54 - utils - INFO - 
================================================================================
                            DEEP CLUSTERING TRAINING                            
================================================================================

2025-11-03 20:04:56 - utils - INFO - Loaded dataframe from /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_features.csv
2025-11-03 20:04:56 - utils - INFO - Data split: Train=236292, Val=50634, Test=50635
2025-11-03 20:04:56 - utils - INFO - Initialized Deep Clustering Model with input_dim=84
2025-11-03 20:04:56 - utils - INFO - Training deep clustering model...
2025-11-03 20:04:56 - utils - INFO - Initializing cluster centers with k-means...
2025-11-03 20:04:56 - utils - INFO - Building encoder network...
2025-11-03 20:04:56 - utils - INFO - Encoder architecture:
2025-11-03 20:04:56 - utils - INFO - Model: "Encoder"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┓
┃ Layer (type)                         ┃ Output Shape                ┃         Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━┩
│ input_layer (InputLayer)             │ (None, 84)                  │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ encoder_dense_0 (Dense)              │ (None, 128)                 │          10,880 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout (Dropout)                    │ (None, 128)                 │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ encoder_dense_1 (Dense)              │ (None, 64)                  │           8,256 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout_1 (Dropout)                  │ (None, 64)                  │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ encoder_dense_2 (Dense)              │ (None, 32)                  │           2,080 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout_2 (Dropout)                  │ (None, 32)                  │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ encoding (Dense)                     │ (None, 32)                  │           1,056 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ l2_normalize (Lambda)                │ (None, 32)                  │               0 │
└──────────────────────────────────────┴─────────────────────────────┴─────────────────┘
 Total params: 22,272 (87.00 KB)
 Trainable params: 22,272 (87.00 KB)
 Non-trainable params: 0 (0.00 B)

2025-11-03 20:05:00 - utils - INFO - Initialized 5 cluster centers
2025-11-03 20:05:00 - utils - INFO - Building deep clustering model...
2025-11-03 20:05:00 - utils - INFO - Deep clustering model built
2025-11-03 20:05:00 - utils - INFO - Compiling deep clustering model...
2025-11-03 20:05:04 - utils - INFO - Epoch 0/100, Loss: 0.0062
2025-11-03 20:05:04 - utils - ERROR - ✗ Deep Clustering training failed: The filename must end in `.weights.h5`. Received: filepath=/Users/bipinrimal/Downloads/Thesis_work/models/deep_clustering_weights.h5
2025-11-03 20:05:04 - utils - INFO - 
✓ Stage 3 completed: 1 models trained
2025-11-03 20:05:25 - utils - INFO - Utility functions loaded successfully
2025-11-03 20:09:53 - utils - INFO - Utility functions loaded successfully
2025-11-03 20:12:16 - utils - INFO - Utility functions loaded successfully
2025-11-03 20:18:54 - utils - INFO - Utility functions loaded successfully
2025-11-03 20:21:40 - utils - INFO - Loaded dataframe from /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv
2025-11-03 20:21:40 - utils - INFO - 
================================================================================
                          FEATURE ENGINEERING PIPELINE                          
================================================================================

2025-11-03 20:21:40 - utils - INFO - Creating temporal features...
2025-11-03 20:21:59 - utils - INFO - Temporal features created
2025-11-03 20:21:59 - utils - INFO - Creating user aggregated features with window: 1D
2025-11-03 20:24:20 - utils - INFO - Created 11 aggregated features
2025-11-03 20:24:29 - utils - INFO - Creating behavioral ratio features...
2025-11-03 20:24:29 - utils - INFO - Behavioral ratio features created
2025-11-03 20:24:29 - utils - INFO - Creating statistical features per user...
2025-11-03 20:24:29 - utils - INFO - Created 70 statistical features
2025-11-03 20:24:31 - utils - INFO - Scaling features (fit=True)...
2025-11-03 20:24:31 - utils - INFO - Scaled 84 features
2025-11-03 20:24:31 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/feature_scaler.pkl
2025-11-03 20:24:31 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/label_encoders.pkl
2025-11-03 20:24:31 - utils - INFO - Feature engineering artifacts saved
2025-11-03 20:24:31 - utils - INFO - Feature engineering completed: 337561 samples, 84 features
2025-11-03 20:24:51 - utils - INFO - Saved dataframe to /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_features.csv
2025-11-03 20:24:51 - utils - INFO - Creating sequences with length=30, stride=5
2025-11-03 20:46:53 - utils - INFO - Created 4932147 sequences from 1000 users
2025-11-03 20:51:31 - utils - INFO - Sequences saved for LSTM training
2025-11-03 20:55:03 - utils - INFO - Utility functions loaded successfully
2025-11-03 20:55:07 - utils - INFO - ================================================================================
2025-11-03 20:55:07 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-11-03 20:55:07 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-11-03 20:55:07 - utils - INFO - ================================================================================
2025-11-03 20:55:07 - utils - INFO - 
================================================================================
                            STAGE 3: MODEL TRAINING                             
================================================================================

2025-11-03 20:55:07 - utils - INFO - 
>>> Training Isolation Forest...
2025-11-03 20:55:07 - utils - INFO - 
================================================================================
                           ISOLATION FOREST TRAINING                            
================================================================================

2025-11-03 20:55:08 - utils - INFO - Loaded dataframe from /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_features.csv
2025-11-03 20:55:08 - utils - INFO - Initialized Isolation Forest with params: {'n_estimators': 100, 'max_samples': 'auto', 'contamination': 0.01, 'max_features': 1.0, 'bootstrap': False, 'n_jobs': -1, 'random_state': 42, 'verbose': 0}
2025-11-03 20:55:08 - utils - INFO - Data split: Train=236292, Val=50634, Test=50635
2025-11-03 20:55:08 - utils - INFO - Training Isolation Forest...
2025-11-03 20:55:09 - utils - INFO - Isolation Forest training completed
2025-11-03 20:55:09 - utils - INFO - Evaluating Isolation Forest...
2025-11-03 20:55:09 - utils - INFO - 
============================================================
2025-11-03 20:55:09 - utils - INFO - Isolation Forest Performance Metrics
2025-11-03 20:55:09 - utils - INFO - ============================================================
2025-11-03 20:55:09 - utils - INFO - Accuracy:  0.9905
2025-11-03 20:55:09 - utils - INFO - Precision: 0.0000
2025-11-03 20:55:09 - utils - INFO - Recall:    0.0000
2025-11-03 20:55:09 - utils - INFO - F1-Score:  0.0000
2025-11-03 20:55:09 - utils - INFO - AUC-ROC:   nan
2025-11-03 20:55:09 - utils - INFO - ============================================================

2025-11-03 20:55:09 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest.pkl
2025-11-03 20:55:09 - utils - INFO - Isolation Forest model saved to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest.pkl
2025-11-03 20:55:09 - utils - INFO - Isolation Forest training and evaluation completed!
2025-11-03 20:55:09 - utils - INFO - ✓ Isolation Forest training completed
2025-11-03 20:55:09 - utils - INFO - 
>>> Training LSTM Autoencoder...
2025-11-03 20:55:09 - utils - INFO - 
================================================================================
                           LSTM AUTOENCODER TRAINING                            
================================================================================

2025-11-03 20:55:16 - utils - INFO - Loaded sequences: (4932147, 30, 27)
2025-11-03 20:55:16 - utils - INFO - Loaded labels: (4932147,)
2025-11-03 20:56:45 - utils - INFO - Data split: Train=3452502, Val=739822, Test=739823
2025-11-03 20:58:07 - utils - INFO - Training on 3452502 normal sequences
2025-11-03 20:58:07 - utils - INFO - Initialized LSTM Autoencoder for sequences of shape (30, 27)
2025-11-03 20:58:07 - utils - INFO - Training LSTM Autoencoder...
2025-11-03 20:58:07 - utils - INFO - Building LSTM Autoencoder model...
2025-11-03 20:58:08 - utils - INFO - Model architecture:
2025-11-03 20:58:08 - utils - INFO - Model: "LSTM_Autoencoder"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┓
┃ Layer (type)                         ┃ Output Shape                ┃         Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━┩
│ input_layer (InputLayer)             │ (None, 30, 27)              │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ encoder_lstm_0 (LSTM)                │ (None, 30, 64)              │          23,552 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout (Dropout)                    │ (None, 30, 64)              │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ encoder_lstm_1 (LSTM)                │ (None, 32)                  │          12,416 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout_1 (Dropout)                  │ (None, 32)                  │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ encoding (Dense)                     │ (None, 32)                  │           1,056 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ repeat_vector (RepeatVector)         │ (None, 30, 32)              │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ decoder_lstm_0 (LSTM)                │ (None, 30, 32)              │           8,320 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout_2 (Dropout)                  │ (None, 30, 32)              │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ decoder_lstm_1 (LSTM)                │ (None, 30, 64)              │          24,832 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout_3 (Dropout)                  │ (None, 30, 64)              │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ output (TimeDistributed)             │ (None, 30, 27)              │           1,755 │
└──────────────────────────────────────┴─────────────────────────────┴─────────────────┘
 Total params: 71,931 (280.98 KB)
 Trainable params: 71,931 (280.98 KB)
 Non-trainable params: 0 (0.00 B)

2025-11-03 21:13:14 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-11-03 21:26:09 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-11-03 21:39:14 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-11-03 21:52:19 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-11-03 22:05:24 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-11-04 11:15:35 - utils - INFO - Utility functions loaded successfully
2025-11-04 11:15:40 - utils - INFO - ================================================================================
2025-11-04 11:15:40 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-11-04 11:15:40 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-11-04 11:15:40 - utils - INFO - ================================================================================
2025-11-04 11:15:40 - utils - INFO - 
================================================================================
                            STAGE 3: MODEL TRAINING                             
================================================================================

2025-11-04 11:15:40 - utils - INFO - 
>>> Training Isolation Forest...
2025-11-04 11:15:40 - utils - INFO - 
================================================================================
                           ISOLATION FOREST TRAINING                            
================================================================================

2025-11-04 11:15:41 - utils - INFO - Loaded dataframe from /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_features.csv
2025-11-04 11:15:41 - utils - INFO - Initialized Isolation Forest with params: {'n_estimators': 100, 'max_samples': 'auto', 'contamination': 0.01, 'max_features': 1.0, 'bootstrap': False, 'n_jobs': -1, 'random_state': 42, 'verbose': 0}
2025-11-04 11:15:41 - utils - INFO - Data split: Train=236292, Val=50634, Test=50635
2025-11-04 11:15:41 - utils - INFO - Training Isolation Forest...
2025-11-04 11:15:42 - utils - INFO - Isolation Forest training completed
2025-11-04 11:15:42 - utils - INFO - Evaluating Isolation Forest...
2025-11-04 11:15:42 - utils - INFO - 
============================================================
2025-11-04 11:15:42 - utils - INFO - Isolation Forest Performance Metrics
2025-11-04 11:15:42 - utils - INFO - ============================================================
2025-11-04 11:15:42 - utils - INFO - Accuracy:  0.9905
2025-11-04 11:15:42 - utils - INFO - Precision: 0.0000
2025-11-04 11:15:42 - utils - INFO - Recall:    0.0000
2025-11-04 11:15:42 - utils - INFO - F1-Score:  0.0000
2025-11-04 11:15:42 - utils - INFO - AUC-ROC:   nan
2025-11-04 11:15:42 - utils - INFO - ============================================================

2025-11-04 11:15:42 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest.pkl
2025-11-04 11:15:42 - utils - INFO - Isolation Forest model saved to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest.pkl
2025-11-04 11:15:42 - utils - INFO - Isolation Forest training and evaluation completed!
2025-11-04 11:15:42 - utils - INFO - ✓ Isolation Forest training completed
2025-11-04 11:15:42 - utils - INFO - 
>>> Training LSTM Autoencoder...
2025-11-04 11:15:42 - utils - INFO - 
================================================================================
                           LSTM AUTOENCODER TRAINING                            
================================================================================

2025-11-04 11:15:50 - utils - INFO - Loaded sequences: (4932147, 30, 27)
2025-11-04 11:15:50 - utils - INFO - Loaded labels: (4932147,)
2025-11-04 11:21:59 - utils - INFO - Data split: Train=3452502, Val=739822, Test=739823
2025-11-04 11:23:40 - utils - INFO - Training on 3452502 normal sequences
2025-11-04 11:23:40 - utils - INFO - Initialized LSTM Autoencoder for sequences of shape (30, 27)
2025-11-04 11:23:40 - utils - INFO - Training LSTM Autoencoder...
2025-11-04 11:23:40 - utils - INFO - Building LSTM Autoencoder model...
2025-11-04 11:23:41 - utils - INFO - Model architecture:
2025-11-04 11:23:41 - utils - INFO - Model: "LSTM_Autoencoder"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┓
┃ Layer (type)                         ┃ Output Shape                ┃         Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━┩
│ input_layer (InputLayer)             │ (None, 30, 27)              │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ encoder_lstm_0 (LSTM)                │ (None, 30, 64)              │          23,552 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout (Dropout)                    │ (None, 30, 64)              │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ encoder_lstm_1 (LSTM)                │ (None, 32)                  │          12,416 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout_1 (Dropout)                  │ (None, 32)                  │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ encoding (Dense)                     │ (None, 32)                  │           1,056 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ repeat_vector (RepeatVector)         │ (None, 30, 32)              │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ decoder_lstm_0 (LSTM)                │ (None, 30, 32)              │           8,320 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout_2 (Dropout)                  │ (None, 30, 32)              │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ decoder_lstm_1 (LSTM)                │ (None, 30, 64)              │          24,832 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout_3 (Dropout)                  │ (None, 30, 64)              │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ output (TimeDistributed)             │ (None, 30, 27)              │           1,755 │
└──────────────────────────────────────┴─────────────────────────────┴─────────────────┘
 Total params: 71,931 (280.98 KB)
 Trainable params: 71,931 (280.98 KB)
 Non-trainable params: 0 (0.00 B)

2025-11-04 11:30:55 - utils - INFO - Utility functions loaded successfully
2025-11-04 11:31:00 - utils - INFO - ================================================================================
2025-11-04 11:31:00 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-11-04 11:31:00 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-11-04 11:31:00 - utils - INFO - ================================================================================
2025-11-04 11:31:00 - utils - INFO - 
================================================================================
                            STAGE 3: MODEL TRAINING                             
================================================================================

2025-11-04 11:31:00 - utils - INFO - 
>>> Training Isolation Forest...
2025-11-04 11:31:00 - utils - INFO - 
================================================================================
                           ISOLATION FOREST TRAINING                            
================================================================================

2025-11-04 11:31:02 - utils - INFO - Loaded dataframe from /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_features.csv
2025-11-04 11:31:02 - utils - INFO - Initialized Isolation Forest with params: {'n_estimators': 100, 'max_samples': 'auto', 'contamination': 0.01, 'max_features': 1.0, 'bootstrap': False, 'n_jobs': -1, 'random_state': 42, 'verbose': 0}
2025-11-04 11:31:02 - utils - INFO - Data split: Train=236292, Val=50634, Test=50635
2025-11-04 11:31:02 - utils - INFO - Training Isolation Forest...
2025-11-04 11:31:02 - utils - INFO - Isolation Forest training completed
2025-11-04 11:31:02 - utils - INFO - Evaluating Isolation Forest...
2025-11-04 11:31:03 - utils - INFO - 
============================================================
2025-11-04 11:31:03 - utils - INFO - Isolation Forest Performance Metrics
2025-11-04 11:31:03 - utils - INFO - ============================================================
2025-11-04 11:31:03 - utils - INFO - Accuracy:  0.9905
2025-11-04 11:31:03 - utils - INFO - Precision: 0.0000
2025-11-04 11:31:03 - utils - INFO - Recall:    0.0000
2025-11-04 11:31:03 - utils - INFO - F1-Score:  0.0000
2025-11-04 11:31:03 - utils - INFO - AUC-ROC:   nan
2025-11-04 11:31:03 - utils - INFO - ============================================================

2025-11-04 11:31:03 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest.pkl
2025-11-04 11:31:03 - utils - INFO - Isolation Forest model saved to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest.pkl
2025-11-04 11:31:03 - utils - INFO - Isolation Forest training and evaluation completed!
2025-11-04 11:31:03 - utils - INFO - ✓ Isolation Forest training completed
2025-11-04 11:31:03 - utils - INFO - 
>>> Training LSTM Autoencoder...
2025-11-04 11:31:03 - utils - INFO - 
================================================================================
                     LIGHTWEIGHT LSTM AUTOENCODER TRAINING                      
================================================================================

2025-11-04 11:31:10 - utils - INFO - Loaded sequences: (4932147, 30, 27)
2025-11-04 11:31:10 - utils - INFO - Reducing sequence length from 30 to 20 for efficiency
2025-11-04 11:32:26 - utils - INFO - Data split: Train=3452502, Val=739822, Test=739823
2025-11-04 11:33:14 - utils - INFO - Training on 3452502 normal sequences
2025-11-04 11:33:14 - utils - INFO - Initialized Lightweight LSTM Autoencoder (20, 27)
2025-11-04 11:33:14 - utils - INFO - Training lightweight LSTM Autoencoder...
2025-11-04 11:33:14 - utils - INFO - Building lightweight LSTM Autoencoder...
2025-11-04 11:33:15 - utils - INFO - Model built with 20,363 parameters
2025-11-04 11:33:15 - utils - INFO - Training on 3452502 sequences...
2025-11-04 12:59:04 - utils - INFO - Training completed
2025-11-04 12:59:04 - utils - INFO - Training completed in 5150.61 seconds
2025-11-04 12:59:04 - utils - INFO - Evaluating lightweight LSTM Autoencoder...
2025-11-04 12:59:42 - utils - INFO - 
============================================================
2025-11-04 12:59:42 - utils - INFO - LSTM Autoencoder (Lightweight) Performance Metrics
2025-11-04 12:59:42 - utils - INFO - ============================================================
2025-11-04 12:59:42 - utils - INFO - Accuracy:  0.9500
2025-11-04 12:59:42 - utils - INFO - Precision: 0.0000
2025-11-04 12:59:42 - utils - INFO - Recall:    0.0000
2025-11-04 12:59:42 - utils - INFO - F1-Score:  0.0000
2025-11-04 12:59:42 - utils - INFO - AUC-ROC:   nan
2025-11-04 12:59:42 - utils - INFO - ============================================================

2025-11-04 12:59:42 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-11-04 12:59:42 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/lstm_autoencoder.h5
2025-11-04 13:00:01 - utils - INFO - Lightweight LSTM Autoencoder completed!
2025-11-04 13:00:01 - utils - INFO - Total time: 5150.61 seconds
2025-11-04 13:00:01 - utils - INFO - ✓ LSTM Autoencoder training completed
2025-11-04 13:00:01 - utils - INFO - 
>>> Training Deep Clustering...
2025-11-04 13:00:01 - utils - INFO - 
================================================================================
                      LIGHTWEIGHT DEEP CLUSTERING TRAINING                      
================================================================================

2025-11-04 13:00:03 - utils - INFO - Loaded dataframe from /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_features.csv
2025-11-04 13:00:03 - utils - INFO - Dataset: 337561 samples, 84 features
2025-11-04 13:00:03 - utils - INFO - Data split: Train=236292, Val=50634, Test=50635
2025-11-04 13:00:03 - utils - INFO - Initialized Lightweight Deep Clustering (n_clusters=5, encoding_dim=32)
2025-11-04 13:00:03 - utils - INFO - Training lightweight deep clustering model...
2025-11-04 13:00:04 - utils - INFO - Fitting MiniBatch K-Means clustering...
2025-11-04 13:00:04 - utils - INFO - Lightweight deep clustering training completed
2025-11-04 13:00:04 - utils - INFO - Training completed in 0.82 seconds
2025-11-04 13:00:04 - utils - INFO - Evaluating lightweight deep clustering model...
2025-11-04 13:00:04 - utils - INFO - 
============================================================
2025-11-04 13:00:04 - utils - INFO - Deep Clustering (Lightweight) Performance Metrics
2025-11-04 13:00:04 - utils - INFO - ============================================================
2025-11-04 13:00:04 - utils - INFO - Accuracy:  0.9500
2025-11-04 13:00:04 - utils - INFO - Precision: 0.0000
2025-11-04 13:00:04 - utils - INFO - Recall:    0.0000
2025-11-04 13:00:04 - utils - INFO - F1-Score:  0.0000
2025-11-04 13:00:04 - utils - INFO - AUC-ROC:   nan
2025-11-04 13:00:04 - utils - INFO - ============================================================

2025-11-04 13:00:04 - utils - ERROR - ✗ Deep Clustering training failed: Path.replace() takes 2 positional arguments but 3 were given
2025-11-04 13:00:04 - utils - INFO - 
✓ Stage 3 completed: 2 models trained
2025-11-04 13:01:23 - utils - INFO - Utility functions loaded successfully
2025-11-04 13:01:23 - utils - INFO - 
================================================================================
                      LIGHTWEIGHT DEEP CLUSTERING TRAINING                      
================================================================================

2025-11-04 13:01:24 - utils - INFO - Loaded dataframe from /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_features.csv
2025-11-04 13:01:24 - utils - INFO - Dataset: 337561 samples, 84 features
2025-11-04 13:01:24 - utils - INFO - Data split: Train=236292, Val=50634, Test=50635
2025-11-04 13:01:24 - utils - INFO - Initialized Lightweight Deep Clustering (n_clusters=5, encoding_dim=32)
2025-11-04 13:01:24 - utils - INFO - Training lightweight deep clustering model...
2025-11-04 13:01:24 - utils - INFO - Fitting MiniBatch K-Means clustering...
2025-11-04 13:01:24 - utils - INFO - Lightweight deep clustering training completed
2025-11-04 13:01:24 - utils - INFO - Training completed in 0.15 seconds
2025-11-04 13:01:24 - utils - INFO - Evaluating lightweight deep clustering model...
2025-11-04 13:01:24 - utils - INFO - 
============================================================
2025-11-04 13:01:24 - utils - INFO - Deep Clustering (Lightweight) Performance Metrics
2025-11-04 13:01:24 - utils - INFO - ============================================================
2025-11-04 13:01:24 - utils - INFO - Accuracy:  0.9500
2025-11-04 13:01:24 - utils - INFO - Precision: 0.0000
2025-11-04 13:01:24 - utils - INFO - Recall:    0.0000
2025-11-04 13:01:24 - utils - INFO - F1-Score:  0.0000
2025-11-04 13:01:24 - utils - INFO - AUC-ROC:   nan
2025-11-04 13:01:24 - utils - INFO - ============================================================

2025-11-04 13:02:25 - utils - INFO - Utility functions loaded successfully
2025-11-04 13:02:25 - utils - INFO - 
================================================================================
                      LIGHTWEIGHT DEEP CLUSTERING TRAINING                      
================================================================================

2025-11-04 13:02:26 - utils - INFO - Loaded dataframe from /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_features.csv
2025-11-04 13:02:26 - utils - INFO - Dataset: 337561 samples, 84 features
2025-11-04 13:02:27 - utils - INFO - Data split: Train=236292, Val=50634, Test=50635
2025-11-04 13:02:27 - utils - INFO - Initialized Lightweight Deep Clustering (n_clusters=5, encoding_dim=32)
2025-11-04 13:02:27 - utils - INFO - Training lightweight deep clustering model...
2025-11-04 13:02:27 - utils - INFO - Fitting MiniBatch K-Means clustering...
2025-11-04 13:02:27 - utils - INFO - Lightweight deep clustering training completed
2025-11-04 13:02:27 - utils - INFO - Training completed in 0.16 seconds
2025-11-04 13:02:27 - utils - INFO - Evaluating lightweight deep clustering model...
2025-11-04 13:02:27 - utils - INFO - 
============================================================
2025-11-04 13:02:27 - utils - INFO - Deep Clustering (Lightweight) Performance Metrics
2025-11-04 13:02:27 - utils - INFO - ============================================================
2025-11-04 13:02:27 - utils - INFO - Accuracy:  0.9500
2025-11-04 13:02:27 - utils - INFO - Precision: 0.0000
2025-11-04 13:02:27 - utils - INFO - Recall:    0.0000
2025-11-04 13:02:27 - utils - INFO - F1-Score:  0.0000
2025-11-04 13:02:27 - utils - INFO - AUC-ROC:   nan
2025-11-04 13:02:27 - utils - INFO - ============================================================

2025-11-04 13:04:30 - utils - INFO - Utility functions loaded successfully
2025-11-04 13:04:30 - utils - INFO - 
================================================================================
                      LIGHTWEIGHT DEEP CLUSTERING TRAINING                      
================================================================================

2025-11-04 13:04:32 - utils - INFO - Loaded dataframe from /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_features.csv
2025-11-04 13:04:32 - utils - INFO - Dataset: 337561 samples, 84 features
2025-11-04 13:04:32 - utils - INFO - Data split: Train=236292, Val=50634, Test=50635
2025-11-04 13:04:32 - utils - INFO - Initialized Lightweight Deep Clustering (n_clusters=5, encoding_dim=32)
2025-11-04 13:04:32 - utils - INFO - Training lightweight deep clustering model...
2025-11-04 13:04:32 - utils - INFO - Fitting MiniBatch K-Means clustering...
2025-11-04 13:04:32 - utils - INFO - Lightweight deep clustering training completed
2025-11-04 13:04:32 - utils - INFO - Training completed in 0.15 seconds
2025-11-04 13:04:32 - utils - INFO - Evaluating lightweight deep clustering model...
2025-11-04 13:04:32 - utils - INFO - 
============================================================
2025-11-04 13:04:32 - utils - INFO - Deep Clustering (Lightweight) Performance Metrics
2025-11-04 13:04:32 - utils - INFO - ============================================================
2025-11-04 13:04:32 - utils - INFO - Accuracy:  0.9500
2025-11-04 13:04:32 - utils - INFO - Precision: 0.0000
2025-11-04 13:04:32 - utils - INFO - Recall:    0.0000
2025-11-04 13:04:32 - utils - INFO - F1-Score:  0.0000
2025-11-04 13:04:32 - utils - INFO - AUC-ROC:   nan
2025-11-04 13:04:32 - utils - INFO - ============================================================

2025-11-04 13:04:32 - utils - INFO - Lightweight deep clustering model saved to /Users/bipinrimal/Downloads/Thesis_work/models/deep_clustering.pkl
2025-11-04 13:04:32 - utils - INFO - Lightweight deep clustering training and evaluation completed!
2025-11-04 13:04:32 - utils - INFO - Total time: 0.15 seconds
2025-11-04 13:05:25 - utils - INFO - Utility functions loaded successfully
2025-11-04 13:05:28 - utils - INFO - 
================================================================================
                     LIGHTWEIGHT LSTM AUTOENCODER TRAINING                      
================================================================================

2025-11-04 13:05:35 - utils - INFO - Loaded sequences: (4932147, 30, 27)
2025-11-04 13:05:35 - utils - INFO - Reducing sequence length from 30 to 20 for efficiency
2025-11-04 13:06:39 - utils - INFO - Utility functions loaded successfully
2025-11-04 13:06:42 - utils - INFO - ================================================================================
2025-11-04 13:06:42 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-11-04 13:06:42 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-11-04 13:06:42 - utils - INFO - ================================================================================
2025-11-04 13:06:42 - utils - INFO - 
================================================================================
                           STAGE 4: MODEL EVALUATION                            
================================================================================

2025-11-04 13:06:42 - utils - INFO - 
================================================================================
                         COMPREHENSIVE MODEL EVALUATION                         
================================================================================

2025-11-04 13:06:42 - utils - INFO - Loading results for all models...
2025-11-04 13:06:42 - utils - INFO - Loaded results for isolation_forest
2025-11-04 13:06:43 - utils - INFO - Loaded results for lstm_autoencoder
2025-11-04 13:06:43 - utils - INFO - Loaded results for deep_clustering
2025-11-04 13:06:43 - utils - INFO - Loaded results for 3 models
2025-11-04 13:06:43 - utils - INFO - Creating metrics comparison table...
2025-11-04 13:06:43 - utils - INFO - Metrics comparison table created
2025-11-04 13:06:43 - utils - INFO - Creating confusion matrix plots...
2025-11-04 13:06:44 - utils - INFO - Confusion matrices saved to /Users/bipinrimal/Downloads/Thesis_work/results/confusion_matrices/all_models.png
2025-11-04 13:06:44 - utils - INFO - Creating ROC curves...
2025-11-04 13:06:44 - utils - INFO - ROC curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/roc_curves/roc_comparison.png
2025-11-04 13:06:44 - utils - INFO - Creating Precision-Recall curves...
2025-11-04 13:06:44 - utils - INFO - Precision-Recall curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/precision_recall_comparison.png
2025-11-04 13:06:44 - utils - INFO - Creating metrics comparison bar chart...
2025-11-04 13:06:45 - utils - INFO - Metrics comparison bar chart saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/metrics_comparison_bar.png
2025-11-04 13:06:45 - utils - INFO - Creating anomaly score distribution plots...
2025-11-04 13:06:45 - utils - INFO - Score distributions saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/score_distributions.png
2025-11-04 13:06:45 - utils - INFO - Generating evaluation report...
2025-11-04 13:06:45 - utils - INFO - Evaluation report saved to /Users/bipinrimal/Downloads/Thesis_work/results/evaluation_report.txt
2025-11-04 13:06:45 - utils - INFO - Comprehensive evaluation completed!
2025-11-04 13:06:45 - utils - INFO - ✓ Stage 4 completed: Comprehensive evaluation report generated
2025-11-04 13:07:15 - utils - INFO - Utility functions loaded successfully
2025-11-04 13:07:18 - utils - INFO - ================================================================================
2025-11-04 13:07:18 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-11-04 13:07:18 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-11-04 13:07:18 - utils - INFO - ================================================================================
2025-11-04 13:07:18 - utils - INFO - 
================================================================================
                         STAGE 5: ENSEMBLE INTEGRATION                          
================================================================================

2025-11-04 13:07:18 - utils - INFO - Initialized Ensemble Detector with method: weighted
2025-11-04 13:07:18 - utils - INFO - 
================================================================================
                            ENSEMBLE SYSTEM PIPELINE                            
================================================================================

2025-11-04 13:07:18 - utils - INFO - Loading predictions from individual models...
2025-11-04 13:07:18 - utils - INFO - Loaded isolation_forest predictions
2025-11-04 13:07:18 - utils - INFO - Loaded lstm_autoencoder predictions
2025-11-04 13:07:18 - utils - INFO - Loaded deep_clustering predictions
2025-11-04 13:07:18 - utils - INFO - Loaded predictions from 3 models
2025-11-04 13:07:18 - utils - INFO - Computing weighted ensemble...
2025-11-04 13:07:18 - utils - ERROR - Error with weighted ensemble: operands could not be broadcast together with shapes (50635,) (739823,) (50635,) 
2025-11-04 13:07:18 - utils - INFO - Initialized Ensemble Detector with method: majority
2025-11-04 13:07:18 - utils - INFO - 
================================================================================
                            ENSEMBLE SYSTEM PIPELINE                            
================================================================================

2025-11-04 13:07:18 - utils - INFO - Loading predictions from individual models...
2025-11-04 13:07:18 - utils - INFO - Loaded isolation_forest predictions
2025-11-04 13:07:18 - utils - INFO - Loaded lstm_autoencoder predictions
2025-11-04 13:07:18 - utils - INFO - Loaded deep_clustering predictions
2025-11-04 13:07:18 - utils - INFO - Loaded predictions from 3 models
2025-11-04 13:07:18 - utils - INFO - Computing majority voting ensemble...
2025-11-04 13:07:18 - utils - ERROR - Error with majority ensemble: setting an array element with a sequence. The requested array has an inhomogeneous shape after 1 dimensions. The detected shape was (3,) + inhomogeneous part.
2025-11-04 13:07:18 - utils - INFO - Initialized Ensemble Detector with method: cascade
2025-11-04 13:07:18 - utils - INFO - 
================================================================================
                            ENSEMBLE SYSTEM PIPELINE                            
================================================================================

2025-11-04 13:07:18 - utils - INFO - Loading predictions from individual models...
2025-11-04 13:07:18 - utils - INFO - Loaded isolation_forest predictions
2025-11-04 13:07:18 - utils - INFO - Loaded lstm_autoencoder predictions
2025-11-04 13:07:18 - utils - INFO - Loaded deep_clustering predictions
2025-11-04 13:07:18 - utils - INFO - Loaded predictions from 3 models
2025-11-04 13:07:18 - utils - INFO - Computing cascade ensemble...
2025-11-04 13:07:18 - utils - ERROR - Error with cascade ensemble: operands could not be broadcast together with shapes (50635,) (739823,) 
2025-11-04 13:07:18 - utils - INFO - 
✓ Stage 5 completed: Best ensemble method = None (F1=0.0000)
2025-11-04 13:07:32 - utils - INFO - Utility functions loaded successfully
2025-11-04 13:07:34 - utils - INFO - ================================================================================
2025-11-04 13:07:34 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-11-04 13:07:34 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-11-04 13:07:34 - utils - INFO - ================================================================================
2025-11-04 13:07:34 - utils - INFO - 
================================================================================
                             STAGE 6: VISUALIZATION                             
================================================================================

2025-11-04 13:07:34 - utils - INFO - 
================================================================================
                           GENERATING VISUALIZATIONS                            
================================================================================

2025-11-04 13:07:34 - utils - INFO - Creating alert severity distribution plot...
2025-11-04 13:07:34 - utils - WARNING - Alerts file not found
2025-11-04 13:07:34 - utils - INFO - Creating model agreement plot...
2025-11-04 13:07:34 - utils - WARNING - Alerts file not found
2025-11-04 13:07:34 - utils - INFO - Creating anomaly score timeline for ensemble_weighted...
2025-11-04 13:07:34 - utils - WARNING - Predictions file not found for ensemble_weighted
2025-11-04 13:07:34 - utils - INFO - Creating feature importance visualization...
2025-11-04 13:07:35 - utils - INFO - Feature importance heatmap saved
2025-11-04 13:07:35 - utils - INFO - Creating executive summary chart...
2025-11-04 13:07:35 - utils - WARNING - Could not create performance comparison: [Errno 2] No such file or directory: '/Users/bipinrimal/Downloads/Thesis_work/results/ensemble_weighted_comparison.csv'
2025-11-04 13:07:35 - utils - WARNING - Could not create severity pie chart: [Errno 2] No such file or directory: '/Users/bipinrimal/Downloads/Thesis_work/results/generated_alerts.csv'
2025-11-04 13:07:35 - utils - WARNING - Could not create top alerts chart: [Errno 2] No such file or directory: '/Users/bipinrimal/Downloads/Thesis_work/results/generated_alerts.csv'
2025-11-04 13:07:35 - utils - INFO - Executive summary chart saved
2025-11-04 13:07:35 - utils - INFO - All visualizations saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations
2025-11-04 13:07:35 - utils - INFO - Visualization generation completed!
2025-11-04 13:07:35 - utils - INFO - ✓ Stage 6 completed: All visualizations generated
2025-11-04 13:08:19 - utils - INFO - Utility functions loaded successfully
2025-11-04 13:08:21 - utils - INFO - ================================================================================
2025-11-04 13:08:21 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-11-04 13:08:21 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-11-04 13:08:21 - utils - INFO - ================================================================================
2025-11-04 13:08:21 - utils - INFO - 
================================================================================
                         STAGE 5: ENSEMBLE INTEGRATION                          
================================================================================

2025-11-04 13:08:21 - utils - INFO - Initialized Ensemble Detector with method: weighted
2025-11-04 13:08:21 - utils - INFO - 
================================================================================
                            ENSEMBLE SYSTEM PIPELINE                            
================================================================================

2025-11-04 13:08:21 - utils - INFO - Loading predictions from individual models...
2025-11-04 13:08:21 - utils - INFO - Loaded isolation_forest predictions
2025-11-04 13:08:21 - utils - INFO - Loaded lstm_autoencoder predictions
2025-11-04 13:08:21 - utils - INFO - Loaded deep_clustering predictions
2025-11-04 13:08:21 - utils - INFO - Loaded predictions from 3 models
2025-11-04 13:08:21 - utils - INFO - Computing weighted ensemble...
2025-11-04 13:08:21 - utils - ERROR - Error with weighted ensemble: operands could not be broadcast together with shapes (50635,) (739823,) (50635,) 
2025-11-04 13:08:21 - utils - INFO - Initialized Ensemble Detector with method: majority
2025-11-04 13:08:21 - utils - INFO - 
================================================================================
                            ENSEMBLE SYSTEM PIPELINE                            
================================================================================

2025-11-04 13:08:21 - utils - INFO - Loading predictions from individual models...
2025-11-04 13:08:21 - utils - INFO - Loaded isolation_forest predictions
2025-11-04 13:08:21 - utils - INFO - Loaded lstm_autoencoder predictions
2025-11-04 13:08:21 - utils - INFO - Loaded deep_clustering predictions
2025-11-04 13:08:21 - utils - INFO - Loaded predictions from 3 models
2025-11-04 13:08:21 - utils - INFO - Computing majority voting ensemble...
2025-11-04 13:08:21 - utils - ERROR - Error with majority ensemble: setting an array element with a sequence. The requested array has an inhomogeneous shape after 1 dimensions. The detected shape was (3,) + inhomogeneous part.
2025-11-04 13:08:21 - utils - INFO - Initialized Ensemble Detector with method: cascade
2025-11-04 13:08:21 - utils - INFO - 
================================================================================
                            ENSEMBLE SYSTEM PIPELINE                            
================================================================================

2025-11-04 13:08:21 - utils - INFO - Loading predictions from individual models...
2025-11-04 13:08:21 - utils - INFO - Loaded isolation_forest predictions
2025-11-04 13:08:21 - utils - INFO - Loaded lstm_autoencoder predictions
2025-11-04 13:08:21 - utils - INFO - Loaded deep_clustering predictions
2025-11-04 13:08:21 - utils - INFO - Loaded predictions from 3 models
2025-11-04 13:08:21 - utils - INFO - Computing cascade ensemble...
2025-11-04 13:08:21 - utils - ERROR - Error with cascade ensemble: operands could not be broadcast together with shapes (50635,) (739823,) 
2025-11-04 13:08:21 - utils - INFO - 
✓ Stage 5 completed: Best ensemble method = None (F1=0.0000)
2025-11-04 13:10:35 - utils - INFO - Utility functions loaded successfully
2025-11-04 13:10:38 - utils - INFO - ================================================================================
2025-11-04 13:10:38 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-11-04 13:10:38 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-11-04 13:10:38 - utils - INFO - ================================================================================
2025-11-04 13:10:38 - utils - INFO - 
================================================================================
                         STAGE 5: ENSEMBLE INTEGRATION                          
================================================================================

2025-11-04 13:10:38 - utils - INFO - Initialized Ensemble Detector with method: weighted
2025-11-04 13:10:38 - utils - INFO - 
================================================================================
                            ENSEMBLE SYSTEM PIPELINE                            
================================================================================

2025-11-04 13:10:38 - utils - INFO - Loading predictions from individual models...
2025-11-04 13:10:38 - utils - INFO - Loaded isolation_forest predictions: 50635 samples
2025-11-04 13:10:38 - utils - INFO - Loaded lstm_autoencoder predictions: 739823 samples
2025-11-04 13:10:38 - utils - INFO - Loaded deep_clustering predictions: 50635 samples
2025-11-04 13:10:38 - utils - WARNING - Models have different sample counts: {'isolation_forest': 50635, 'lstm_autoencoder': 739823, 'deep_clustering': 50635}
2025-11-04 13:10:38 - utils - INFO - Will use aggregation strategy to align predictions...
2025-11-04 13:10:38 - utils - INFO - Aligning predictions across models...
2025-11-04 13:10:38 - utils - INFO - Using isolation_forest as reference (50635 samples)
2025-11-04 13:10:38 - utils - INFO - Aggregating lstm_autoencoder from 739823 to 50635 samples
2025-11-04 13:10:38 - utils - INFO - Predictions aligned successfully
2025-11-04 13:10:38 - utils - INFO - Loaded predictions from 3 models
2025-11-04 13:10:38 - utils - INFO - Computing weighted ensemble...
2025-11-04 13:10:38 - utils - INFO - Weighted ensemble: 120 anomalies detected
2025-11-04 13:10:38 - utils - INFO - Evaluating ensemble performance...
2025-11-04 13:10:38 - utils - INFO - 
============================================================
2025-11-04 13:10:38 - utils - INFO - Ensemble (weighted) Performance Metrics
2025-11-04 13:10:38 - utils - INFO - ============================================================
2025-11-04 13:10:38 - utils - INFO - Accuracy:  0.9976
2025-11-04 13:10:38 - utils - INFO - Precision: 0.0000
2025-11-04 13:10:38 - utils - INFO - Recall:    0.0000
2025-11-04 13:10:38 - utils - INFO - F1-Score:  0.0000
2025-11-04 13:10:38 - utils - INFO - AUC-ROC:   nan
2025-11-04 13:10:38 - utils - INFO - ============================================================

2025-11-04 13:10:38 - utils - INFO - Comparing ensemble with individual models...
2025-11-04 13:10:38 - utils - INFO - Evaluating ensemble performance...
2025-11-04 13:10:38 - utils - INFO - 
============================================================
2025-11-04 13:10:38 - utils - INFO - Ensemble (weighted) Performance Metrics
2025-11-04 13:10:38 - utils - INFO - ============================================================
2025-11-04 13:10:38 - utils - INFO - Accuracy:  0.9976
2025-11-04 13:10:38 - utils - INFO - Precision: 0.0000
2025-11-04 13:10:38 - utils - INFO - Recall:    0.0000
2025-11-04 13:10:38 - utils - INFO - F1-Score:  0.0000
2025-11-04 13:10:38 - utils - INFO - AUC-ROC:   nan
2025-11-04 13:10:38 - utils - INFO - ============================================================

2025-11-04 13:10:38 - utils - INFO - 
Comparison Results:
2025-11-04 13:10:38 - utils - INFO - 
              model  accuracy  precision  recall  f1_score  auc_roc
   Isolation Forest    0.9905        0.0     0.0       0.0      NaN
   Lstm Autoencoder    0.9500        0.0     0.0       0.0      NaN
    Deep Clustering    0.9500        0.0     0.0       0.0      NaN
Ensemble (weighted)    0.9976        0.0     0.0       0.0      NaN
2025-11-04 13:10:38 - utils - INFO - Ensemble predictions saved
2025-11-04 13:10:38 - utils - INFO - Generating alerts...
2025-11-04 13:10:38 - utils - INFO - Generated 120 alerts
2025-11-04 13:10:38 - utils - INFO - Severity distribution:
severity
medium    120
Name: count, dtype: int64
2025-11-04 13:10:38 - utils - INFO - Alerts saved to /Users/bipinrimal/Downloads/Thesis_work/results/generated_alerts.csv
2025-11-04 13:10:38 - utils - INFO - Ensemble pipeline completed!
2025-11-04 13:10:38 - utils - INFO - Initialized Ensemble Detector with method: majority
2025-11-04 13:10:38 - utils - INFO - 
================================================================================
                            ENSEMBLE SYSTEM PIPELINE                            
================================================================================

2025-11-04 13:10:38 - utils - INFO - Loading predictions from individual models...
2025-11-04 13:10:38 - utils - INFO - Loaded isolation_forest predictions: 50635 samples
2025-11-04 13:10:38 - utils - INFO - Loaded lstm_autoencoder predictions: 739823 samples
2025-11-04 13:10:38 - utils - INFO - Loaded deep_clustering predictions: 50635 samples
2025-11-04 13:10:38 - utils - WARNING - Models have different sample counts: {'isolation_forest': 50635, 'lstm_autoencoder': 739823, 'deep_clustering': 50635}
2025-11-04 13:10:38 - utils - INFO - Will use aggregation strategy to align predictions...
2025-11-04 13:10:38 - utils - INFO - Aligning predictions across models...
2025-11-04 13:10:38 - utils - INFO - Using isolation_forest as reference (50635 samples)
2025-11-04 13:10:38 - utils - INFO - Aggregating lstm_autoencoder from 739823 to 50635 samples
2025-11-04 13:10:38 - utils - INFO - Predictions aligned successfully
2025-11-04 13:10:38 - utils - INFO - Loaded predictions from 3 models
2025-11-04 13:10:38 - utils - INFO - Computing majority voting ensemble...
2025-11-04 13:10:38 - utils - INFO - Majority voting: 181 anomalies detected
2025-11-04 13:10:38 - utils - INFO - Evaluating ensemble performance...
2025-11-04 13:10:38 - utils - INFO - 
============================================================
2025-11-04 13:10:38 - utils - INFO - Ensemble (majority) Performance Metrics
2025-11-04 13:10:38 - utils - INFO - ============================================================
2025-11-04 13:10:38 - utils - INFO - Accuracy:  0.9964
2025-11-04 13:10:38 - utils - INFO - Precision: 0.0000
2025-11-04 13:10:38 - utils - INFO - Recall:    0.0000
2025-11-04 13:10:38 - utils - INFO - F1-Score:  0.0000
2025-11-04 13:10:38 - utils - INFO - AUC-ROC:   nan
2025-11-04 13:10:38 - utils - INFO - ============================================================

2025-11-04 13:10:38 - utils - INFO - Comparing ensemble with individual models...
2025-11-04 13:10:38 - utils - INFO - Evaluating ensemble performance...
2025-11-04 13:10:38 - utils - INFO - 
============================================================
2025-11-04 13:10:38 - utils - INFO - Ensemble (majority) Performance Metrics
2025-11-04 13:10:38 - utils - INFO - ============================================================
2025-11-04 13:10:38 - utils - INFO - Accuracy:  0.9964
2025-11-04 13:10:38 - utils - INFO - Precision: 0.0000
2025-11-04 13:10:38 - utils - INFO - Recall:    0.0000
2025-11-04 13:10:38 - utils - INFO - F1-Score:  0.0000
2025-11-04 13:10:38 - utils - INFO - AUC-ROC:   nan
2025-11-04 13:10:38 - utils - INFO - ============================================================

2025-11-04 13:10:38 - utils - INFO - 
Comparison Results:
2025-11-04 13:10:38 - utils - INFO - 
              model  accuracy  precision  recall  f1_score  auc_roc
   Isolation Forest    0.9905        0.0     0.0       0.0      NaN
   Lstm Autoencoder    0.9500        0.0     0.0       0.0      NaN
    Deep Clustering    0.9500        0.0     0.0       0.0      NaN
Ensemble (majority)    0.9964        0.0     0.0       0.0      NaN
2025-11-04 13:10:38 - utils - INFO - Ensemble predictions saved
2025-11-04 13:10:38 - utils - INFO - Generating alerts...
2025-11-04 13:10:38 - utils - INFO - Generated 193 alerts
2025-11-04 13:10:38 - utils - INFO - Severity distribution:
severity
medium    193
Name: count, dtype: int64
2025-11-04 13:10:38 - utils - INFO - Alerts saved to /Users/bipinrimal/Downloads/Thesis_work/results/generated_alerts.csv
2025-11-04 13:10:38 - utils - INFO - Ensemble pipeline completed!
2025-11-04 13:10:38 - utils - INFO - Initialized Ensemble Detector with method: cascade
2025-11-04 13:10:38 - utils - INFO - 
================================================================================
                            ENSEMBLE SYSTEM PIPELINE                            
================================================================================

2025-11-04 13:10:38 - utils - INFO - Loading predictions from individual models...
2025-11-04 13:10:38 - utils - INFO - Loaded isolation_forest predictions: 50635 samples
2025-11-04 13:10:38 - utils - INFO - Loaded lstm_autoencoder predictions: 739823 samples
2025-11-04 13:10:38 - utils - INFO - Loaded deep_clustering predictions: 50635 samples
2025-11-04 13:10:38 - utils - WARNING - Models have different sample counts: {'isolation_forest': 50635, 'lstm_autoencoder': 739823, 'deep_clustering': 50635}
2025-11-04 13:10:38 - utils - INFO - Will use aggregation strategy to align predictions...
2025-11-04 13:10:38 - utils - INFO - Aligning predictions across models...
2025-11-04 13:10:38 - utils - INFO - Using isolation_forest as reference (50635 samples)
2025-11-04 13:10:38 - utils - INFO - Aggregating lstm_autoencoder from 739823 to 50635 samples
2025-11-04 13:10:38 - utils - INFO - Predictions aligned successfully
2025-11-04 13:10:38 - utils - INFO - Loaded predictions from 3 models
2025-11-04 13:10:38 - utils - INFO - Computing cascade ensemble...
2025-11-04 13:10:38 - utils - INFO - Cascade ensemble: 1 anomalies detected
2025-11-04 13:10:38 - utils - INFO - Evaluating ensemble performance...
2025-11-04 13:10:38 - utils - INFO - 
============================================================
2025-11-04 13:10:38 - utils - INFO - Ensemble (cascade) Performance Metrics
2025-11-04 13:10:38 - utils - INFO - ============================================================
2025-11-04 13:10:38 - utils - INFO - Accuracy:  1.0000
2025-11-04 13:10:38 - utils - INFO - Precision: 0.0000
2025-11-04 13:10:38 - utils - INFO - Recall:    0.0000
2025-11-04 13:10:38 - utils - INFO - F1-Score:  0.0000
2025-11-04 13:10:38 - utils - INFO - AUC-ROC:   nan
2025-11-04 13:10:38 - utils - INFO - ============================================================

2025-11-04 13:10:38 - utils - INFO - Comparing ensemble with individual models...
2025-11-04 13:10:38 - utils - INFO - Evaluating ensemble performance...
2025-11-04 13:10:38 - utils - INFO - 
============================================================
2025-11-04 13:10:38 - utils - INFO - Ensemble (cascade) Performance Metrics
2025-11-04 13:10:38 - utils - INFO - ============================================================
2025-11-04 13:10:38 - utils - INFO - Accuracy:  1.0000
2025-11-04 13:10:38 - utils - INFO - Precision: 0.0000
2025-11-04 13:10:38 - utils - INFO - Recall:    0.0000
2025-11-04 13:10:38 - utils - INFO - F1-Score:  0.0000
2025-11-04 13:10:38 - utils - INFO - AUC-ROC:   nan
2025-11-04 13:10:38 - utils - INFO - ============================================================

2025-11-04 13:10:38 - utils - INFO - 
Comparison Results:
2025-11-04 13:10:38 - utils - INFO - 
             model  accuracy  precision  recall  f1_score  auc_roc
  Isolation Forest    0.9905        0.0     0.0       0.0      NaN
  Lstm Autoencoder    0.9500        0.0     0.0       0.0      NaN
   Deep Clustering    0.9500        0.0     0.0       0.0      NaN
Ensemble (cascade)    1.0000        0.0     0.0       0.0      NaN
2025-11-04 13:10:38 - utils - INFO - Ensemble predictions saved
2025-11-04 13:10:38 - utils - INFO - Generating alerts...
2025-11-04 13:10:38 - utils - INFO - Generated 8426 alerts
2025-11-04 13:10:38 - utils - INFO - Severity distribution:
severity
medium      6732
high        1542
critical     152
Name: count, dtype: int64
2025-11-04 13:10:38 - utils - INFO - Alerts saved to /Users/bipinrimal/Downloads/Thesis_work/results/generated_alerts.csv
2025-11-04 13:10:38 - utils - INFO - Ensemble pipeline completed!
2025-11-04 13:10:38 - utils - INFO - 
✓ Stage 5 completed: Best ensemble method = None (F1=0.0000)
2025-11-04 13:38:39 - utils - INFO - Utility functions loaded successfully
2025-11-04 13:42:08 - utils - INFO - Loaded dataframe from /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv
2025-11-04 13:42:08 - utils - INFO - 
================================================================================
                          FEATURE ENGINEERING PIPELINE                          
================================================================================

2025-11-04 13:42:08 - utils - INFO - Creating temporal features...
2025-11-04 13:42:27 - utils - INFO - Temporal features created
2025-11-04 13:42:27 - utils - INFO - Creating user aggregated features with window: 1D
2025-11-04 13:46:55 - utils - INFO - Created 11 aggregated features
2025-11-04 13:47:13 - utils - INFO - Creating behavioral ratio features...
2025-11-04 13:47:13 - utils - INFO - Behavioral ratio features created
2025-11-04 13:47:13 - utils - INFO - Creating statistical features per user...
2025-11-04 13:47:14 - utils - INFO - Created 70 statistical features
2025-11-04 13:47:15 - utils - INFO - Scaling features (fit=True)...
2025-11-04 13:47:16 - utils - INFO - Scaled 84 features
2025-11-04 13:47:16 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/feature_scaler.pkl
2025-11-04 13:47:16 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/label_encoders.pkl
2025-11-04 13:47:16 - utils - INFO - Feature engineering artifacts saved
2025-11-04 13:47:16 - utils - INFO - Feature engineering completed: 337561 samples, 84 features
2025-11-04 13:47:47 - utils - INFO - Saved dataframe to /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_features.csv
2025-11-04 13:47:47 - utils - INFO - Creating sequences with length=15, stride=10
2025-11-04 14:12:21 - utils - INFO - Created 2467828 sequences from 1000 users
2025-11-04 14:13:09 - utils - INFO - Sequences saved for LSTM training
2025-11-04 14:13:41 - utils - INFO - Utility functions loaded successfully
2025-11-04 14:13:44 - utils - INFO - ================================================================================
2025-11-04 14:13:44 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-11-04 14:13:44 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-11-04 14:13:44 - utils - INFO - ================================================================================
2025-11-04 14:13:44 - utils - INFO - 
================================================================================
                            STAGE 3: MODEL TRAINING                             
================================================================================

2025-11-04 14:13:44 - utils - INFO - 
>>> Training Isolation Forest...
2025-11-04 14:13:44 - utils - INFO - 
================================================================================
                           ISOLATION FOREST TRAINING                            
================================================================================

2025-11-04 14:13:46 - utils - INFO - Loaded dataframe from /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_features.csv
2025-11-04 14:13:46 - utils - INFO - Initialized Isolation Forest with params: {'n_estimators': 50, 'max_samples': 256, 'contamination': 0.01, 'max_features': 1.0, 'bootstrap': False, 'n_jobs': -1, 'random_state': 42, 'verbose': 0}
2025-11-04 14:13:46 - utils - INFO - Data split: Train=236292, Val=50634, Test=50635
2025-11-04 14:13:46 - utils - INFO - Training Isolation Forest...
2025-11-04 14:13:46 - utils - INFO - Isolation Forest training completed
2025-11-04 14:13:46 - utils - INFO - Calibrating threshold for target FPR=0.05
2025-11-04 14:13:46 - utils - INFO - Calibrated threshold: 0.5934
2025-11-04 14:13:46 - utils - INFO - Evaluating Isolation Forest...
2025-11-04 14:13:46 - utils - INFO - 
============================================================
2025-11-04 14:13:46 - utils - INFO - Isolation Forest Performance Metrics
2025-11-04 14:13:46 - utils - INFO - ============================================================
2025-11-04 14:13:46 - utils - INFO - Accuracy:  0.9898
2025-11-04 14:13:46 - utils - INFO - Precision: 0.5711
2025-11-04 14:13:46 - utils - INFO - Recall:    0.4779
2025-11-04 14:13:46 - utils - INFO - F1-Score:  0.5204
2025-11-04 14:13:46 - utils - INFO - AUC-ROC:   0.9919
2025-11-04 14:13:46 - utils - INFO - ============================================================

2025-11-04 14:13:46 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest.pkl
2025-11-04 14:13:46 - utils - INFO - Isolation Forest model saved to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest.pkl
2025-11-04 14:13:47 - utils - INFO - Isolation Forest training and evaluation completed!
2025-11-04 14:13:47 - utils - INFO - ✓ Isolation Forest training completed
2025-11-04 14:13:47 - utils - INFO - 
>>> Training LSTM Autoencoder...
2025-11-04 14:13:47 - utils - INFO - 
================================================================================
                            DEEP CLUSTERING TRAINING                            
================================================================================

2025-11-04 14:13:48 - utils - INFO - Loaded dataframe from /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_features.csv
2025-11-04 14:13:48 - utils - INFO - Data split: Train=236292, Val=50634, Test=50635
2025-11-04 14:13:48 - utils - INFO - Initialized Deep Clustering Model with input_dim=84
2025-11-04 14:13:48 - utils - INFO - Training deep clustering model...
2025-11-04 14:13:48 - utils - INFO - Initializing cluster centers with k-means...
2025-11-04 14:13:48 - utils - INFO - Building encoder network...
2025-11-04 14:13:48 - utils - INFO - Encoder architecture:
2025-11-04 14:13:48 - utils - INFO - Model: "Encoder"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┓
┃ Layer (type)                         ┃ Output Shape                ┃         Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━┩
│ input_layer (InputLayer)             │ (None, 84)                  │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ encoder_dense_0 (Dense)              │ (None, 64)                  │           5,440 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout (Dropout)                    │ (None, 64)                  │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ encoder_dense_1 (Dense)              │ (None, 32)                  │           2,080 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout_1 (Dropout)                  │ (None, 32)                  │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ encoding (Dense)                     │ (None, 32)                  │           1,056 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ l2_normalize (Lambda)                │ (None, 32)                  │               0 │
└──────────────────────────────────────┴─────────────────────────────┴─────────────────┘
 Total params: 8,576 (33.50 KB)
 Trainable params: 8,576 (33.50 KB)
 Non-trainable params: 0 (0.00 B)

2025-11-04 14:13:52 - utils - INFO - Initialized 5 cluster centers
2025-11-04 14:13:52 - utils - INFO - Building deep clustering model...
2025-11-04 14:13:52 - utils - INFO - Deep clustering model built
2025-11-04 14:13:52 - utils - INFO - Compiling deep clustering model...
2025-11-04 14:13:55 - utils - INFO - Epoch 0/30, Loss: 0.0062
2025-11-04 14:13:55 - utils - ERROR - ✗ LSTM Autoencoder training failed: The filename must end in `.weights.h5`. Received: filepath=/Users/bipinrimal/Downloads/Thesis_work/models/deep_clustering.pkl
2025-11-04 14:13:55 - utils - INFO - 
>>> Training Deep Clustering...
2025-11-04 14:13:55 - utils - INFO - 
================================================================================
                      LIGHTWEIGHT DEEP CLUSTERING TRAINING                      
================================================================================

2025-11-04 14:13:57 - utils - INFO - Loaded dataframe from /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_features.csv
2025-11-04 14:13:57 - utils - INFO - Dataset: 337561 samples, 84 features
2025-11-04 14:13:57 - utils - INFO - Data split: Train=236292, Val=50634, Test=50635
2025-11-04 14:13:57 - utils - INFO - Initialized Lightweight Deep Clustering (n_clusters=5, encoding_dim=32)
2025-11-04 14:13:57 - utils - INFO - Training lightweight deep clustering model...
2025-11-04 14:13:57 - utils - INFO - Fitting MiniBatch K-Means clustering...
2025-11-04 14:13:57 - utils - INFO - Lightweight deep clustering training completed
2025-11-04 14:13:57 - utils - INFO - Training completed in 0.14 seconds
2025-11-04 14:13:57 - utils - INFO - Calibrating threshold for target FPR=0.05
2025-11-04 14:13:57 - utils - INFO - Calibrated threshold: 0.7997
2025-11-04 14:13:57 - utils - INFO - Evaluating lightweight deep clustering model...
2025-11-04 14:13:57 - utils - INFO - 
============================================================
2025-11-04 14:13:57 - utils - INFO - Deep Clustering (Lightweight) Performance Metrics
2025-11-04 14:13:57 - utils - INFO - ============================================================
2025-11-04 14:13:57 - utils - INFO - Accuracy:  0.9441
2025-11-04 14:13:57 - utils - INFO - Precision: 0.0031
2025-11-04 14:13:57 - utils - INFO - Recall:    0.0119
2025-11-04 14:13:57 - utils - INFO - F1-Score:  0.0049
2025-11-04 14:13:57 - utils - INFO - AUC-ROC:   0.5445
2025-11-04 14:13:57 - utils - INFO - ============================================================

2025-11-04 14:13:57 - utils - ERROR - ✗ Deep Clustering training failed: Path.replace() takes 2 positional arguments but 3 were given
2025-11-04 14:13:57 - utils - INFO - 
✓ Stage 3 completed: 1 models trained
2025-11-04 14:13:58 - utils - INFO - Utility functions loaded successfully
2025-11-04 14:14:00 - utils - INFO - ================================================================================
2025-11-04 14:14:00 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-11-04 14:14:00 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-11-04 14:14:00 - utils - INFO - ================================================================================
2025-11-04 14:14:00 - utils - INFO - 
================================================================================
                           STAGE 4: MODEL EVALUATION                            
================================================================================

2025-11-04 14:14:00 - utils - INFO - 
================================================================================
                         COMPREHENSIVE MODEL EVALUATION                         
================================================================================

2025-11-04 14:14:00 - utils - INFO - Loading results for all models...
2025-11-04 14:14:00 - utils - INFO - Loaded results for isolation_forest
2025-11-04 14:14:00 - utils - INFO - Loaded results for lstm_autoencoder
2025-11-04 14:14:00 - utils - INFO - Loaded results for deep_clustering
2025-11-04 14:14:00 - utils - INFO - Loaded results for 3 models
2025-11-04 14:14:00 - utils - INFO - Creating metrics comparison table...
2025-11-04 14:14:00 - utils - INFO - Metrics comparison table created
2025-11-04 14:14:00 - utils - INFO - Creating confusion matrix plots...
2025-11-04 14:14:00 - utils - INFO - Confusion matrices saved to /Users/bipinrimal/Downloads/Thesis_work/results/confusion_matrices/all_models.png
2025-11-04 14:14:00 - utils - INFO - Creating ROC curves...
2025-11-04 14:14:01 - utils - INFO - ROC curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/roc_curves/roc_comparison.png
2025-11-04 14:14:01 - utils - INFO - Creating Precision-Recall curves...
2025-11-04 14:14:01 - utils - INFO - Precision-Recall curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/precision_recall_comparison.png
2025-11-04 14:14:01 - utils - INFO - Creating metrics comparison bar chart...
2025-11-04 14:14:01 - utils - INFO - Metrics comparison bar chart saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/metrics_comparison_bar.png
2025-11-04 14:14:01 - utils - INFO - Creating anomaly score distribution plots...
2025-11-04 14:14:01 - utils - INFO - Score distributions saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/score_distributions.png
2025-11-04 14:14:01 - utils - INFO - Generating evaluation report...
2025-11-04 14:14:01 - utils - INFO - Evaluation report saved to /Users/bipinrimal/Downloads/Thesis_work/results/evaluation_report.txt
2025-11-04 14:14:01 - utils - INFO - Comprehensive evaluation completed!
2025-11-04 14:14:01 - utils - INFO - ✓ Stage 4 completed: Comprehensive evaluation report generated
2025-11-04 14:59:39 - utils - INFO - Utility functions loaded successfully
2025-11-04 15:03:56 - utils - INFO - Loaded dataframe from /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv
2025-11-04 15:03:56 - utils - INFO - 
================================================================================
                          FEATURE ENGINEERING PIPELINE                          
================================================================================

2025-11-04 15:03:56 - utils - INFO - Creating temporal features...
2025-11-04 15:04:25 - utils - INFO - Temporal features created
2025-11-04 15:04:25 - utils - INFO - Creating user aggregated features with window: 1D
2025-11-04 15:07:42 - utils - INFO - Created 11 aggregated features
2025-11-04 15:07:57 - utils - INFO - Creating behavioral ratio features...
2025-11-04 15:07:57 - utils - INFO - Behavioral ratio features created
2025-11-04 15:07:57 - utils - INFO - Creating statistical features per user...
2025-11-04 15:07:57 - utils - INFO - Created 70 statistical features
2025-11-04 15:07:58 - utils - INFO - Scaling features (fit=True)...
2025-11-04 15:07:59 - utils - INFO - Scaled 84 features
2025-11-04 15:07:59 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/feature_scaler.pkl
2025-11-04 15:07:59 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/label_encoders.pkl
2025-11-04 15:07:59 - utils - INFO - Feature engineering artifacts saved
2025-11-04 15:07:59 - utils - INFO - Feature engineering completed: 337561 samples, 84 features
2025-11-04 15:08:21 - utils - INFO - Saved dataframe to /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_features.csv
2025-11-04 15:08:21 - utils - INFO - Creating sequences with length=15, stride=10
2025-11-04 15:32:37 - utils - INFO - Created 2467828 sequences from 1000 users
2025-11-04 15:33:30 - utils - INFO - Sequences saved for LSTM training
2025-11-04 15:34:01 - utils - INFO - Utility functions loaded successfully
2025-11-04 15:34:04 - utils - INFO - ================================================================================
2025-11-04 15:34:04 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-11-04 15:34:04 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-11-04 15:34:04 - utils - INFO - ================================================================================
2025-11-04 15:34:04 - utils - INFO - 
================================================================================
                            STAGE 3: MODEL TRAINING                             
================================================================================

2025-11-04 15:34:04 - utils - INFO - 
>>> Training Isolation Forest...
2025-11-04 15:34:04 - utils - INFO - 
================================================================================
                           ISOLATION FOREST TRAINING                            
================================================================================

2025-11-04 15:34:06 - utils - INFO - Loaded dataframe from /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_features.csv
2025-11-04 15:34:06 - utils - INFO - Initialized Isolation Forest with params: {'n_estimators': 50, 'max_samples': 256, 'contamination': 0.01, 'max_features': 1.0, 'bootstrap': False, 'n_jobs': -1, 'random_state': 42, 'verbose': 0}
2025-11-04 15:34:06 - utils - INFO - Data split: Train=236292, Val=50634, Test=50635
2025-11-04 15:34:06 - utils - INFO - Training Isolation Forest...
2025-11-04 15:34:06 - utils - INFO - Isolation Forest training completed
2025-11-04 15:34:06 - utils - INFO - Calibrating threshold for target FPR=0.05
2025-11-04 15:34:06 - utils - INFO - Calibrated threshold: 0.5934
2025-11-04 15:34:06 - utils - INFO - Evaluating Isolation Forest...
2025-11-04 15:34:06 - utils - INFO - 
============================================================
2025-11-04 15:34:06 - utils - INFO - Isolation Forest Performance Metrics
2025-11-04 15:34:06 - utils - INFO - ============================================================
2025-11-04 15:34:06 - utils - INFO - Accuracy:  0.9898
2025-11-04 15:34:06 - utils - INFO - Precision: 0.5711
2025-11-04 15:34:06 - utils - INFO - Recall:    0.4779
2025-11-04 15:34:06 - utils - INFO - F1-Score:  0.5204
2025-11-04 15:34:06 - utils - INFO - AUC-ROC:   0.9919
2025-11-04 15:34:06 - utils - INFO - ============================================================

2025-11-04 15:34:06 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest.pkl
2025-11-04 15:34:06 - utils - INFO - Isolation Forest model saved to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest.pkl
2025-11-04 15:34:06 - utils - INFO - Isolation Forest training and evaluation completed!
2025-11-04 15:34:06 - utils - INFO - ✓ Isolation Forest training completed
2025-11-04 15:34:06 - utils - INFO - 
>>> Training LSTM Autoencoder...
2025-11-04 15:34:06 - utils - INFO - 
================================================================================
                            DEEP CLUSTERING TRAINING                            
================================================================================

2025-11-04 15:34:08 - utils - INFO - Loaded dataframe from /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_features.csv
2025-11-04 15:34:08 - utils - INFO - Data split: Train=236292, Val=50634, Test=50635
2025-11-04 15:34:08 - utils - INFO - Initialized Deep Clustering Model with input_dim=84
2025-11-04 15:34:08 - utils - INFO - Training deep clustering model...
2025-11-04 15:34:08 - utils - INFO - Initializing cluster centers with k-means...
2025-11-04 15:34:08 - utils - INFO - Building encoder network...
2025-11-04 15:34:08 - utils - INFO - Encoder architecture:
2025-11-04 15:34:08 - utils - INFO - Model: "Encoder"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┓
┃ Layer (type)                         ┃ Output Shape                ┃         Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━┩
│ input_layer (InputLayer)             │ (None, 84)                  │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ encoder_dense_0 (Dense)              │ (None, 64)                  │           5,440 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout (Dropout)                    │ (None, 64)                  │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ encoder_dense_1 (Dense)              │ (None, 32)                  │           2,080 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout_1 (Dropout)                  │ (None, 32)                  │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ encoding (Dense)                     │ (None, 32)                  │           1,056 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ l2_normalize (Lambda)                │ (None, 32)                  │               0 │
└──────────────────────────────────────┴─────────────────────────────┴─────────────────┘
 Total params: 8,576 (33.50 KB)
 Trainable params: 8,576 (33.50 KB)
 Non-trainable params: 0 (0.00 B)

2025-11-04 15:34:12 - utils - INFO - Initialized 5 cluster centers
2025-11-04 15:34:12 - utils - INFO - Building deep clustering model...
2025-11-04 15:34:12 - utils - INFO - Deep clustering model built
2025-11-04 15:34:12 - utils - INFO - Compiling deep clustering model...
2025-11-04 15:34:16 - utils - INFO - Epoch 0/30, Loss: 0.0059
2025-11-04 15:34:16 - utils - ERROR - ✗ LSTM Autoencoder training failed: The filename must end in `.weights.h5`. Received: filepath=/Users/bipinrimal/Downloads/Thesis_work/models/deep_clustering.pkl
2025-11-04 15:34:16 - utils - INFO - 
>>> Training Deep Clustering...
2025-11-04 15:34:16 - utils - INFO - 
================================================================================
                      LIGHTWEIGHT DEEP CLUSTERING TRAINING                      
================================================================================

2025-11-04 15:34:17 - utils - INFO - Loaded dataframe from /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_features.csv
2025-11-04 15:34:17 - utils - INFO - Dataset: 337561 samples, 84 features
2025-11-04 15:34:17 - utils - INFO - Data split: Train=236292, Val=50634, Test=50635
2025-11-04 15:34:17 - utils - INFO - Initialized Lightweight Deep Clustering (n_clusters=5, encoding_dim=32)
2025-11-04 15:34:17 - utils - INFO - Training lightweight deep clustering model...
2025-11-04 15:34:17 - utils - INFO - Fitting MiniBatch K-Means clustering...
2025-11-04 15:34:17 - utils - INFO - Lightweight deep clustering training completed
2025-11-04 15:34:17 - utils - INFO - Training completed in 0.14 seconds
2025-11-04 15:34:17 - utils - INFO - Calibrating threshold for target FPR=0.05
2025-11-04 15:34:17 - utils - INFO - Calibrated threshold: 0.7997
2025-11-04 15:34:17 - utils - INFO - Evaluating lightweight deep clustering model...
2025-11-04 15:34:17 - utils - INFO - 
============================================================
2025-11-04 15:34:17 - utils - INFO - Deep Clustering (Lightweight) Performance Metrics
2025-11-04 15:34:17 - utils - INFO - ============================================================
2025-11-04 15:34:17 - utils - INFO - Accuracy:  0.9441
2025-11-04 15:34:17 - utils - INFO - Precision: 0.0031
2025-11-04 15:34:17 - utils - INFO - Recall:    0.0119
2025-11-04 15:34:17 - utils - INFO - F1-Score:  0.0049
2025-11-04 15:34:17 - utils - INFO - AUC-ROC:   0.5445
2025-11-04 15:34:17 - utils - INFO - ============================================================

2025-11-04 15:34:17 - utils - ERROR - ✗ Deep Clustering training failed: Path.replace() takes 2 positional arguments but 3 were given
2025-11-04 15:34:17 - utils - INFO - 
✓ Stage 3 completed: 1 models trained
2025-11-04 15:49:28 - utils - INFO - Utility functions loaded successfully
2025-11-04 15:49:30 - utils - INFO - ================================================================================
2025-11-04 15:49:30 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-11-04 15:49:30 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-11-04 15:49:30 - utils - INFO - ================================================================================
2025-11-04 15:49:30 - utils - INFO - 
================================================================================
                            STAGE 3: MODEL TRAINING                             
================================================================================

2025-11-04 15:49:30 - utils - INFO - 
>>> Training Isolation Forest...
2025-11-04 15:49:30 - utils - INFO - 
================================================================================
                           ISOLATION FOREST TRAINING                            
================================================================================

2025-11-04 15:49:32 - utils - INFO - Loaded dataframe from /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_features.csv
2025-11-04 15:49:32 - utils - INFO - Initialized Isolation Forest with params: {'n_estimators': 50, 'max_samples': 256, 'contamination': 0.01, 'max_features': 1.0, 'bootstrap': False, 'n_jobs': -1, 'random_state': 42, 'verbose': 0}
2025-11-04 15:49:32 - utils - INFO - Data split: Train=236292, Val=50634, Test=50635
2025-11-04 15:49:32 - utils - INFO - Training Isolation Forest...
2025-11-04 15:49:32 - utils - INFO - Isolation Forest training completed
2025-11-04 15:49:32 - utils - INFO - Calibrating threshold for target FPR=0.05
2025-11-04 15:49:32 - utils - INFO - Calibrated threshold: 0.5934
2025-11-04 15:49:32 - utils - INFO - Evaluating Isolation Forest...
2025-11-04 15:49:32 - utils - INFO - 
============================================================
2025-11-04 15:49:32 - utils - INFO - Isolation Forest Performance Metrics
2025-11-04 15:49:32 - utils - INFO - ============================================================
2025-11-04 15:49:32 - utils - INFO - Accuracy:  0.9898
2025-11-04 15:49:32 - utils - INFO - Precision: 0.5711
2025-11-04 15:49:32 - utils - INFO - Recall:    0.4779
2025-11-04 15:49:32 - utils - INFO - F1-Score:  0.5204
2025-11-04 15:49:32 - utils - INFO - AUC-ROC:   0.9919
2025-11-04 15:49:32 - utils - INFO - ============================================================

2025-11-04 15:49:32 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest.pkl
2025-11-04 15:49:32 - utils - INFO - Isolation Forest model saved to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest.pkl
2025-11-04 15:49:32 - utils - INFO - Isolation Forest training and evaluation completed!
2025-11-04 15:49:32 - utils - INFO - ✓ Isolation Forest training completed
2025-11-04 15:49:32 - utils - INFO - 
>>> Training LSTM Autoencoder...
2025-11-04 15:49:32 - utils - INFO - 
================================================================================
                            DEEP CLUSTERING TRAINING                            
================================================================================

2025-11-04 15:49:34 - utils - INFO - Loaded dataframe from /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_features.csv
2025-11-04 15:49:34 - utils - INFO - Data split: Train=236292, Val=50634, Test=50635
2025-11-04 15:49:34 - utils - INFO - Initialized Deep Clustering Model with input_dim=84
2025-11-04 15:49:34 - utils - INFO - Training deep clustering model...
2025-11-04 15:49:34 - utils - INFO - Initializing cluster centers with k-means...
2025-11-04 15:49:34 - utils - INFO - Building encoder network...
2025-11-04 15:49:34 - utils - INFO - Encoder architecture:
2025-11-04 15:49:34 - utils - INFO - Model: "Encoder"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┓
┃ Layer (type)                         ┃ Output Shape                ┃         Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━┩
│ input_layer (InputLayer)             │ (None, 84)                  │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ encoder_dense_0 (Dense)              │ (None, 64)                  │           5,440 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout (Dropout)                    │ (None, 64)                  │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ encoder_dense_1 (Dense)              │ (None, 32)                  │           2,080 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout_1 (Dropout)                  │ (None, 32)                  │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ encoding (Dense)                     │ (None, 32)                  │           1,056 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ l2_normalize (Lambda)                │ (None, 32)                  │               0 │
└──────────────────────────────────────┴─────────────────────────────┴─────────────────┘
 Total params: 8,576 (33.50 KB)
 Trainable params: 8,576 (33.50 KB)
 Non-trainable params: 0 (0.00 B)

2025-11-04 15:49:38 - utils - INFO - Initialized 5 cluster centers
2025-11-04 15:49:38 - utils - INFO - Building deep clustering model...
2025-11-04 15:49:38 - utils - INFO - Deep clustering model built
2025-11-04 15:49:38 - utils - INFO - Compiling deep clustering model...
2025-11-04 15:49:41 - utils - INFO - Epoch 0/30, Loss: 0.0049
2025-11-04 15:49:41 - utils - ERROR - ✗ LSTM Autoencoder training failed: The filename must end in `.weights.h5`. Received: filepath=/Users/bipinrimal/Downloads/Thesis_work/models/deep_clustering.pkl
2025-11-04 15:49:41 - utils - INFO - 
>>> Training Deep Clustering...
2025-11-04 15:49:41 - utils - INFO - 
================================================================================
                      LIGHTWEIGHT DEEP CLUSTERING TRAINING                      
================================================================================

2025-11-04 15:49:43 - utils - INFO - Loaded dataframe from /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_features.csv
2025-11-04 15:49:43 - utils - INFO - Dataset: 337561 samples, 84 features
2025-11-04 15:49:43 - utils - INFO - Data split: Train=236292, Val=50634, Test=50635
2025-11-04 15:49:43 - utils - INFO - Initialized Lightweight Deep Clustering (n_clusters=5, encoding_dim=32)
2025-11-04 15:49:43 - utils - INFO - Training lightweight deep clustering model...
2025-11-04 15:49:43 - utils - INFO - Fitting MiniBatch K-Means clustering...
2025-11-04 15:49:43 - utils - INFO - Lightweight deep clustering training completed
2025-11-04 15:49:43 - utils - INFO - Training completed in 0.14 seconds
2025-11-04 15:49:43 - utils - INFO - Calibrating threshold for target FPR=0.05
2025-11-04 15:49:43 - utils - INFO - Calibrated threshold: 0.7997
2025-11-04 15:49:43 - utils - INFO - Evaluating lightweight deep clustering model...
2025-11-04 15:49:43 - utils - INFO - 
============================================================
2025-11-04 15:49:43 - utils - INFO - Deep Clustering (Lightweight) Performance Metrics
2025-11-04 15:49:43 - utils - INFO - ============================================================
2025-11-04 15:49:43 - utils - INFO - Accuracy:  0.9441
2025-11-04 15:49:43 - utils - INFO - Precision: 0.0031
2025-11-04 15:49:43 - utils - INFO - Recall:    0.0119
2025-11-04 15:49:43 - utils - INFO - F1-Score:  0.0049
2025-11-04 15:49:43 - utils - INFO - AUC-ROC:   0.5445
2025-11-04 15:49:43 - utils - INFO - ============================================================

2025-11-04 15:49:43 - utils - ERROR - ✗ Deep Clustering training failed: Path.replace() takes 2 positional arguments but 3 were given
2025-11-04 15:49:43 - utils - INFO - 
✓ Stage 3 completed: 1 models trained
2025-11-04 15:50:01 - utils - INFO - Utility functions loaded successfully
2025-11-04 15:50:01 - utils - INFO - 
================================================================================
                      LIGHTWEIGHT DEEP CLUSTERING TRAINING                      
================================================================================

2025-11-04 15:50:02 - utils - INFO - Loaded dataframe from /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_features.csv
2025-11-04 15:50:02 - utils - INFO - Dataset: 337561 samples, 84 features
2025-11-04 15:50:02 - utils - INFO - Data split: Train=236292, Val=50634, Test=50635
2025-11-04 15:50:02 - utils - INFO - Initialized Lightweight Deep Clustering (n_clusters=5, encoding_dim=32)
2025-11-04 15:50:02 - utils - INFO - Training lightweight deep clustering model...
2025-11-04 15:50:02 - utils - INFO - Fitting MiniBatch K-Means clustering...
2025-11-04 15:50:02 - utils - INFO - Lightweight deep clustering training completed
2025-11-04 15:50:02 - utils - INFO - Training completed in 0.16 seconds
2025-11-04 15:50:02 - utils - INFO - Calibrating threshold for target FPR=0.05
2025-11-04 15:50:02 - utils - INFO - Calibrated threshold: 0.7997
2025-11-04 15:50:02 - utils - INFO - Evaluating lightweight deep clustering model...
2025-11-04 15:50:02 - utils - INFO - 
============================================================
2025-11-04 15:50:02 - utils - INFO - Deep Clustering (Lightweight) Performance Metrics
2025-11-04 15:50:02 - utils - INFO - ============================================================
2025-11-04 15:50:02 - utils - INFO - Accuracy:  0.9441
2025-11-04 15:50:02 - utils - INFO - Precision: 0.0031
2025-11-04 15:50:02 - utils - INFO - Recall:    0.0119
2025-11-04 15:50:02 - utils - INFO - F1-Score:  0.0049
2025-11-04 15:50:02 - utils - INFO - AUC-ROC:   0.5445
2025-11-04 15:50:02 - utils - INFO - ============================================================

2025-11-04 15:50:02 - utils - INFO - Lightweight deep clustering model saved to /Users/bipinrimal/Downloads/Thesis_work/models/deep_clustering.pkl
2025-11-04 15:50:02 - utils - INFO - Lightweight deep clustering training and evaluation completed!
2025-11-04 15:50:02 - utils - INFO - Total time: 0.16 seconds
2025-11-04 15:51:35 - utils - INFO - Utility functions loaded successfully
2025-11-04 15:51:38 - utils - INFO - ================================================================================
2025-11-04 15:51:38 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-11-04 15:51:38 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-11-04 15:51:38 - utils - INFO - ================================================================================
2025-11-04 15:51:38 - utils - INFO - 
================================================================================
                           STAGE 4: MODEL EVALUATION                            
================================================================================

2025-11-04 15:51:38 - utils - INFO - 
================================================================================
                         COMPREHENSIVE MODEL EVALUATION                         
================================================================================

2025-11-04 15:51:38 - utils - INFO - Loading results for all models...
2025-11-04 15:51:38 - utils - INFO - Loaded results for isolation_forest
2025-11-04 15:51:38 - utils - INFO - Loaded results for lstm_autoencoder
2025-11-04 15:51:38 - utils - INFO - Loaded results for deep_clustering
2025-11-04 15:51:38 - utils - INFO - Loaded results for 3 models
2025-11-04 15:51:38 - utils - INFO - Creating metrics comparison table...
2025-11-04 15:51:38 - utils - INFO - Metrics comparison table created
2025-11-04 15:51:38 - utils - INFO - Creating confusion matrix plots...
2025-11-04 15:51:38 - utils - INFO - Confusion matrices saved to /Users/bipinrimal/Downloads/Thesis_work/results/confusion_matrices/all_models.png
2025-11-04 15:51:38 - utils - INFO - Creating ROC curves...
2025-11-04 15:51:38 - utils - INFO - ROC curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/roc_curves/roc_comparison.png
2025-11-04 15:51:38 - utils - INFO - Creating Precision-Recall curves...
2025-11-04 15:51:39 - utils - INFO - Precision-Recall curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/precision_recall_comparison.png
2025-11-04 15:51:39 - utils - INFO - Creating metrics comparison bar chart...
2025-11-04 15:51:39 - utils - INFO - Metrics comparison bar chart saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/metrics_comparison_bar.png
2025-11-04 15:51:39 - utils - INFO - Creating anomaly score distribution plots...
2025-11-04 15:51:39 - utils - INFO - Score distributions saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/score_distributions.png
2025-11-04 15:51:39 - utils - INFO - Generating evaluation report...
2025-11-04 15:51:39 - utils - INFO - Evaluation report saved to /Users/bipinrimal/Downloads/Thesis_work/results/evaluation_report.txt
2025-11-04 15:51:39 - utils - INFO - Comprehensive evaluation completed!
2025-11-04 15:51:39 - utils - INFO - ✓ Stage 4 completed: Comprehensive evaluation report generated
2025-11-04 15:52:04 - utils - INFO - Utility functions loaded successfully
2025-11-04 15:52:06 - utils - INFO - ================================================================================
2025-11-04 15:52:06 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-11-04 15:52:06 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-11-04 15:52:06 - utils - INFO - ================================================================================
2025-11-04 15:52:06 - utils - INFO - 
================================================================================
                         STAGE 5: ENSEMBLE INTEGRATION                          
================================================================================

2025-11-04 15:52:06 - utils - INFO - Initialized Ensemble Detector with method: weighted
2025-11-04 15:52:06 - utils - INFO - 
================================================================================
                            ENSEMBLE SYSTEM PIPELINE                            
================================================================================

2025-11-04 15:52:06 - utils - INFO - Loading predictions from individual models...
2025-11-04 15:52:06 - utils - INFO - Loaded isolation_forest predictions: 50635 samples
2025-11-04 15:52:06 - utils - INFO - Loaded lstm_autoencoder predictions: 739823 samples
2025-11-04 15:52:06 - utils - INFO - Loaded deep_clustering predictions: 50635 samples
2025-11-04 15:52:06 - utils - WARNING - Models have different sample counts: {'isolation_forest': 50635, 'lstm_autoencoder': 739823, 'deep_clustering': 50635}
2025-11-04 15:52:06 - utils - INFO - Will use aggregation strategy to align predictions...
2025-11-04 15:52:06 - utils - INFO - Aligning predictions across models...
2025-11-04 15:52:06 - utils - INFO - Using isolation_forest as reference (50635 samples)
2025-11-04 15:52:06 - utils - INFO - Aggregating lstm_autoencoder from 739823 to 50635 samples
2025-11-04 15:52:06 - utils - INFO - Predictions aligned successfully
2025-11-04 15:52:06 - utils - INFO - Loaded predictions from 3 models
2025-11-04 15:52:06 - utils - INFO - Computing weighted ensemble...
2025-11-04 15:52:06 - utils - INFO - Weighted ensemble: 166 anomalies detected
2025-11-04 15:52:06 - utils - INFO - Evaluating ensemble performance...
2025-11-04 15:52:06 - utils - INFO - 
============================================================
2025-11-04 15:52:06 - utils - INFO - Ensemble (weighted) Performance Metrics
2025-11-04 15:52:06 - utils - INFO - ============================================================
2025-11-04 15:52:06 - utils - INFO - Accuracy:  0.9894
2025-11-04 15:52:06 - utils - INFO - Precision: 0.6506
2025-11-04 15:52:06 - utils - INFO - Recall:    0.1837
2025-11-04 15:52:06 - utils - INFO - F1-Score:  0.2865
2025-11-04 15:52:06 - utils - INFO - AUC-ROC:   0.9638
2025-11-04 15:52:06 - utils - INFO - ============================================================

2025-11-04 15:52:06 - utils - INFO - Comparing ensemble with individual models...
2025-11-04 15:52:06 - utils - INFO - Evaluating ensemble performance...
2025-11-04 15:52:06 - utils - INFO - 
============================================================
2025-11-04 15:52:06 - utils - INFO - Ensemble (weighted) Performance Metrics
2025-11-04 15:52:06 - utils - INFO - ============================================================
2025-11-04 15:52:06 - utils - INFO - Accuracy:  0.9894
2025-11-04 15:52:06 - utils - INFO - Precision: 0.6506
2025-11-04 15:52:06 - utils - INFO - Recall:    0.1837
2025-11-04 15:52:06 - utils - INFO - F1-Score:  0.2865
2025-11-04 15:52:06 - utils - INFO - AUC-ROC:   0.9638
2025-11-04 15:52:06 - utils - INFO - ============================================================

2025-11-04 15:52:06 - utils - INFO - 
Comparison Results:
2025-11-04 15:52:06 - utils - INFO - 
              model  accuracy  precision  recall  f1_score  auc_roc
   Isolation Forest    0.9898     0.5711  0.4779    0.5204   0.9919
   Lstm Autoencoder    0.9396     0.0126  0.0544    0.0205   0.5030
    Deep Clustering    0.9441     0.0031  0.0119    0.0049   0.5445
Ensemble (weighted)    0.9894     0.6506  0.1837    0.2865   0.9638
2025-11-04 15:52:06 - utils - INFO - Ensemble predictions saved
2025-11-04 15:52:06 - utils - INFO - Generating alerts...
2025-11-04 15:52:06 - utils - INFO - Generated 166 alerts
2025-11-04 15:52:06 - utils - INFO - Severity distribution:
severity
medium    165
high        1
Name: count, dtype: int64
2025-11-04 15:52:06 - utils - INFO - Alerts saved to /Users/bipinrimal/Downloads/Thesis_work/results/generated_alerts.csv
2025-11-04 15:52:06 - utils - INFO - Ensemble pipeline completed!
2025-11-04 15:52:06 - utils - INFO - Initialized Ensemble Detector with method: majority
2025-11-04 15:52:06 - utils - INFO - 
================================================================================
                            ENSEMBLE SYSTEM PIPELINE                            
================================================================================

2025-11-04 15:52:06 - utils - INFO - Loading predictions from individual models...
2025-11-04 15:52:06 - utils - INFO - Loaded isolation_forest predictions: 50635 samples
2025-11-04 15:52:06 - utils - INFO - Loaded lstm_autoencoder predictions: 739823 samples
2025-11-04 15:52:06 - utils - INFO - Loaded deep_clustering predictions: 50635 samples
2025-11-04 15:52:06 - utils - WARNING - Models have different sample counts: {'isolation_forest': 50635, 'lstm_autoencoder': 739823, 'deep_clustering': 50635}
2025-11-04 15:52:06 - utils - INFO - Will use aggregation strategy to align predictions...
2025-11-04 15:52:06 - utils - INFO - Aligning predictions across models...
2025-11-04 15:52:06 - utils - INFO - Using isolation_forest as reference (50635 samples)
2025-11-04 15:52:06 - utils - INFO - Aggregating lstm_autoencoder from 739823 to 50635 samples
2025-11-04 15:52:06 - utils - INFO - Predictions aligned successfully
2025-11-04 15:52:06 - utils - INFO - Loaded predictions from 3 models
2025-11-04 15:52:06 - utils - INFO - Computing majority voting ensemble...
2025-11-04 15:52:06 - utils - INFO - Majority voting: 129 anomalies detected
2025-11-04 15:52:06 - utils - INFO - Evaluating ensemble performance...
2025-11-04 15:52:06 - utils - INFO - 
============================================================
2025-11-04 15:52:06 - utils - INFO - Ensemble (majority) Performance Metrics
2025-11-04 15:52:06 - utils - INFO - ============================================================
2025-11-04 15:52:06 - utils - INFO - Accuracy:  0.9864
2025-11-04 15:52:06 - utils - INFO - Precision: 0.1163
2025-11-04 15:52:06 - utils - INFO - Recall:    0.0255
2025-11-04 15:52:06 - utils - INFO - F1-Score:  0.0418
2025-11-04 15:52:06 - utils - INFO - AUC-ROC:   0.9367
2025-11-04 15:52:06 - utils - INFO - ============================================================

2025-11-04 15:52:06 - utils - INFO - Comparing ensemble with individual models...
2025-11-04 15:52:06 - utils - INFO - Evaluating ensemble performance...
2025-11-04 15:52:06 - utils - INFO - 
============================================================
2025-11-04 15:52:06 - utils - INFO - Ensemble (majority) Performance Metrics
2025-11-04 15:52:06 - utils - INFO - ============================================================
2025-11-04 15:52:06 - utils - INFO - Accuracy:  0.9864
2025-11-04 15:52:06 - utils - INFO - Precision: 0.1163
2025-11-04 15:52:06 - utils - INFO - Recall:    0.0255
2025-11-04 15:52:06 - utils - INFO - F1-Score:  0.0418
2025-11-04 15:52:06 - utils - INFO - AUC-ROC:   0.9367
2025-11-04 15:52:06 - utils - INFO - ============================================================

2025-11-04 15:52:06 - utils - INFO - 
Comparison Results:
2025-11-04 15:52:06 - utils - INFO - 
              model  accuracy  precision  recall  f1_score  auc_roc
   Isolation Forest    0.9898     0.5711  0.4779    0.5204   0.9919
   Lstm Autoencoder    0.9396     0.0126  0.0544    0.0205   0.5030
    Deep Clustering    0.9441     0.0031  0.0119    0.0049   0.5445
Ensemble (majority)    0.9864     0.1163  0.0255    0.0418   0.9367
2025-11-04 15:52:06 - utils - INFO - Ensemble predictions saved
2025-11-04 15:52:06 - utils - INFO - Generating alerts...
2025-11-04 15:52:06 - utils - INFO - Generated 102 alerts
2025-11-04 15:52:06 - utils - INFO - Severity distribution:
severity
medium    102
Name: count, dtype: int64
2025-11-04 15:52:06 - utils - INFO - Alerts saved to /Users/bipinrimal/Downloads/Thesis_work/results/generated_alerts.csv
2025-11-04 15:52:06 - utils - INFO - Ensemble pipeline completed!
2025-11-04 15:52:06 - utils - INFO - Initialized Ensemble Detector with method: cascade
2025-11-04 15:52:06 - utils - INFO - 
================================================================================
                            ENSEMBLE SYSTEM PIPELINE                            
================================================================================

2025-11-04 15:52:06 - utils - INFO - Loading predictions from individual models...
2025-11-04 15:52:06 - utils - INFO - Loaded isolation_forest predictions: 50635 samples
2025-11-04 15:52:06 - utils - INFO - Loaded lstm_autoencoder predictions: 739823 samples
2025-11-04 15:52:06 - utils - INFO - Loaded deep_clustering predictions: 50635 samples
2025-11-04 15:52:06 - utils - WARNING - Models have different sample counts: {'isolation_forest': 50635, 'lstm_autoencoder': 739823, 'deep_clustering': 50635}
2025-11-04 15:52:06 - utils - INFO - Will use aggregation strategy to align predictions...
2025-11-04 15:52:06 - utils - INFO - Aligning predictions across models...
2025-11-04 15:52:06 - utils - INFO - Using isolation_forest as reference (50635 samples)
2025-11-04 15:52:06 - utils - INFO - Aggregating lstm_autoencoder from 739823 to 50635 samples
2025-11-04 15:52:06 - utils - INFO - Predictions aligned successfully
2025-11-04 15:52:06 - utils - INFO - Loaded predictions from 3 models
2025-11-04 15:52:06 - utils - INFO - Computing cascade ensemble...
2025-11-04 15:52:06 - utils - INFO - Cascade ensemble: 0 anomalies detected
2025-11-04 15:52:06 - utils - INFO - Evaluating ensemble performance...
2025-11-04 15:52:06 - utils - INFO - 
============================================================
2025-11-04 15:52:06 - utils - INFO - Ensemble (cascade) Performance Metrics
2025-11-04 15:52:06 - utils - INFO - ============================================================
2025-11-04 15:52:06 - utils - INFO - Accuracy:  0.9884
2025-11-04 15:52:06 - utils - INFO - Precision: 0.0000
2025-11-04 15:52:06 - utils - INFO - Recall:    0.0000
2025-11-04 15:52:06 - utils - INFO - F1-Score:  0.0000
2025-11-04 15:52:06 - utils - INFO - AUC-ROC:   0.9477
2025-11-04 15:52:06 - utils - INFO - ============================================================

2025-11-04 15:52:06 - utils - INFO - Comparing ensemble with individual models...
2025-11-04 15:52:06 - utils - INFO - Evaluating ensemble performance...
2025-11-04 15:52:06 - utils - INFO - 
============================================================
2025-11-04 15:52:06 - utils - INFO - Ensemble (cascade) Performance Metrics
2025-11-04 15:52:06 - utils - INFO - ============================================================
2025-11-04 15:52:06 - utils - INFO - Accuracy:  0.9884
2025-11-04 15:52:06 - utils - INFO - Precision: 0.0000
2025-11-04 15:52:06 - utils - INFO - Recall:    0.0000
2025-11-04 15:52:06 - utils - INFO - F1-Score:  0.0000
2025-11-04 15:52:06 - utils - INFO - AUC-ROC:   0.9477
2025-11-04 15:52:06 - utils - INFO - ============================================================

2025-11-04 15:52:06 - utils - INFO - 
Comparison Results:
2025-11-04 15:52:06 - utils - INFO - 
             model  accuracy  precision  recall  f1_score  auc_roc
  Isolation Forest    0.9898     0.5711  0.4779    0.5204   0.9919
  Lstm Autoencoder    0.9396     0.0126  0.0544    0.0205   0.5030
   Deep Clustering    0.9441     0.0031  0.0119    0.0049   0.5445
Ensemble (cascade)    0.9884     0.0000  0.0000    0.0000   0.9477
2025-11-04 15:52:06 - utils - INFO - Ensemble predictions saved
2025-11-04 15:52:06 - utils - INFO - Generating alerts...
2025-11-04 15:52:06 - utils - INFO - Generated 9376 alerts
2025-11-04 15:52:06 - utils - INFO - Severity distribution:
severity
medium      8004
high        1310
critical      62
Name: count, dtype: int64
2025-11-04 15:52:06 - utils - INFO - Alerts saved to /Users/bipinrimal/Downloads/Thesis_work/results/generated_alerts.csv
2025-11-04 15:52:06 - utils - INFO - Ensemble pipeline completed!
2025-11-04 15:52:06 - utils - INFO - 
✓ Stage 5 completed: Best ensemble method = weighted (F1=0.2865)
2025-11-04 15:52:21 - utils - INFO - Utility functions loaded successfully
2025-11-04 15:52:23 - utils - INFO - ================================================================================
2025-11-04 15:52:23 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-11-04 15:52:23 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-11-04 15:52:23 - utils - INFO - ================================================================================
2025-11-04 15:52:23 - utils - INFO - 
================================================================================
                             STAGE 6: VISUALIZATION                             
================================================================================

2025-11-04 15:52:23 - utils - INFO - 
================================================================================
                           GENERATING VISUALIZATIONS                            
================================================================================

2025-11-04 15:52:23 - utils - INFO - Creating alert severity distribution plot...
2025-11-04 15:52:23 - utils - INFO - Alert severity distribution plot saved
2025-11-04 15:52:23 - utils - INFO - Creating model agreement plot...
2025-11-04 15:52:23 - utils - INFO - Model agreement plot saved
2025-11-04 15:52:23 - utils - INFO - Creating anomaly score timeline for ensemble_weighted...
2025-11-04 15:52:25 - utils - INFO - Anomaly score timeline saved for ensemble_weighted
2025-11-04 15:52:25 - utils - INFO - Creating feature importance visualization...
2025-11-04 15:52:25 - utils - INFO - Feature importance heatmap saved
2025-11-04 15:52:25 - utils - INFO - Creating executive summary chart...
2025-11-04 15:52:25 - utils - INFO - Executive summary chart saved
2025-11-04 15:52:25 - utils - INFO - All visualizations saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations
2025-11-04 15:52:25 - utils - INFO - Visualization generation completed!
2025-11-04 15:52:25 - utils - INFO - ✓ Stage 6 completed: All visualizations generated
2025-11-05 13:09:42 - utils - INFO - Utility functions loaded successfully
2025-11-05 13:09:59 - utils - INFO - Utility functions loaded successfully
2025-11-05 13:09:59 - utils - INFO - 
================================================================================
                            LABELING INSIDER THREATS                            
================================================================================

2025-11-05 13:09:59 - utils - INFO - Loading CMU-CERT answers file...
2025-11-05 13:09:59 - utils - INFO - Loaded 191 insider incidents
2025-11-05 13:09:59 - utils - INFO - Identified 191 unique insider users:
2025-11-05 13:09:59 - utils - INFO -   - AAF0535
2025-11-05 13:09:59 - utils - INFO -   - AAM0658
2025-11-05 13:09:59 - utils - INFO -   - ABB0427
2025-11-05 13:09:59 - utils - INFO -   - ABC0174
2025-11-05 13:09:59 - utils - INFO -   - ACA1126
2025-11-05 13:09:59 - utils - INFO -   - ACM1770
2025-11-05 13:09:59 - utils - INFO -   - ACM2278
2025-11-05 13:09:59 - utils - INFO -   - ADC1257
2025-11-05 13:09:59 - utils - INFO -   - AJR0932
2025-11-05 13:09:59 - utils - INFO -   - AKR0057
2025-11-05 13:09:59 - utils - INFO -   - ALT1465
2025-11-05 13:09:59 - utils - INFO -   - ALW0764
2025-11-05 13:09:59 - utils - INFO -   - AMC1883
2025-11-05 13:09:59 - utils - INFO -   - ASH0298
2025-11-05 13:09:59 - utils - INFO -   - ASH0458
2025-11-05 13:09:59 - utils - INFO -   - AYG1697
2025-11-05 13:09:59 - utils - INFO -   - BBS0039
2025-11-05 13:09:59 - utils - INFO -   - BDP0096
2025-11-05 13:09:59 - utils - INFO -   - BDV0168
2025-11-05 13:09:59 - utils - INFO -   - BGC0686
2025-11-05 13:09:59 - utils - INFO -   - BIH0745
2025-11-05 13:09:59 - utils - INFO -   - BLS0678
2025-11-05 13:09:59 - utils - INFO -   - BSS0369
2025-11-05 13:09:59 - utils - INFO -   - BTL0226
2025-11-05 13:09:59 - utils - INFO -   - BYO1846
2025-11-05 13:09:59 - utils - INFO -   - CAH0936
2025-11-05 13:09:59 - utils - INFO -   - CBW1826
2025-11-05 13:09:59 - utils - INFO -   - CCA0046
2025-11-05 13:09:59 - utils - INFO -   - CCH0959
2025-11-05 13:09:59 - utils - INFO -   - CCL0068
2025-11-05 13:09:59 - utils - INFO -   - CDE1846
2025-11-05 13:09:59 - utils - INFO -   - CEJ0109
2025-11-05 13:09:59 - utils - INFO -   - CGF1056
2025-11-05 13:09:59 - utils - INFO -   - CHP1711
2025-11-05 13:09:59 - utils - INFO -   - CIF1430
2025-11-05 13:09:59 - utils - INFO -   - CKP0630
2025-11-05 13:09:59 - utils - INFO -   - CMP2946
2025-11-05 13:09:59 - utils - INFO -   - CPD1525
2025-11-05 13:09:59 - utils - INFO -   - CQW0652
2025-11-05 13:09:59 - utils - INFO -   - CRD0272
2025-11-05 13:09:59 - utils - INFO -   - CSC0217
2025-11-05 13:09:59 - utils - INFO -   - CSF0929
2025-11-05 13:09:59 - utils - INFO -   - CSF2712
2025-11-05 13:09:59 - utils - INFO -   - CWW1120
2025-11-05 13:09:59 - utils - INFO -   - DAS1320
2025-11-05 13:09:59 - utils - INFO -   - DCC1119
2025-11-05 13:09:59 - utils - INFO -   - DCH0843
2025-11-05 13:09:59 - utils - INFO -   - DIB0285
2025-11-05 13:09:59 - utils - INFO -   - DIM0330
2025-11-05 13:09:59 - utils - INFO -   - DKG0161
2025-11-05 13:09:59 - utils - INFO -   - DNJ0740
2025-11-05 13:09:59 - utils - INFO -   - DQM0809
2025-11-05 13:09:59 - utils - INFO -   - DRR0162
2025-11-05 13:09:59 - utils - INFO -   - EDB0714
2025-11-05 13:09:59 - utils - INFO -   - EGD0132
2025-11-05 13:09:59 - utils - INFO -   - EHB0824
2025-11-05 13:09:59 - utils - INFO -   - EHD0584
2025-11-05 13:09:59 - utils - INFO -   - ELM1123
2025-11-05 13:09:59 - utils - INFO -   - ELT1370
2025-11-05 13:09:59 - utils - INFO -   - EPG1196
2025-11-05 13:09:59 - utils - INFO -   - ETW0002
2025-11-05 13:09:59 - utils - INFO -   - FMG0527
2025-11-05 13:09:59 - utils - INFO -   - FSC0601
2025-11-05 13:09:59 - utils - INFO -   - FTM0406
2025-11-05 13:09:59 - utils - INFO -   - FZG0389
2025-11-05 13:09:59 - utils - INFO -   - GCD0194
2025-11-05 13:09:59 - utils - INFO -   - GFM1815
2025-11-05 13:09:59 - utils - INFO -   - GHL0460
2025-11-05 13:09:59 - utils - INFO -   - GKW0043
2025-11-05 13:09:59 - utils - INFO -   - GMB0400
2025-11-05 13:09:59 - utils - INFO -   - GTD0219
2025-11-05 13:09:59 - utils - INFO -   - GWG0497
2025-11-05 13:09:59 - utils - INFO -   - HBO0413
2025-11-05 13:09:59 - utils - INFO -   - HBP1076
2025-11-05 13:09:59 - utils - INFO -   - HFC0492
2025-11-05 13:09:59 - utils - INFO -   - HIS1394
2025-11-05 13:09:59 - utils - INFO -   - HJB0462
2025-11-05 13:09:59 - utils - INFO -   - HJB0742
2025-11-05 13:09:59 - utils - INFO -   - HMS1658
2025-11-05 13:09:59 - utils - INFO -   - HSN0675
2025-11-05 13:09:59 - utils - INFO -   - HXL0968
2025-11-05 13:09:59 - utils - INFO -   - HXP0976
2025-11-05 13:09:59 - utils - INFO -   - ICB1354
2025-11-05 13:09:59 - utils - INFO -   - IHC0561
2025-11-05 13:09:59 - utils - INFO -   - IJM0776
2025-11-05 13:09:59 - utils - INFO -   - IKR0401
2025-11-05 13:09:59 - utils - INFO -   - IRH1224
2025-11-05 13:09:59 - utils - INFO -   - ISW0738
2025-11-05 13:09:59 - utils - INFO -   - ITA0159
2025-11-05 13:09:59 - utils - INFO -   - IUB0565
2025-11-05 13:09:59 - utils - INFO -   - JAK0783
2025-11-05 13:09:59 - utils - INFO -   - JAL0811
2025-11-05 13:09:59 - utils - INFO -   - JCC0016
2025-11-05 13:09:59 - utils - INFO -   - JCE0258
2025-11-05 13:09:59 - utils - INFO -   - JGT0221
2025-11-05 13:09:59 - utils - INFO -   - JIG1593
2025-11-05 13:09:59 - utils - INFO -   - JJM0203
2025-11-05 13:09:59 - utils - INFO -   - JKB0287
2025-11-05 13:09:59 - utils - INFO -   - JLM0364
2025-11-05 13:09:59 - utils - INFO -   - JMB0308
2025-11-05 13:09:59 - utils - INFO -   - JMM0613
2025-11-05 13:09:59 - utils - INFO -   - JNR1592
2025-11-05 13:09:59 - utils - INFO -   - JPH1910
2025-11-05 13:09:59 - utils - INFO -   - JRG0207
2025-11-05 13:09:59 - utils - INFO -   - JTC1885
2025-11-05 13:09:59 - utils - INFO -   - JTM0223
2025-11-05 13:09:59 - utils - INFO -   - JUP1472
2025-11-05 13:09:59 - utils - INFO -   - KBC1390
2025-11-05 13:09:59 - utils - INFO -   - KCM0466
2025-11-05 13:09:59 - utils - INFO -   - KDC0996
2025-11-05 13:09:59 - utils - INFO -   - KEW0198
2025-11-05 13:09:59 - utils - INFO -   - KLH0596
2025-11-05 13:09:59 - utils - INFO -   - KPC0073
2025-11-05 13:09:59 - utils - INFO -   - KRL0501
2025-11-05 13:09:59 - utils - INFO -   - KSS1005
2025-11-05 13:09:59 - utils - INFO -   - KTW0365
2025-11-05 13:09:59 - utils - INFO -   - LAH0463
2025-11-05 13:09:59 - utils - INFO -   - LBE0376
2025-11-05 13:09:59 - utils - INFO -   - LCC0819
2025-11-05 13:09:59 - utils - INFO -   - LJO1360
2025-11-05 13:09:59 - utils - INFO -   - LJR0523
2025-11-05 13:09:59 - utils - INFO -   - LQC0479
2025-11-05 13:09:59 - utils - INFO -   - LVF1626
2025-11-05 13:09:59 - utils - INFO -   - MAR0955
2025-11-05 13:09:59 - utils - INFO -   - MAS0025
2025-11-05 13:09:59 - utils - INFO -   - MBG3183
2025-11-05 13:09:59 - utils - INFO -   - MCF0600
2025-11-05 13:09:59 - utils - INFO -   - MCP0611
2025-11-05 13:09:59 - utils - INFO -   - MDH0580
2025-11-05 13:09:59 - utils - INFO -   - MDS0680
2025-11-05 13:09:59 - utils - INFO -   - MGB1235
2025-11-05 13:09:59 - utils - INFO -   - MIB0203
2025-11-05 13:09:59 - utils - INFO -   - MJR0711
2025-11-05 13:09:59 - utils - INFO -   - MOS0047
2025-11-05 13:09:59 - utils - INFO -   - MPF0690
2025-11-05 13:09:59 - utils - INFO -   - MPM0220
2025-11-05 13:09:59 - utils - INFO -   - MSO0222
2025-11-05 13:09:59 - utils - INFO -   - MTP1582
2025-11-05 13:09:59 - utils - INFO -   - MYD0978
2025-11-05 13:09:59 - utils - INFO -   - NAH1366
2025-11-05 13:09:59 - utils - INFO -   - NIV1608
2025-11-05 13:09:59 - utils - INFO -   - NKM1738
2025-11-05 13:09:59 - utils - INFO -   - NKN1405
2025-11-05 13:09:59 - utils - INFO -   - NWT0098
2025-11-05 13:09:59 - utils - INFO -   - NZL1395
2025-11-05 13:09:59 - utils - INFO -   - OFS0030
2025-11-05 13:09:59 - utils - INFO -   - OHS0036
2025-11-05 13:09:59 - utils - INFO -   - OKM1092
2025-11-05 13:09:59 - utils - INFO -   - ONS0995
2025-11-05 13:09:59 - utils - INFO -   - OSS1463
2025-11-05 13:09:59 - utils - INFO -   - PBC0077
2025-11-05 13:09:59 - utils - INFO -   - PLJ1771
2025-11-05 13:09:59 - utils - INFO -   - PNL0301
2025-11-05 13:09:59 - utils - INFO -   - PPF0435
2025-11-05 13:09:59 - utils - INFO -   - PSF0133
2025-11-05 13:09:59 - utils - INFO -   - PTH0005
2025-11-05 13:09:59 - utils - INFO -   - RAB0589
2025-11-05 13:09:59 - utils - INFO -   - RAR0725
2025-11-05 13:09:59 - utils - INFO -   - RCG0584
2025-11-05 13:09:59 - utils - INFO -   - RCW0822
2025-11-05 13:09:59 - utils - INFO -   - REF1924
2025-11-05 13:09:59 - utils - INFO -   - RGG0064
2025-11-05 13:09:59 - utils - INFO -   - RHL0992
2025-11-05 13:09:59 - utils - INFO -   - RKD0604
2025-11-05 13:09:59 - utils - INFO -   - RMW0542
2025-11-05 13:09:59 - utils - INFO -   - RRS0056
2025-11-05 13:09:59 - utils - INFO -   - SAF1942
2025-11-05 13:09:59 - utils - INFO -   - SIS0042
2025-11-05 13:09:59 - utils - INFO -   - SLL0193
2025-11-05 13:09:59 - utils - INFO -   - SNK1280
2025-11-05 13:09:59 - utils - INFO -   - TAP0551
2025-11-05 13:09:59 - utils - INFO -   - TMC0934
2025-11-05 13:09:59 - utils - INFO -   - TMT0851
2025-11-05 13:09:59 - utils - INFO -   - TNB1616
2025-11-05 13:09:59 - utils - INFO -   - TNM0961
2025-11-05 13:09:59 - utils - INFO -   - TRC1838
2025-11-05 13:09:59 - utils - INFO -   - VAH1292
2025-11-05 13:09:59 - utils - INFO -   - VCF1602
2025-11-05 13:09:59 - utils - INFO -   - VRP0267
2025-11-05 13:09:59 - utils - INFO -   - VSS0154
2025-11-05 13:09:59 - utils - INFO -   - WCW1013
2025-11-05 13:09:59 - utils - INFO -   - WDD0366
2025-11-05 13:09:59 - utils - INFO -   - WDT1634
2025-11-05 13:09:59 - utils - INFO -   - WHB1247
2025-11-05 13:09:59 - utils - INFO -   - WOS1834
2025-11-05 13:09:59 - utils - INFO -   - WSK1857
2025-11-05 13:09:59 - utils - INFO -   - WWW0701
2025-11-05 13:09:59 - utils - INFO -   - XHW0498
2025-11-05 13:09:59 - utils - INFO -   - ZEH0685
2025-11-05 13:09:59 - utils - INFO -   - ZIE0741
2025-11-05 13:09:59 - utils - INFO -   - ZKP0542
2025-11-05 13:09:59 - utils - WARNING - Could not parse dates for CDE1846: month must be in 1..12: /21/2011 11:43:39, at position 0
2025-11-05 13:09:59 - utils - INFO - Parsed 190 insider activity periods
2025-11-05 13:09:59 - utils - INFO - Loading processed data from /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv...
2025-11-05 13:13:54 - utils - INFO - Utility functions loaded successfully
2025-11-05 13:13:54 - utils - INFO - 
================================================================================
                            LABELING INSIDER THREATS                            
================================================================================

2025-11-05 13:13:54 - utils - INFO - Loading CMU-CERT answers file...
2025-11-05 13:13:54 - utils - INFO - Loaded 191 insider incidents
2025-11-05 13:13:54 - utils - INFO - Identified 191 unique insider users:
2025-11-05 13:13:54 - utils - INFO -   - AAF0535
2025-11-05 13:13:54 - utils - INFO -   - AAM0658
2025-11-05 13:13:54 - utils - INFO -   - ABB0427
2025-11-05 13:13:54 - utils - INFO -   - ABC0174
2025-11-05 13:13:54 - utils - INFO -   - ACA1126
2025-11-05 13:13:54 - utils - INFO -   - ACM1770
2025-11-05 13:13:54 - utils - INFO -   - ACM2278
2025-11-05 13:13:54 - utils - INFO -   - ADC1257
2025-11-05 13:13:54 - utils - INFO -   - AJR0932
2025-11-05 13:13:54 - utils - INFO -   - AKR0057
2025-11-05 13:13:54 - utils - INFO -   - ALT1465
2025-11-05 13:13:54 - utils - INFO -   - ALW0764
2025-11-05 13:13:54 - utils - INFO -   - AMC1883
2025-11-05 13:13:54 - utils - INFO -   - ASH0298
2025-11-05 13:13:54 - utils - INFO -   - ASH0458
2025-11-05 13:13:54 - utils - INFO -   - AYG1697
2025-11-05 13:13:54 - utils - INFO -   - BBS0039
2025-11-05 13:13:54 - utils - INFO -   - BDP0096
2025-11-05 13:13:54 - utils - INFO -   - BDV0168
2025-11-05 13:13:54 - utils - INFO -   - BGC0686
2025-11-05 13:13:54 - utils - INFO -   - BIH0745
2025-11-05 13:13:54 - utils - INFO -   - BLS0678
2025-11-05 13:13:54 - utils - INFO -   - BSS0369
2025-11-05 13:13:54 - utils - INFO -   - BTL0226
2025-11-05 13:13:54 - utils - INFO -   - BYO1846
2025-11-05 13:13:54 - utils - INFO -   - CAH0936
2025-11-05 13:13:54 - utils - INFO -   - CBW1826
2025-11-05 13:13:54 - utils - INFO -   - CCA0046
2025-11-05 13:13:54 - utils - INFO -   - CCH0959
2025-11-05 13:13:54 - utils - INFO -   - CCL0068
2025-11-05 13:13:54 - utils - INFO -   - CDE1846
2025-11-05 13:13:54 - utils - INFO -   - CEJ0109
2025-11-05 13:13:54 - utils - INFO -   - CGF1056
2025-11-05 13:13:54 - utils - INFO -   - CHP1711
2025-11-05 13:13:54 - utils - INFO -   - CIF1430
2025-11-05 13:13:54 - utils - INFO -   - CKP0630
2025-11-05 13:13:54 - utils - INFO -   - CMP2946
2025-11-05 13:13:54 - utils - INFO -   - CPD1525
2025-11-05 13:13:54 - utils - INFO -   - CQW0652
2025-11-05 13:13:54 - utils - INFO -   - CRD0272
2025-11-05 13:13:54 - utils - INFO -   - CSC0217
2025-11-05 13:13:54 - utils - INFO -   - CSF0929
2025-11-05 13:13:54 - utils - INFO -   - CSF2712
2025-11-05 13:13:54 - utils - INFO -   - CWW1120
2025-11-05 13:13:54 - utils - INFO -   - DAS1320
2025-11-05 13:13:54 - utils - INFO -   - DCC1119
2025-11-05 13:13:54 - utils - INFO -   - DCH0843
2025-11-05 13:13:54 - utils - INFO -   - DIB0285
2025-11-05 13:13:54 - utils - INFO -   - DIM0330
2025-11-05 13:13:54 - utils - INFO -   - DKG0161
2025-11-05 13:13:54 - utils - INFO -   - DNJ0740
2025-11-05 13:13:54 - utils - INFO -   - DQM0809
2025-11-05 13:13:54 - utils - INFO -   - DRR0162
2025-11-05 13:13:54 - utils - INFO -   - EDB0714
2025-11-05 13:13:54 - utils - INFO -   - EGD0132
2025-11-05 13:13:54 - utils - INFO -   - EHB0824
2025-11-05 13:13:54 - utils - INFO -   - EHD0584
2025-11-05 13:13:54 - utils - INFO -   - ELM1123
2025-11-05 13:13:54 - utils - INFO -   - ELT1370
2025-11-05 13:13:54 - utils - INFO -   - EPG1196
2025-11-05 13:13:54 - utils - INFO -   - ETW0002
2025-11-05 13:13:54 - utils - INFO -   - FMG0527
2025-11-05 13:13:54 - utils - INFO -   - FSC0601
2025-11-05 13:13:54 - utils - INFO -   - FTM0406
2025-11-05 13:13:54 - utils - INFO -   - FZG0389
2025-11-05 13:13:54 - utils - INFO -   - GCD0194
2025-11-05 13:13:54 - utils - INFO -   - GFM1815
2025-11-05 13:13:54 - utils - INFO -   - GHL0460
2025-11-05 13:13:54 - utils - INFO -   - GKW0043
2025-11-05 13:13:54 - utils - INFO -   - GMB0400
2025-11-05 13:13:54 - utils - INFO -   - GTD0219
2025-11-05 13:13:54 - utils - INFO -   - GWG0497
2025-11-05 13:13:54 - utils - INFO -   - HBO0413
2025-11-05 13:13:54 - utils - INFO -   - HBP1076
2025-11-05 13:13:54 - utils - INFO -   - HFC0492
2025-11-05 13:13:54 - utils - INFO -   - HIS1394
2025-11-05 13:13:54 - utils - INFO -   - HJB0462
2025-11-05 13:13:54 - utils - INFO -   - HJB0742
2025-11-05 13:13:54 - utils - INFO -   - HMS1658
2025-11-05 13:13:54 - utils - INFO -   - HSN0675
2025-11-05 13:13:54 - utils - INFO -   - HXL0968
2025-11-05 13:13:54 - utils - INFO -   - HXP0976
2025-11-05 13:13:54 - utils - INFO -   - ICB1354
2025-11-05 13:13:54 - utils - INFO -   - IHC0561
2025-11-05 13:13:54 - utils - INFO -   - IJM0776
2025-11-05 13:13:54 - utils - INFO -   - IKR0401
2025-11-05 13:13:54 - utils - INFO -   - IRH1224
2025-11-05 13:13:54 - utils - INFO -   - ISW0738
2025-11-05 13:13:54 - utils - INFO -   - ITA0159
2025-11-05 13:13:54 - utils - INFO -   - IUB0565
2025-11-05 13:13:54 - utils - INFO -   - JAK0783
2025-11-05 13:13:54 - utils - INFO -   - JAL0811
2025-11-05 13:13:54 - utils - INFO -   - JCC0016
2025-11-05 13:13:54 - utils - INFO -   - JCE0258
2025-11-05 13:13:54 - utils - INFO -   - JGT0221
2025-11-05 13:13:54 - utils - INFO -   - JIG1593
2025-11-05 13:13:54 - utils - INFO -   - JJM0203
2025-11-05 13:13:54 - utils - INFO -   - JKB0287
2025-11-05 13:13:54 - utils - INFO -   - JLM0364
2025-11-05 13:13:54 - utils - INFO -   - JMB0308
2025-11-05 13:13:54 - utils - INFO -   - JMM0613
2025-11-05 13:13:54 - utils - INFO -   - JNR1592
2025-11-05 13:13:54 - utils - INFO -   - JPH1910
2025-11-05 13:13:54 - utils - INFO -   - JRG0207
2025-11-05 13:13:54 - utils - INFO -   - JTC1885
2025-11-05 13:13:54 - utils - INFO -   - JTM0223
2025-11-05 13:13:54 - utils - INFO -   - JUP1472
2025-11-05 13:13:54 - utils - INFO -   - KBC1390
2025-11-05 13:13:54 - utils - INFO -   - KCM0466
2025-11-05 13:13:54 - utils - INFO -   - KDC0996
2025-11-05 13:13:54 - utils - INFO -   - KEW0198
2025-11-05 13:13:54 - utils - INFO -   - KLH0596
2025-11-05 13:13:54 - utils - INFO -   - KPC0073
2025-11-05 13:13:54 - utils - INFO -   - KRL0501
2025-11-05 13:13:54 - utils - INFO -   - KSS1005
2025-11-05 13:13:54 - utils - INFO -   - KTW0365
2025-11-05 13:13:54 - utils - INFO -   - LAH0463
2025-11-05 13:13:54 - utils - INFO -   - LBE0376
2025-11-05 13:13:54 - utils - INFO -   - LCC0819
2025-11-05 13:13:54 - utils - INFO -   - LJO1360
2025-11-05 13:13:54 - utils - INFO -   - LJR0523
2025-11-05 13:13:54 - utils - INFO -   - LQC0479
2025-11-05 13:13:54 - utils - INFO -   - LVF1626
2025-11-05 13:13:54 - utils - INFO -   - MAR0955
2025-11-05 13:13:54 - utils - INFO -   - MAS0025
2025-11-05 13:13:54 - utils - INFO -   - MBG3183
2025-11-05 13:13:54 - utils - INFO -   - MCF0600
2025-11-05 13:13:54 - utils - INFO -   - MCP0611
2025-11-05 13:13:54 - utils - INFO -   - MDH0580
2025-11-05 13:13:54 - utils - INFO -   - MDS0680
2025-11-05 13:13:54 - utils - INFO -   - MGB1235
2025-11-05 13:13:54 - utils - INFO -   - MIB0203
2025-11-05 13:13:54 - utils - INFO -   - MJR0711
2025-11-05 13:13:54 - utils - INFO -   - MOS0047
2025-11-05 13:13:54 - utils - INFO -   - MPF0690
2025-11-05 13:13:54 - utils - INFO -   - MPM0220
2025-11-05 13:13:54 - utils - INFO -   - MSO0222
2025-11-05 13:13:54 - utils - INFO -   - MTP1582
2025-11-05 13:13:54 - utils - INFO -   - MYD0978
2025-11-05 13:13:54 - utils - INFO -   - NAH1366
2025-11-05 13:13:54 - utils - INFO -   - NIV1608
2025-11-05 13:13:54 - utils - INFO -   - NKM1738
2025-11-05 13:13:54 - utils - INFO -   - NKN1405
2025-11-05 13:13:54 - utils - INFO -   - NWT0098
2025-11-05 13:13:54 - utils - INFO -   - NZL1395
2025-11-05 13:13:54 - utils - INFO -   - OFS0030
2025-11-05 13:13:54 - utils - INFO -   - OHS0036
2025-11-05 13:13:54 - utils - INFO -   - OKM1092
2025-11-05 13:13:54 - utils - INFO -   - ONS0995
2025-11-05 13:13:54 - utils - INFO -   - OSS1463
2025-11-05 13:13:54 - utils - INFO -   - PBC0077
2025-11-05 13:13:54 - utils - INFO -   - PLJ1771
2025-11-05 13:13:54 - utils - INFO -   - PNL0301
2025-11-05 13:13:54 - utils - INFO -   - PPF0435
2025-11-05 13:13:54 - utils - INFO -   - PSF0133
2025-11-05 13:13:54 - utils - INFO -   - PTH0005
2025-11-05 13:13:54 - utils - INFO -   - RAB0589
2025-11-05 13:13:54 - utils - INFO -   - RAR0725
2025-11-05 13:13:54 - utils - INFO -   - RCG0584
2025-11-05 13:13:54 - utils - INFO -   - RCW0822
2025-11-05 13:13:54 - utils - INFO -   - REF1924
2025-11-05 13:13:54 - utils - INFO -   - RGG0064
2025-11-05 13:13:54 - utils - INFO -   - RHL0992
2025-11-05 13:13:54 - utils - INFO -   - RKD0604
2025-11-05 13:13:54 - utils - INFO -   - RMW0542
2025-11-05 13:13:54 - utils - INFO -   - RRS0056
2025-11-05 13:13:54 - utils - INFO -   - SAF1942
2025-11-05 13:13:54 - utils - INFO -   - SIS0042
2025-11-05 13:13:54 - utils - INFO -   - SLL0193
2025-11-05 13:13:54 - utils - INFO -   - SNK1280
2025-11-05 13:13:54 - utils - INFO -   - TAP0551
2025-11-05 13:13:54 - utils - INFO -   - TMC0934
2025-11-05 13:13:54 - utils - INFO -   - TMT0851
2025-11-05 13:13:54 - utils - INFO -   - TNB1616
2025-11-05 13:13:54 - utils - INFO -   - TNM0961
2025-11-05 13:13:54 - utils - INFO -   - TRC1838
2025-11-05 13:13:54 - utils - INFO -   - VAH1292
2025-11-05 13:13:54 - utils - INFO -   - VCF1602
2025-11-05 13:13:54 - utils - INFO -   - VRP0267
2025-11-05 13:13:54 - utils - INFO -   - VSS0154
2025-11-05 13:13:54 - utils - INFO -   - WCW1013
2025-11-05 13:13:54 - utils - INFO -   - WDD0366
2025-11-05 13:13:54 - utils - INFO -   - WDT1634
2025-11-05 13:13:54 - utils - INFO -   - WHB1247
2025-11-05 13:13:54 - utils - INFO -   - WOS1834
2025-11-05 13:13:54 - utils - INFO -   - WSK1857
2025-11-05 13:13:54 - utils - INFO -   - WWW0701
2025-11-05 13:13:54 - utils - INFO -   - XHW0498
2025-11-05 13:13:54 - utils - INFO -   - ZEH0685
2025-11-05 13:13:54 - utils - INFO -   - ZIE0741
2025-11-05 13:13:54 - utils - INFO -   - ZKP0542
2025-11-05 13:13:54 - utils - WARNING - Could not parse dates for CDE1846: month must be in 1..12: /21/2011 11:43:39, at position 0
2025-11-05 13:13:54 - utils - INFO - Parsed 190 insider activity periods
2025-11-05 13:13:54 - utils - INFO - Loading processed data from /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv...
2025-11-05 13:15:32 - utils - INFO - Utility functions loaded successfully
2025-11-05 13:15:32 - utils - INFO - 
================================================================================
                            LABELING INSIDER THREATS                            
================================================================================

2025-11-05 13:15:32 - utils - INFO - Loading CMU-CERT answers file...
2025-11-05 13:15:32 - utils - INFO - Loaded 191 insider incidents
2025-11-05 13:15:32 - utils - INFO - Identified 191 unique insider users:
2025-11-05 13:15:32 - utils - INFO -   - AAF0535
2025-11-05 13:15:32 - utils - INFO -   - AAM0658
2025-11-05 13:15:32 - utils - INFO -   - ABB0427
2025-11-05 13:15:32 - utils - INFO -   - ABC0174
2025-11-05 13:15:32 - utils - INFO -   - ACA1126
2025-11-05 13:15:32 - utils - INFO -   - ACM1770
2025-11-05 13:15:32 - utils - INFO -   - ACM2278
2025-11-05 13:15:32 - utils - INFO -   - ADC1257
2025-11-05 13:15:32 - utils - INFO -   - AJR0932
2025-11-05 13:15:32 - utils - INFO -   - AKR0057
2025-11-05 13:15:32 - utils - INFO -   - ALT1465
2025-11-05 13:15:32 - utils - INFO -   - ALW0764
2025-11-05 13:15:32 - utils - INFO -   - AMC1883
2025-11-05 13:15:32 - utils - INFO -   - ASH0298
2025-11-05 13:15:32 - utils - INFO -   - ASH0458
2025-11-05 13:15:32 - utils - INFO -   - AYG1697
2025-11-05 13:15:32 - utils - INFO -   - BBS0039
2025-11-05 13:15:32 - utils - INFO -   - BDP0096
2025-11-05 13:15:32 - utils - INFO -   - BDV0168
2025-11-05 13:15:32 - utils - INFO -   - BGC0686
2025-11-05 13:15:32 - utils - INFO -   - BIH0745
2025-11-05 13:15:32 - utils - INFO -   - BLS0678
2025-11-05 13:15:32 - utils - INFO -   - BSS0369
2025-11-05 13:15:32 - utils - INFO -   - BTL0226
2025-11-05 13:15:32 - utils - INFO -   - BYO1846
2025-11-05 13:15:32 - utils - INFO -   - CAH0936
2025-11-05 13:15:32 - utils - INFO -   - CBW1826
2025-11-05 13:15:32 - utils - INFO -   - CCA0046
2025-11-05 13:15:32 - utils - INFO -   - CCH0959
2025-11-05 13:15:32 - utils - INFO -   - CCL0068
2025-11-05 13:15:32 - utils - INFO -   - CDE1846
2025-11-05 13:15:32 - utils - INFO -   - CEJ0109
2025-11-05 13:15:32 - utils - INFO -   - CGF1056
2025-11-05 13:15:32 - utils - INFO -   - CHP1711
2025-11-05 13:15:32 - utils - INFO -   - CIF1430
2025-11-05 13:15:32 - utils - INFO -   - CKP0630
2025-11-05 13:15:32 - utils - INFO -   - CMP2946
2025-11-05 13:15:32 - utils - INFO -   - CPD1525
2025-11-05 13:15:32 - utils - INFO -   - CQW0652
2025-11-05 13:15:32 - utils - INFO -   - CRD0272
2025-11-05 13:15:32 - utils - INFO -   - CSC0217
2025-11-05 13:15:32 - utils - INFO -   - CSF0929
2025-11-05 13:15:32 - utils - INFO -   - CSF2712
2025-11-05 13:15:32 - utils - INFO -   - CWW1120
2025-11-05 13:15:32 - utils - INFO -   - DAS1320
2025-11-05 13:15:32 - utils - INFO -   - DCC1119
2025-11-05 13:15:32 - utils - INFO -   - DCH0843
2025-11-05 13:15:32 - utils - INFO -   - DIB0285
2025-11-05 13:15:32 - utils - INFO -   - DIM0330
2025-11-05 13:15:32 - utils - INFO -   - DKG0161
2025-11-05 13:15:32 - utils - INFO -   - DNJ0740
2025-11-05 13:15:32 - utils - INFO -   - DQM0809
2025-11-05 13:15:32 - utils - INFO -   - DRR0162
2025-11-05 13:15:32 - utils - INFO -   - EDB0714
2025-11-05 13:15:32 - utils - INFO -   - EGD0132
2025-11-05 13:15:32 - utils - INFO -   - EHB0824
2025-11-05 13:15:32 - utils - INFO -   - EHD0584
2025-11-05 13:15:32 - utils - INFO -   - ELM1123
2025-11-05 13:15:32 - utils - INFO -   - ELT1370
2025-11-05 13:15:32 - utils - INFO -   - EPG1196
2025-11-05 13:15:32 - utils - INFO -   - ETW0002
2025-11-05 13:15:32 - utils - INFO -   - FMG0527
2025-11-05 13:15:32 - utils - INFO -   - FSC0601
2025-11-05 13:15:32 - utils - INFO -   - FTM0406
2025-11-05 13:15:32 - utils - INFO -   - FZG0389
2025-11-05 13:15:32 - utils - INFO -   - GCD0194
2025-11-05 13:15:32 - utils - INFO -   - GFM1815
2025-11-05 13:15:32 - utils - INFO -   - GHL0460
2025-11-05 13:15:32 - utils - INFO -   - GKW0043
2025-11-05 13:15:32 - utils - INFO -   - GMB0400
2025-11-05 13:15:32 - utils - INFO -   - GTD0219
2025-11-05 13:15:32 - utils - INFO -   - GWG0497
2025-11-05 13:15:32 - utils - INFO -   - HBO0413
2025-11-05 13:15:32 - utils - INFO -   - HBP1076
2025-11-05 13:15:32 - utils - INFO -   - HFC0492
2025-11-05 13:15:32 - utils - INFO -   - HIS1394
2025-11-05 13:15:32 - utils - INFO -   - HJB0462
2025-11-05 13:15:32 - utils - INFO -   - HJB0742
2025-11-05 13:15:32 - utils - INFO -   - HMS1658
2025-11-05 13:15:32 - utils - INFO -   - HSN0675
2025-11-05 13:15:32 - utils - INFO -   - HXL0968
2025-11-05 13:15:32 - utils - INFO -   - HXP0976
2025-11-05 13:15:32 - utils - INFO -   - ICB1354
2025-11-05 13:15:32 - utils - INFO -   - IHC0561
2025-11-05 13:15:32 - utils - INFO -   - IJM0776
2025-11-05 13:15:32 - utils - INFO -   - IKR0401
2025-11-05 13:15:32 - utils - INFO -   - IRH1224
2025-11-05 13:15:32 - utils - INFO -   - ISW0738
2025-11-05 13:15:32 - utils - INFO -   - ITA0159
2025-11-05 13:15:32 - utils - INFO -   - IUB0565
2025-11-05 13:15:32 - utils - INFO -   - JAK0783
2025-11-05 13:15:32 - utils - INFO -   - JAL0811
2025-11-05 13:15:32 - utils - INFO -   - JCC0016
2025-11-05 13:15:32 - utils - INFO -   - JCE0258
2025-11-05 13:15:32 - utils - INFO -   - JGT0221
2025-11-05 13:15:32 - utils - INFO -   - JIG1593
2025-11-05 13:15:32 - utils - INFO -   - JJM0203
2025-11-05 13:15:32 - utils - INFO -   - JKB0287
2025-11-05 13:15:32 - utils - INFO -   - JLM0364
2025-11-05 13:15:32 - utils - INFO -   - JMB0308
2025-11-05 13:15:32 - utils - INFO -   - JMM0613
2025-11-05 13:15:32 - utils - INFO -   - JNR1592
2025-11-05 13:15:32 - utils - INFO -   - JPH1910
2025-11-05 13:15:32 - utils - INFO -   - JRG0207
2025-11-05 13:15:32 - utils - INFO -   - JTC1885
2025-11-05 13:15:32 - utils - INFO -   - JTM0223
2025-11-05 13:15:32 - utils - INFO -   - JUP1472
2025-11-05 13:15:32 - utils - INFO -   - KBC1390
2025-11-05 13:15:32 - utils - INFO -   - KCM0466
2025-11-05 13:15:32 - utils - INFO -   - KDC0996
2025-11-05 13:15:32 - utils - INFO -   - KEW0198
2025-11-05 13:15:32 - utils - INFO -   - KLH0596
2025-11-05 13:15:32 - utils - INFO -   - KPC0073
2025-11-05 13:15:32 - utils - INFO -   - KRL0501
2025-11-05 13:15:32 - utils - INFO -   - KSS1005
2025-11-05 13:15:32 - utils - INFO -   - KTW0365
2025-11-05 13:15:32 - utils - INFO -   - LAH0463
2025-11-05 13:15:32 - utils - INFO -   - LBE0376
2025-11-05 13:15:32 - utils - INFO -   - LCC0819
2025-11-05 13:15:32 - utils - INFO -   - LJO1360
2025-11-05 13:15:32 - utils - INFO -   - LJR0523
2025-11-05 13:15:32 - utils - INFO -   - LQC0479
2025-11-05 13:15:32 - utils - INFO -   - LVF1626
2025-11-05 13:15:32 - utils - INFO -   - MAR0955
2025-11-05 13:15:32 - utils - INFO -   - MAS0025
2025-11-05 13:15:32 - utils - INFO -   - MBG3183
2025-11-05 13:15:32 - utils - INFO -   - MCF0600
2025-11-05 13:15:32 - utils - INFO -   - MCP0611
2025-11-05 13:15:32 - utils - INFO -   - MDH0580
2025-11-05 13:15:32 - utils - INFO -   - MDS0680
2025-11-05 13:15:32 - utils - INFO -   - MGB1235
2025-11-05 13:15:32 - utils - INFO -   - MIB0203
2025-11-05 13:15:32 - utils - INFO -   - MJR0711
2025-11-05 13:15:32 - utils - INFO -   - MOS0047
2025-11-05 13:15:32 - utils - INFO -   - MPF0690
2025-11-05 13:15:32 - utils - INFO -   - MPM0220
2025-11-05 13:15:32 - utils - INFO -   - MSO0222
2025-11-05 13:15:32 - utils - INFO -   - MTP1582
2025-11-05 13:15:32 - utils - INFO -   - MYD0978
2025-11-05 13:15:32 - utils - INFO -   - NAH1366
2025-11-05 13:15:32 - utils - INFO -   - NIV1608
2025-11-05 13:15:32 - utils - INFO -   - NKM1738
2025-11-05 13:15:32 - utils - INFO -   - NKN1405
2025-11-05 13:15:32 - utils - INFO -   - NWT0098
2025-11-05 13:15:32 - utils - INFO -   - NZL1395
2025-11-05 13:15:32 - utils - INFO -   - OFS0030
2025-11-05 13:15:32 - utils - INFO -   - OHS0036
2025-11-05 13:15:32 - utils - INFO -   - OKM1092
2025-11-05 13:15:32 - utils - INFO -   - ONS0995
2025-11-05 13:15:32 - utils - INFO -   - OSS1463
2025-11-05 13:15:32 - utils - INFO -   - PBC0077
2025-11-05 13:15:32 - utils - INFO -   - PLJ1771
2025-11-05 13:15:32 - utils - INFO -   - PNL0301
2025-11-05 13:15:32 - utils - INFO -   - PPF0435
2025-11-05 13:15:32 - utils - INFO -   - PSF0133
2025-11-05 13:15:32 - utils - INFO -   - PTH0005
2025-11-05 13:15:32 - utils - INFO -   - RAB0589
2025-11-05 13:15:32 - utils - INFO -   - RAR0725
2025-11-05 13:15:32 - utils - INFO -   - RCG0584
2025-11-05 13:15:32 - utils - INFO -   - RCW0822
2025-11-05 13:15:32 - utils - INFO -   - REF1924
2025-11-05 13:15:32 - utils - INFO -   - RGG0064
2025-11-05 13:15:32 - utils - INFO -   - RHL0992
2025-11-05 13:15:32 - utils - INFO -   - RKD0604
2025-11-05 13:15:32 - utils - INFO -   - RMW0542
2025-11-05 13:15:32 - utils - INFO -   - RRS0056
2025-11-05 13:15:32 - utils - INFO -   - SAF1942
2025-11-05 13:15:32 - utils - INFO -   - SIS0042
2025-11-05 13:15:32 - utils - INFO -   - SLL0193
2025-11-05 13:15:32 - utils - INFO -   - SNK1280
2025-11-05 13:15:32 - utils - INFO -   - TAP0551
2025-11-05 13:15:32 - utils - INFO -   - TMC0934
2025-11-05 13:15:32 - utils - INFO -   - TMT0851
2025-11-05 13:15:32 - utils - INFO -   - TNB1616
2025-11-05 13:15:32 - utils - INFO -   - TNM0961
2025-11-05 13:15:32 - utils - INFO -   - TRC1838
2025-11-05 13:15:32 - utils - INFO -   - VAH1292
2025-11-05 13:15:32 - utils - INFO -   - VCF1602
2025-11-05 13:15:32 - utils - INFO -   - VRP0267
2025-11-05 13:15:32 - utils - INFO -   - VSS0154
2025-11-05 13:15:32 - utils - INFO -   - WCW1013
2025-11-05 13:15:32 - utils - INFO -   - WDD0366
2025-11-05 13:15:32 - utils - INFO -   - WDT1634
2025-11-05 13:15:32 - utils - INFO -   - WHB1247
2025-11-05 13:15:32 - utils - INFO -   - WOS1834
2025-11-05 13:15:32 - utils - INFO -   - WSK1857
2025-11-05 13:15:32 - utils - INFO -   - WWW0701
2025-11-05 13:15:32 - utils - INFO -   - XHW0498
2025-11-05 13:15:32 - utils - INFO -   - ZEH0685
2025-11-05 13:15:32 - utils - INFO -   - ZIE0741
2025-11-05 13:15:32 - utils - INFO -   - ZKP0542
2025-11-05 13:15:32 - utils - WARNING - Could not parse dates for CDE1846: month must be in 1..12: /21/2011 11:43:39, at position 0
2025-11-05 13:15:32 - utils - INFO - Parsed 190 insider activity periods
2025-11-05 13:15:32 - utils - INFO - Loading processed data from /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv...
2025-11-05 13:17:39 - utils - INFO - Loaded 24,687,756 records
2025-11-05 13:17:39 - utils - INFO - Applying temporal labeling (only during attack periods)...
2025-11-05 13:17:43 - utils - INFO -   RCW0822: 1,184 records (2010-09-29 to 2010-10-15)
2025-11-05 13:17:44 - utils - INFO -   JCE0258: 636 records (2010-07-12 to 2010-09-03)
2025-11-05 13:19:12 - utils - INFO - 
Temporal labeling complete:
2025-11-05 13:19:12 - utils - INFO -   Normal records:   24,685,936 (99.99%)
2025-11-05 13:19:12 - utils - INFO -   Insider records:  1,820 (0.01%)
2025-11-05 13:22:32 - utils - INFO - 
Labeled data saved to /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv
2025-11-05 13:22:32 - utils - INFO - 
================================================================================
2025-11-05 13:22:32 - utils - INFO - INSIDER LABELING SUMMARY
2025-11-05 13:22:32 - utils - INFO - ================================================================================
2025-11-05 13:22:32 - utils - INFO - 
Insider Activity by User:
2025-11-05 13:22:32 - utils - INFO -   USER_28ddb9dfe958: 636 malicious records
2025-11-05 13:22:32 - utils - INFO -   USER_4e7a0b9a4f3a: 1,184 malicious records
2025-11-05 13:22:32 - utils - INFO - 
Insider Activity by Type:
2025-11-05 13:22:32 - utils - INFO -   http: 1,469
2025-11-05 13:22:32 - utils - INFO -   device: 233
2025-11-05 13:22:32 - utils - INFO -   file: 118
2025-11-05 13:22:32 - utils - INFO - 
Dataset Balance:
2025-11-05 13:22:32 - utils - INFO -   Total records:    24,687,756
2025-11-05 13:22:32 - utils - INFO -   Normal (0):       24,685,936 (99.99%)
2025-11-05 13:22:32 - utils - INFO -   Insider (1):      1,820 (0.01%)
2025-11-05 13:22:32 - utils - INFO -   Imbalance ratio:  1:13564
2025-11-05 13:22:32 - utils - INFO - 
================================================================================
2025-11-05 13:22:32 - utils - INFO - Summary saved to /Users/bipinrimal/Downloads/Thesis_work/results/insider_labeling_summary.txt
2025-11-05 13:23:04 - utils - INFO - Utility functions loaded successfully
2025-11-05 13:25:10 - utils - INFO - Loaded dataframe from /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv
2025-11-05 13:25:10 - utils - INFO - 
================================================================================
                          FEATURE ENGINEERING PIPELINE                          
================================================================================

2025-11-05 13:25:10 - utils - INFO - Creating temporal features...
2025-11-05 13:25:24 - utils - INFO - Temporal features created
2025-11-05 13:25:24 - utils - INFO - Creating user aggregated features with window: 1D
2025-11-05 13:27:03 - utils - INFO - Created 11 aggregated features
2025-11-05 13:27:10 - utils - INFO - Creating behavioral ratio features...
2025-11-05 13:27:10 - utils - INFO - Behavioral ratio features created
2025-11-05 13:27:10 - utils - INFO - Creating statistical features per user...
2025-11-05 13:27:10 - utils - INFO - Created 70 statistical features
2025-11-05 13:27:11 - utils - INFO - Scaling features (fit=True)...
2025-11-05 13:27:11 - utils - INFO - Scaled 84 features
2025-11-05 13:27:11 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/feature_scaler.pkl
2025-11-05 13:27:11 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/label_encoders.pkl
2025-11-05 13:27:11 - utils - INFO - Feature engineering artifacts saved
2025-11-05 13:27:11 - utils - INFO - Feature engineering completed: 337561 samples, 84 features
2025-11-05 13:27:29 - utils - INFO - Saved dataframe to /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_features.csv
2025-11-05 13:27:29 - utils - INFO - Creating sequences with length=15, stride=10
2025-11-05 13:49:17 - utils - INFO - Created 2467828 sequences from 1000 users
2025-11-05 13:49:47 - utils - INFO - Sequences saved for LSTM training
2025-11-05 14:00:19 - utils - INFO - Utility functions loaded successfully
2025-11-05 14:00:28 - utils - INFO - ================================================================================
2025-11-05 14:00:28 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-11-05 14:00:28 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-11-05 14:00:28 - utils - INFO - ================================================================================
2025-11-05 14:00:28 - utils - INFO - 
================================================================================
                            STAGE 3: MODEL TRAINING                             
================================================================================

2025-11-05 14:00:28 - utils - INFO - 
>>> Training Isolation Forest...
2025-11-05 14:00:28 - utils - INFO - 
================================================================================
                           ISOLATION FOREST TRAINING                            
================================================================================

2025-11-05 14:00:29 - utils - INFO - Loaded dataframe from /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_features.csv
2025-11-05 14:00:29 - utils - INFO - Initialized Isolation Forest with params: {'n_estimators': 50, 'max_samples': 256, 'contamination': 0.01, 'max_features': 1.0, 'bootstrap': False, 'n_jobs': -1, 'random_state': 42, 'verbose': 0}
2025-11-05 14:00:30 - utils - INFO - Data split: Train=236292, Val=50634, Test=50635
2025-11-05 14:00:30 - utils - INFO - Training Isolation Forest...
2025-11-05 14:00:30 - utils - INFO - Isolation Forest training completed
2025-11-05 14:00:30 - utils - INFO - Calibrating threshold for target FPR=0.05
2025-11-05 14:00:30 - utils - INFO - Calibrated threshold: 0.5848
2025-11-05 14:00:30 - utils - INFO - Evaluating Isolation Forest...
2025-11-05 14:00:30 - utils - INFO - 
============================================================
2025-11-05 14:00:30 - utils - INFO - Isolation Forest Performance Metrics
2025-11-05 14:00:30 - utils - INFO - ============================================================
2025-11-05 14:00:30 - utils - INFO - Accuracy:  0.9880
2025-11-05 14:00:30 - utils - INFO - Precision: 0.0000
2025-11-05 14:00:30 - utils - INFO - Recall:    0.0000
2025-11-05 14:00:30 - utils - INFO - F1-Score:  0.0000
2025-11-05 14:00:30 - utils - INFO - AUC-ROC:   0.7601
2025-11-05 14:00:30 - utils - INFO - ============================================================

2025-11-05 14:00:30 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest.pkl
2025-11-05 14:00:30 - utils - INFO - Isolation Forest model saved to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest.pkl
2025-11-05 14:00:30 - utils - INFO - Isolation Forest training and evaluation completed!
2025-11-05 14:00:30 - utils - INFO - ✓ Isolation Forest training completed
2025-11-05 14:00:30 - utils - INFO - 
>>> Training LSTM Autoencoder...
2025-11-05 14:00:30 - utils - INFO - 
================================================================================
                            DEEP CLUSTERING TRAINING                            
================================================================================

2025-11-05 14:00:32 - utils - INFO - Loaded dataframe from /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_features.csv
2025-11-05 14:00:32 - utils - INFO - Data split: Train=236292, Val=50634, Test=50635
2025-11-05 14:00:32 - utils - INFO - Initialized Deep Clustering Model with input_dim=84
2025-11-05 14:00:32 - utils - INFO - Training deep clustering model...
2025-11-05 14:00:32 - utils - INFO - Initializing cluster centers with k-means...
2025-11-05 14:00:32 - utils - INFO - Building encoder network...
2025-11-05 14:00:32 - utils - INFO - Encoder architecture:
2025-11-05 14:00:32 - utils - INFO - Model: "Encoder"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┓
┃ Layer (type)                         ┃ Output Shape                ┃         Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━┩
│ input_layer (InputLayer)             │ (None, 84)                  │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ encoder_dense_0 (Dense)              │ (None, 64)                  │           5,440 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout (Dropout)                    │ (None, 64)                  │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ encoder_dense_1 (Dense)              │ (None, 32)                  │           2,080 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout_1 (Dropout)                  │ (None, 32)                  │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ encoding (Dense)                     │ (None, 32)                  │           1,056 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ l2_normalize (Lambda)                │ (None, 32)                  │               0 │
└──────────────────────────────────────┴─────────────────────────────┴─────────────────┘
 Total params: 8,576 (33.50 KB)
 Trainable params: 8,576 (33.50 KB)
 Non-trainable params: 0 (0.00 B)

2025-11-05 14:00:36 - utils - INFO - Initialized 5 cluster centers
2025-11-05 14:00:36 - utils - INFO - Building deep clustering model...
2025-11-05 14:00:36 - utils - INFO - Deep clustering model built
2025-11-05 14:00:36 - utils - INFO - Compiling deep clustering model...
2025-11-05 14:00:39 - utils - INFO - Epoch 0/30, Loss: 0.0061
2025-11-05 14:00:39 - utils - ERROR - ✗ LSTM Autoencoder training failed: The filename must end in `.weights.h5`. Received: filepath=/Users/bipinrimal/Downloads/Thesis_work/models/deep_clustering.pkl
2025-11-05 14:00:39 - utils - INFO - 
>>> Training Deep Clustering...
2025-11-05 14:00:39 - utils - INFO - 
================================================================================
                      LIGHTWEIGHT DEEP CLUSTERING TRAINING                      
================================================================================

2025-11-05 14:00:41 - utils - INFO - Loaded dataframe from /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_features.csv
2025-11-05 14:00:41 - utils - INFO - Dataset: 337561 samples, 84 features
2025-11-05 14:00:41 - utils - INFO - Data split: Train=236292, Val=50634, Test=50635
2025-11-05 14:00:41 - utils - INFO - Initialized Lightweight Deep Clustering (n_clusters=5, encoding_dim=32)
2025-11-05 14:00:41 - utils - INFO - Training lightweight deep clustering model...
2025-11-05 14:00:41 - utils - INFO - Fitting MiniBatch K-Means clustering...
2025-11-05 14:00:41 - utils - INFO - Lightweight deep clustering training completed
2025-11-05 14:00:41 - utils - INFO - Training completed in 0.11 seconds
2025-11-05 14:00:41 - utils - INFO - Calibrating threshold for target FPR=0.05
2025-11-05 14:00:41 - utils - INFO - Calibrated threshold: 0.7681
2025-11-05 14:00:41 - utils - INFO - Evaluating lightweight deep clustering model...
2025-11-05 14:00:41 - utils - INFO - 
============================================================
2025-11-05 14:00:41 - utils - INFO - Deep Clustering (Lightweight) Performance Metrics
2025-11-05 14:00:41 - utils - INFO - ============================================================
2025-11-05 14:00:41 - utils - INFO - Accuracy:  0.9412
2025-11-05 14:00:41 - utils - INFO - Precision: 0.0117
2025-11-05 14:00:41 - utils - INFO - Recall:    0.5738
2025-11-05 14:00:41 - utils - INFO - F1-Score:  0.0230
2025-11-05 14:00:41 - utils - INFO - AUC-ROC:   0.8855
2025-11-05 14:00:41 - utils - INFO - ============================================================

2025-11-05 14:00:41 - utils - ERROR - ✗ Deep Clustering training failed: Path.replace() takes 2 positional arguments but 3 were given
2025-11-05 14:00:41 - utils - INFO - 
✓ Stage 3 completed: 1 models trained
2025-11-05 14:18:20 - utils - INFO - Utility functions loaded successfully
2025-11-05 14:18:20 - utils - INFO - 
================================================================================
                      LIGHTWEIGHT DEEP CLUSTERING TRAINING                      
================================================================================

2025-11-05 14:18:22 - utils - INFO - Loaded dataframe from /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_features.csv
2025-11-05 14:18:22 - utils - INFO - Dataset: 337561 samples, 84 features
2025-11-05 14:18:22 - utils - INFO - Data split: Train=236292, Val=50634, Test=50635
2025-11-05 14:18:22 - utils - INFO - Initialized Lightweight Deep Clustering (n_clusters=5, encoding_dim=32)
2025-11-05 14:18:22 - utils - INFO - Training lightweight deep clustering model...
2025-11-05 14:18:22 - utils - INFO - Fitting MiniBatch K-Means clustering...
2025-11-05 14:18:22 - utils - INFO - Lightweight deep clustering training completed
2025-11-05 14:18:22 - utils - INFO - Training completed in 0.12 seconds
2025-11-05 14:18:22 - utils - INFO - Calibrating threshold for target FPR=0.05
2025-11-05 14:18:22 - utils - INFO - Calibrated threshold: 0.7681
2025-11-05 14:18:22 - utils - INFO - Evaluating lightweight deep clustering model...
2025-11-05 14:18:22 - utils - INFO - 
============================================================
2025-11-05 14:18:22 - utils - INFO - Deep Clustering (Lightweight) Performance Metrics
2025-11-05 14:18:22 - utils - INFO - ============================================================
2025-11-05 14:18:22 - utils - INFO - Accuracy:  0.9412
2025-11-05 14:18:22 - utils - INFO - Precision: 0.0117
2025-11-05 14:18:22 - utils - INFO - Recall:    0.5738
2025-11-05 14:18:22 - utils - INFO - F1-Score:  0.0230
2025-11-05 14:18:22 - utils - INFO - AUC-ROC:   0.8855
2025-11-05 14:18:22 - utils - INFO - ============================================================

2025-11-05 14:18:22 - utils - INFO - Lightweight deep clustering model saved to /Users/bipinrimal/Downloads/Thesis_work/models/deep_clustering.pkl
2025-11-05 14:18:22 - utils - INFO - Lightweight deep clustering training and evaluation completed!
2025-11-05 14:18:22 - utils - INFO - Total time: 0.12 seconds
2025-11-05 14:18:35 - utils - INFO - Utility functions loaded successfully
2025-11-05 14:18:38 - utils - INFO - ================================================================================
2025-11-05 14:18:38 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-11-05 14:18:38 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-11-05 14:18:38 - utils - INFO - ================================================================================
2025-11-05 14:18:38 - utils - INFO - 
================================================================================
                           STAGE 4: MODEL EVALUATION                            
================================================================================

2025-11-05 14:18:38 - utils - INFO - 
================================================================================
                         COMPREHENSIVE MODEL EVALUATION                         
================================================================================

2025-11-05 14:18:38 - utils - INFO - Loading results for all models...
2025-11-05 14:18:38 - utils - INFO - Loaded results for isolation_forest
2025-11-05 14:18:38 - utils - INFO - Loaded results for lstm_autoencoder
2025-11-05 14:18:38 - utils - INFO - Loaded results for deep_clustering
2025-11-05 14:18:38 - utils - INFO - Loaded results for 3 models
2025-11-05 14:18:38 - utils - INFO - Creating metrics comparison table...
2025-11-05 14:18:38 - utils - INFO - Metrics comparison table created
2025-11-05 14:18:38 - utils - INFO - Creating confusion matrix plots...
2025-11-05 14:18:38 - utils - INFO - Confusion matrices saved to /Users/bipinrimal/Downloads/Thesis_work/results/confusion_matrices/all_models.png
2025-11-05 14:18:38 - utils - INFO - Creating ROC curves...
2025-11-05 14:18:38 - utils - INFO - ROC curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/roc_curves/roc_comparison.png
2025-11-05 14:18:38 - utils - INFO - Creating Precision-Recall curves...
2025-11-05 14:18:38 - utils - INFO - Precision-Recall curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/precision_recall_comparison.png
2025-11-05 14:18:38 - utils - INFO - Creating metrics comparison bar chart...
2025-11-05 14:18:39 - utils - INFO - Metrics comparison bar chart saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/metrics_comparison_bar.png
2025-11-05 14:18:39 - utils - INFO - Creating anomaly score distribution plots...
2025-11-05 14:18:39 - utils - INFO - Score distributions saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/score_distributions.png
2025-11-05 14:18:39 - utils - INFO - Generating evaluation report...
2025-11-05 14:18:39 - utils - INFO - Evaluation report saved to /Users/bipinrimal/Downloads/Thesis_work/results/evaluation_report.txt
2025-11-05 14:18:39 - utils - INFO - Comprehensive evaluation completed!
2025-11-05 14:18:39 - utils - INFO - ✓ Stage 4 completed: Comprehensive evaluation report generated
2025-11-06 12:51:21 - utils - INFO - Utility functions loaded successfully
2025-11-06 12:51:32 - utils - INFO - Utility functions loaded successfully
2025-11-06 12:51:40 - utils - INFO - Utility functions loaded successfully
2025-11-06 12:51:40 - utils - INFO - Loading detailed observable files...
2025-11-06 12:51:40 - utils - ERROR - Error: 'NoneType' object has no attribute 'iterrows'
2025-11-06 12:52:57 - utils - INFO - Utility functions loaded successfully
2025-11-06 12:53:16 - utils - INFO - Utility functions loaded successfully
2025-11-06 12:55:20 - utils - INFO - Utility functions loaded successfully
2025-11-06 13:00:33 - utils - INFO - Utility functions loaded successfully
2025-11-06 13:00:33 - utils - ERROR - Error: name 'answers' is not defined
2025-11-06 13:00:44 - utils - INFO - Utility functions loaded successfully
2025-11-06 13:00:44 - utils - INFO - Loading detailed observable files...
2025-11-06 13:00:44 - utils - ERROR - Error: 'NoneType' object has no attribute 'iterrows'
2025-11-06 13:01:02 - utils - INFO - Utility functions loaded successfully
2025-11-06 13:01:02 - utils - INFO - Loading detailed observable files...
2025-11-06 13:01:02 - utils - ERROR - Error: 'NoneType' object has no attribute 'iterrows'
2025-11-06 13:01:12 - utils - INFO - Utility functions loaded successfully
2025-11-06 13:01:12 - utils - INFO - Loading detailed observable files...
2025-11-06 13:01:12 - utils - ERROR - Error: 'NoneType' object has no attribute 'iterrows'
2025-11-06 13:01:26 - utils - INFO - Utility functions loaded successfully
2025-11-06 13:01:26 - utils - INFO - Loading detailed observable files...
2025-11-06 13:01:26 - utils - ERROR - Error: 'NoneType' object has no attribute 'iterrows'
2025-11-06 13:01:36 - utils - INFO - Utility functions loaded successfully
2025-11-06 13:01:36 - utils - INFO - Loading detailed observable files...
2025-11-06 13:01:36 - utils - ERROR - Error: 'NoneType' object has no attribute 'iterrows'
2025-11-06 13:01:53 - utils - INFO - Utility functions loaded successfully
2025-11-06 13:01:53 - utils - INFO - Loading detailed observable files...
2025-11-06 13:01:53 - utils - ERROR - Error: 'NoneType' object has no attribute 'iterrows'
2025-11-06 13:03:44 - utils - INFO - Utility functions loaded successfully
2025-11-06 13:03:44 - utils - INFO - Loading detailed observable files...
2025-11-06 13:03:44 - utils - ERROR - Error: 'NoneType' object has no attribute 'iterrows'
2025-11-06 13:05:05 - utils - INFO - Utility functions loaded successfully
2025-11-06 13:05:05 - utils - INFO - Loading detailed observable files...
2025-11-06 13:05:05 - utils - INFO - Loaded master file: 191 insider incidents
2025-11-06 13:05:05 - utils - INFO -   Loaded r2.csv: 26 events for ONS0995
2025-11-06 13:05:05 - utils - INFO -   Loaded r3.1-1.csv: 35 events for CSF0929
2025-11-06 13:05:05 - utils - INFO -   Loaded r3.1-2.csv: 310 events for CCH0959
2025-11-06 13:05:05 - utils - INFO -   Loaded r3.2-1.csv: 24 events for RCW0822
2025-11-06 13:05:05 - utils - INFO -   Loaded r3.2-2.csv: 253 events for JCE0258
2025-11-06 13:05:05 - utils - INFO -   Loaded r4.1-1.csv: 10 events for ABB0427
2025-11-06 13:05:05 - utils - INFO -   Loaded r4.1-2.csv: 246 events for HFC0492
2025-11-06 13:05:05 - utils - INFO -   Loaded r4.1-3.csv: 17 events for KTW0365
2025-11-06 13:05:05 - utils - WARNING -   Could not find r4.2-1-AAM0658.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r4.2-1-AJR0932.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r4.2-1-BDV0168.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r4.2-1-BIH0745.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r4.2-1-BLS0678.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r4.2-1-BTL0226.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r4.2-1-CAH0936.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r4.2-1-DCH0843.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r4.2-1-EHB0824.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r4.2-1-EHD0584.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r4.2-1-FMG0527.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r4.2-1-FTM0406.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r4.2-1-GHL0460.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r4.2-1-HJB0742.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r4.2-1-JMB0308.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r4.2-1-JRG0207.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r4.2-1-KLH0596.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r4.2-1-KPC0073.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r4.2-1-LJR0523.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r4.2-1-LQC0479.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r4.2-1-MAR0955.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r4.2-1-MAS0025.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r4.2-1-MCF0600.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r4.2-1-MYD0978.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r4.2-1-PPF0435.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r4.2-1-RAB0589.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r4.2-1-RGG0064.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r4.2-1-RKD0604.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r4.2-1-TAP0551.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r4.2-1-WDD0366.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r4.2-2-AAF0535.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r4.2-2-ABC0174.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r4.2-2-AKR0057.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r4.2-2-CCL0068.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r4.2-2-CEJ0109.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r4.2-2-CQW0652.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r4.2-2-DIB0285.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r4.2-2-DRR0162.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r4.2-2-EDB0714.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r4.2-2-EGD0132.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r4.2-2-FSC0601.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r4.2-2-HBO0413.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r4.2-2-HXL0968.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r4.2-2-IJM0776.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r4.2-2-IKR0401.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r4.2-2-IUB0565.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r4.2-2-JJM0203.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r4.2-2-KRL0501.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r4.2-2-LCC0819.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r4.2-2-MDH0580.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r4.2-2-MOS0047.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r4.2-2-NWT0098.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r4.2-2-PNL0301.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r4.2-2-PSF0133.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r4.2-2-RAR0725.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r4.2-2-RHL0992.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r4.2-2-RMW0542.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r4.2-2-TNM0961.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r4.2-2-VSS0154.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r4.2-2-XHW0498.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r4.2-3-BBS0039.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r4.2-3-BSS0369.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r4.2-3-CCA0046.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r4.2-3-CSC0217.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r4.2-3-GTD0219.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r4.2-3-JGT0221.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r4.2-3-JLM0364.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r4.2-3-JTM0223.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r4.2-3-MPM0220.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r4.2-3-MSO0222.csv
2025-11-06 13:05:05 - utils - INFO -   Loaded r5.1-1.csv: 23 events for JTC1885
2025-11-06 13:05:05 - utils - INFO -   Loaded r5.1-2.csv: 181 events for LBE0376
2025-11-06 13:05:05 - utils - INFO -   Loaded r5.1-3.csv: 33 events for BGC0686
2025-11-06 13:05:05 - utils - INFO -   Loaded r5.1-4.csv: 114 events for JAK0783
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-1-ALT1465.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-1-ALW0764.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-1-AYG1697.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-1-DAS1320.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-1-DNJ0740.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-1-ELT1370.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-1-EPG1196.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-1-ETW0002.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-1-FZG0389.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-1-GFM1815.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-1-IHC0561.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-1-ISW0738.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-1-JKB0287.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-1-JUP1472.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-1-KBC1390.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-1-KEW0198.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-1-MIB0203.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-1-NIV1608.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-1-PBC0077.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-1-PTH0005.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-1-REF1924.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-1-SAF1942.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-1-SLL0193.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-1-TMC0934.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-1-VAH1292.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-1-WHB1247.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-1-WSK1857.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-1-WWW0701.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-1-ZKP0542.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-2-VCF1602.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-2-KSS1005.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-2-MCP0611.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-2-TNB1616.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-2-ZIE0741.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-2-HXP0976.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-2-HIS1394.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-2-JAL0811.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-2-ITA0159.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-2-CIF1430.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-2-RRS0056.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-2-MDS0680.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-2-TMT0851.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-2-OSS1463.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-2-HSN0675.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-2-WDT1634.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-2-OKM1092.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-2-CKP0630.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-2-ICB1354.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-2-TRC1838.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-2-NAH1366.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-2-BYO1846.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-2-GWG0497.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-2-MGB1235.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-2-CHP1711.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-2-SNK1280.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-2-LVF1626.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-2-HMS1658.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-2-DCC1119.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-2-SIS0042.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-3-ACA1126.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-3-CRD0272.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-3-CWW1120.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-3-ELM1123.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-3-GKW0043.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-3-KCM0466.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-3-LAH0463.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-3-MPF0690.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-3-VRP0267.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-3-ZEH0685.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-4-ACM1770.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-4-AMC1883.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-4-ASH0298.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-4-ASH0458.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-4-BDP0096.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-4-CBW1826.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-4-CGF1056.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-4-CPD1525.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-4-DIM0330.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-4-DKG0161.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-4-DQM0809.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-4-GCD0194.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-4-GMB0400.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-4-HBP1076.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-4-IRH1224.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-4-JCC0016.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-4-JIG1593.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-4-JMM0613.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-4-JNR1592.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-4-KDC0996.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-4-MJR0711.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-4-MTP1582.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-4-NKM1738.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-4-NKN1405.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-4-NZL1395.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-4-OFS0030.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-4-OHS0036.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-4-RCG0584.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-4-WCW1013.csv
2025-11-06 13:05:05 - utils - WARNING -   Could not find r5.2-4-WOS1834.csv
2025-11-06 13:05:05 - utils - INFO -   Loaded r6.1-1.csv: 22 events for CSF2712
2025-11-06 13:05:05 - utils - INFO -   Loaded r6.1-2.csv: 226 events for JPH1910
2025-11-06 13:05:05 - utils - INFO -   Loaded r6.1-3.csv: 28 events for HJB0462
2025-11-06 13:05:05 - utils - WARNING -   Could not find r6.1-4.csv
2025-11-06 13:05:05 - utils - INFO -   Loaded r6.1-5.csv: 4 events for ADC1257
2025-11-06 13:05:05 - utils - INFO -   Loaded r6.2-1.csv: 22 events for ACM2278
2025-11-06 13:05:05 - utils - INFO -   Loaded r6.2-2.csv: 242 events for CMP2946
2025-11-06 13:05:05 - utils - INFO -   Loaded r6.2-3.csv: 68 events for PLJ1771
2025-11-06 13:05:05 - utils - INFO -   Loaded r6.2-4.csv: 134 events for CDE1846
2025-11-06 13:05:05 - utils - INFO -   Loaded r6.2-5.csv: 4 events for MBG3183
2025-11-06 13:05:05 - utils - INFO - Loaded 21 observable files
2025-11-06 13:05:05 - utils - INFO - 
================================================================================
                           VALIDATING INSIDER LABELS                            
================================================================================

2025-11-06 13:05:05 - utils - INFO - Loaded master file: 191 insider incidents
2025-11-06 13:05:05 - utils - INFO - 
Validating 191 unique insider users...
2025-11-06 13:05:05 - utils - INFO - Checking for user ONS0995 (sampling 50,000 rows)...
2025-11-06 13:06:19 - utils - WARNING -   User ONS0995 NOT FOUND in processed data!
2025-11-06 13:06:19 - utils - INFO - Checking for user CSF0929 (sampling 50,000 rows)...
2025-11-06 13:07:34 - utils - WARNING -   User CSF0929 NOT FOUND in processed data!
2025-11-06 13:07:34 - utils - INFO - Checking for user CCH0959 (sampling 50,000 rows)...
2025-11-06 13:08:53 - utils - WARNING -   User CCH0959 NOT FOUND in processed data!
2025-11-06 13:08:53 - utils - INFO - Checking for user RCW0822 (sampling 50,000 rows)...
2025-11-06 13:08:53 - utils - INFO -   Found 45 records for RCW0822 (chunk 1)
2025-11-06 13:08:53 - utils - INFO -   0 labeled as insider
2025-11-06 13:08:53 - utils - INFO - Checking for user JCE0258 (sampling 50,000 rows)...
2025-11-06 13:08:53 - utils - INFO -   Found 15 records for JCE0258 (chunk 1)
2025-11-06 13:08:53 - utils - INFO -   0 labeled as insider
2025-11-06 13:08:53 - utils - INFO - Checking for user ABB0427 (sampling 50,000 rows)...
2025-11-06 13:10:13 - utils - WARNING -   User ABB0427 NOT FOUND in processed data!
2025-11-06 13:10:13 - utils - INFO - Checking for user HFC0492 (sampling 50,000 rows)...
2025-11-06 13:11:29 - utils - WARNING -   User HFC0492 NOT FOUND in processed data!
2025-11-06 13:11:29 - utils - INFO - Checking for user KTW0365 (sampling 50,000 rows)...
2025-11-06 13:12:44 - utils - WARNING -   User KTW0365 NOT FOUND in processed data!
2025-11-06 13:12:44 - utils - INFO - Checking for user AAM0658 (sampling 50,000 rows)...
2025-11-06 13:14:05 - utils - WARNING -   User AAM0658 NOT FOUND in processed data!
2025-11-06 13:14:05 - utils - INFO - Checking for user AJR0932 (sampling 50,000 rows)...
2025-11-06 13:15:24 - utils - WARNING -   User AJR0932 NOT FOUND in processed data!
2025-11-06 13:15:24 - utils - INFO - 
Comparing observables for RCW0822 with processed data...
2025-11-06 13:15:24 - utils - INFO - Ground truth: 24 malicious events
2025-11-06 13:22:45 - utils - INFO - Utility functions loaded successfully
2025-11-06 13:22:45 - utils - INFO - 
================================================================================
                       MEMORY-EFFICIENT INSIDER LABELING                        
================================================================================

2025-11-06 13:22:45 - utils - INFO - Loaded 191 insider users from answers file
2025-11-06 13:22:45 - utils - INFO - Processing /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv in chunks of 50,000 rows...
2025-11-06 13:22:45 - utils - INFO - Scanning file...
2025-11-06 13:22:51 - utils - INFO - Total rows to process: 24,687,756
2025-11-06 13:22:51 - utils - INFO - Using user column: user
2025-11-06 13:22:52 - utils - INFO - Progress: 50,000/24,687,756 (0.2%) - Labeled: 60
2025-11-06 13:22:52 - utils - INFO - Progress: 100,000/24,687,756 (0.4%) - Labeled: 138
2025-11-06 13:22:53 - utils - INFO - Progress: 150,000/24,687,756 (0.6%) - Labeled: 215
2025-11-06 13:22:53 - utils - INFO - Progress: 200,000/24,687,756 (0.8%) - Labeled: 285
2025-11-06 13:22:54 - utils - INFO - Progress: 250,000/24,687,756 (1.0%) - Labeled: 343
2025-11-06 13:22:54 - utils - INFO - Progress: 300,000/24,687,756 (1.2%) - Labeled: 402
2025-11-06 13:22:55 - utils - INFO - Progress: 350,000/24,687,756 (1.4%) - Labeled: 489
2025-11-06 13:22:55 - utils - INFO - Progress: 400,000/24,687,756 (1.6%) - Labeled: 565
2025-11-06 13:22:56 - utils - INFO - Progress: 450,000/24,687,756 (1.8%) - Labeled: 643
2025-11-06 13:22:56 - utils - INFO - Progress: 500,000/24,687,756 (2.0%) - Labeled: 732
2025-11-06 13:22:57 - utils - INFO - Progress: 550,000/24,687,756 (2.2%) - Labeled: 809
2025-11-06 13:22:57 - utils - INFO - Progress: 600,000/24,687,756 (2.4%) - Labeled: 883
2025-11-06 13:22:58 - utils - INFO - Progress: 650,000/24,687,756 (2.6%) - Labeled: 983
2025-11-06 13:22:58 - utils - INFO - Progress: 700,000/24,687,756 (2.8%) - Labeled: 1,057
2025-11-06 13:22:59 - utils - INFO - Progress: 750,000/24,687,756 (3.0%) - Labeled: 1,128
2025-11-06 13:22:59 - utils - INFO - Progress: 800,000/24,687,756 (3.2%) - Labeled: 1,203
2025-11-06 13:23:00 - utils - INFO - Progress: 850,000/24,687,756 (3.4%) - Labeled: 1,294
2025-11-06 13:23:00 - utils - INFO - Progress: 900,000/24,687,756 (3.6%) - Labeled: 1,364
2025-11-06 13:23:01 - utils - INFO - Progress: 950,000/24,687,756 (3.8%) - Labeled: 1,431
2025-11-06 13:23:01 - utils - INFO - Progress: 1,000,000/24,687,756 (4.1%) - Labeled: 1,511
2025-11-06 13:23:02 - utils - INFO - Progress: 1,050,000/24,687,756 (4.3%) - Labeled: 1,592
2025-11-06 13:23:02 - utils - INFO - Progress: 1,100,000/24,687,756 (4.5%) - Labeled: 1,675
2025-11-06 13:23:03 - utils - INFO - Progress: 1,150,000/24,687,756 (4.7%) - Labeled: 1,760
2025-11-06 13:23:03 - utils - INFO - Progress: 1,200,000/24,687,756 (4.9%) - Labeled: 1,819
2025-11-06 13:23:04 - utils - INFO - Progress: 1,250,000/24,687,756 (5.1%) - Labeled: 1,897
2025-11-06 13:23:04 - utils - INFO - Progress: 1,300,000/24,687,756 (5.3%) - Labeled: 1,983
2025-11-06 13:23:05 - utils - INFO - Progress: 1,350,000/24,687,756 (5.5%) - Labeled: 2,072
2025-11-06 13:23:05 - utils - INFO - Progress: 1,400,000/24,687,756 (5.7%) - Labeled: 2,163
2025-11-06 13:23:06 - utils - INFO - Progress: 1,450,000/24,687,756 (5.9%) - Labeled: 2,245
2025-11-06 13:23:06 - utils - INFO - Progress: 1,500,000/24,687,756 (6.1%) - Labeled: 2,327
2025-11-06 13:23:07 - utils - INFO - Progress: 1,550,000/24,687,756 (6.3%) - Labeled: 2,406
2025-11-06 13:23:07 - utils - INFO - Progress: 1,600,000/24,687,756 (6.5%) - Labeled: 2,486
2025-11-06 13:23:08 - utils - INFO - Progress: 1,650,000/24,687,756 (6.7%) - Labeled: 2,557
2025-11-06 13:23:08 - utils - INFO - Progress: 1,700,000/24,687,756 (6.9%) - Labeled: 2,647
2025-11-06 13:23:09 - utils - INFO - Progress: 1,750,000/24,687,756 (7.1%) - Labeled: 2,741
2025-11-06 13:23:09 - utils - INFO - Progress: 1,800,000/24,687,756 (7.3%) - Labeled: 2,823
2025-11-06 13:23:10 - utils - INFO - Progress: 1,850,000/24,687,756 (7.5%) - Labeled: 2,913
2025-11-06 13:23:10 - utils - INFO - Progress: 1,900,000/24,687,756 (7.7%) - Labeled: 2,990
2025-11-06 13:23:11 - utils - INFO - Progress: 1,950,000/24,687,756 (7.9%) - Labeled: 3,064
2025-11-06 13:23:11 - utils - INFO - Progress: 2,000,000/24,687,756 (8.1%) - Labeled: 3,157
2025-11-06 13:23:12 - utils - INFO - Progress: 2,050,000/24,687,756 (8.3%) - Labeled: 3,219
2025-11-06 13:23:12 - utils - INFO - Progress: 2,100,000/24,687,756 (8.5%) - Labeled: 3,299
2025-11-06 13:23:13 - utils - INFO - Progress: 2,150,000/24,687,756 (8.7%) - Labeled: 3,393
2025-11-06 13:23:14 - utils - INFO - Progress: 2,200,000/24,687,756 (8.9%) - Labeled: 3,478
2025-11-06 13:23:14 - utils - INFO - Progress: 2,250,000/24,687,756 (9.1%) - Labeled: 3,548
2025-11-06 13:23:15 - utils - INFO - Progress: 2,300,000/24,687,756 (9.3%) - Labeled: 3,610
2025-11-06 13:23:15 - utils - INFO - Progress: 2,350,000/24,687,756 (9.5%) - Labeled: 3,688
2025-11-06 13:23:16 - utils - INFO - Progress: 2,400,000/24,687,756 (9.7%) - Labeled: 3,756
2025-11-06 13:23:16 - utils - INFO - Progress: 2,450,000/24,687,756 (9.9%) - Labeled: 3,857
2025-11-06 13:23:17 - utils - INFO - Progress: 2,500,000/24,687,756 (10.1%) - Labeled: 3,932
2025-11-06 13:23:17 - utils - INFO - Progress: 2,550,000/24,687,756 (10.3%) - Labeled: 4,001
2025-11-06 13:23:18 - utils - INFO - Progress: 2,600,000/24,687,756 (10.5%) - Labeled: 4,109
2025-11-06 13:23:18 - utils - INFO - Progress: 2,650,000/24,687,756 (10.7%) - Labeled: 4,193
2025-11-06 13:23:19 - utils - INFO - Progress: 2,700,000/24,687,756 (10.9%) - Labeled: 4,270
2025-11-06 13:23:19 - utils - INFO - Progress: 2,750,000/24,687,756 (11.1%) - Labeled: 4,347
2025-11-06 13:23:20 - utils - INFO - Progress: 2,800,000/24,687,756 (11.3%) - Labeled: 4,445
2025-11-06 13:23:20 - utils - INFO - Progress: 2,850,000/24,687,756 (11.5%) - Labeled: 4,502
2025-11-06 13:23:21 - utils - INFO - Progress: 2,900,000/24,687,756 (11.7%) - Labeled: 4,572
2025-11-06 13:23:21 - utils - INFO - Progress: 2,950,000/24,687,756 (11.9%) - Labeled: 4,639
2025-11-06 13:23:22 - utils - INFO - Progress: 3,000,000/24,687,756 (12.2%) - Labeled: 4,710
2025-11-06 13:23:22 - utils - INFO - Progress: 3,050,000/24,687,756 (12.4%) - Labeled: 4,769
2025-11-06 13:23:23 - utils - INFO - Progress: 3,100,000/24,687,756 (12.6%) - Labeled: 4,834
2025-11-06 13:23:23 - utils - INFO - Progress: 3,150,000/24,687,756 (12.8%) - Labeled: 4,916
2025-11-06 13:23:24 - utils - INFO - Progress: 3,200,000/24,687,756 (13.0%) - Labeled: 4,992
2025-11-06 13:23:24 - utils - INFO - Progress: 3,250,000/24,687,756 (13.2%) - Labeled: 5,082
2025-11-06 13:23:25 - utils - INFO - Progress: 3,300,000/24,687,756 (13.4%) - Labeled: 5,160
2025-11-06 13:23:25 - utils - INFO - Progress: 3,350,000/24,687,756 (13.6%) - Labeled: 5,229
2025-11-06 13:23:26 - utils - INFO - Progress: 3,400,000/24,687,756 (13.8%) - Labeled: 5,330
2025-11-06 13:23:26 - utils - INFO - Progress: 3,450,000/24,687,756 (14.0%) - Labeled: 5,401
2025-11-06 13:23:27 - utils - INFO - Progress: 3,500,000/24,687,756 (14.2%) - Labeled: 5,519
2025-11-06 13:23:27 - utils - INFO - Progress: 3,550,000/24,687,756 (14.4%) - Labeled: 5,630
2025-11-06 13:23:28 - utils - INFO - Progress: 3,600,000/24,687,756 (14.6%) - Labeled: 5,696
2025-11-06 13:23:29 - utils - INFO - Progress: 3,650,000/24,687,756 (14.8%) - Labeled: 5,794
2025-11-06 13:23:29 - utils - INFO - Progress: 3,700,000/24,687,756 (15.0%) - Labeled: 5,887
2025-11-06 13:23:30 - utils - INFO - Progress: 3,750,000/24,687,756 (15.2%) - Labeled: 5,961
2025-11-06 13:23:30 - utils - INFO - Progress: 3,800,000/24,687,756 (15.4%) - Labeled: 6,037
2025-11-06 13:23:31 - utils - INFO - Progress: 3,850,000/24,687,756 (15.6%) - Labeled: 6,095
2025-11-06 13:23:31 - utils - INFO - Progress: 3,900,000/24,687,756 (15.8%) - Labeled: 6,174
2025-11-06 13:23:32 - utils - INFO - Progress: 3,950,000/24,687,756 (16.0%) - Labeled: 6,266
2025-11-06 13:23:32 - utils - INFO - Progress: 4,000,000/24,687,756 (16.2%) - Labeled: 6,356
2025-11-06 13:23:33 - utils - INFO - Progress: 4,050,000/24,687,756 (16.4%) - Labeled: 6,463
2025-11-06 13:23:33 - utils - INFO - Progress: 4,100,000/24,687,756 (16.6%) - Labeled: 6,545
2025-11-06 13:23:34 - utils - INFO - Progress: 4,150,000/24,687,756 (16.8%) - Labeled: 6,630
2025-11-06 13:23:34 - utils - INFO - Progress: 4,200,000/24,687,756 (17.0%) - Labeled: 6,710
2025-11-06 13:23:35 - utils - INFO - Progress: 4,250,000/24,687,756 (17.2%) - Labeled: 6,797
2025-11-06 13:23:35 - utils - INFO - Progress: 4,300,000/24,687,756 (17.4%) - Labeled: 6,870
2025-11-06 13:23:36 - utils - INFO - Progress: 4,350,000/24,687,756 (17.6%) - Labeled: 6,949
2025-11-06 13:23:36 - utils - INFO - Progress: 4,400,000/24,687,756 (17.8%) - Labeled: 7,027
2025-11-06 13:23:37 - utils - INFO - Progress: 4,450,000/24,687,756 (18.0%) - Labeled: 7,106
2025-11-06 13:23:37 - utils - INFO - Progress: 4,500,000/24,687,756 (18.2%) - Labeled: 7,178
2025-11-06 13:23:38 - utils - INFO - Progress: 4,550,000/24,687,756 (18.4%) - Labeled: 7,233
2025-11-06 13:23:38 - utils - INFO - Progress: 4,600,000/24,687,756 (18.6%) - Labeled: 7,313
2025-11-06 13:23:39 - utils - INFO - Progress: 4,650,000/24,687,756 (18.8%) - Labeled: 7,376
2025-11-06 13:23:39 - utils - INFO - Progress: 4,700,000/24,687,756 (19.0%) - Labeled: 7,457
2025-11-06 13:23:40 - utils - INFO - Progress: 4,750,000/24,687,756 (19.2%) - Labeled: 7,562
2025-11-06 13:23:40 - utils - INFO - Progress: 4,800,000/24,687,756 (19.4%) - Labeled: 7,634
2025-11-06 13:23:41 - utils - INFO - Progress: 4,850,000/24,687,756 (19.6%) - Labeled: 7,716
2025-11-06 13:23:41 - utils - INFO - Progress: 4,900,000/24,687,756 (19.8%) - Labeled: 7,770
2025-11-06 13:23:42 - utils - INFO - Progress: 4,950,000/24,687,756 (20.1%) - Labeled: 7,869
2025-11-06 13:23:42 - utils - INFO - Progress: 5,000,000/24,687,756 (20.3%) - Labeled: 7,949
2025-11-06 13:23:43 - utils - INFO - Progress: 5,050,000/24,687,756 (20.5%) - Labeled: 8,026
2025-11-06 13:23:44 - utils - INFO - Progress: 5,100,000/24,687,756 (20.7%) - Labeled: 8,108
2025-11-06 13:23:44 - utils - INFO - Progress: 5,150,000/24,687,756 (20.9%) - Labeled: 8,190
2025-11-06 13:23:45 - utils - INFO - Progress: 5,200,000/24,687,756 (21.1%) - Labeled: 8,259
2025-11-06 13:23:45 - utils - INFO - Progress: 5,250,000/24,687,756 (21.3%) - Labeled: 8,345
2025-11-06 13:23:46 - utils - INFO - Progress: 5,300,000/24,687,756 (21.5%) - Labeled: 8,432
2025-11-06 13:23:46 - utils - INFO - Progress: 5,350,000/24,687,756 (21.7%) - Labeled: 8,516
2025-11-06 13:23:47 - utils - INFO - Progress: 5,400,000/24,687,756 (21.9%) - Labeled: 8,599
2025-11-06 13:23:47 - utils - INFO - Progress: 5,450,000/24,687,756 (22.1%) - Labeled: 8,665
2025-11-06 13:23:48 - utils - INFO - Progress: 5,500,000/24,687,756 (22.3%) - Labeled: 8,747
2025-11-06 13:23:48 - utils - INFO - Progress: 5,550,000/24,687,756 (22.5%) - Labeled: 8,835
2025-11-06 13:23:49 - utils - INFO - Progress: 5,600,000/24,687,756 (22.7%) - Labeled: 8,903
2025-11-06 13:23:50 - utils - INFO - Progress: 5,650,000/24,687,756 (22.9%) - Labeled: 8,991
2025-11-06 13:23:50 - utils - INFO - Progress: 5,700,000/24,687,756 (23.1%) - Labeled: 9,074
2025-11-06 13:23:51 - utils - INFO - Progress: 5,750,000/24,687,756 (23.3%) - Labeled: 9,161
2025-11-06 13:23:51 - utils - INFO - Progress: 5,800,000/24,687,756 (23.5%) - Labeled: 9,261
2025-11-06 13:23:52 - utils - INFO - Progress: 5,850,000/24,687,756 (23.7%) - Labeled: 9,340
2025-11-06 13:23:52 - utils - INFO - Progress: 5,900,000/24,687,756 (23.9%) - Labeled: 9,419
2025-11-06 13:23:53 - utils - INFO - Progress: 5,950,000/24,687,756 (24.1%) - Labeled: 9,495
2025-11-06 13:23:53 - utils - INFO - Progress: 6,000,000/24,687,756 (24.3%) - Labeled: 9,579
2025-11-06 13:23:54 - utils - INFO - Progress: 6,050,000/24,687,756 (24.5%) - Labeled: 9,655
2025-11-06 13:23:54 - utils - INFO - Progress: 6,100,000/24,687,756 (24.7%) - Labeled: 9,741
2025-11-06 13:23:55 - utils - INFO - Progress: 6,150,000/24,687,756 (24.9%) - Labeled: 9,831
2025-11-06 13:23:55 - utils - INFO - Progress: 6,200,000/24,687,756 (25.1%) - Labeled: 9,927
2025-11-06 13:23:56 - utils - INFO - Progress: 6,250,000/24,687,756 (25.3%) - Labeled: 10,028
2025-11-06 13:23:56 - utils - INFO - Progress: 6,300,000/24,687,756 (25.5%) - Labeled: 10,124
2025-11-06 13:23:57 - utils - INFO - Progress: 6,350,000/24,687,756 (25.7%) - Labeled: 10,211
2025-11-06 13:23:57 - utils - INFO - Progress: 6,400,000/24,687,756 (25.9%) - Labeled: 10,301
2025-11-06 13:23:58 - utils - INFO - Progress: 6,450,000/24,687,756 (26.1%) - Labeled: 10,394
2025-11-06 13:23:58 - utils - INFO - Progress: 6,500,000/24,687,756 (26.3%) - Labeled: 10,472
2025-11-06 13:23:59 - utils - INFO - Progress: 6,550,000/24,687,756 (26.5%) - Labeled: 10,552
2025-11-06 13:23:59 - utils - INFO - Progress: 6,600,000/24,687,756 (26.7%) - Labeled: 10,620
2025-11-06 13:24:00 - utils - INFO - Progress: 6,650,000/24,687,756 (26.9%) - Labeled: 10,685
2025-11-06 13:24:00 - utils - INFO - Progress: 6,700,000/24,687,756 (27.1%) - Labeled: 10,757
2025-11-06 13:24:01 - utils - INFO - Progress: 6,750,000/24,687,756 (27.3%) - Labeled: 10,827
2025-11-06 13:24:01 - utils - INFO - Progress: 6,800,000/24,687,756 (27.5%) - Labeled: 10,916
2025-11-06 13:24:02 - utils - INFO - Progress: 6,850,000/24,687,756 (27.7%) - Labeled: 10,988
2025-11-06 13:24:02 - utils - INFO - Progress: 6,900,000/24,687,756 (27.9%) - Labeled: 11,056
2025-11-06 13:24:03 - utils - INFO - Progress: 6,950,000/24,687,756 (28.2%) - Labeled: 11,142
2025-11-06 13:24:04 - utils - INFO - Progress: 7,000,000/24,687,756 (28.4%) - Labeled: 11,232
2025-11-06 13:24:04 - utils - INFO - Progress: 7,050,000/24,687,756 (28.6%) - Labeled: 11,323
2025-11-06 13:24:05 - utils - INFO - Progress: 7,100,000/24,687,756 (28.8%) - Labeled: 11,405
2025-11-06 13:24:05 - utils - INFO - Progress: 7,150,000/24,687,756 (29.0%) - Labeled: 11,509
2025-11-06 13:24:06 - utils - INFO - Progress: 7,200,000/24,687,756 (29.2%) - Labeled: 11,586
2025-11-06 13:24:06 - utils - INFO - Progress: 7,250,000/24,687,756 (29.4%) - Labeled: 11,676
2025-11-06 13:24:07 - utils - INFO - Progress: 7,300,000/24,687,756 (29.6%) - Labeled: 11,744
2025-11-06 13:24:07 - utils - INFO - Progress: 7,350,000/24,687,756 (29.8%) - Labeled: 11,817
2025-11-06 13:24:08 - utils - INFO - Progress: 7,400,000/24,687,756 (30.0%) - Labeled: 11,898
2025-11-06 13:24:08 - utils - INFO - Progress: 7,450,000/24,687,756 (30.2%) - Labeled: 11,956
2025-11-06 13:24:09 - utils - INFO - Progress: 7,500,000/24,687,756 (30.4%) - Labeled: 12,033
2025-11-06 13:24:09 - utils - INFO - Progress: 7,550,000/24,687,756 (30.6%) - Labeled: 12,121
2025-11-06 13:24:10 - utils - INFO - Progress: 7,600,000/24,687,756 (30.8%) - Labeled: 12,190
2025-11-06 13:24:10 - utils - INFO - Progress: 7,650,000/24,687,756 (31.0%) - Labeled: 12,266
2025-11-06 13:24:11 - utils - INFO - Progress: 7,700,000/24,687,756 (31.2%) - Labeled: 12,343
2025-11-06 13:24:11 - utils - INFO - Progress: 7,750,000/24,687,756 (31.4%) - Labeled: 12,410
2025-11-06 13:24:12 - utils - INFO - Progress: 7,800,000/24,687,756 (31.6%) - Labeled: 12,482
2025-11-06 13:24:12 - utils - INFO - Progress: 7,850,000/24,687,756 (31.8%) - Labeled: 12,561
2025-11-06 13:24:13 - utils - INFO - Progress: 7,900,000/24,687,756 (32.0%) - Labeled: 12,630
2025-11-06 13:24:13 - utils - INFO - Progress: 7,950,000/24,687,756 (32.2%) - Labeled: 12,721
2025-11-06 13:24:14 - utils - INFO - Progress: 8,000,000/24,687,756 (32.4%) - Labeled: 12,829
2025-11-06 13:24:14 - utils - INFO - Progress: 8,050,000/24,687,756 (32.6%) - Labeled: 12,894
2025-11-06 13:24:15 - utils - INFO - Progress: 8,100,000/24,687,756 (32.8%) - Labeled: 12,980
2025-11-06 13:24:15 - utils - INFO - Progress: 8,150,000/24,687,756 (33.0%) - Labeled: 13,051
2025-11-06 13:24:16 - utils - INFO - Progress: 8,200,000/24,687,756 (33.2%) - Labeled: 13,132
2025-11-06 13:24:17 - utils - INFO - Progress: 8,250,000/24,687,756 (33.4%) - Labeled: 13,196
2025-11-06 13:24:17 - utils - INFO - Progress: 8,300,000/24,687,756 (33.6%) - Labeled: 13,309
2025-11-06 13:24:18 - utils - INFO - Progress: 8,350,000/24,687,756 (33.8%) - Labeled: 13,396
2025-11-06 13:24:18 - utils - INFO - Progress: 8,400,000/24,687,756 (34.0%) - Labeled: 13,485
2025-11-06 13:24:19 - utils - INFO - Progress: 8,450,000/24,687,756 (34.2%) - Labeled: 13,557
2025-11-06 13:24:19 - utils - INFO - Progress: 8,500,000/24,687,756 (34.4%) - Labeled: 13,641
2025-11-06 13:24:20 - utils - INFO - Progress: 8,550,000/24,687,756 (34.6%) - Labeled: 13,726
2025-11-06 13:24:20 - utils - INFO - Progress: 8,600,000/24,687,756 (34.8%) - Labeled: 13,806
2025-11-06 13:24:21 - utils - INFO - Progress: 8,650,000/24,687,756 (35.0%) - Labeled: 13,885
2025-11-06 13:24:21 - utils - INFO - Progress: 8,700,000/24,687,756 (35.2%) - Labeled: 13,949
2025-11-06 13:24:22 - utils - INFO - Progress: 8,750,000/24,687,756 (35.4%) - Labeled: 14,045
2025-11-06 13:24:22 - utils - INFO - Progress: 8,800,000/24,687,756 (35.6%) - Labeled: 14,131
2025-11-06 13:24:23 - utils - INFO - Progress: 8,850,000/24,687,756 (35.8%) - Labeled: 14,201
2025-11-06 13:24:23 - utils - INFO - Progress: 8,900,000/24,687,756 (36.1%) - Labeled: 14,279
2025-11-06 13:24:24 - utils - INFO - Progress: 8,950,000/24,687,756 (36.3%) - Labeled: 14,358
2025-11-06 13:24:24 - utils - INFO - Progress: 9,000,000/24,687,756 (36.5%) - Labeled: 14,435
2025-11-06 13:24:25 - utils - INFO - Progress: 9,050,000/24,687,756 (36.7%) - Labeled: 14,526
2025-11-06 13:24:25 - utils - INFO - Progress: 9,100,000/24,687,756 (36.9%) - Labeled: 14,606
2025-11-06 13:24:26 - utils - INFO - Progress: 9,150,000/24,687,756 (37.1%) - Labeled: 14,688
2025-11-06 13:24:26 - utils - INFO - Progress: 9,200,000/24,687,756 (37.3%) - Labeled: 14,776
2025-11-06 13:24:27 - utils - INFO - Progress: 9,250,000/24,687,756 (37.5%) - Labeled: 14,846
2025-11-06 13:24:28 - utils - INFO - Progress: 9,300,000/24,687,756 (37.7%) - Labeled: 14,913
2025-11-06 13:24:28 - utils - INFO - Progress: 9,350,000/24,687,756 (37.9%) - Labeled: 14,990
2025-11-06 13:24:29 - utils - INFO - Progress: 9,400,000/24,687,756 (38.1%) - Labeled: 15,092
2025-11-06 13:24:29 - utils - INFO - Progress: 9,450,000/24,687,756 (38.3%) - Labeled: 15,185
2025-11-06 13:24:30 - utils - INFO - Progress: 9,500,000/24,687,756 (38.5%) - Labeled: 15,268
2025-11-06 13:24:30 - utils - INFO - Progress: 9,550,000/24,687,756 (38.7%) - Labeled: 15,368
2025-11-06 13:24:31 - utils - INFO - Progress: 9,600,000/24,687,756 (38.9%) - Labeled: 15,472
2025-11-06 13:24:31 - utils - INFO - Progress: 9,650,000/24,687,756 (39.1%) - Labeled: 15,564
2025-11-06 13:24:32 - utils - INFO - Progress: 9,700,000/24,687,756 (39.3%) - Labeled: 15,665
2025-11-06 13:24:32 - utils - INFO - Progress: 9,750,000/24,687,756 (39.5%) - Labeled: 15,745
2025-11-06 13:24:33 - utils - INFO - Progress: 9,800,000/24,687,756 (39.7%) - Labeled: 15,831
2025-11-06 13:24:33 - utils - INFO - Progress: 9,850,000/24,687,756 (39.9%) - Labeled: 15,923
2025-11-06 13:24:34 - utils - INFO - Progress: 9,900,000/24,687,756 (40.1%) - Labeled: 16,009
2025-11-06 13:24:34 - utils - INFO - Progress: 9,950,000/24,687,756 (40.3%) - Labeled: 16,107
2025-11-06 13:24:35 - utils - INFO - Progress: 10,000,000/24,687,756 (40.5%) - Labeled: 16,201
2025-11-06 13:24:36 - utils - INFO - Progress: 10,050,000/24,687,756 (40.7%) - Labeled: 16,285
2025-11-06 13:24:36 - utils - INFO - Progress: 10,100,000/24,687,756 (40.9%) - Labeled: 16,363
2025-11-06 13:24:37 - utils - INFO - Progress: 10,150,000/24,687,756 (41.1%) - Labeled: 16,453
2025-11-06 13:24:37 - utils - INFO - Progress: 10,200,000/24,687,756 (41.3%) - Labeled: 16,520
2025-11-06 13:24:38 - utils - INFO - Progress: 10,250,000/24,687,756 (41.5%) - Labeled: 16,588
2025-11-06 13:24:38 - utils - INFO - Progress: 10,300,000/24,687,756 (41.7%) - Labeled: 16,667
2025-11-06 13:24:39 - utils - INFO - Progress: 10,350,000/24,687,756 (41.9%) - Labeled: 16,748
2025-11-06 13:24:39 - utils - INFO - Progress: 10,400,000/24,687,756 (42.1%) - Labeled: 16,841
2025-11-06 13:24:40 - utils - INFO - Progress: 10,450,000/24,687,756 (42.3%) - Labeled: 16,928
2025-11-06 13:24:40 - utils - INFO - Progress: 10,500,000/24,687,756 (42.5%) - Labeled: 17,032
2025-11-06 13:24:41 - utils - INFO - Progress: 10,550,000/24,687,756 (42.7%) - Labeled: 17,117
2025-11-06 13:24:41 - utils - INFO - Progress: 10,600,000/24,687,756 (42.9%) - Labeled: 17,213
2025-11-06 13:24:42 - utils - INFO - Progress: 10,650,000/24,687,756 (43.1%) - Labeled: 17,330
2025-11-06 13:24:42 - utils - INFO - Progress: 10,700,000/24,687,756 (43.3%) - Labeled: 17,413
2025-11-06 13:24:43 - utils - INFO - Progress: 10,750,000/24,687,756 (43.5%) - Labeled: 17,494
2025-11-06 13:24:43 - utils - INFO - Progress: 10,800,000/24,687,756 (43.7%) - Labeled: 17,588
2025-11-06 13:24:44 - utils - INFO - Progress: 10,850,000/24,687,756 (43.9%) - Labeled: 17,686
2025-11-06 13:24:44 - utils - INFO - Progress: 10,900,000/24,687,756 (44.2%) - Labeled: 17,780
2025-11-06 13:24:45 - utils - INFO - Progress: 10,950,000/24,687,756 (44.4%) - Labeled: 17,867
2025-11-06 13:24:45 - utils - INFO - Progress: 11,000,000/24,687,756 (44.6%) - Labeled: 17,936
2025-11-06 13:24:46 - utils - INFO - Progress: 11,050,000/24,687,756 (44.8%) - Labeled: 18,017
2025-11-06 13:24:47 - utils - INFO - Progress: 11,100,000/24,687,756 (45.0%) - Labeled: 18,103
2025-11-06 13:24:47 - utils - INFO - Progress: 11,150,000/24,687,756 (45.2%) - Labeled: 18,207
2025-11-06 13:24:48 - utils - INFO - Progress: 11,200,000/24,687,756 (45.4%) - Labeled: 18,302
2025-11-06 13:24:48 - utils - INFO - Progress: 11,250,000/24,687,756 (45.6%) - Labeled: 18,384
2025-11-06 13:24:49 - utils - INFO - Progress: 11,300,000/24,687,756 (45.8%) - Labeled: 18,449
2025-11-06 13:24:49 - utils - INFO - Progress: 11,350,000/24,687,756 (46.0%) - Labeled: 18,519
2025-11-06 13:24:50 - utils - INFO - Progress: 11,400,000/24,687,756 (46.2%) - Labeled: 18,626
2025-11-06 13:24:50 - utils - INFO - Progress: 11,450,000/24,687,756 (46.4%) - Labeled: 18,729
2025-11-06 13:24:51 - utils - INFO - Progress: 11,500,000/24,687,756 (46.6%) - Labeled: 18,856
2025-11-06 13:24:52 - utils - INFO - Progress: 11,550,000/24,687,756 (46.8%) - Labeled: 19,030
2025-11-06 13:24:52 - utils - INFO - Progress: 11,600,000/24,687,756 (47.0%) - Labeled: 19,100
2025-11-06 13:24:53 - utils - INFO - Progress: 11,650,000/24,687,756 (47.2%) - Labeled: 19,183
2025-11-06 13:24:53 - utils - INFO - Progress: 11,700,000/24,687,756 (47.4%) - Labeled: 19,263
2025-11-06 13:24:54 - utils - INFO - Progress: 11,750,000/24,687,756 (47.6%) - Labeled: 19,349
2025-11-06 13:24:54 - utils - INFO - Progress: 11,800,000/24,687,756 (47.8%) - Labeled: 19,432
2025-11-06 13:24:55 - utils - INFO - Progress: 11,850,000/24,687,756 (48.0%) - Labeled: 19,502
2025-11-06 13:24:55 - utils - INFO - Progress: 11,900,000/24,687,756 (48.2%) - Labeled: 19,619
2025-11-06 13:24:56 - utils - INFO - Progress: 11,950,000/24,687,756 (48.4%) - Labeled: 19,690
2025-11-06 13:24:56 - utils - INFO - Progress: 12,000,000/24,687,756 (48.6%) - Labeled: 19,771
2025-11-06 13:24:57 - utils - INFO - Progress: 12,050,000/24,687,756 (48.8%) - Labeled: 19,873
2025-11-06 13:24:57 - utils - INFO - Progress: 12,100,000/24,687,756 (49.0%) - Labeled: 19,952
2025-11-06 13:24:58 - utils - INFO - Progress: 12,150,000/24,687,756 (49.2%) - Labeled: 20,039
2025-11-06 13:24:59 - utils - INFO - Progress: 12,200,000/24,687,756 (49.4%) - Labeled: 20,130
2025-11-06 13:24:59 - utils - INFO - Progress: 12,250,000/24,687,756 (49.6%) - Labeled: 20,214
2025-11-06 13:25:00 - utils - INFO - Progress: 12,300,000/24,687,756 (49.8%) - Labeled: 20,317
2025-11-06 13:25:00 - utils - INFO - Progress: 12,350,000/24,687,756 (50.0%) - Labeled: 20,390
2025-11-06 13:25:01 - utils - INFO - Progress: 12,400,000/24,687,756 (50.2%) - Labeled: 20,473
2025-11-06 13:25:01 - utils - INFO - Progress: 12,450,000/24,687,756 (50.4%) - Labeled: 20,574
2025-11-06 13:25:02 - utils - INFO - Progress: 12,500,000/24,687,756 (50.6%) - Labeled: 20,647
2025-11-06 13:25:02 - utils - INFO - Progress: 12,550,000/24,687,756 (50.8%) - Labeled: 20,739
2025-11-06 13:25:03 - utils - INFO - Progress: 12,600,000/24,687,756 (51.0%) - Labeled: 20,825
2025-11-06 13:25:03 - utils - INFO - Progress: 12,650,000/24,687,756 (51.2%) - Labeled: 20,898
2025-11-06 13:25:04 - utils - INFO - Progress: 12,700,000/24,687,756 (51.4%) - Labeled: 20,981
2025-11-06 13:25:04 - utils - INFO - Progress: 12,750,000/24,687,756 (51.6%) - Labeled: 21,076
2025-11-06 13:25:05 - utils - INFO - Progress: 12,800,000/24,687,756 (51.8%) - Labeled: 21,159
2025-11-06 13:25:05 - utils - INFO - Progress: 12,850,000/24,687,756 (52.1%) - Labeled: 21,228
2025-11-06 13:25:06 - utils - INFO - Progress: 12,900,000/24,687,756 (52.3%) - Labeled: 21,311
2025-11-06 13:25:06 - utils - INFO - Progress: 12,950,000/24,687,756 (52.5%) - Labeled: 21,386
2025-11-06 13:25:07 - utils - INFO - Progress: 13,000,000/24,687,756 (52.7%) - Labeled: 21,467
2025-11-06 13:25:07 - utils - INFO - Progress: 13,050,000/24,687,756 (52.9%) - Labeled: 21,554
2025-11-06 13:25:08 - utils - INFO - Progress: 13,100,000/24,687,756 (53.1%) - Labeled: 21,626
2025-11-06 13:25:09 - utils - INFO - Progress: 13,150,000/24,687,756 (53.3%) - Labeled: 21,691
2025-11-06 13:25:09 - utils - INFO - Progress: 13,200,000/24,687,756 (53.5%) - Labeled: 21,759
2025-11-06 13:25:10 - utils - INFO - Progress: 13,250,000/24,687,756 (53.7%) - Labeled: 21,829
2025-11-06 13:25:10 - utils - INFO - Progress: 13,300,000/24,687,756 (53.9%) - Labeled: 21,916
2025-11-06 13:25:11 - utils - INFO - Progress: 13,350,000/24,687,756 (54.1%) - Labeled: 21,992
2025-11-06 13:25:11 - utils - INFO - Progress: 13,400,000/24,687,756 (54.3%) - Labeled: 22,088
2025-11-06 13:25:12 - utils - INFO - Progress: 13,450,000/24,687,756 (54.5%) - Labeled: 22,176
2025-11-06 13:25:12 - utils - INFO - Progress: 13,500,000/24,687,756 (54.7%) - Labeled: 22,243
2025-11-06 13:25:13 - utils - INFO - Progress: 13,550,000/24,687,756 (54.9%) - Labeled: 22,328
2025-11-06 13:25:13 - utils - INFO - Progress: 13,600,000/24,687,756 (55.1%) - Labeled: 22,393
2025-11-06 13:25:14 - utils - INFO - Progress: 13,650,000/24,687,756 (55.3%) - Labeled: 22,454
2025-11-06 13:25:15 - utils - INFO - Progress: 13,700,000/24,687,756 (55.5%) - Labeled: 22,541
2025-11-06 13:25:15 - utils - INFO - Progress: 13,750,000/24,687,756 (55.7%) - Labeled: 22,642
2025-11-06 13:25:16 - utils - INFO - Progress: 13,800,000/24,687,756 (55.9%) - Labeled: 22,776
2025-11-06 13:25:16 - utils - INFO - Progress: 13,850,000/24,687,756 (56.1%) - Labeled: 22,846
2025-11-06 13:25:17 - utils - INFO - Progress: 13,900,000/24,687,756 (56.3%) - Labeled: 22,911
2025-11-06 13:25:17 - utils - INFO - Progress: 13,950,000/24,687,756 (56.5%) - Labeled: 22,996
2025-11-06 13:25:18 - utils - INFO - Progress: 14,000,000/24,687,756 (56.7%) - Labeled: 23,080
2025-11-06 13:25:18 - utils - INFO - Progress: 14,050,000/24,687,756 (56.9%) - Labeled: 23,171
2025-11-06 13:25:19 - utils - INFO - Progress: 14,100,000/24,687,756 (57.1%) - Labeled: 23,283
2025-11-06 13:25:19 - utils - INFO - Progress: 14,150,000/24,687,756 (57.3%) - Labeled: 23,372
2025-11-06 13:25:20 - utils - INFO - Progress: 14,200,000/24,687,756 (57.5%) - Labeled: 23,442
2025-11-06 13:25:20 - utils - INFO - Progress: 14,250,000/24,687,756 (57.7%) - Labeled: 23,514
2025-11-06 13:25:21 - utils - INFO - Progress: 14,300,000/24,687,756 (57.9%) - Labeled: 23,578
2025-11-06 13:25:22 - utils - INFO - Progress: 14,350,000/24,687,756 (58.1%) - Labeled: 23,654
2025-11-06 13:25:22 - utils - INFO - Progress: 14,400,000/24,687,756 (58.3%) - Labeled: 23,747
2025-11-06 13:25:23 - utils - INFO - Progress: 14,450,000/24,687,756 (58.5%) - Labeled: 23,819
2025-11-06 13:25:23 - utils - INFO - Progress: 14,500,000/24,687,756 (58.7%) - Labeled: 23,952
2025-11-06 13:25:24 - utils - INFO - Progress: 14,550,000/24,687,756 (58.9%) - Labeled: 24,015
2025-11-06 13:25:24 - utils - INFO - Progress: 14,600,000/24,687,756 (59.1%) - Labeled: 24,090
2025-11-06 13:25:25 - utils - INFO - Progress: 14,650,000/24,687,756 (59.3%) - Labeled: 24,167
2025-11-06 13:25:25 - utils - INFO - Progress: 14,700,000/24,687,756 (59.5%) - Labeled: 24,222
2025-11-06 13:25:26 - utils - INFO - Progress: 14,750,000/24,687,756 (59.7%) - Labeled: 24,286
2025-11-06 13:25:26 - utils - INFO - Progress: 14,800,000/24,687,756 (59.9%) - Labeled: 24,359
2025-11-06 13:25:27 - utils - INFO - Progress: 14,850,000/24,687,756 (60.2%) - Labeled: 24,437
2025-11-06 13:25:28 - utils - INFO - Progress: 14,900,000/24,687,756 (60.4%) - Labeled: 24,511
2025-11-06 13:25:28 - utils - INFO - Progress: 14,950,000/24,687,756 (60.6%) - Labeled: 24,586
2025-11-06 13:25:29 - utils - INFO - Progress: 15,000,000/24,687,756 (60.8%) - Labeled: 24,665
2025-11-06 13:25:29 - utils - INFO - Progress: 15,050,000/24,687,756 (61.0%) - Labeled: 24,737
2025-11-06 13:25:30 - utils - INFO - Progress: 15,100,000/24,687,756 (61.2%) - Labeled: 24,809
2025-11-06 13:25:30 - utils - INFO - Progress: 15,150,000/24,687,756 (61.4%) - Labeled: 24,924
2025-11-06 13:25:31 - utils - INFO - Progress: 15,200,000/24,687,756 (61.6%) - Labeled: 24,989
2025-11-06 13:25:31 - utils - INFO - Progress: 15,250,000/24,687,756 (61.8%) - Labeled: 25,024
2025-11-06 13:25:32 - utils - INFO - Progress: 15,300,000/24,687,756 (62.0%) - Labeled: 25,024
2025-11-06 13:25:32 - utils - INFO - Progress: 15,350,000/24,687,756 (62.2%) - Labeled: 25,024
2025-11-06 13:25:33 - utils - INFO - Progress: 15,400,000/24,687,756 (62.4%) - Labeled: 25,024
2025-11-06 13:25:33 - utils - INFO - Progress: 15,450,000/24,687,756 (62.6%) - Labeled: 25,024
2025-11-06 13:25:34 - utils - INFO - Progress: 15,500,000/24,687,756 (62.8%) - Labeled: 25,024
2025-11-06 13:25:34 - utils - INFO - Progress: 15,550,000/24,687,756 (63.0%) - Labeled: 25,024
2025-11-06 13:25:35 - utils - INFO - Progress: 15,600,000/24,687,756 (63.2%) - Labeled: 25,024
2025-11-06 13:25:35 - utils - INFO - Progress: 15,650,000/24,687,756 (63.4%) - Labeled: 25,024
2025-11-06 13:25:36 - utils - INFO - Progress: 15,700,000/24,687,756 (63.6%) - Labeled: 25,024
2025-11-06 13:25:37 - utils - INFO - Progress: 15,750,000/24,687,756 (63.8%) - Labeled: 25,024
2025-11-06 13:25:37 - utils - INFO - Progress: 15,800,000/24,687,756 (64.0%) - Labeled: 25,024
2025-11-06 13:25:38 - utils - INFO - Progress: 15,850,000/24,687,756 (64.2%) - Labeled: 25,024
2025-11-06 13:25:38 - utils - INFO - Progress: 15,900,000/24,687,756 (64.4%) - Labeled: 25,024
2025-11-06 13:25:39 - utils - INFO - Progress: 15,950,000/24,687,756 (64.6%) - Labeled: 25,024
2025-11-06 13:25:39 - utils - INFO - Progress: 16,000,000/24,687,756 (64.8%) - Labeled: 25,024
2025-11-06 13:25:40 - utils - INFO - Progress: 16,050,000/24,687,756 (65.0%) - Labeled: 25,024
2025-11-06 13:25:40 - utils - INFO - Progress: 16,100,000/24,687,756 (65.2%) - Labeled: 25,024
2025-11-06 13:25:41 - utils - INFO - Progress: 16,150,000/24,687,756 (65.4%) - Labeled: 25,024
2025-11-06 13:25:41 - utils - INFO - Progress: 16,200,000/24,687,756 (65.6%) - Labeled: 25,024
2025-11-06 13:25:42 - utils - INFO - Progress: 16,250,000/24,687,756 (65.8%) - Labeled: 25,024
2025-11-06 13:25:42 - utils - INFO - Progress: 16,300,000/24,687,756 (66.0%) - Labeled: 25,024
2025-11-06 13:25:43 - utils - INFO - Progress: 16,350,000/24,687,756 (66.2%) - Labeled: 25,024
2025-11-06 13:25:43 - utils - INFO - Progress: 16,400,000/24,687,756 (66.4%) - Labeled: 25,024
2025-11-06 13:25:44 - utils - INFO - Progress: 16,450,000/24,687,756 (66.6%) - Labeled: 25,024
2025-11-06 13:25:44 - utils - INFO - Progress: 16,500,000/24,687,756 (66.8%) - Labeled: 25,024
2025-11-06 13:25:45 - utils - INFO - Progress: 16,550,000/24,687,756 (67.0%) - Labeled: 25,024
2025-11-06 13:25:45 - utils - INFO - Progress: 16,600,000/24,687,756 (67.2%) - Labeled: 25,024
2025-11-06 13:25:46 - utils - INFO - Progress: 16,650,000/24,687,756 (67.4%) - Labeled: 25,024
2025-11-06 13:25:47 - utils - INFO - Progress: 16,700,000/24,687,756 (67.6%) - Labeled: 25,024
2025-11-06 13:25:47 - utils - INFO - Progress: 16,750,000/24,687,756 (67.8%) - Labeled: 25,024
2025-11-06 13:25:48 - utils - INFO - Progress: 16,800,000/24,687,756 (68.0%) - Labeled: 25,024
2025-11-06 13:25:48 - utils - INFO - Progress: 16,850,000/24,687,756 (68.3%) - Labeled: 25,024
2025-11-06 13:25:49 - utils - INFO - Progress: 16,900,000/24,687,756 (68.5%) - Labeled: 25,024
2025-11-06 13:25:49 - utils - INFO - Progress: 16,950,000/24,687,756 (68.7%) - Labeled: 25,024
2025-11-06 13:25:50 - utils - INFO - Progress: 17,000,000/24,687,756 (68.9%) - Labeled: 25,024
2025-11-06 13:25:50 - utils - INFO - Progress: 17,050,000/24,687,756 (69.1%) - Labeled: 25,024
2025-11-06 13:25:51 - utils - INFO - Progress: 17,100,000/24,687,756 (69.3%) - Labeled: 25,024
2025-11-06 13:25:51 - utils - INFO - Progress: 17,150,000/24,687,756 (69.5%) - Labeled: 25,024
2025-11-06 13:25:52 - utils - INFO - Progress: 17,200,000/24,687,756 (69.7%) - Labeled: 25,024
2025-11-06 13:25:52 - utils - INFO - Progress: 17,250,000/24,687,756 (69.9%) - Labeled: 25,024
2025-11-06 13:25:53 - utils - INFO - Progress: 17,300,000/24,687,756 (70.1%) - Labeled: 25,024
2025-11-06 13:25:53 - utils - INFO - Progress: 17,350,000/24,687,756 (70.3%) - Labeled: 25,024
2025-11-06 13:25:54 - utils - INFO - Progress: 17,400,000/24,687,756 (70.5%) - Labeled: 25,024
2025-11-06 13:25:54 - utils - INFO - Progress: 17,450,000/24,687,756 (70.7%) - Labeled: 25,024
2025-11-06 13:25:55 - utils - INFO - Progress: 17,500,000/24,687,756 (70.9%) - Labeled: 25,024
2025-11-06 13:25:56 - utils - INFO - Progress: 17,550,000/24,687,756 (71.1%) - Labeled: 25,024
2025-11-06 13:25:56 - utils - INFO - Progress: 17,600,000/24,687,756 (71.3%) - Labeled: 25,024
2025-11-06 13:25:57 - utils - INFO - Progress: 17,650,000/24,687,756 (71.5%) - Labeled: 25,024
2025-11-06 13:25:57 - utils - INFO - Progress: 17,700,000/24,687,756 (71.7%) - Labeled: 25,024
2025-11-06 13:25:58 - utils - INFO - Progress: 17,750,000/24,687,756 (71.9%) - Labeled: 25,024
2025-11-06 13:25:58 - utils - INFO - Progress: 17,800,000/24,687,756 (72.1%) - Labeled: 25,024
2025-11-06 13:25:59 - utils - INFO - Progress: 17,850,000/24,687,756 (72.3%) - Labeled: 25,024
2025-11-06 13:25:59 - utils - INFO - Progress: 17,900,000/24,687,756 (72.5%) - Labeled: 25,024
2025-11-06 13:26:00 - utils - INFO - Progress: 17,950,000/24,687,756 (72.7%) - Labeled: 25,024
2025-11-06 13:26:00 - utils - INFO - Progress: 18,000,000/24,687,756 (72.9%) - Labeled: 25,024
2025-11-06 13:26:01 - utils - INFO - Progress: 18,050,000/24,687,756 (73.1%) - Labeled: 25,024
2025-11-06 13:26:01 - utils - INFO - Progress: 18,100,000/24,687,756 (73.3%) - Labeled: 25,024
2025-11-06 13:26:02 - utils - INFO - Progress: 18,150,000/24,687,756 (73.5%) - Labeled: 25,024
2025-11-06 13:26:02 - utils - INFO - Progress: 18,200,000/24,687,756 (73.7%) - Labeled: 25,024
2025-11-06 13:26:03 - utils - INFO - Progress: 18,250,000/24,687,756 (73.9%) - Labeled: 25,024
2025-11-06 13:26:04 - utils - INFO - Progress: 18,300,000/24,687,756 (74.1%) - Labeled: 25,024
2025-11-06 13:26:04 - utils - INFO - Progress: 18,350,000/24,687,756 (74.3%) - Labeled: 25,024
2025-11-06 13:26:05 - utils - INFO - Progress: 18,400,000/24,687,756 (74.5%) - Labeled: 25,024
2025-11-06 13:26:05 - utils - INFO - Progress: 18,450,000/24,687,756 (74.7%) - Labeled: 25,024
2025-11-06 13:26:06 - utils - INFO - Progress: 18,500,000/24,687,756 (74.9%) - Labeled: 25,024
2025-11-06 13:26:06 - utils - INFO - Progress: 18,550,000/24,687,756 (75.1%) - Labeled: 25,024
2025-11-06 13:26:07 - utils - INFO - Progress: 18,600,000/24,687,756 (75.3%) - Labeled: 25,024
2025-11-06 13:26:07 - utils - INFO - Progress: 18,650,000/24,687,756 (75.5%) - Labeled: 25,024
2025-11-06 13:26:08 - utils - INFO - Progress: 18,700,000/24,687,756 (75.7%) - Labeled: 25,024
2025-11-06 13:26:08 - utils - INFO - Progress: 18,750,000/24,687,756 (75.9%) - Labeled: 25,024
2025-11-06 13:26:09 - utils - INFO - Progress: 18,800,000/24,687,756 (76.2%) - Labeled: 25,024
2025-11-06 13:26:09 - utils - INFO - Progress: 18,850,000/24,687,756 (76.4%) - Labeled: 25,024
2025-11-06 13:26:10 - utils - INFO - Progress: 18,900,000/24,687,756 (76.6%) - Labeled: 25,024
2025-11-06 13:26:10 - utils - INFO - Progress: 18,950,000/24,687,756 (76.8%) - Labeled: 25,024
2025-11-06 13:26:11 - utils - INFO - Progress: 19,000,000/24,687,756 (77.0%) - Labeled: 25,024
2025-11-06 13:26:11 - utils - INFO - Progress: 19,050,000/24,687,756 (77.2%) - Labeled: 25,024
2025-11-06 13:26:12 - utils - INFO - Progress: 19,100,000/24,687,756 (77.4%) - Labeled: 25,024
2025-11-06 13:26:12 - utils - INFO - Progress: 19,150,000/24,687,756 (77.6%) - Labeled: 25,024
2025-11-06 13:26:13 - utils - INFO - Progress: 19,200,000/24,687,756 (77.8%) - Labeled: 25,024
2025-11-06 13:26:14 - utils - INFO - Progress: 19,250,000/24,687,756 (78.0%) - Labeled: 25,024
2025-11-06 13:26:14 - utils - INFO - Progress: 19,300,000/24,687,756 (78.2%) - Labeled: 25,024
2025-11-06 13:26:15 - utils - INFO - Progress: 19,350,000/24,687,756 (78.4%) - Labeled: 25,024
2025-11-06 13:26:15 - utils - INFO - Progress: 19,400,000/24,687,756 (78.6%) - Labeled: 25,024
2025-11-06 13:26:16 - utils - INFO - Progress: 19,450,000/24,687,756 (78.8%) - Labeled: 25,024
2025-11-06 13:26:16 - utils - INFO - Progress: 19,500,000/24,687,756 (79.0%) - Labeled: 25,024
2025-11-06 13:26:17 - utils - INFO - Progress: 19,550,000/24,687,756 (79.2%) - Labeled: 25,024
2025-11-06 13:26:17 - utils - INFO - Progress: 19,600,000/24,687,756 (79.4%) - Labeled: 25,024
2025-11-06 13:26:18 - utils - INFO - Progress: 19,650,000/24,687,756 (79.6%) - Labeled: 25,024
2025-11-06 13:26:18 - utils - INFO - Progress: 19,700,000/24,687,756 (79.8%) - Labeled: 25,024
2025-11-06 13:26:19 - utils - INFO - Progress: 19,750,000/24,687,756 (80.0%) - Labeled: 25,024
2025-11-06 13:26:19 - utils - INFO - Progress: 19,800,000/24,687,756 (80.2%) - Labeled: 25,024
2025-11-06 13:26:20 - utils - INFO - Progress: 19,850,000/24,687,756 (80.4%) - Labeled: 25,024
2025-11-06 13:26:20 - utils - INFO - Progress: 19,900,000/24,687,756 (80.6%) - Labeled: 25,024
2025-11-06 13:26:21 - utils - INFO - Progress: 19,950,000/24,687,756 (80.8%) - Labeled: 25,024
2025-11-06 13:26:21 - utils - INFO - Progress: 20,000,000/24,687,756 (81.0%) - Labeled: 25,024
2025-11-06 13:26:22 - utils - INFO - Progress: 20,050,000/24,687,756 (81.2%) - Labeled: 25,024
2025-11-06 13:26:22 - utils - INFO - Progress: 20,100,000/24,687,756 (81.4%) - Labeled: 25,024
2025-11-06 13:26:23 - utils - INFO - Progress: 20,150,000/24,687,756 (81.6%) - Labeled: 25,024
2025-11-06 13:26:23 - utils - INFO - Progress: 20,200,000/24,687,756 (81.8%) - Labeled: 25,024
2025-11-06 13:26:24 - utils - INFO - Progress: 20,250,000/24,687,756 (82.0%) - Labeled: 25,024
2025-11-06 13:26:24 - utils - INFO - Progress: 20,300,000/24,687,756 (82.2%) - Labeled: 25,024
2025-11-06 13:26:25 - utils - INFO - Progress: 20,350,000/24,687,756 (82.4%) - Labeled: 25,024
2025-11-06 13:26:26 - utils - INFO - Progress: 20,400,000/24,687,756 (82.6%) - Labeled: 25,024
2025-11-06 13:26:26 - utils - INFO - Progress: 20,450,000/24,687,756 (82.8%) - Labeled: 25,024
2025-11-06 13:26:27 - utils - INFO - Progress: 20,500,000/24,687,756 (83.0%) - Labeled: 25,024
2025-11-06 13:26:27 - utils - INFO - Progress: 20,550,000/24,687,756 (83.2%) - Labeled: 25,024
2025-11-06 13:26:28 - utils - INFO - Progress: 20,600,000/24,687,756 (83.4%) - Labeled: 25,024
2025-11-06 13:26:28 - utils - INFO - Progress: 20,650,000/24,687,756 (83.6%) - Labeled: 25,024
2025-11-06 13:26:29 - utils - INFO - Progress: 20,700,000/24,687,756 (83.8%) - Labeled: 25,024
2025-11-06 13:26:29 - utils - INFO - Progress: 20,750,000/24,687,756 (84.0%) - Labeled: 25,024
2025-11-06 13:26:30 - utils - INFO - Progress: 20,800,000/24,687,756 (84.3%) - Labeled: 25,024
2025-11-06 13:26:30 - utils - INFO - Progress: 20,850,000/24,687,756 (84.5%) - Labeled: 25,024
2025-11-06 13:26:31 - utils - INFO - Progress: 20,900,000/24,687,756 (84.7%) - Labeled: 25,024
2025-11-06 13:26:31 - utils - INFO - Progress: 20,950,000/24,687,756 (84.9%) - Labeled: 25,024
2025-11-06 13:26:32 - utils - INFO - Progress: 21,000,000/24,687,756 (85.1%) - Labeled: 25,024
2025-11-06 13:26:32 - utils - INFO - Progress: 21,050,000/24,687,756 (85.3%) - Labeled: 25,024
2025-11-06 13:26:33 - utils - INFO - Progress: 21,100,000/24,687,756 (85.5%) - Labeled: 25,024
2025-11-06 13:26:33 - utils - INFO - Progress: 21,150,000/24,687,756 (85.7%) - Labeled: 25,024
2025-11-06 13:26:34 - utils - INFO - Progress: 21,200,000/24,687,756 (85.9%) - Labeled: 25,024
2025-11-06 13:26:34 - utils - INFO - Progress: 21,250,000/24,687,756 (86.1%) - Labeled: 25,024
2025-11-06 13:26:35 - utils - INFO - Progress: 21,300,000/24,687,756 (86.3%) - Labeled: 25,024
2025-11-06 13:26:35 - utils - INFO - Progress: 21,350,000/24,687,756 (86.5%) - Labeled: 25,024
2025-11-06 13:26:36 - utils - INFO - Progress: 21,400,000/24,687,756 (86.7%) - Labeled: 25,024
2025-11-06 13:26:36 - utils - INFO - Progress: 21,450,000/24,687,756 (86.9%) - Labeled: 25,024
2025-11-06 13:26:37 - utils - INFO - Progress: 21,500,000/24,687,756 (87.1%) - Labeled: 25,024
2025-11-06 13:26:37 - utils - INFO - Progress: 21,550,000/24,687,756 (87.3%) - Labeled: 25,024
2025-11-06 13:26:38 - utils - INFO - Progress: 21,600,000/24,687,756 (87.5%) - Labeled: 25,024
2025-11-06 13:26:39 - utils - INFO - Progress: 21,650,000/24,687,756 (87.7%) - Labeled: 25,024
2025-11-06 13:26:39 - utils - INFO - Progress: 21,700,000/24,687,756 (87.9%) - Labeled: 25,024
2025-11-06 13:26:40 - utils - INFO - Progress: 21,750,000/24,687,756 (88.1%) - Labeled: 25,024
2025-11-06 13:26:40 - utils - INFO - Progress: 21,800,000/24,687,756 (88.3%) - Labeled: 25,024
2025-11-06 13:26:41 - utils - INFO - Progress: 21,850,000/24,687,756 (88.5%) - Labeled: 25,024
2025-11-06 13:26:41 - utils - INFO - Progress: 21,900,000/24,687,756 (88.7%) - Labeled: 25,024
2025-11-06 13:26:42 - utils - INFO - Progress: 21,950,000/24,687,756 (88.9%) - Labeled: 25,024
2025-11-06 13:26:42 - utils - INFO - Progress: 22,000,000/24,687,756 (89.1%) - Labeled: 25,024
2025-11-06 13:26:43 - utils - INFO - Progress: 22,050,000/24,687,756 (89.3%) - Labeled: 25,024
2025-11-06 13:26:43 - utils - INFO - Progress: 22,100,000/24,687,756 (89.5%) - Labeled: 25,024
2025-11-06 13:26:44 - utils - INFO - Progress: 22,150,000/24,687,756 (89.7%) - Labeled: 25,024
2025-11-06 13:26:44 - utils - INFO - Progress: 22,200,000/24,687,756 (89.9%) - Labeled: 25,024
2025-11-06 13:26:45 - utils - INFO - Progress: 22,250,000/24,687,756 (90.1%) - Labeled: 25,024
2025-11-06 13:26:45 - utils - INFO - Progress: 22,300,000/24,687,756 (90.3%) - Labeled: 25,024
2025-11-06 13:26:46 - utils - INFO - Progress: 22,350,000/24,687,756 (90.5%) - Labeled: 25,024
2025-11-06 13:26:46 - utils - INFO - Progress: 22,400,000/24,687,756 (90.7%) - Labeled: 25,024
2025-11-06 13:26:47 - utils - INFO - Progress: 22,450,000/24,687,756 (90.9%) - Labeled: 25,024
2025-11-06 13:26:47 - utils - INFO - Progress: 22,500,000/24,687,756 (91.1%) - Labeled: 25,024
2025-11-06 13:26:48 - utils - INFO - Progress: 22,550,000/24,687,756 (91.3%) - Labeled: 25,024
2025-11-06 13:26:48 - utils - INFO - Progress: 22,600,000/24,687,756 (91.5%) - Labeled: 25,024
2025-11-06 13:26:49 - utils - INFO - Progress: 22,650,000/24,687,756 (91.7%) - Labeled: 25,024
2025-11-06 13:26:50 - utils - INFO - Progress: 22,700,000/24,687,756 (91.9%) - Labeled: 25,024
2025-11-06 13:26:50 - utils - INFO - Progress: 22,750,000/24,687,756 (92.2%) - Labeled: 25,024
2025-11-06 13:26:51 - utils - INFO - Progress: 22,800,000/24,687,756 (92.4%) - Labeled: 25,024
2025-11-06 13:26:51 - utils - INFO - Progress: 22,850,000/24,687,756 (92.6%) - Labeled: 25,024
2025-11-06 13:26:52 - utils - INFO - Progress: 22,900,000/24,687,756 (92.8%) - Labeled: 25,024
2025-11-06 13:26:52 - utils - INFO - Progress: 22,950,000/24,687,756 (93.0%) - Labeled: 25,024
2025-11-06 13:26:53 - utils - INFO - Progress: 23,000,000/24,687,756 (93.2%) - Labeled: 25,024
2025-11-06 13:26:53 - utils - INFO - Progress: 23,050,000/24,687,756 (93.4%) - Labeled: 25,024
2025-11-06 13:26:54 - utils - INFO - Progress: 23,100,000/24,687,756 (93.6%) - Labeled: 25,024
2025-11-06 13:26:54 - utils - INFO - Progress: 23,150,000/24,687,756 (93.8%) - Labeled: 25,024
2025-11-06 13:26:55 - utils - INFO - Progress: 23,200,000/24,687,756 (94.0%) - Labeled: 25,024
2025-11-06 13:26:55 - utils - INFO - Progress: 23,250,000/24,687,756 (94.2%) - Labeled: 25,024
2025-11-06 13:26:56 - utils - INFO - Progress: 23,300,000/24,687,756 (94.4%) - Labeled: 25,024
2025-11-06 13:26:56 - utils - INFO - Progress: 23,350,000/24,687,756 (94.6%) - Labeled: 25,024
2025-11-06 13:26:57 - utils - INFO - Progress: 23,400,000/24,687,756 (94.8%) - Labeled: 25,024
2025-11-06 13:26:57 - utils - INFO - Progress: 23,450,000/24,687,756 (95.0%) - Labeled: 25,024
2025-11-06 13:26:58 - utils - INFO - Progress: 23,500,000/24,687,756 (95.2%) - Labeled: 25,024
2025-11-06 13:26:58 - utils - INFO - Progress: 23,550,000/24,687,756 (95.4%) - Labeled: 25,024
2025-11-06 13:26:59 - utils - INFO - Progress: 23,600,000/24,687,756 (95.6%) - Labeled: 25,024
2025-11-06 13:26:59 - utils - INFO - Progress: 23,650,000/24,687,756 (95.8%) - Labeled: 25,024
2025-11-06 13:27:00 - utils - INFO - Progress: 23,700,000/24,687,756 (96.0%) - Labeled: 25,024
2025-11-06 13:27:00 - utils - INFO - Progress: 23,750,000/24,687,756 (96.2%) - Labeled: 25,024
2025-11-06 13:27:01 - utils - INFO - Progress: 23,800,000/24,687,756 (96.4%) - Labeled: 25,024
2025-11-06 13:27:02 - utils - INFO - Progress: 23,850,000/24,687,756 (96.6%) - Labeled: 25,024
2025-11-06 13:27:02 - utils - INFO - Progress: 23,900,000/24,687,756 (96.8%) - Labeled: 25,024
2025-11-06 13:27:03 - utils - INFO - Progress: 23,950,000/24,687,756 (97.0%) - Labeled: 25,024
2025-11-06 13:27:03 - utils - INFO - Progress: 24,000,000/24,687,756 (97.2%) - Labeled: 25,024
2025-11-06 13:27:04 - utils - INFO - Progress: 24,050,000/24,687,756 (97.4%) - Labeled: 25,024
2025-11-06 13:27:04 - utils - INFO - Progress: 24,100,000/24,687,756 (97.6%) - Labeled: 25,024
2025-11-06 13:27:05 - utils - INFO - Progress: 24,150,000/24,687,756 (97.8%) - Labeled: 25,024
2025-11-06 13:27:05 - utils - INFO - Progress: 24,200,000/24,687,756 (98.0%) - Labeled: 25,024
2025-11-06 13:27:06 - utils - INFO - Progress: 24,250,000/24,687,756 (98.2%) - Labeled: 25,024
2025-11-06 13:27:06 - utils - INFO - Progress: 24,300,000/24,687,756 (98.4%) - Labeled: 25,024
2025-11-06 13:27:07 - utils - INFO - Progress: 24,350,000/24,687,756 (98.6%) - Labeled: 25,024
2025-11-06 13:27:07 - utils - INFO - Progress: 24,400,000/24,687,756 (98.8%) - Labeled: 25,024
2025-11-06 13:27:08 - utils - INFO - Progress: 24,450,000/24,687,756 (99.0%) - Labeled: 25,024
2025-11-06 13:27:08 - utils - INFO - Progress: 24,500,000/24,687,756 (99.2%) - Labeled: 25,024
2025-11-06 13:27:09 - utils - INFO - Progress: 24,550,000/24,687,756 (99.4%) - Labeled: 25,024
2025-11-06 13:27:09 - utils - INFO - Progress: 24,600,000/24,687,756 (99.6%) - Labeled: 25,024
2025-11-06 13:27:10 - utils - INFO - Progress: 24,650,000/24,687,756 (99.8%) - Labeled: 25,024
2025-11-06 13:27:10 - utils - INFO - Progress: 24,687,756/24,687,756 (100.0%) - Labeled: 25,024
2025-11-06 13:27:10 - utils - INFO - 
Labeling complete!
2025-11-06 13:27:10 - utils - INFO -   Total rows:     24,687,756
2025-11-06 13:27:10 - utils - INFO -   Insider rows:   25,024 (0.1014%)
2025-11-06 13:27:10 - utils - INFO -   Normal rows:    24,662,732 (99.90%)
2025-11-06 13:27:10 - utils - INFO - 
Verifying labels (sampling 10,000 rows)...
2025-11-06 13:27:50 - utils - INFO - Sample statistics:
2025-11-06 13:27:50 - utils - INFO -   Normal (0):   9,989
2025-11-06 13:27:50 - utils - INFO -   Insider (1):  11
2025-11-06 13:27:50 - utils - INFO -   Unique insiders in sample: 1
2025-11-06 13:27:50 - utils - INFO - 
Replacing original file with labeled version...
2025-11-06 13:28:30 - utils - INFO - Utility functions loaded successfully
2025-11-06 13:32:40 - utils - INFO - Loaded dataframe from /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv
2025-11-06 13:32:40 - utils - INFO - 
================================================================================
                          FEATURE ENGINEERING PIPELINE                          
================================================================================

2025-11-06 13:32:40 - utils - INFO - Creating temporal features...
2025-11-06 13:32:55 - utils - INFO - Temporal features created
2025-11-06 13:32:55 - utils - INFO - Creating user aggregated features with window: 1D
2025-11-06 13:35:04 - utils - INFO - Created 11 aggregated features
2025-11-06 13:35:19 - utils - INFO - Creating behavioral ratio features...
2025-11-06 13:35:19 - utils - INFO - Behavioral ratio features created
2025-11-06 13:35:19 - utils - INFO - Creating statistical features per user...
2025-11-06 13:35:19 - utils - INFO - Created 70 statistical features
2025-11-06 13:35:21 - utils - INFO - Scaling features (fit=True)...
2025-11-06 13:35:21 - utils - INFO - Scaled 84 features
2025-11-06 13:35:21 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/feature_scaler.pkl
2025-11-06 13:35:21 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/label_encoders.pkl
2025-11-06 13:35:21 - utils - INFO - Feature engineering artifacts saved
2025-11-06 13:35:21 - utils - INFO - Feature engineering completed: 337561 samples, 84 features
2025-11-06 13:35:41 - utils - INFO - Saved dataframe to /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_features.csv
2025-11-06 13:35:41 - utils - INFO - Creating sequences with length=15, stride=10
2025-11-06 13:57:41 - utils - INFO - Created 2467828 sequences from 1000 users
2025-11-06 13:58:17 - utils - INFO - Sequences saved for LSTM training
2025-11-06 13:59:00 - utils - INFO - Utility functions loaded successfully
2025-11-06 13:59:00 - utils - INFO - 
================================================================================
                           ISOLATION FOREST TRAINING                            
================================================================================

2025-11-06 13:59:02 - utils - INFO - Loaded dataframe from /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_features.csv
2025-11-06 13:59:02 - utils - INFO - Initialized Isolation Forest with params: {'n_estimators': 50, 'max_samples': 256, 'contamination': 0.01, 'max_features': 1.0, 'bootstrap': False, 'n_jobs': -1, 'random_state': 42, 'verbose': 0}
2025-11-06 13:59:02 - utils - INFO - Data split: Train=236292, Val=50634, Test=50635
2025-11-06 13:59:02 - utils - INFO - Training Isolation Forest...
2025-11-06 13:59:02 - utils - INFO - Isolation Forest training completed
2025-11-06 13:59:02 - utils - INFO - Calibrating threshold for target FPR=0.05
2025-11-06 13:59:02 - utils - INFO - Calibrated threshold: 0.5848
2025-11-06 13:59:02 - utils - INFO - Evaluating Isolation Forest...
2025-11-06 13:59:02 - utils - INFO - 
============================================================
2025-11-06 13:59:02 - utils - INFO - Isolation Forest Performance Metrics
2025-11-06 13:59:02 - utils - INFO - ============================================================
2025-11-06 13:59:02 - utils - INFO - Accuracy:  0.9880
2025-11-06 13:59:02 - utils - INFO - Precision: 0.0000
2025-11-06 13:59:02 - utils - INFO - Recall:    0.0000
2025-11-06 13:59:02 - utils - INFO - F1-Score:  0.0000
2025-11-06 13:59:02 - utils - INFO - AUC-ROC:   0.7601
2025-11-06 13:59:02 - utils - INFO - ============================================================

2025-11-06 13:59:02 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest.pkl
2025-11-06 13:59:02 - utils - INFO - Isolation Forest model saved to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest.pkl
2025-11-06 13:59:02 - utils - INFO - Isolation Forest training and evaluation completed!
2025-11-06 13:59:03 - utils - INFO - Utility functions loaded successfully
2025-11-06 13:59:03 - utils - INFO - 
================================================================================
                      LIGHTWEIGHT DEEP CLUSTERING TRAINING                      
================================================================================

2025-11-06 13:59:05 - utils - INFO - Loaded dataframe from /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_features.csv
2025-11-06 13:59:05 - utils - INFO - Dataset: 337561 samples, 84 features
2025-11-06 13:59:05 - utils - INFO - Data split: Train=236292, Val=50634, Test=50635
2025-11-06 13:59:05 - utils - INFO - Initialized Lightweight Deep Clustering (n_clusters=5, encoding_dim=32)
2025-11-06 13:59:05 - utils - INFO - Training lightweight deep clustering model...
2025-11-06 13:59:05 - utils - INFO - Fitting MiniBatch K-Means clustering...
2025-11-06 13:59:05 - utils - INFO - Lightweight deep clustering training completed
2025-11-06 13:59:05 - utils - INFO - Training completed in 0.14 seconds
2025-11-06 13:59:05 - utils - INFO - Calibrating threshold for target FPR=0.05
2025-11-06 13:59:05 - utils - INFO - Calibrated threshold: 0.7681
2025-11-06 13:59:05 - utils - INFO - Evaluating lightweight deep clustering model...
2025-11-06 13:59:05 - utils - INFO - 
============================================================
2025-11-06 13:59:05 - utils - INFO - Deep Clustering (Lightweight) Performance Metrics
2025-11-06 13:59:05 - utils - INFO - ============================================================
2025-11-06 13:59:05 - utils - INFO - Accuracy:  0.9412
2025-11-06 13:59:05 - utils - INFO - Precision: 0.0117
2025-11-06 13:59:05 - utils - INFO - Recall:    0.5738
2025-11-06 13:59:05 - utils - INFO - F1-Score:  0.0230
2025-11-06 13:59:05 - utils - INFO - AUC-ROC:   0.8855
2025-11-06 13:59:05 - utils - INFO - ============================================================

2025-11-06 13:59:05 - utils - INFO - Lightweight deep clustering model saved to /Users/bipinrimal/Downloads/Thesis_work/models/deep_clustering.pkl
2025-11-06 13:59:05 - utils - INFO - Lightweight deep clustering training and evaluation completed!
2025-11-06 13:59:05 - utils - INFO - Total time: 0.14 seconds
2025-11-06 13:59:39 - utils - INFO - Utility functions loaded successfully
2025-11-06 13:59:42 - utils - INFO - 
================================================================================
                     LIGHTWEIGHT LSTM AUTOENCODER TRAINING                      
================================================================================

2025-11-06 13:59:43 - utils - INFO - Loaded sequences: (2467828, 15, 27)
2025-11-06 13:59:47 - utils - INFO - Data split: Train=1727479, Val=370174, Test=370175
2025-11-06 13:59:50 - utils - INFO - Training on 1725728 normal sequences
2025-11-06 13:59:50 - utils - INFO - Initialized Lightweight LSTM Autoencoder (15, 27)
2025-11-06 13:59:50 - utils - INFO - Training lightweight LSTM Autoencoder...
2025-11-06 13:59:50 - utils - INFO - Building lightweight LSTM Autoencoder...
2025-11-06 13:59:50 - utils - INFO - Model built with 20,363 parameters
2025-11-06 13:59:50 - utils - INFO - Training on 1725728 sequences...
2025-11-06 14:00:37 - utils - INFO - Utility functions loaded successfully
2025-11-06 14:00:37 - utils - INFO - 
================================================================================
                      LIGHTWEIGHT DEEP CLUSTERING TRAINING                      
================================================================================

2025-11-06 14:00:39 - utils - INFO - Loaded dataframe from /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_features.csv
2025-11-06 14:00:39 - utils - INFO - Dataset: 337561 samples, 84 features
2025-11-06 14:00:39 - utils - INFO - Data split: Train=236292, Val=50634, Test=50635
2025-11-06 14:00:39 - utils - INFO - Initialized Lightweight Deep Clustering (n_clusters=5, encoding_dim=32)
2025-11-06 14:00:39 - utils - INFO - Training lightweight deep clustering model...
2025-11-06 14:00:39 - utils - INFO - Fitting MiniBatch K-Means clustering...
2025-11-06 14:00:39 - utils - INFO - Lightweight deep clustering training completed
2025-11-06 14:00:39 - utils - INFO - Training completed in 0.14 seconds
2025-11-06 14:00:39 - utils - INFO - Calibrating threshold for target FPR=0.05
2025-11-06 14:00:39 - utils - INFO - Calibrated threshold: 0.7681
2025-11-06 14:00:39 - utils - INFO - Evaluating lightweight deep clustering model...
2025-11-06 14:00:39 - utils - INFO - 
============================================================
2025-11-06 14:00:39 - utils - INFO - Deep Clustering (Lightweight) Performance Metrics
2025-11-06 14:00:39 - utils - INFO - ============================================================
2025-11-06 14:00:39 - utils - INFO - Accuracy:  0.9412
2025-11-06 14:00:39 - utils - INFO - Precision: 0.0117
2025-11-06 14:00:39 - utils - INFO - Recall:    0.5738
2025-11-06 14:00:39 - utils - INFO - F1-Score:  0.0230
2025-11-06 14:00:39 - utils - INFO - AUC-ROC:   0.8855
2025-11-06 14:00:39 - utils - INFO - ============================================================

2025-11-06 14:00:51 - utils - INFO - Utility functions loaded successfully
2025-11-06 14:00:51 - utils - INFO - 
================================================================================
                      LIGHTWEIGHT DEEP CLUSTERING TRAINING                      
================================================================================

2025-11-06 14:00:53 - utils - INFO - Loaded dataframe from /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_features.csv
2025-11-06 14:00:53 - utils - INFO - Dataset: 337561 samples, 84 features
2025-11-06 14:00:53 - utils - INFO - Data split: Train=236292, Val=50634, Test=50635
2025-11-06 14:00:53 - utils - INFO - Initialized Lightweight Deep Clustering (n_clusters=5, encoding_dim=32)
2025-11-06 14:00:53 - utils - INFO - Training lightweight deep clustering model...
2025-11-06 14:00:53 - utils - INFO - Fitting MiniBatch K-Means clustering...
2025-11-06 14:00:53 - utils - INFO - Lightweight deep clustering training completed
2025-11-06 14:00:53 - utils - INFO - Training completed in 0.18 seconds
2025-11-06 14:00:53 - utils - INFO - Calibrating threshold for target FPR=0.05
2025-11-06 14:00:53 - utils - INFO - Calibrated threshold: 0.7681
2025-11-06 14:00:53 - utils - INFO - Evaluating lightweight deep clustering model...
2025-11-06 14:00:53 - utils - INFO - 
============================================================
2025-11-06 14:00:53 - utils - INFO - Deep Clustering (Lightweight) Performance Metrics
2025-11-06 14:00:53 - utils - INFO - ============================================================
2025-11-06 14:00:53 - utils - INFO - Accuracy:  0.9412
2025-11-06 14:00:53 - utils - INFO - Precision: 0.0117
2025-11-06 14:00:53 - utils - INFO - Recall:    0.5738
2025-11-06 14:00:53 - utils - INFO - F1-Score:  0.0230
2025-11-06 14:00:53 - utils - INFO - AUC-ROC:   0.8855
2025-11-06 14:00:53 - utils - INFO - ============================================================

2025-11-06 14:00:53 - utils - INFO - Lightweight deep clustering model saved to /Users/bipinrimal/Downloads/Thesis_work/models/deep_clustering.pkl
2025-11-06 14:00:53 - utils - INFO - Lightweight deep clustering training and evaluation completed!
2025-11-06 14:00:53 - utils - INFO - Total time: 0.18 seconds
2025-11-06 14:16:18 - utils - INFO - Utility functions loaded successfully
2025-11-06 14:16:18 - utils - INFO - Loading detailed observable files...
2025-11-06 14:16:18 - utils - INFO - Loaded master file: 191 insider incidents
2025-11-06 14:16:18 - utils - INFO -   Loaded r2.csv: 26 events for ONS0995
2025-11-06 14:16:18 - utils - INFO -   Loaded r3.1-1.csv: 35 events for CSF0929
2025-11-06 14:16:18 - utils - INFO -   Loaded r3.1-2.csv: 310 events for CCH0959
2025-11-06 14:16:18 - utils - INFO -   Loaded r3.2-1.csv: 24 events for RCW0822
2025-11-06 14:16:18 - utils - INFO -   Loaded r3.2-2.csv: 253 events for JCE0258
2025-11-06 14:16:18 - utils - INFO -   Loaded r4.1-1.csv: 10 events for ABB0427
2025-11-06 14:16:18 - utils - INFO -   Loaded r4.1-2.csv: 246 events for HFC0492
2025-11-06 14:16:18 - utils - INFO -   Loaded r4.1-3.csv: 17 events for KTW0365
2025-11-06 14:16:18 - utils - WARNING -   Could not find r4.2-1-AAM0658.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r4.2-1-AJR0932.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r4.2-1-BDV0168.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r4.2-1-BIH0745.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r4.2-1-BLS0678.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r4.2-1-BTL0226.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r4.2-1-CAH0936.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r4.2-1-DCH0843.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r4.2-1-EHB0824.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r4.2-1-EHD0584.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r4.2-1-FMG0527.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r4.2-1-FTM0406.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r4.2-1-GHL0460.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r4.2-1-HJB0742.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r4.2-1-JMB0308.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r4.2-1-JRG0207.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r4.2-1-KLH0596.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r4.2-1-KPC0073.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r4.2-1-LJR0523.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r4.2-1-LQC0479.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r4.2-1-MAR0955.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r4.2-1-MAS0025.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r4.2-1-MCF0600.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r4.2-1-MYD0978.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r4.2-1-PPF0435.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r4.2-1-RAB0589.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r4.2-1-RGG0064.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r4.2-1-RKD0604.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r4.2-1-TAP0551.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r4.2-1-WDD0366.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r4.2-2-AAF0535.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r4.2-2-ABC0174.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r4.2-2-AKR0057.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r4.2-2-CCL0068.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r4.2-2-CEJ0109.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r4.2-2-CQW0652.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r4.2-2-DIB0285.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r4.2-2-DRR0162.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r4.2-2-EDB0714.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r4.2-2-EGD0132.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r4.2-2-FSC0601.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r4.2-2-HBO0413.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r4.2-2-HXL0968.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r4.2-2-IJM0776.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r4.2-2-IKR0401.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r4.2-2-IUB0565.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r4.2-2-JJM0203.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r4.2-2-KRL0501.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r4.2-2-LCC0819.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r4.2-2-MDH0580.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r4.2-2-MOS0047.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r4.2-2-NWT0098.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r4.2-2-PNL0301.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r4.2-2-PSF0133.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r4.2-2-RAR0725.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r4.2-2-RHL0992.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r4.2-2-RMW0542.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r4.2-2-TNM0961.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r4.2-2-VSS0154.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r4.2-2-XHW0498.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r4.2-3-BBS0039.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r4.2-3-BSS0369.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r4.2-3-CCA0046.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r4.2-3-CSC0217.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r4.2-3-GTD0219.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r4.2-3-JGT0221.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r4.2-3-JLM0364.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r4.2-3-JTM0223.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r4.2-3-MPM0220.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r4.2-3-MSO0222.csv
2025-11-06 14:16:18 - utils - INFO -   Loaded r5.1-1.csv: 23 events for JTC1885
2025-11-06 14:16:18 - utils - INFO -   Loaded r5.1-2.csv: 181 events for LBE0376
2025-11-06 14:16:18 - utils - INFO -   Loaded r5.1-3.csv: 33 events for BGC0686
2025-11-06 14:16:18 - utils - INFO -   Loaded r5.1-4.csv: 114 events for JAK0783
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-1-ALT1465.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-1-ALW0764.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-1-AYG1697.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-1-DAS1320.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-1-DNJ0740.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-1-ELT1370.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-1-EPG1196.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-1-ETW0002.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-1-FZG0389.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-1-GFM1815.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-1-IHC0561.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-1-ISW0738.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-1-JKB0287.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-1-JUP1472.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-1-KBC1390.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-1-KEW0198.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-1-MIB0203.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-1-NIV1608.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-1-PBC0077.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-1-PTH0005.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-1-REF1924.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-1-SAF1942.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-1-SLL0193.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-1-TMC0934.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-1-VAH1292.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-1-WHB1247.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-1-WSK1857.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-1-WWW0701.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-1-ZKP0542.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-2-VCF1602.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-2-KSS1005.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-2-MCP0611.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-2-TNB1616.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-2-ZIE0741.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-2-HXP0976.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-2-HIS1394.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-2-JAL0811.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-2-ITA0159.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-2-CIF1430.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-2-RRS0056.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-2-MDS0680.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-2-TMT0851.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-2-OSS1463.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-2-HSN0675.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-2-WDT1634.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-2-OKM1092.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-2-CKP0630.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-2-ICB1354.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-2-TRC1838.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-2-NAH1366.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-2-BYO1846.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-2-GWG0497.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-2-MGB1235.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-2-CHP1711.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-2-SNK1280.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-2-LVF1626.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-2-HMS1658.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-2-DCC1119.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-2-SIS0042.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-3-ACA1126.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-3-CRD0272.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-3-CWW1120.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-3-ELM1123.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-3-GKW0043.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-3-KCM0466.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-3-LAH0463.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-3-MPF0690.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-3-VRP0267.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-3-ZEH0685.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-4-ACM1770.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-4-AMC1883.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-4-ASH0298.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-4-ASH0458.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-4-BDP0096.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-4-CBW1826.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-4-CGF1056.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-4-CPD1525.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-4-DIM0330.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-4-DKG0161.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-4-DQM0809.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-4-GCD0194.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-4-GMB0400.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-4-HBP1076.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-4-IRH1224.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-4-JCC0016.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-4-JIG1593.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-4-JMM0613.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-4-JNR1592.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-4-KDC0996.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-4-MJR0711.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-4-MTP1582.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-4-NKM1738.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-4-NKN1405.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-4-NZL1395.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-4-OFS0030.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-4-OHS0036.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-4-RCG0584.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-4-WCW1013.csv
2025-11-06 14:16:18 - utils - WARNING -   Could not find r5.2-4-WOS1834.csv
2025-11-06 14:16:18 - utils - INFO -   Loaded r6.1-1.csv: 22 events for CSF2712
2025-11-06 14:16:18 - utils - INFO -   Loaded r6.1-2.csv: 226 events for JPH1910
2025-11-06 14:16:18 - utils - INFO -   Loaded r6.1-3.csv: 28 events for HJB0462
2025-11-06 14:16:18 - utils - WARNING -   Could not find r6.1-4.csv
2025-11-06 14:16:18 - utils - INFO -   Loaded r6.1-5.csv: 4 events for ADC1257
2025-11-06 14:16:18 - utils - INFO -   Loaded r6.2-1.csv: 22 events for ACM2278
2025-11-06 14:16:18 - utils - INFO -   Loaded r6.2-2.csv: 242 events for CMP2946
2025-11-06 14:16:18 - utils - INFO -   Loaded r6.2-3.csv: 68 events for PLJ1771
2025-11-06 14:16:18 - utils - INFO -   Loaded r6.2-4.csv: 134 events for CDE1846
2025-11-06 14:16:18 - utils - INFO -   Loaded r6.2-5.csv: 4 events for MBG3183
2025-11-06 14:16:18 - utils - INFO - Loaded 21 observable files
2025-11-06 14:16:18 - utils - INFO - 
================================================================================
                           VALIDATING INSIDER LABELS                            
================================================================================

2025-11-06 14:16:18 - utils - INFO - Loaded master file: 191 insider incidents
2025-11-06 14:16:18 - utils - INFO - 
Validating 191 unique insider users...
2025-11-06 14:16:18 - utils - INFO - Checking for user ONS0995 (sampling 50,000 rows)...
2025-11-06 14:16:28 - utils - ERROR - Error: Error tokenizing data. C error: Calling read(nbytes) on source failed. Try engine='python'.
2025-11-06 14:31:47 - utils - INFO - Training completed
2025-11-06 14:31:47 - utils - INFO - Training completed in 1916.97 seconds
2025-11-06 14:31:47 - utils - INFO - Calibrating threshold for target FPR=0.05
2025-11-06 14:31:54 - utils - INFO - Calibrated threshold: 0.6962
2025-11-06 14:31:54 - utils - INFO - Evaluating lightweight LSTM Autoencoder...
2025-11-06 14:32:06 - utils - INFO - 
============================================================
2025-11-06 14:32:06 - utils - INFO - LSTM Autoencoder (Lightweight) Performance Metrics
2025-11-06 14:32:06 - utils - INFO - ============================================================
2025-11-06 14:32:06 - utils - INFO - Accuracy:  0.9497
2025-11-06 14:32:06 - utils - INFO - Precision: 0.0010
2025-11-06 14:32:06 - utils - INFO - Recall:    0.0507
2025-11-06 14:32:06 - utils - INFO - F1-Score:  0.0020
2025-11-06 14:32:06 - utils - INFO - AUC-ROC:   0.4844
2025-11-06 14:32:06 - utils - INFO - ============================================================

2025-11-06 14:32:20 - utils - INFO - Utility functions loaded successfully
2025-11-06 14:32:23 - utils - INFO - ================================================================================
2025-11-06 14:32:23 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-11-06 14:32:23 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-11-06 14:32:23 - utils - INFO - ================================================================================
2025-11-06 14:32:23 - utils - INFO - 
================================================================================
                           STAGE 4: MODEL EVALUATION                            
================================================================================

2025-11-06 14:32:23 - utils - INFO - 
================================================================================
                         COMPREHENSIVE MODEL EVALUATION                         
================================================================================

2025-11-06 14:32:23 - utils - INFO - Loading results for all models...
2025-11-06 14:32:23 - utils - INFO - Loaded results for isolation_forest
2025-11-06 14:32:24 - utils - INFO - Loaded results for lstm_autoencoder
2025-11-06 14:32:24 - utils - INFO - Loaded results for deep_clustering
2025-11-06 14:32:24 - utils - INFO - Loaded results for 3 models
2025-11-06 14:32:24 - utils - INFO - Creating metrics comparison table...
2025-11-06 14:32:24 - utils - INFO - Metrics comparison table created
2025-11-06 14:32:24 - utils - INFO - Creating confusion matrix plots...
2025-11-06 14:32:24 - utils - INFO - Confusion matrices saved to /Users/bipinrimal/Downloads/Thesis_work/results/confusion_matrices/all_models.png
2025-11-06 14:32:24 - utils - INFO - Creating ROC curves...
2025-11-06 14:32:24 - utils - INFO - ROC curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/roc_curves/roc_comparison.png
2025-11-06 14:32:24 - utils - INFO - Creating Precision-Recall curves...
2025-11-06 14:32:24 - utils - INFO - Precision-Recall curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/precision_recall_comparison.png
2025-11-06 14:32:24 - utils - INFO - Creating metrics comparison bar chart...
2025-11-06 14:32:24 - utils - INFO - Metrics comparison bar chart saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/metrics_comparison_bar.png
2025-11-06 14:32:24 - utils - INFO - Creating anomaly score distribution plots...
2025-11-06 14:32:25 - utils - INFO - Score distributions saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/score_distributions.png
2025-11-06 14:32:25 - utils - INFO - Generating evaluation report...
2025-11-06 14:32:25 - utils - INFO - Evaluation report saved to /Users/bipinrimal/Downloads/Thesis_work/results/evaluation_report.txt
2025-11-06 14:32:25 - utils - INFO - Comprehensive evaluation completed!
2025-11-06 14:32:25 - utils - INFO - ✓ Stage 4 completed: Comprehensive evaluation report generated
2025-11-06 14:34:13 - utils - INFO - Utility functions loaded successfully
2025-11-06 14:34:16 - utils - INFO - ================================================================================
2025-11-06 14:34:16 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-11-06 14:34:16 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-11-06 14:34:16 - utils - INFO - ================================================================================
2025-11-06 14:34:16 - utils - INFO - 
================================================================================
                           STAGE 4: MODEL EVALUATION                            
================================================================================

2025-11-06 14:34:16 - utils - INFO - 
================================================================================
                         COMPREHENSIVE MODEL EVALUATION                         
================================================================================

2025-11-06 14:34:16 - utils - INFO - Loading results for all models...
2025-11-06 14:34:16 - utils - INFO - Loaded results for isolation_forest
2025-11-06 14:34:16 - utils - INFO - Loaded results for lstm_autoencoder
2025-11-06 14:34:16 - utils - INFO - Loaded results for deep_clustering
2025-11-06 14:34:16 - utils - INFO - Loaded results for 3 models
2025-11-06 14:34:16 - utils - INFO - Creating metrics comparison table...
2025-11-06 14:34:16 - utils - INFO - Metrics comparison table created
2025-11-06 14:34:16 - utils - INFO - Creating confusion matrix plots...
2025-11-06 14:34:16 - utils - INFO - Confusion matrices saved to /Users/bipinrimal/Downloads/Thesis_work/results/confusion_matrices/all_models.png
2025-11-06 14:34:16 - utils - INFO - Creating ROC curves...
2025-11-06 14:34:17 - utils - INFO - ROC curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/roc_curves/roc_comparison.png
2025-11-06 14:34:17 - utils - INFO - Creating Precision-Recall curves...
2025-11-06 14:34:17 - utils - INFO - Precision-Recall curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/precision_recall_comparison.png
2025-11-06 14:34:17 - utils - INFO - Creating metrics comparison bar chart...
2025-11-06 14:34:17 - utils - INFO - Metrics comparison bar chart saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/metrics_comparison_bar.png
2025-11-06 14:34:17 - utils - INFO - Creating anomaly score distribution plots...
2025-11-06 14:34:17 - utils - INFO - Score distributions saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/score_distributions.png
2025-11-06 14:34:17 - utils - INFO - Generating evaluation report...
2025-11-06 14:34:17 - utils - INFO - Evaluation report saved to /Users/bipinrimal/Downloads/Thesis_work/results/evaluation_report.txt
2025-11-06 14:34:17 - utils - INFO - Comprehensive evaluation completed!
2025-11-06 14:34:17 - utils - INFO - ✓ Stage 4 completed: Comprehensive evaluation report generated
2025-11-06 14:35:44 - utils - INFO - Utility functions loaded successfully
2025-11-06 14:35:44 - utils - INFO - Loading detailed observable files...
2025-11-06 14:35:44 - utils - INFO - Loaded master file: 191 insider incidents
2025-11-06 14:35:44 - utils - INFO -   Loaded r2.csv: 26 events for ONS0995
2025-11-06 14:35:44 - utils - INFO -   Loaded r3.1-1.csv: 35 events for CSF0929
2025-11-06 14:35:44 - utils - INFO -   Loaded r3.1-2.csv: 310 events for CCH0959
2025-11-06 14:35:44 - utils - INFO -   Loaded r3.2-1.csv: 24 events for RCW0822
2025-11-06 14:35:44 - utils - INFO -   Loaded r3.2-2.csv: 253 events for JCE0258
2025-11-06 14:35:44 - utils - INFO -   Loaded r4.1-1.csv: 10 events for ABB0427
2025-11-06 14:35:44 - utils - INFO -   Loaded r4.1-2.csv: 246 events for HFC0492
2025-11-06 14:35:44 - utils - INFO -   Loaded r4.1-3.csv: 17 events for KTW0365
2025-11-06 14:35:44 - utils - WARNING -   Could not find r4.2-1-AAM0658.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r4.2-1-AJR0932.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r4.2-1-BDV0168.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r4.2-1-BIH0745.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r4.2-1-BLS0678.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r4.2-1-BTL0226.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r4.2-1-CAH0936.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r4.2-1-DCH0843.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r4.2-1-EHB0824.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r4.2-1-EHD0584.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r4.2-1-FMG0527.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r4.2-1-FTM0406.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r4.2-1-GHL0460.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r4.2-1-HJB0742.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r4.2-1-JMB0308.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r4.2-1-JRG0207.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r4.2-1-KLH0596.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r4.2-1-KPC0073.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r4.2-1-LJR0523.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r4.2-1-LQC0479.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r4.2-1-MAR0955.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r4.2-1-MAS0025.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r4.2-1-MCF0600.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r4.2-1-MYD0978.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r4.2-1-PPF0435.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r4.2-1-RAB0589.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r4.2-1-RGG0064.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r4.2-1-RKD0604.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r4.2-1-TAP0551.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r4.2-1-WDD0366.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r4.2-2-AAF0535.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r4.2-2-ABC0174.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r4.2-2-AKR0057.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r4.2-2-CCL0068.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r4.2-2-CEJ0109.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r4.2-2-CQW0652.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r4.2-2-DIB0285.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r4.2-2-DRR0162.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r4.2-2-EDB0714.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r4.2-2-EGD0132.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r4.2-2-FSC0601.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r4.2-2-HBO0413.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r4.2-2-HXL0968.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r4.2-2-IJM0776.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r4.2-2-IKR0401.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r4.2-2-IUB0565.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r4.2-2-JJM0203.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r4.2-2-KRL0501.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r4.2-2-LCC0819.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r4.2-2-MDH0580.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r4.2-2-MOS0047.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r4.2-2-NWT0098.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r4.2-2-PNL0301.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r4.2-2-PSF0133.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r4.2-2-RAR0725.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r4.2-2-RHL0992.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r4.2-2-RMW0542.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r4.2-2-TNM0961.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r4.2-2-VSS0154.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r4.2-2-XHW0498.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r4.2-3-BBS0039.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r4.2-3-BSS0369.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r4.2-3-CCA0046.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r4.2-3-CSC0217.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r4.2-3-GTD0219.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r4.2-3-JGT0221.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r4.2-3-JLM0364.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r4.2-3-JTM0223.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r4.2-3-MPM0220.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r4.2-3-MSO0222.csv
2025-11-06 14:35:44 - utils - INFO -   Loaded r5.1-1.csv: 23 events for JTC1885
2025-11-06 14:35:44 - utils - INFO -   Loaded r5.1-2.csv: 181 events for LBE0376
2025-11-06 14:35:44 - utils - INFO -   Loaded r5.1-3.csv: 33 events for BGC0686
2025-11-06 14:35:44 - utils - INFO -   Loaded r5.1-4.csv: 114 events for JAK0783
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-1-ALT1465.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-1-ALW0764.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-1-AYG1697.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-1-DAS1320.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-1-DNJ0740.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-1-ELT1370.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-1-EPG1196.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-1-ETW0002.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-1-FZG0389.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-1-GFM1815.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-1-IHC0561.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-1-ISW0738.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-1-JKB0287.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-1-JUP1472.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-1-KBC1390.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-1-KEW0198.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-1-MIB0203.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-1-NIV1608.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-1-PBC0077.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-1-PTH0005.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-1-REF1924.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-1-SAF1942.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-1-SLL0193.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-1-TMC0934.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-1-VAH1292.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-1-WHB1247.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-1-WSK1857.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-1-WWW0701.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-1-ZKP0542.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-2-VCF1602.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-2-KSS1005.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-2-MCP0611.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-2-TNB1616.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-2-ZIE0741.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-2-HXP0976.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-2-HIS1394.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-2-JAL0811.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-2-ITA0159.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-2-CIF1430.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-2-RRS0056.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-2-MDS0680.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-2-TMT0851.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-2-OSS1463.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-2-HSN0675.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-2-WDT1634.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-2-OKM1092.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-2-CKP0630.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-2-ICB1354.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-2-TRC1838.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-2-NAH1366.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-2-BYO1846.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-2-GWG0497.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-2-MGB1235.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-2-CHP1711.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-2-SNK1280.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-2-LVF1626.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-2-HMS1658.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-2-DCC1119.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-2-SIS0042.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-3-ACA1126.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-3-CRD0272.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-3-CWW1120.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-3-ELM1123.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-3-GKW0043.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-3-KCM0466.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-3-LAH0463.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-3-MPF0690.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-3-VRP0267.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-3-ZEH0685.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-4-ACM1770.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-4-AMC1883.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-4-ASH0298.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-4-ASH0458.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-4-BDP0096.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-4-CBW1826.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-4-CGF1056.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-4-CPD1525.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-4-DIM0330.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-4-DKG0161.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-4-DQM0809.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-4-GCD0194.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-4-GMB0400.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-4-HBP1076.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-4-IRH1224.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-4-JCC0016.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-4-JIG1593.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-4-JMM0613.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-4-JNR1592.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-4-KDC0996.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-4-MJR0711.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-4-MTP1582.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-4-NKM1738.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-4-NKN1405.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-4-NZL1395.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-4-OFS0030.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-4-OHS0036.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-4-RCG0584.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-4-WCW1013.csv
2025-11-06 14:35:44 - utils - WARNING -   Could not find r5.2-4-WOS1834.csv
2025-11-06 14:35:44 - utils - INFO -   Loaded r6.1-1.csv: 22 events for CSF2712
2025-11-06 14:35:44 - utils - INFO -   Loaded r6.1-2.csv: 226 events for JPH1910
2025-11-06 14:35:44 - utils - INFO -   Loaded r6.1-3.csv: 28 events for HJB0462
2025-11-06 14:35:44 - utils - WARNING -   Could not find r6.1-4.csv
2025-11-06 14:35:44 - utils - INFO -   Loaded r6.1-5.csv: 4 events for ADC1257
2025-11-06 14:35:44 - utils - INFO -   Loaded r6.2-1.csv: 22 events for ACM2278
2025-11-06 14:35:44 - utils - INFO -   Loaded r6.2-2.csv: 242 events for CMP2946
2025-11-06 14:35:44 - utils - INFO -   Loaded r6.2-3.csv: 68 events for PLJ1771
2025-11-06 14:35:44 - utils - INFO -   Loaded r6.2-4.csv: 134 events for CDE1846
2025-11-06 14:35:44 - utils - INFO -   Loaded r6.2-5.csv: 4 events for MBG3183
2025-11-06 14:35:44 - utils - INFO - Loaded 21 observable files
2025-11-06 14:35:44 - utils - INFO - 
================================================================================
                           VALIDATING INSIDER LABELS                            
================================================================================

2025-11-06 14:35:44 - utils - INFO - Loaded master file: 191 insider incidents
2025-11-06 14:35:44 - utils - INFO - 
Validating 191 unique insider users...
2025-11-06 14:35:44 - utils - INFO - Checking for user ONS0995 (sampling 50,000 rows)...
2025-11-06 14:35:47 - utils - ERROR - Error: Error tokenizing data. C error: Calling read(nbytes) on source failed. Try engine='python'.
2025-11-06 14:35:47 - utils - INFO - Utility functions loaded successfully
2025-11-06 14:35:47 - utils - INFO - Loading detailed observable files...
2025-11-06 14:35:47 - utils - INFO - Loaded master file: 191 insider incidents
2025-11-06 14:35:47 - utils - INFO -   Loaded r2.csv: 26 events for ONS0995
2025-11-06 14:35:47 - utils - INFO -   Loaded r3.1-1.csv: 35 events for CSF0929
2025-11-06 14:35:47 - utils - INFO -   Loaded r3.1-2.csv: 310 events for CCH0959
2025-11-06 14:35:47 - utils - INFO -   Loaded r3.2-1.csv: 24 events for RCW0822
2025-11-06 14:35:47 - utils - INFO -   Loaded r3.2-2.csv: 253 events for JCE0258
2025-11-06 14:35:47 - utils - INFO -   Loaded r4.1-1.csv: 10 events for ABB0427
2025-11-06 14:35:47 - utils - INFO -   Loaded r4.1-2.csv: 246 events for HFC0492
2025-11-06 14:35:47 - utils - INFO -   Loaded r4.1-3.csv: 17 events for KTW0365
2025-11-06 14:35:47 - utils - WARNING -   Could not find r4.2-1-AAM0658.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r4.2-1-AJR0932.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r4.2-1-BDV0168.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r4.2-1-BIH0745.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r4.2-1-BLS0678.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r4.2-1-BTL0226.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r4.2-1-CAH0936.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r4.2-1-DCH0843.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r4.2-1-EHB0824.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r4.2-1-EHD0584.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r4.2-1-FMG0527.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r4.2-1-FTM0406.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r4.2-1-GHL0460.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r4.2-1-HJB0742.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r4.2-1-JMB0308.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r4.2-1-JRG0207.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r4.2-1-KLH0596.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r4.2-1-KPC0073.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r4.2-1-LJR0523.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r4.2-1-LQC0479.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r4.2-1-MAR0955.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r4.2-1-MAS0025.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r4.2-1-MCF0600.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r4.2-1-MYD0978.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r4.2-1-PPF0435.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r4.2-1-RAB0589.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r4.2-1-RGG0064.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r4.2-1-RKD0604.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r4.2-1-TAP0551.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r4.2-1-WDD0366.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r4.2-2-AAF0535.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r4.2-2-ABC0174.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r4.2-2-AKR0057.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r4.2-2-CCL0068.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r4.2-2-CEJ0109.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r4.2-2-CQW0652.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r4.2-2-DIB0285.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r4.2-2-DRR0162.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r4.2-2-EDB0714.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r4.2-2-EGD0132.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r4.2-2-FSC0601.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r4.2-2-HBO0413.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r4.2-2-HXL0968.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r4.2-2-IJM0776.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r4.2-2-IKR0401.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r4.2-2-IUB0565.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r4.2-2-JJM0203.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r4.2-2-KRL0501.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r4.2-2-LCC0819.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r4.2-2-MDH0580.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r4.2-2-MOS0047.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r4.2-2-NWT0098.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r4.2-2-PNL0301.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r4.2-2-PSF0133.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r4.2-2-RAR0725.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r4.2-2-RHL0992.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r4.2-2-RMW0542.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r4.2-2-TNM0961.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r4.2-2-VSS0154.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r4.2-2-XHW0498.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r4.2-3-BBS0039.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r4.2-3-BSS0369.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r4.2-3-CCA0046.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r4.2-3-CSC0217.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r4.2-3-GTD0219.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r4.2-3-JGT0221.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r4.2-3-JLM0364.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r4.2-3-JTM0223.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r4.2-3-MPM0220.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r4.2-3-MSO0222.csv
2025-11-06 14:35:47 - utils - INFO -   Loaded r5.1-1.csv: 23 events for JTC1885
2025-11-06 14:35:47 - utils - INFO -   Loaded r5.1-2.csv: 181 events for LBE0376
2025-11-06 14:35:47 - utils - INFO -   Loaded r5.1-3.csv: 33 events for BGC0686
2025-11-06 14:35:47 - utils - INFO -   Loaded r5.1-4.csv: 114 events for JAK0783
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-1-ALT1465.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-1-ALW0764.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-1-AYG1697.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-1-DAS1320.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-1-DNJ0740.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-1-ELT1370.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-1-EPG1196.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-1-ETW0002.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-1-FZG0389.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-1-GFM1815.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-1-IHC0561.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-1-ISW0738.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-1-JKB0287.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-1-JUP1472.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-1-KBC1390.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-1-KEW0198.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-1-MIB0203.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-1-NIV1608.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-1-PBC0077.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-1-PTH0005.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-1-REF1924.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-1-SAF1942.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-1-SLL0193.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-1-TMC0934.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-1-VAH1292.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-1-WHB1247.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-1-WSK1857.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-1-WWW0701.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-1-ZKP0542.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-2-VCF1602.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-2-KSS1005.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-2-MCP0611.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-2-TNB1616.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-2-ZIE0741.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-2-HXP0976.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-2-HIS1394.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-2-JAL0811.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-2-ITA0159.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-2-CIF1430.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-2-RRS0056.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-2-MDS0680.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-2-TMT0851.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-2-OSS1463.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-2-HSN0675.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-2-WDT1634.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-2-OKM1092.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-2-CKP0630.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-2-ICB1354.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-2-TRC1838.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-2-NAH1366.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-2-BYO1846.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-2-GWG0497.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-2-MGB1235.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-2-CHP1711.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-2-SNK1280.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-2-LVF1626.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-2-HMS1658.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-2-DCC1119.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-2-SIS0042.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-3-ACA1126.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-3-CRD0272.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-3-CWW1120.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-3-ELM1123.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-3-GKW0043.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-3-KCM0466.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-3-LAH0463.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-3-MPF0690.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-3-VRP0267.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-3-ZEH0685.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-4-ACM1770.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-4-AMC1883.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-4-ASH0298.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-4-ASH0458.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-4-BDP0096.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-4-CBW1826.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-4-CGF1056.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-4-CPD1525.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-4-DIM0330.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-4-DKG0161.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-4-DQM0809.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-4-GCD0194.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-4-GMB0400.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-4-HBP1076.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-4-IRH1224.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-4-JCC0016.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-4-JIG1593.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-4-JMM0613.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-4-JNR1592.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-4-KDC0996.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-4-MJR0711.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-4-MTP1582.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-4-NKM1738.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-4-NKN1405.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-4-NZL1395.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-4-OFS0030.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-4-OHS0036.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-4-RCG0584.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-4-WCW1013.csv
2025-11-06 14:35:47 - utils - WARNING -   Could not find r5.2-4-WOS1834.csv
2025-11-06 14:35:47 - utils - INFO -   Loaded r6.1-1.csv: 22 events for CSF2712
2025-11-06 14:35:47 - utils - INFO -   Loaded r6.1-2.csv: 226 events for JPH1910
2025-11-06 14:35:47 - utils - INFO -   Loaded r6.1-3.csv: 28 events for HJB0462
2025-11-06 14:35:47 - utils - WARNING -   Could not find r6.1-4.csv
2025-11-06 14:35:47 - utils - INFO -   Loaded r6.1-5.csv: 4 events for ADC1257
2025-11-06 14:35:47 - utils - INFO -   Loaded r6.2-1.csv: 22 events for ACM2278
2025-11-06 14:35:47 - utils - INFO -   Loaded r6.2-2.csv: 242 events for CMP2946
2025-11-06 14:35:47 - utils - INFO -   Loaded r6.2-3.csv: 68 events for PLJ1771
2025-11-06 14:35:47 - utils - INFO -   Loaded r6.2-4.csv: 134 events for CDE1846
2025-11-06 14:35:47 - utils - INFO -   Loaded r6.2-5.csv: 4 events for MBG3183
2025-11-06 14:35:47 - utils - INFO - Loaded 21 observable files
2025-11-06 14:35:47 - utils - INFO - Checking for user ONS0995 (sampling 10,000 rows)...
2025-11-06 14:35:48 - utils - ERROR - Error: Error tokenizing data. C error: Calling read(nbytes) on source failed. Try engine='python'.
2025-11-06 14:35:55 - utils - INFO - Utility functions loaded successfully
2025-11-06 14:35:55 - utils - INFO - Loading detailed observable files...
2025-11-06 14:35:55 - utils - INFO - Loaded master file: 191 insider incidents
2025-11-06 14:35:55 - utils - INFO -   Loaded r2.csv: 26 events for ONS0995
2025-11-06 14:35:55 - utils - INFO -   Loaded r3.1-1.csv: 35 events for CSF0929
2025-11-06 14:35:55 - utils - INFO -   Loaded r3.1-2.csv: 310 events for CCH0959
2025-11-06 14:35:55 - utils - INFO -   Loaded r3.2-1.csv: 24 events for RCW0822
2025-11-06 14:35:55 - utils - INFO -   Loaded r3.2-2.csv: 253 events for JCE0258
2025-11-06 14:35:55 - utils - INFO -   Loaded r4.1-1.csv: 10 events for ABB0427
2025-11-06 14:35:55 - utils - INFO -   Loaded r4.1-2.csv: 246 events for HFC0492
2025-11-06 14:35:55 - utils - INFO -   Loaded r4.1-3.csv: 17 events for KTW0365
2025-11-06 14:35:55 - utils - WARNING -   Could not find r4.2-1-AAM0658.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r4.2-1-AJR0932.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r4.2-1-BDV0168.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r4.2-1-BIH0745.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r4.2-1-BLS0678.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r4.2-1-BTL0226.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r4.2-1-CAH0936.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r4.2-1-DCH0843.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r4.2-1-EHB0824.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r4.2-1-EHD0584.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r4.2-1-FMG0527.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r4.2-1-FTM0406.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r4.2-1-GHL0460.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r4.2-1-HJB0742.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r4.2-1-JMB0308.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r4.2-1-JRG0207.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r4.2-1-KLH0596.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r4.2-1-KPC0073.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r4.2-1-LJR0523.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r4.2-1-LQC0479.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r4.2-1-MAR0955.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r4.2-1-MAS0025.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r4.2-1-MCF0600.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r4.2-1-MYD0978.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r4.2-1-PPF0435.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r4.2-1-RAB0589.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r4.2-1-RGG0064.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r4.2-1-RKD0604.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r4.2-1-TAP0551.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r4.2-1-WDD0366.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r4.2-2-AAF0535.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r4.2-2-ABC0174.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r4.2-2-AKR0057.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r4.2-2-CCL0068.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r4.2-2-CEJ0109.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r4.2-2-CQW0652.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r4.2-2-DIB0285.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r4.2-2-DRR0162.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r4.2-2-EDB0714.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r4.2-2-EGD0132.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r4.2-2-FSC0601.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r4.2-2-HBO0413.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r4.2-2-HXL0968.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r4.2-2-IJM0776.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r4.2-2-IKR0401.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r4.2-2-IUB0565.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r4.2-2-JJM0203.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r4.2-2-KRL0501.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r4.2-2-LCC0819.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r4.2-2-MDH0580.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r4.2-2-MOS0047.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r4.2-2-NWT0098.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r4.2-2-PNL0301.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r4.2-2-PSF0133.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r4.2-2-RAR0725.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r4.2-2-RHL0992.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r4.2-2-RMW0542.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r4.2-2-TNM0961.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r4.2-2-VSS0154.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r4.2-2-XHW0498.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r4.2-3-BBS0039.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r4.2-3-BSS0369.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r4.2-3-CCA0046.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r4.2-3-CSC0217.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r4.2-3-GTD0219.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r4.2-3-JGT0221.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r4.2-3-JLM0364.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r4.2-3-JTM0223.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r4.2-3-MPM0220.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r4.2-3-MSO0222.csv
2025-11-06 14:35:55 - utils - INFO -   Loaded r5.1-1.csv: 23 events for JTC1885
2025-11-06 14:35:55 - utils - INFO -   Loaded r5.1-2.csv: 181 events for LBE0376
2025-11-06 14:35:55 - utils - INFO -   Loaded r5.1-3.csv: 33 events for BGC0686
2025-11-06 14:35:55 - utils - INFO -   Loaded r5.1-4.csv: 114 events for JAK0783
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-1-ALT1465.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-1-ALW0764.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-1-AYG1697.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-1-DAS1320.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-1-DNJ0740.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-1-ELT1370.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-1-EPG1196.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-1-ETW0002.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-1-FZG0389.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-1-GFM1815.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-1-IHC0561.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-1-ISW0738.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-1-JKB0287.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-1-JUP1472.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-1-KBC1390.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-1-KEW0198.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-1-MIB0203.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-1-NIV1608.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-1-PBC0077.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-1-PTH0005.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-1-REF1924.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-1-SAF1942.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-1-SLL0193.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-1-TMC0934.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-1-VAH1292.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-1-WHB1247.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-1-WSK1857.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-1-WWW0701.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-1-ZKP0542.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-2-VCF1602.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-2-KSS1005.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-2-MCP0611.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-2-TNB1616.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-2-ZIE0741.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-2-HXP0976.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-2-HIS1394.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-2-JAL0811.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-2-ITA0159.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-2-CIF1430.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-2-RRS0056.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-2-MDS0680.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-2-TMT0851.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-2-OSS1463.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-2-HSN0675.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-2-WDT1634.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-2-OKM1092.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-2-CKP0630.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-2-ICB1354.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-2-TRC1838.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-2-NAH1366.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-2-BYO1846.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-2-GWG0497.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-2-MGB1235.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-2-CHP1711.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-2-SNK1280.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-2-LVF1626.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-2-HMS1658.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-2-DCC1119.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-2-SIS0042.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-3-ACA1126.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-3-CRD0272.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-3-CWW1120.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-3-ELM1123.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-3-GKW0043.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-3-KCM0466.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-3-LAH0463.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-3-MPF0690.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-3-VRP0267.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-3-ZEH0685.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-4-ACM1770.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-4-AMC1883.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-4-ASH0298.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-4-ASH0458.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-4-BDP0096.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-4-CBW1826.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-4-CGF1056.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-4-CPD1525.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-4-DIM0330.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-4-DKG0161.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-4-DQM0809.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-4-GCD0194.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-4-GMB0400.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-4-HBP1076.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-4-IRH1224.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-4-JCC0016.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-4-JIG1593.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-4-JMM0613.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-4-JNR1592.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-4-KDC0996.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-4-MJR0711.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-4-MTP1582.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-4-NKM1738.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-4-NKN1405.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-4-NZL1395.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-4-OFS0030.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-4-OHS0036.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-4-RCG0584.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-4-WCW1013.csv
2025-11-06 14:35:55 - utils - WARNING -   Could not find r5.2-4-WOS1834.csv
2025-11-06 14:35:55 - utils - INFO -   Loaded r6.1-1.csv: 22 events for CSF2712
2025-11-06 14:35:55 - utils - INFO -   Loaded r6.1-2.csv: 226 events for JPH1910
2025-11-06 14:35:55 - utils - INFO -   Loaded r6.1-3.csv: 28 events for HJB0462
2025-11-06 14:35:55 - utils - WARNING -   Could not find r6.1-4.csv
2025-11-06 14:35:55 - utils - INFO -   Loaded r6.1-5.csv: 4 events for ADC1257
2025-11-06 14:35:55 - utils - INFO -   Loaded r6.2-1.csv: 22 events for ACM2278
2025-11-06 14:35:55 - utils - INFO -   Loaded r6.2-2.csv: 242 events for CMP2946
2025-11-06 14:35:55 - utils - INFO -   Loaded r6.2-3.csv: 68 events for PLJ1771
2025-11-06 14:35:55 - utils - INFO -   Loaded r6.2-4.csv: 134 events for CDE1846
2025-11-06 14:35:55 - utils - INFO -   Loaded r6.2-5.csv: 4 events for MBG3183
2025-11-06 14:35:55 - utils - INFO - Loaded 21 observable files
2025-11-06 14:35:55 - utils - INFO - 
================================================================================
                           VALIDATING INSIDER LABELS                            
================================================================================

2025-11-06 14:35:55 - utils - INFO - Loaded master file: 191 insider incidents
2025-11-06 14:35:55 - utils - INFO - 
Validating 191 unique insider users...
2025-11-06 14:35:55 - utils - INFO - Checking for user ONS0995 (sampling 50,000 rows)...
2025-11-06 14:37:10 - utils - WARNING -   User ONS0995 NOT FOUND in processed data!
2025-11-06 14:37:10 - utils - INFO - Checking for user CSF0929 (sampling 50,000 rows)...
2025-11-06 14:37:25 - utils - ERROR - Error: Error tokenizing data. C error: Calling read(nbytes) on source failed. Try engine='python'.
2025-11-06 14:37:54 - utils - INFO - Utility functions loaded successfully
2025-11-06 14:37:54 - utils - INFO - Loading detailed observable files...
2025-11-06 14:37:54 - utils - INFO - Loaded master file: 191 insider incidents
2025-11-06 14:37:54 - utils - INFO -   Loaded r2.csv: 26 events for ONS0995
2025-11-06 14:37:54 - utils - INFO -   Loaded r3.1-1.csv: 35 events for CSF0929
2025-11-06 14:37:54 - utils - INFO -   Loaded r3.1-2.csv: 310 events for CCH0959
2025-11-06 14:37:54 - utils - INFO -   Loaded r3.2-1.csv: 24 events for RCW0822
2025-11-06 14:37:54 - utils - INFO -   Loaded r3.2-2.csv: 253 events for JCE0258
2025-11-06 14:37:54 - utils - INFO -   Loaded r4.1-1.csv: 10 events for ABB0427
2025-11-06 14:37:54 - utils - INFO -   Loaded r4.1-2.csv: 246 events for HFC0492
2025-11-06 14:37:54 - utils - INFO -   Loaded r4.1-3.csv: 17 events for KTW0365
2025-11-06 14:37:54 - utils - WARNING -   Could not find r4.2-1-AAM0658.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r4.2-1-AJR0932.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r4.2-1-BDV0168.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r4.2-1-BIH0745.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r4.2-1-BLS0678.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r4.2-1-BTL0226.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r4.2-1-CAH0936.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r4.2-1-DCH0843.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r4.2-1-EHB0824.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r4.2-1-EHD0584.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r4.2-1-FMG0527.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r4.2-1-FTM0406.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r4.2-1-GHL0460.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r4.2-1-HJB0742.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r4.2-1-JMB0308.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r4.2-1-JRG0207.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r4.2-1-KLH0596.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r4.2-1-KPC0073.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r4.2-1-LJR0523.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r4.2-1-LQC0479.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r4.2-1-MAR0955.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r4.2-1-MAS0025.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r4.2-1-MCF0600.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r4.2-1-MYD0978.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r4.2-1-PPF0435.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r4.2-1-RAB0589.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r4.2-1-RGG0064.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r4.2-1-RKD0604.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r4.2-1-TAP0551.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r4.2-1-WDD0366.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r4.2-2-AAF0535.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r4.2-2-ABC0174.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r4.2-2-AKR0057.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r4.2-2-CCL0068.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r4.2-2-CEJ0109.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r4.2-2-CQW0652.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r4.2-2-DIB0285.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r4.2-2-DRR0162.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r4.2-2-EDB0714.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r4.2-2-EGD0132.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r4.2-2-FSC0601.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r4.2-2-HBO0413.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r4.2-2-HXL0968.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r4.2-2-IJM0776.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r4.2-2-IKR0401.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r4.2-2-IUB0565.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r4.2-2-JJM0203.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r4.2-2-KRL0501.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r4.2-2-LCC0819.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r4.2-2-MDH0580.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r4.2-2-MOS0047.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r4.2-2-NWT0098.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r4.2-2-PNL0301.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r4.2-2-PSF0133.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r4.2-2-RAR0725.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r4.2-2-RHL0992.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r4.2-2-RMW0542.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r4.2-2-TNM0961.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r4.2-2-VSS0154.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r4.2-2-XHW0498.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r4.2-3-BBS0039.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r4.2-3-BSS0369.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r4.2-3-CCA0046.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r4.2-3-CSC0217.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r4.2-3-GTD0219.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r4.2-3-JGT0221.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r4.2-3-JLM0364.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r4.2-3-JTM0223.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r4.2-3-MPM0220.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r4.2-3-MSO0222.csv
2025-11-06 14:37:54 - utils - INFO -   Loaded r5.1-1.csv: 23 events for JTC1885
2025-11-06 14:37:54 - utils - INFO -   Loaded r5.1-2.csv: 181 events for LBE0376
2025-11-06 14:37:54 - utils - INFO -   Loaded r5.1-3.csv: 33 events for BGC0686
2025-11-06 14:37:54 - utils - INFO -   Loaded r5.1-4.csv: 114 events for JAK0783
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-1-ALT1465.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-1-ALW0764.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-1-AYG1697.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-1-DAS1320.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-1-DNJ0740.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-1-ELT1370.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-1-EPG1196.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-1-ETW0002.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-1-FZG0389.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-1-GFM1815.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-1-IHC0561.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-1-ISW0738.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-1-JKB0287.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-1-JUP1472.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-1-KBC1390.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-1-KEW0198.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-1-MIB0203.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-1-NIV1608.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-1-PBC0077.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-1-PTH0005.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-1-REF1924.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-1-SAF1942.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-1-SLL0193.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-1-TMC0934.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-1-VAH1292.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-1-WHB1247.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-1-WSK1857.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-1-WWW0701.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-1-ZKP0542.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-2-VCF1602.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-2-KSS1005.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-2-MCP0611.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-2-TNB1616.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-2-ZIE0741.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-2-HXP0976.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-2-HIS1394.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-2-JAL0811.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-2-ITA0159.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-2-CIF1430.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-2-RRS0056.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-2-MDS0680.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-2-TMT0851.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-2-OSS1463.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-2-HSN0675.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-2-WDT1634.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-2-OKM1092.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-2-CKP0630.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-2-ICB1354.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-2-TRC1838.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-2-NAH1366.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-2-BYO1846.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-2-GWG0497.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-2-MGB1235.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-2-CHP1711.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-2-SNK1280.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-2-LVF1626.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-2-HMS1658.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-2-DCC1119.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-2-SIS0042.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-3-ACA1126.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-3-CRD0272.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-3-CWW1120.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-3-ELM1123.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-3-GKW0043.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-3-KCM0466.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-3-LAH0463.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-3-MPF0690.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-3-VRP0267.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-3-ZEH0685.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-4-ACM1770.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-4-AMC1883.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-4-ASH0298.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-4-ASH0458.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-4-BDP0096.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-4-CBW1826.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-4-CGF1056.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-4-CPD1525.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-4-DIM0330.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-4-DKG0161.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-4-DQM0809.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-4-GCD0194.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-4-GMB0400.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-4-HBP1076.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-4-IRH1224.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-4-JCC0016.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-4-JIG1593.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-4-JMM0613.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-4-JNR1592.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-4-KDC0996.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-4-MJR0711.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-4-MTP1582.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-4-NKM1738.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-4-NKN1405.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-4-NZL1395.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-4-OFS0030.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-4-OHS0036.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-4-RCG0584.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-4-WCW1013.csv
2025-11-06 14:37:54 - utils - WARNING -   Could not find r5.2-4-WOS1834.csv
2025-11-06 14:37:54 - utils - INFO -   Loaded r6.1-1.csv: 22 events for CSF2712
2025-11-06 14:37:54 - utils - INFO -   Loaded r6.1-2.csv: 226 events for JPH1910
2025-11-06 14:37:54 - utils - INFO -   Loaded r6.1-3.csv: 28 events for HJB0462
2025-11-06 14:37:54 - utils - WARNING -   Could not find r6.1-4.csv
2025-11-06 14:37:54 - utils - INFO -   Loaded r6.1-5.csv: 4 events for ADC1257
2025-11-06 14:37:54 - utils - INFO -   Loaded r6.2-1.csv: 22 events for ACM2278
2025-11-06 14:37:54 - utils - INFO -   Loaded r6.2-2.csv: 242 events for CMP2946
2025-11-06 14:37:54 - utils - INFO -   Loaded r6.2-3.csv: 68 events for PLJ1771
2025-11-06 14:37:54 - utils - INFO -   Loaded r6.2-4.csv: 134 events for CDE1846
2025-11-06 14:37:54 - utils - INFO -   Loaded r6.2-5.csv: 4 events for MBG3183
2025-11-06 14:37:54 - utils - INFO - Loaded 21 observable files
2025-11-06 14:37:54 - utils - INFO - 
================================================================================
                           VALIDATING INSIDER LABELS                            
================================================================================

2025-11-06 14:37:54 - utils - INFO - Loaded master file: 191 insider incidents
2025-11-06 14:37:54 - utils - INFO - 
Validating 191 unique insider users...
2025-11-06 14:37:54 - utils - INFO - Checking for user ONS0995 (sampling 50,000 rows)...
2025-11-06 14:37:57 - utils - ERROR - Error: Error tokenizing data. C error: Calling read(nbytes) on source failed. Try engine='python'.
2025-11-06 14:38:19 - utils - INFO - Utility functions loaded successfully
2025-11-06 14:38:19 - utils - INFO - Loading detailed observable files...
2025-11-06 14:38:19 - utils - INFO - Loaded master file: 191 insider incidents
2025-11-06 14:38:19 - utils - INFO -   Loaded r2.csv: 26 events for ONS0995
2025-11-06 14:38:19 - utils - WARNING -   Could not find r3.1-1.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r3.1-2.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r3.2-1.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r3.2-2.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.1-1.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.1-2.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.1-3.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.2-1-AAM0658.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.2-1-AJR0932.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.2-1-BDV0168.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.2-1-BIH0745.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.2-1-BLS0678.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.2-1-BTL0226.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.2-1-CAH0936.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.2-1-DCH0843.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.2-1-EHB0824.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.2-1-EHD0584.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.2-1-FMG0527.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.2-1-FTM0406.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.2-1-GHL0460.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.2-1-HJB0742.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.2-1-JMB0308.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.2-1-JRG0207.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.2-1-KLH0596.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.2-1-KPC0073.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.2-1-LJR0523.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.2-1-LQC0479.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.2-1-MAR0955.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.2-1-MAS0025.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.2-1-MCF0600.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.2-1-MYD0978.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.2-1-PPF0435.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.2-1-RAB0589.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.2-1-RGG0064.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.2-1-RKD0604.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.2-1-TAP0551.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.2-1-WDD0366.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.2-2-AAF0535.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.2-2-ABC0174.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.2-2-AKR0057.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.2-2-CCL0068.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.2-2-CEJ0109.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.2-2-CQW0652.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.2-2-DIB0285.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.2-2-DRR0162.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.2-2-EDB0714.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.2-2-EGD0132.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.2-2-FSC0601.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.2-2-HBO0413.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.2-2-HXL0968.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.2-2-IJM0776.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.2-2-IKR0401.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.2-2-IUB0565.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.2-2-JJM0203.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.2-2-KRL0501.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.2-2-LCC0819.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.2-2-MDH0580.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.2-2-MOS0047.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.2-2-NWT0098.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.2-2-PNL0301.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.2-2-PSF0133.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.2-2-RAR0725.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.2-2-RHL0992.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.2-2-RMW0542.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.2-2-TNM0961.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.2-2-VSS0154.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.2-2-XHW0498.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.2-3-BBS0039.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.2-3-BSS0369.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.2-3-CCA0046.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.2-3-CSC0217.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.2-3-GTD0219.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.2-3-JGT0221.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.2-3-JLM0364.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.2-3-JTM0223.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.2-3-MPM0220.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r4.2-3-MSO0222.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.1-1.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.1-2.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.1-3.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.1-4.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-1-ALT1465.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-1-ALW0764.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-1-AYG1697.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-1-DAS1320.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-1-DNJ0740.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-1-ELT1370.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-1-EPG1196.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-1-ETW0002.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-1-FZG0389.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-1-GFM1815.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-1-IHC0561.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-1-ISW0738.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-1-JKB0287.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-1-JUP1472.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-1-KBC1390.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-1-KEW0198.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-1-MIB0203.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-1-NIV1608.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-1-PBC0077.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-1-PTH0005.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-1-REF1924.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-1-SAF1942.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-1-SLL0193.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-1-TMC0934.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-1-VAH1292.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-1-WHB1247.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-1-WSK1857.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-1-WWW0701.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-1-ZKP0542.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-2-VCF1602.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-2-KSS1005.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-2-MCP0611.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-2-TNB1616.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-2-ZIE0741.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-2-HXP0976.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-2-HIS1394.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-2-JAL0811.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-2-ITA0159.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-2-CIF1430.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-2-RRS0056.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-2-MDS0680.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-2-TMT0851.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-2-OSS1463.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-2-HSN0675.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-2-WDT1634.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-2-OKM1092.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-2-CKP0630.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-2-ICB1354.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-2-TRC1838.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-2-NAH1366.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-2-BYO1846.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-2-GWG0497.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-2-MGB1235.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-2-CHP1711.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-2-SNK1280.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-2-LVF1626.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-2-HMS1658.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-2-DCC1119.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-2-SIS0042.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-3-ACA1126.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-3-CRD0272.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-3-CWW1120.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-3-ELM1123.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-3-GKW0043.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-3-KCM0466.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-3-LAH0463.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-3-MPF0690.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-3-VRP0267.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-3-ZEH0685.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-4-ACM1770.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-4-AMC1883.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-4-ASH0298.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-4-ASH0458.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-4-BDP0096.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-4-CBW1826.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-4-CGF1056.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-4-CPD1525.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-4-DIM0330.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-4-DKG0161.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-4-DQM0809.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-4-GCD0194.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-4-GMB0400.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-4-HBP1076.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-4-IRH1224.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-4-JCC0016.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-4-JIG1593.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-4-JMM0613.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-4-JNR1592.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-4-KDC0996.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-4-MJR0711.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-4-MTP1582.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-4-NKM1738.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-4-NKN1405.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-4-NZL1395.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-4-OFS0030.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-4-OHS0036.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-4-RCG0584.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-4-WCW1013.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r5.2-4-WOS1834.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r6.1-1.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r6.1-2.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r6.1-3.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r6.1-4.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r6.1-5.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r6.2-1.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r6.2-2.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r6.2-3.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r6.2-4.csv
2025-11-06 14:38:19 - utils - WARNING -   Could not find r6.2-5.csv
2025-11-06 14:38:19 - utils - INFO - Loaded 1 observable files
2025-11-06 14:38:19 - utils - INFO - 
================================================================================
                           VALIDATING INSIDER LABELS                            
================================================================================

2025-11-06 14:38:19 - utils - INFO - Loaded master file: 191 insider incidents
2025-11-06 14:38:19 - utils - INFO - 
Validating 191 unique insider users...
2025-11-06 14:38:19 - utils - INFO - Checking for user ONS0995 (sampling 50,000 rows)...
2025-11-06 14:39:34 - utils - WARNING -   User ONS0995 NOT FOUND in processed data!
2025-11-06 14:39:34 - utils - INFO - Checking for user CSF0929 (sampling 50,000 rows)...
2025-11-06 14:40:49 - utils - WARNING -   User CSF0929 NOT FOUND in processed data!
2025-11-06 14:40:49 - utils - INFO - Checking for user CCH0959 (sampling 50,000 rows)...
2025-11-06 14:42:04 - utils - WARNING -   User CCH0959 NOT FOUND in processed data!
2025-11-06 14:42:04 - utils - INFO - Checking for user RCW0822 (sampling 50,000 rows)...
2025-11-06 14:42:04 - utils - INFO -   Found 45 records for RCW0822 (chunk 1)
2025-11-06 14:42:04 - utils - INFO -   45 labeled as insider
2025-11-06 14:42:04 - utils - INFO - Checking for user JCE0258 (sampling 50,000 rows)...
2025-11-06 14:42:04 - utils - INFO -   Found 15 records for JCE0258 (chunk 1)
2025-11-06 14:42:04 - utils - INFO -   15 labeled as insider
2025-11-06 14:42:04 - utils - INFO - Checking for user ABB0427 (sampling 50,000 rows)...
2025-11-06 14:43:20 - utils - WARNING -   User ABB0427 NOT FOUND in processed data!
2025-11-06 14:43:20 - utils - INFO - Checking for user HFC0492 (sampling 50,000 rows)...
2025-11-06 14:44:38 - utils - WARNING -   User HFC0492 NOT FOUND in processed data!
2025-11-06 14:44:38 - utils - INFO - Checking for user KTW0365 (sampling 50,000 rows)...
2025-11-06 14:45:55 - utils - WARNING -   User KTW0365 NOT FOUND in processed data!
2025-11-06 14:45:55 - utils - INFO - Checking for user AAM0658 (sampling 50,000 rows)...
2025-11-06 14:47:13 - utils - WARNING -   User AAM0658 NOT FOUND in processed data!
2025-11-06 14:47:13 - utils - INFO - Checking for user AJR0932 (sampling 50,000 rows)...
2025-11-06 14:48:32 - utils - WARNING -   User AJR0932 NOT FOUND in processed data!
2025-11-06 14:48:32 - utils - INFO - 
Comparing observables for RCW0822 with processed data...
2025-11-06 14:48:32 - utils - WARNING - No observable file found for RCW0822
2025-11-06 14:53:32 - utils - INFO - Utility functions loaded successfully
2025-11-06 14:56:41 - utils - INFO - Loaded dataframe from /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv
2025-11-06 14:56:41 - utils - INFO - 
================================================================================
                          FEATURE ENGINEERING PIPELINE                          
================================================================================

2025-11-06 14:56:41 - utils - INFO - Creating temporal features...
2025-11-06 14:57:11 - utils - INFO - Temporal features created
2025-11-06 14:57:11 - utils - INFO - Creating user aggregated features with window: 1D
2025-11-06 14:59:03 - utils - INFO - Aggregating activity type counts (this may be slow)...
2025-11-06 14:59:40 - utils - INFO - Created 11 aggregated features
2025-11-06 14:59:50 - utils - INFO - Creating behavioral ratio features...
2025-11-06 14:59:50 - utils - INFO - Behavioral ratio features created
2025-11-06 15:01:05 - utils - INFO - Scaling features (fit=True)...
2025-11-06 15:01:05 - utils - INFO - Scaled 14 features
2025-11-06 15:01:05 - utils - INFO - Creating statistical features per user...
2025-11-06 15:01:05 - utils - INFO - Created 70 statistical features
2025-11-06 15:01:05 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/feature_scaler.pkl
2025-11-06 15:01:05 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/label_encoders.pkl
2025-11-06 15:01:05 - utils - INFO - Feature engineering artifacts saved
2025-11-06 15:01:05 - utils - INFO - Daily aggregation completed: 337561 samples, 14 features
2025-11-06 15:01:05 - utils - INFO - Static features completed: 1000 samples
2025-11-06 15:01:14 - utils - INFO - Saved dataframe to /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_static_features.csv
2025-11-06 15:01:16 - utils - INFO - Saved dataframe to /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_daily_features.csv
2025-11-06 15:01:16 - utils - INFO - Creating sequences from *daily aggregated data* (this will be fast)...
2025-11-06 15:01:16 - utils - INFO - Creating sequences from aggregated data (length=15, stride=10)
2025-11-06 15:01:28 - utils - INFO - Created 33097 sequences from 1000 users
2025-11-06 15:01:28 - utils - INFO - Sequences saved for LSTM training
2025-11-06 15:02:40 - utils - INFO - Utility functions loaded successfully
2025-11-06 15:02:43 - utils - INFO - ================================================================================
2025-11-06 15:02:43 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-11-06 15:02:43 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-11-06 15:02:43 - utils - INFO - ================================================================================
2025-11-06 15:02:43 - utils - INFO - 
================================================================================
                            STAGE 3: MODEL TRAINING                             
================================================================================

2025-11-06 15:02:43 - utils - INFO - 
>>> Training Isolation Forest...
2025-11-06 15:02:43 - utils - INFO - 
================================================================================
                           ISOLATION FOREST TRAINING                            
================================================================================

2025-11-06 15:02:45 - utils - INFO - Loaded dataframe from /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_features.csv
2025-11-06 15:02:45 - utils - INFO - Initialized Isolation Forest with params: {'n_estimators': 50, 'max_samples': 256, 'contamination': 0.01, 'max_features': 1.0, 'bootstrap': False, 'n_jobs': -1, 'random_state': 42, 'verbose': 0}
2025-11-06 15:02:45 - utils - INFO - Data split: Train=236292, Val=50634, Test=50635
2025-11-06 15:02:45 - utils - INFO - Training Isolation Forest...
2025-11-06 15:02:45 - utils - INFO - Isolation Forest training completed
2025-11-06 15:02:45 - utils - INFO - Calibrating threshold for target FPR=0.05
2025-11-06 15:02:45 - utils - INFO - Calibrated threshold: 0.5848
2025-11-06 15:02:45 - utils - INFO - Evaluating Isolation Forest...
2025-11-06 15:02:45 - utils - INFO - 
============================================================
2025-11-06 15:02:45 - utils - INFO - Isolation Forest Performance Metrics
2025-11-06 15:02:45 - utils - INFO - ============================================================
2025-11-06 15:02:45 - utils - INFO - Accuracy:  0.9880
2025-11-06 15:02:45 - utils - INFO - Precision: 0.0000
2025-11-06 15:02:45 - utils - INFO - Recall:    0.0000
2025-11-06 15:02:45 - utils - INFO - F1-Score:  0.0000
2025-11-06 15:02:45 - utils - INFO - AUC-ROC:   0.7601
2025-11-06 15:02:45 - utils - INFO - ============================================================

2025-11-06 15:02:45 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest.pkl
2025-11-06 15:02:45 - utils - INFO - Isolation Forest model saved to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest.pkl
2025-11-06 15:02:45 - utils - INFO - Isolation Forest training and evaluation completed!
2025-11-06 15:02:45 - utils - INFO - ✓ Isolation Forest training completed
2025-11-06 15:02:45 - utils - INFO - 
>>> Training LSTM Autoencoder...
2025-11-06 15:02:45 - utils - INFO - 
================================================================================
                            DEEP CLUSTERING TRAINING                            
================================================================================

2025-11-06 15:02:47 - utils - INFO - Loaded dataframe from /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_features.csv
2025-11-06 15:02:47 - utils - INFO - Data split: Train=236292, Val=50634, Test=50635
2025-11-06 15:02:47 - utils - INFO - Initialized Deep Clustering Model with input_dim=84
2025-11-06 15:02:47 - utils - INFO - Training deep clustering model...
2025-11-06 15:02:47 - utils - INFO - Initializing cluster centers with k-means...
2025-11-06 15:02:47 - utils - INFO - Building encoder network...
2025-11-06 15:02:47 - utils - INFO - Encoder architecture:
2025-11-06 15:02:47 - utils - INFO - Model: "Encoder"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┓
┃ Layer (type)                         ┃ Output Shape                ┃         Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━┩
│ input_layer (InputLayer)             │ (None, 84)                  │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ encoder_dense_0 (Dense)              │ (None, 64)                  │           5,440 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout (Dropout)                    │ (None, 64)                  │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ encoder_dense_1 (Dense)              │ (None, 32)                  │           2,080 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout_1 (Dropout)                  │ (None, 32)                  │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ encoding (Dense)                     │ (None, 32)                  │           1,056 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ l2_normalize (Lambda)                │ (None, 32)                  │               0 │
└──────────────────────────────────────┴─────────────────────────────┴─────────────────┘
 Total params: 8,576 (33.50 KB)
 Trainable params: 8,576 (33.50 KB)
 Non-trainable params: 0 (0.00 B)

2025-11-06 15:02:51 - utils - INFO - Initialized 5 cluster centers
2025-11-06 15:02:51 - utils - INFO - Building deep clustering model...
2025-11-06 15:02:51 - utils - INFO - Deep clustering model built
2025-11-06 15:02:51 - utils - INFO - Compiling deep clustering model...
2025-11-06 15:02:55 - utils - INFO - Epoch 0/30, Loss: 0.0065
2025-11-06 15:02:55 - utils - ERROR - ✗ LSTM Autoencoder training failed: The filename must end in `.weights.h5`. Received: filepath=/Users/bipinrimal/Downloads/Thesis_work/models/deep_clustering.pkl
2025-11-06 15:02:55 - utils - INFO - 
>>> Training Deep Clustering...
2025-11-06 15:02:55 - utils - INFO - 
================================================================================
                      LIGHTWEIGHT DEEP CLUSTERING TRAINING                      
================================================================================

2025-11-06 15:02:56 - utils - INFO - Loaded dataframe from /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_features.csv
2025-11-06 15:02:56 - utils - INFO - Dataset: 337561 samples, 84 features
2025-11-06 15:02:56 - utils - INFO - Data split: Train=236292, Val=50634, Test=50635
2025-11-06 15:02:56 - utils - INFO - Initialized Lightweight Deep Clustering (n_clusters=5, encoding_dim=32)
2025-11-06 15:02:56 - utils - INFO - Training lightweight deep clustering model...
2025-11-06 15:02:56 - utils - INFO - Fitting MiniBatch K-Means clustering...
2025-11-06 15:02:56 - utils - INFO - Lightweight deep clustering training completed
2025-11-06 15:02:56 - utils - INFO - Training completed in 0.10 seconds
2025-11-06 15:02:56 - utils - INFO - Calibrating threshold for target FPR=0.05
2025-11-06 15:02:56 - utils - INFO - Calibrated threshold: 0.7681
2025-11-06 15:02:56 - utils - INFO - Evaluating lightweight deep clustering model...
2025-11-06 15:02:56 - utils - INFO - 
============================================================
2025-11-06 15:02:56 - utils - INFO - Deep Clustering (Lightweight) Performance Metrics
2025-11-06 15:02:56 - utils - INFO - ============================================================
2025-11-06 15:02:56 - utils - INFO - Accuracy:  0.9412
2025-11-06 15:02:56 - utils - INFO - Precision: 0.0117
2025-11-06 15:02:56 - utils - INFO - Recall:    0.5738
2025-11-06 15:02:56 - utils - INFO - F1-Score:  0.0230
2025-11-06 15:02:56 - utils - INFO - AUC-ROC:   0.8855
2025-11-06 15:02:56 - utils - INFO - ============================================================

2025-11-06 15:02:56 - utils - ERROR - ✗ Deep Clustering training failed: Path.replace() takes 2 positional arguments but 3 were given
2025-11-06 15:02:56 - utils - INFO - 
✓ Stage 3 completed: 1 models trained
2025-11-06 15:03:16 - utils - INFO - Utility functions loaded successfully
2025-11-06 15:03:16 - utils - INFO - 
================================================================================
                      LIGHTWEIGHT DEEP CLUSTERING TRAINING                      
================================================================================

2025-11-06 15:03:17 - utils - INFO - Loaded dataframe from /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_features.csv
2025-11-06 15:03:17 - utils - INFO - Dataset: 337561 samples, 84 features
2025-11-06 15:03:17 - utils - INFO - Data split: Train=236292, Val=50634, Test=50635
2025-11-06 15:03:17 - utils - INFO - Initialized Lightweight Deep Clustering (n_clusters=5, encoding_dim=32)
2025-11-06 15:03:17 - utils - INFO - Training lightweight deep clustering model...
2025-11-06 15:03:17 - utils - INFO - Fitting MiniBatch K-Means clustering...
2025-11-06 15:03:17 - utils - INFO - Lightweight deep clustering training completed
2025-11-06 15:03:17 - utils - INFO - Training completed in 0.12 seconds
2025-11-06 15:03:17 - utils - INFO - Calibrating threshold for target FPR=0.05
2025-11-06 15:03:17 - utils - INFO - Calibrated threshold: 0.7681
2025-11-06 15:03:17 - utils - INFO - Evaluating lightweight deep clustering model...
2025-11-06 15:03:17 - utils - INFO - 
============================================================
2025-11-06 15:03:17 - utils - INFO - Deep Clustering (Lightweight) Performance Metrics
2025-11-06 15:03:17 - utils - INFO - ============================================================
2025-11-06 15:03:17 - utils - INFO - Accuracy:  0.9412
2025-11-06 15:03:17 - utils - INFO - Precision: 0.0117
2025-11-06 15:03:17 - utils - INFO - Recall:    0.5738
2025-11-06 15:03:17 - utils - INFO - F1-Score:  0.0230
2025-11-06 15:03:17 - utils - INFO - AUC-ROC:   0.8855
2025-11-06 15:03:17 - utils - INFO - ============================================================

2025-11-06 15:03:17 - utils - INFO - Lightweight deep clustering model saved to /Users/bipinrimal/Downloads/Thesis_work/models/deep_clustering.pkl
2025-11-06 15:03:17 - utils - INFO - Lightweight deep clustering training and evaluation completed!
2025-11-06 15:03:17 - utils - INFO - Total time: 0.12 seconds
2025-11-06 15:03:36 - utils - INFO - Utility functions loaded successfully
2025-11-06 15:03:38 - utils - INFO - 
================================================================================
                     LIGHTWEIGHT LSTM AUTOENCODER TRAINING                      
================================================================================

2025-11-06 15:03:38 - utils - INFO - Loaded sequences: (33097, 15, 14)
2025-11-06 15:03:38 - utils - INFO - Data split: Train=23167, Val=4965, Test=4965
2025-11-06 15:03:38 - utils - INFO - Training on 23140 normal sequences
2025-11-06 15:03:38 - utils - INFO - Initialized Lightweight LSTM Autoencoder (15, 14)
2025-11-06 15:03:38 - utils - INFO - Training lightweight LSTM Autoencoder...
2025-11-06 15:03:38 - utils - INFO - Building lightweight LSTM Autoencoder...
2025-11-06 15:03:38 - utils - INFO - Model built with 18,270 parameters
2025-11-06 15:03:38 - utils - INFO - Training on 23140 sequences...
2025-11-06 15:04:06 - utils - INFO - Training completed
2025-11-06 15:04:06 - utils - INFO - Training completed in 28.18 seconds
2025-11-06 15:04:06 - utils - INFO - Calibrating threshold for target FPR=0.05
2025-11-06 15:04:07 - utils - INFO - Calibrated threshold: 0.0386
2025-11-06 15:04:07 - utils - INFO - Evaluating lightweight LSTM Autoencoder...
2025-11-06 15:04:07 - utils - INFO - 
============================================================
2025-11-06 15:04:07 - utils - INFO - LSTM Autoencoder (Lightweight) Performance Metrics
2025-11-06 15:04:07 - utils - INFO - ============================================================
2025-11-06 15:04:07 - utils - INFO - Accuracy:  0.9698
2025-11-06 15:04:07 - utils - INFO - Precision: 0.0000
2025-11-06 15:04:07 - utils - INFO - Recall:    0.0000
2025-11-06 15:04:07 - utils - INFO - F1-Score:  0.0000
2025-11-06 15:04:07 - utils - INFO - AUC-ROC:   0.7966
2025-11-06 15:04:07 - utils - INFO - ============================================================

2025-11-06 15:06:06 - utils - INFO - Utility functions loaded successfully
2025-11-06 15:06:09 - utils - INFO - ================================================================================
2025-11-06 15:06:09 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-11-06 15:06:09 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-11-06 15:06:09 - utils - INFO - ================================================================================
2025-11-06 15:06:09 - utils - INFO - 
================================================================================
                           STAGE 4: MODEL EVALUATION                            
================================================================================

2025-11-06 15:06:09 - utils - INFO - 
================================================================================
                         COMPREHENSIVE MODEL EVALUATION                         
================================================================================

2025-11-06 15:06:09 - utils - INFO - Loading results for all models...
2025-11-06 15:06:09 - utils - INFO - Loaded results for isolation_forest
2025-11-06 15:06:09 - utils - INFO - Loaded results for lstm_autoencoder
2025-11-06 15:06:09 - utils - INFO - Loaded results for deep_clustering
2025-11-06 15:06:09 - utils - INFO - Loaded results for 3 models
2025-11-06 15:06:09 - utils - INFO - Creating metrics comparison table...
2025-11-06 15:06:09 - utils - INFO - Metrics comparison table created
2025-11-06 15:06:09 - utils - INFO - Creating confusion matrix plots...
2025-11-06 15:06:09 - utils - INFO - Confusion matrices saved to /Users/bipinrimal/Downloads/Thesis_work/results/confusion_matrices/all_models.png
2025-11-06 15:06:09 - utils - INFO - Creating ROC curves...
2025-11-06 15:06:09 - utils - INFO - ROC curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/roc_curves/roc_comparison.png
2025-11-06 15:06:09 - utils - INFO - Creating Precision-Recall curves...
2025-11-06 15:06:10 - utils - INFO - Precision-Recall curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/precision_recall_comparison.png
2025-11-06 15:06:10 - utils - INFO - Creating metrics comparison bar chart...
2025-11-06 15:06:10 - utils - INFO - Metrics comparison bar chart saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/metrics_comparison_bar.png
2025-11-06 15:06:10 - utils - INFO - Creating anomaly score distribution plots...
2025-11-06 15:06:10 - utils - INFO - Score distributions saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/score_distributions.png
2025-11-06 15:06:10 - utils - INFO - Generating evaluation report...
2025-11-06 15:06:10 - utils - INFO - Evaluation report saved to /Users/bipinrimal/Downloads/Thesis_work/results/evaluation_report.txt
2025-11-06 15:06:10 - utils - INFO - Comprehensive evaluation completed!
2025-11-06 15:06:10 - utils - INFO - ✓ Stage 4 completed: Comprehensive evaluation report generated
2025-11-06 15:10:06 - utils - INFO - Utility functions loaded successfully
2025-11-06 15:10:06 - utils - INFO - 
================================================================================
                          DATA PREPROCESSING PIPELINE                           
================================================================================

2025-11-06 15:10:06 - utils - INFO - Starting data loading process...
2025-11-06 15:10:06 - utils - INFO - Loading CMU-CERT dataset...
2025-11-06 15:10:06 - utils - INFO - Loaded logon: 840141 records
2025-11-06 15:10:07 - utils - INFO - Loaded device: 712308 records
2025-11-06 15:10:07 - utils - WARNING - File not found: /Users/bipinrimal/Downloads/Thesis_work/data/raw/file.csv
2025-11-06 15:10:07 - utils - INFO - Loaded email: 1189372 records
2025-11-06 15:10:10 - utils - INFO - Loaded http: 7321105 records
2025-11-06 15:10:10 - utils - INFO - Merging all log sources...
2025-11-06 15:10:10 - utils - INFO - Preprocessing logon data...
2025-11-06 15:10:11 - utils - INFO - Parsed datetime column: date
2025-11-06 15:10:11 - utils - INFO - Cleaning dataframe with 840141 rows
2025-11-06 15:10:11 - utils - INFO - Removed 0 duplicate rows
2025-11-06 15:10:12 - utils - INFO - Pseudonymized column: user
2025-11-06 15:10:12 - utils - INFO - Pseudonymized column: pc
2025-11-06 15:10:12 - utils - INFO - Logon data processed: 840141 records
2025-11-06 15:10:12 - utils - INFO - Preprocessing device data...
2025-11-06 15:10:13 - utils - INFO - Parsed datetime column: date
2025-11-06 15:10:13 - utils - INFO - Cleaning dataframe with 712308 rows
2025-11-06 15:10:13 - utils - INFO - Removed 0 duplicate rows
2025-11-06 15:10:13 - utils - INFO - Pseudonymized column: user
2025-11-06 15:10:14 - utils - INFO - Pseudonymized column: pc
2025-11-06 15:10:14 - utils - INFO - Device data processed: 712308 records
2025-11-06 15:10:14 - utils - INFO - Preprocessing email data...
2025-11-06 15:10:15 - utils - INFO - Parsed datetime column: date
2025-11-06 15:10:15 - utils - INFO - Cleaning dataframe with 1189372 rows
2025-11-06 15:10:15 - utils - INFO - Removed 0 duplicate rows
2025-11-06 15:13:09 - utils - INFO - Utility functions loaded successfully
2025-11-06 15:13:09 - utils - INFO - 
================================================================================
                          DATA PREPROCESSING PIPELINE                           
================================================================================

2025-11-06 15:13:09 - utils - INFO - Starting data loading process...
2025-11-06 15:13:09 - utils - INFO - Loading CMU-CERT dataset...
2025-11-06 15:13:09 - utils - INFO - Loaded logon: 840141 records
2025-11-06 15:13:09 - utils - INFO - Loaded device: 712308 records
2025-11-06 15:13:09 - utils - WARNING - File not found: /Users/bipinrimal/Downloads/Thesis_work/data/raw/file.csv
2025-11-06 15:13:10 - utils - INFO - Loaded email: 1189372 records
2025-11-06 15:13:13 - utils - INFO - Loaded http: 7321105 records
2025-11-06 15:13:13 - utils - INFO - Merging all log sources...
2025-11-06 15:13:13 - utils - INFO - Preprocessing logon data...
2025-11-06 15:13:14 - utils - INFO - Parsed datetime column: date
2025-11-06 15:13:14 - utils - INFO - Cleaning dataframe with 840141 rows
2025-11-06 15:13:14 - utils - INFO - Removed 0 duplicate rows
2025-11-06 15:13:14 - utils - INFO - Pseudonymized column: user
2025-11-06 15:13:15 - utils - INFO - Pseudonymized column: pc
2025-11-06 15:13:15 - utils - INFO - Logon data processed: 840141 records
2025-11-06 15:13:15 - utils - INFO - Preprocessing device data...
2025-11-06 15:13:16 - utils - INFO - Parsed datetime column: date
2025-11-06 15:13:16 - utils - INFO - Cleaning dataframe with 712308 rows
2025-11-06 15:13:16 - utils - INFO - Removed 0 duplicate rows
2025-11-06 15:13:16 - utils - INFO - Pseudonymized column: user
2025-11-06 15:13:16 - utils - INFO - Pseudonymized column: pc
2025-11-06 15:13:17 - utils - INFO - Device data processed: 712308 records
2025-11-06 15:13:17 - utils - INFO - Preprocessing email data...
2025-11-06 15:13:18 - utils - INFO - Parsed datetime column: date
2025-11-06 15:13:18 - utils - INFO - Cleaning dataframe with 1189372 rows
2025-11-06 15:13:18 - utils - INFO - Removed 0 duplicate rows
2025-11-06 15:13:19 - utils - INFO - Pseudonymized column: from
2025-11-06 15:13:20 - utils - INFO - Email data processed: 1189372 records
2025-11-06 15:13:20 - utils - INFO - Preprocessing HTTP data...
2025-11-06 15:13:27 - utils - INFO - Parsed datetime column: date
2025-11-06 15:13:27 - utils - INFO - Cleaning dataframe with 7321105 rows
2025-11-06 15:13:30 - utils - INFO - Removed 0 duplicate rows
2025-11-06 15:13:34 - utils - INFO - Pseudonymized column: user
2025-11-06 15:13:37 - utils - INFO - Pseudonymized column: pc
2025-11-06 15:13:42 - utils - INFO - HTTP data processed: 7321105 records
2025-11-06 15:13:46 - utils - INFO - All logs merged: 10062926 total records
2025-11-06 15:13:46 - utils - INFO - min_user_activity_threshold is 0, skipping user filtering.
2025-11-06 15:13:46 - utils - INFO - Initializing 'is_insider' column (all set to 0)...
2025-11-06 15:22:46 - utils - INFO - Utility functions loaded successfully
2025-11-06 15:22:46 - utils - INFO - 
================================================================================
                          DATA PREPROCESSING PIPELINE                           
================================================================================

2025-11-06 15:22:46 - utils - INFO - Starting data loading process...
2025-11-06 15:22:46 - utils - INFO - Loading CMU-CERT dataset...
2025-11-06 15:22:46 - utils - INFO - Loaded logon: 840141 records
2025-11-06 15:22:47 - utils - INFO - Loaded device: 712308 records
2025-11-06 15:22:47 - utils - INFO - Loaded email: 1189372 records
2025-11-06 15:22:50 - utils - INFO - Loaded http: 7321105 records
2025-11-06 15:22:50 - utils - INFO - Loaded psychometric: 1000 records
2025-11-06 15:22:50 - utils - INFO - Merging all log sources...
2025-11-06 15:22:50 - utils - INFO - Preprocessing logon data...
2025-11-06 15:22:51 - utils - INFO - Parsed datetime column: date
2025-11-06 15:22:51 - utils - INFO - Cleaning dataframe with 840141 rows
2025-11-06 15:22:51 - utils - INFO - Removed 0 duplicate rows
2025-11-06 15:22:52 - utils - INFO - Pseudonymized column: user
2025-11-06 15:22:52 - utils - INFO - Pseudonymized column: pc
2025-11-06 15:22:52 - utils - INFO - Logon data processed: 840141 records
2025-11-06 15:22:52 - utils - INFO - Preprocessing device data...
2025-11-06 15:22:53 - utils - INFO - Parsed datetime column: date
2025-11-06 15:22:53 - utils - INFO - Cleaning dataframe with 712308 rows
2025-11-06 15:22:53 - utils - INFO - Removed 0 duplicate rows
2025-11-06 15:22:53 - utils - INFO - Pseudonymized column: user
2025-11-06 15:22:54 - utils - INFO - Pseudonymized column: pc
2025-11-06 15:22:54 - utils - INFO - Device data processed: 712308 records
2025-11-06 15:22:54 - utils - WARNING - file.csv not found, skipping file data.
2025-11-06 15:22:54 - utils - INFO - Preprocessing email data...
2025-11-06 15:22:55 - utils - INFO - Parsed datetime column: date
2025-11-06 15:22:55 - utils - INFO - Cleaning dataframe with 1189372 rows
2025-11-06 15:22:55 - utils - INFO - Removed 0 duplicate rows
2025-11-06 15:22:56 - utils - INFO - Pseudonymized column: from
2025-11-06 15:22:57 - utils - INFO - Email data processed: 1189372 records
2025-11-06 15:22:57 - utils - INFO - Preprocessing HTTP data...
2025-11-06 15:23:04 - utils - INFO - Parsed datetime column: date
2025-11-06 15:23:04 - utils - INFO - Cleaning dataframe with 7321105 rows
2025-11-06 15:23:07 - utils - INFO - Removed 0 duplicate rows
2025-11-06 15:24:52 - utils - INFO - Utility functions loaded successfully
2025-11-06 15:24:52 - utils - INFO - 
================================================================================
                          DATA PREPROCESSING PIPELINE                           
================================================================================

2025-11-06 15:24:52 - utils - INFO - Starting data loading process...
2025-11-06 15:24:52 - utils - INFO - Loading CMU-CERT dataset...
2025-11-06 15:24:52 - utils - INFO - Loaded logon: 840141 records
2025-11-06 15:24:52 - utils - INFO - Loaded device: 712308 records
2025-11-06 15:24:53 - utils - INFO - Loaded email: 1189372 records
2025-11-06 15:24:56 - utils - INFO - Loaded http: 7321105 records
2025-11-06 15:24:56 - utils - INFO - Loaded psychometric: 1000 records
2025-11-06 15:24:56 - utils - INFO - Merging all log sources...
2025-11-06 15:24:56 - utils - INFO - Preprocessing logon data...
2025-11-06 15:24:57 - utils - INFO - Parsed datetime column: date
2025-11-06 15:24:57 - utils - INFO - Cleaning dataframe with 840141 rows
2025-11-06 15:24:57 - utils - INFO - Removed 0 duplicate rows
2025-11-06 15:24:58 - utils - INFO - Pseudonymized column: user
2025-11-06 15:24:58 - utils - INFO - Pseudonymized column: pc
2025-11-06 15:24:58 - utils - INFO - Logon data processed: 840141 records
2025-11-06 15:24:58 - utils - INFO - Preprocessing device data...
2025-11-06 15:24:59 - utils - INFO - Parsed datetime column: date
2025-11-06 15:24:59 - utils - INFO - Cleaning dataframe with 712308 rows
2025-11-06 15:24:59 - utils - INFO - Removed 0 duplicate rows
2025-11-06 15:24:59 - utils - INFO - Pseudonymized column: user
2025-11-06 15:25:00 - utils - INFO - Pseudonymized column: pc
2025-11-06 15:25:00 - utils - INFO - Device data processed: 712308 records
2025-11-06 15:25:00 - utils - WARNING - file.csv not found, skipping file data.
2025-11-06 15:25:00 - utils - INFO - Preprocessing email data...
2025-11-06 15:25:01 - utils - INFO - Parsed datetime column: date
2025-11-06 15:25:01 - utils - INFO - Cleaning dataframe with 1189372 rows
2025-11-06 15:25:01 - utils - INFO - Removed 0 duplicate rows
2025-11-06 15:25:02 - utils - INFO - Pseudonymized column: from
2025-11-06 15:25:03 - utils - INFO - Email data processed: 1189372 records
2025-11-06 15:25:03 - utils - INFO - Preprocessing HTTP data...
2025-11-06 15:25:10 - utils - INFO - Parsed datetime column: date
2025-11-06 15:25:10 - utils - INFO - Cleaning dataframe with 7321105 rows
2025-11-06 15:25:13 - utils - INFO - Removed 0 duplicate rows
2025-11-06 15:25:17 - utils - INFO - Pseudonymized column: user
2025-11-06 15:25:20 - utils - INFO - Pseudonymized column: pc
2025-11-06 15:25:25 - utils - INFO - HTTP data processed: 7321105 records
2025-11-06 15:25:29 - utils - INFO - All event logs merged: 10062926 total records
2025-11-06 15:25:29 - utils - INFO - Loading LDAP data...
2025-11-06 15:25:29 - utils - INFO - Reading latest LDAP file: 2011-05.csv
2025-11-06 15:25:29 - utils - ERROR - Failed to read LDAP file /Users/bipinrimal/Downloads/Thesis_work/data/raw/LDAP/2011-05.csv: "['domain'] not in index"
2025-11-06 15:25:29 - utils - INFO - Preprocessing psychometric data...
2025-11-06 15:25:29 - utils - INFO - Loaded 1000 psychometric profiles
2025-11-06 15:25:29 - utils - INFO - Pseudonymized column: user
2025-11-06 15:25:29 - utils - INFO - Merging static user data (LDAP, Psychometric) into event logs...
2025-11-06 15:25:30 - utils - INFO - Static data merged. Total columns: 31
2025-11-06 15:25:30 - utils - INFO - min_user_activity_threshold is 0, skipping user filtering.
2025-11-06 15:25:30 - utils - INFO - Initializing 'is_insider' column (all set to 0)...
2025-11-06 15:26:08 - utils - INFO - Handled missing values using strategy: fill_mode
2025-11-06 15:27:03 - utils - INFO - Saved dataframe to /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv
2025-11-06 15:27:03 - utils - INFO - Processed data saved to processed_unified_logs.csv
2025-11-06 15:27:03 - utils - INFO - Preprocessing pipeline completed successfully!
2025-11-06 15:27:03 - utils - INFO - Final dataset: 10062926 records, 32 features
2025-11-06 15:27:31 - utils - INFO - Utility functions loaded successfully
2025-11-06 15:27:31 - utils - INFO - 
================================================================================
                       MEMORY-EFFICIENT INSIDER LABELING                        
================================================================================

2025-11-06 15:27:31 - utils - INFO - Loaded 191 insider users from answers file
2025-11-06 15:27:31 - utils - INFO - Processing /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv in chunks of 50,000 rows...
2025-11-06 15:27:31 - utils - INFO - Scanning file...
2025-11-06 15:27:32 - utils - INFO - Total rows to process: 10,062,926
2025-11-06 15:27:32 - utils - INFO - Using user column: user_pseudo
2025-11-06 15:27:32 - utils - INFO - Pseudonymized insider user IDs for matching
2025-11-06 15:27:32 - utils - INFO - Progress: 50,000/10,062,926 (0.5%) - Labeled: 5
2025-11-06 15:27:32 - utils - INFO - Progress: 100,000/10,062,926 (1.0%) - Labeled: 12
2025-11-06 15:27:33 - utils - INFO - Progress: 150,000/10,062,926 (1.5%) - Labeled: 20
2025-11-06 15:27:33 - utils - INFO - Progress: 200,000/10,062,926 (2.0%) - Labeled: 24
2025-11-06 15:27:33 - utils - INFO - Progress: 250,000/10,062,926 (2.5%) - Labeled: 28
2025-11-06 15:27:34 - utils - INFO - Progress: 300,000/10,062,926 (3.0%) - Labeled: 36
2025-11-06 15:27:34 - utils - INFO - Progress: 350,000/10,062,926 (3.5%) - Labeled: 44
2025-11-06 15:27:34 - utils - INFO - Progress: 400,000/10,062,926 (4.0%) - Labeled: 49
2025-11-06 15:27:35 - utils - INFO - Progress: 450,000/10,062,926 (4.5%) - Labeled: 55
2025-11-06 15:27:35 - utils - INFO - Progress: 500,000/10,062,926 (5.0%) - Labeled: 59
2025-11-06 15:27:35 - utils - INFO - Progress: 550,000/10,062,926 (5.5%) - Labeled: 63
2025-11-06 15:27:35 - utils - INFO - Progress: 600,000/10,062,926 (6.0%) - Labeled: 68
2025-11-06 15:27:36 - utils - INFO - Progress: 650,000/10,062,926 (6.5%) - Labeled: 75
2025-11-06 15:27:36 - utils - INFO - Progress: 700,000/10,062,926 (7.0%) - Labeled: 83
2025-11-06 15:27:36 - utils - INFO - Progress: 750,000/10,062,926 (7.5%) - Labeled: 89
2025-11-06 15:27:37 - utils - INFO - Progress: 800,000/10,062,926 (7.9%) - Labeled: 94
2025-11-06 15:27:37 - utils - INFO - Progress: 850,000/10,062,926 (8.4%) - Labeled: 101
2025-11-06 15:27:37 - utils - INFO - Progress: 900,000/10,062,926 (8.9%) - Labeled: 107
2025-11-06 15:27:38 - utils - INFO - Progress: 950,000/10,062,926 (9.4%) - Labeled: 114
2025-11-06 15:27:38 - utils - INFO - Progress: 1,000,000/10,062,926 (9.9%) - Labeled: 125
2025-11-06 15:27:38 - utils - INFO - Progress: 1,050,000/10,062,926 (10.4%) - Labeled: 132
2025-11-06 15:27:39 - utils - INFO - Progress: 1,100,000/10,062,926 (10.9%) - Labeled: 135
2025-11-06 15:27:39 - utils - INFO - Progress: 1,150,000/10,062,926 (11.4%) - Labeled: 141
2025-11-06 15:27:39 - utils - INFO - Progress: 1,200,000/10,062,926 (11.9%) - Labeled: 150
2025-11-06 15:27:39 - utils - INFO - Progress: 1,250,000/10,062,926 (12.4%) - Labeled: 155
2025-11-06 15:27:40 - utils - INFO - Progress: 1,300,000/10,062,926 (12.9%) - Labeled: 160
2025-11-06 15:27:40 - utils - INFO - Progress: 1,350,000/10,062,926 (13.4%) - Labeled: 171
2025-11-06 15:27:40 - utils - INFO - Progress: 1,400,000/10,062,926 (13.9%) - Labeled: 185
2025-11-06 15:27:41 - utils - INFO - Progress: 1,450,000/10,062,926 (14.4%) - Labeled: 189
2025-11-06 15:27:41 - utils - INFO - Progress: 1,500,000/10,062,926 (14.9%) - Labeled: 202
2025-11-06 15:27:41 - utils - INFO - Progress: 1,550,000/10,062,926 (15.4%) - Labeled: 210
2025-11-06 15:27:42 - utils - INFO - Progress: 1,600,000/10,062,926 (15.9%) - Labeled: 216
2025-11-06 15:27:42 - utils - INFO - Progress: 1,650,000/10,062,926 (16.4%) - Labeled: 226
2025-11-06 15:27:42 - utils - INFO - Progress: 1,700,000/10,062,926 (16.9%) - Labeled: 241
2025-11-06 15:27:43 - utils - INFO - Progress: 1,750,000/10,062,926 (17.4%) - Labeled: 246
2025-11-06 15:27:43 - utils - INFO - Progress: 1,800,000/10,062,926 (17.9%) - Labeled: 254
2025-11-06 15:27:43 - utils - INFO - Progress: 1,850,000/10,062,926 (18.4%) - Labeled: 261
2025-11-06 15:27:44 - utils - INFO - Progress: 1,900,000/10,062,926 (18.9%) - Labeled: 266
2025-11-06 15:27:44 - utils - INFO - Progress: 1,950,000/10,062,926 (19.4%) - Labeled: 269
2025-11-06 15:27:44 - utils - INFO - Progress: 2,000,000/10,062,926 (19.9%) - Labeled: 269
2025-11-06 15:27:45 - utils - INFO - Progress: 2,050,000/10,062,926 (20.4%) - Labeled: 269
2025-11-06 15:27:45 - utils - INFO - Progress: 2,100,000/10,062,926 (20.9%) - Labeled: 269
2025-11-06 15:27:45 - utils - INFO - Progress: 2,150,000/10,062,926 (21.4%) - Labeled: 269
2025-11-06 15:27:45 - utils - INFO - Progress: 2,200,000/10,062,926 (21.9%) - Labeled: 269
2025-11-06 15:27:46 - utils - INFO - Progress: 2,250,000/10,062,926 (22.4%) - Labeled: 269
2025-11-06 15:27:46 - utils - INFO - Progress: 2,300,000/10,062,926 (22.9%) - Labeled: 269
2025-11-06 15:27:46 - utils - INFO - Progress: 2,350,000/10,062,926 (23.4%) - Labeled: 269
2025-11-06 15:27:47 - utils - INFO - Progress: 2,400,000/10,062,926 (23.8%) - Labeled: 269
2025-11-06 15:27:47 - utils - INFO - Progress: 2,450,000/10,062,926 (24.3%) - Labeled: 269
2025-11-06 15:27:47 - utils - INFO - Progress: 2,500,000/10,062,926 (24.8%) - Labeled: 269
2025-11-06 15:27:48 - utils - INFO - Progress: 2,550,000/10,062,926 (25.3%) - Labeled: 269
2025-11-06 15:27:48 - utils - INFO - Progress: 2,600,000/10,062,926 (25.8%) - Labeled: 269
2025-11-06 15:27:48 - utils - INFO - Progress: 2,650,000/10,062,926 (26.3%) - Labeled: 269
2025-11-06 15:27:49 - utils - INFO - Progress: 2,700,000/10,062,926 (26.8%) - Labeled: 269
2025-11-06 15:27:49 - utils - INFO - Progress: 2,750,000/10,062,926 (27.3%) - Labeled: 269
2025-11-06 15:27:49 - utils - INFO - Progress: 2,800,000/10,062,926 (27.8%) - Labeled: 269
2025-11-06 15:27:50 - utils - INFO - Progress: 2,850,000/10,062,926 (28.3%) - Labeled: 269
2025-11-06 15:27:50 - utils - INFO - Progress: 2,900,000/10,062,926 (28.8%) - Labeled: 269
2025-11-06 15:27:50 - utils - INFO - Progress: 2,950,000/10,062,926 (29.3%) - Labeled: 269
2025-11-06 15:27:50 - utils - INFO - Progress: 3,000,000/10,062,926 (29.8%) - Labeled: 269
2025-11-06 15:27:51 - utils - INFO - Progress: 3,050,000/10,062,926 (30.3%) - Labeled: 269
2025-11-06 15:27:51 - utils - INFO - Progress: 3,100,000/10,062,926 (30.8%) - Labeled: 269
2025-11-06 15:27:51 - utils - INFO - Progress: 3,150,000/10,062,926 (31.3%) - Labeled: 269
2025-11-06 15:27:52 - utils - INFO - Progress: 3,200,000/10,062,926 (31.8%) - Labeled: 269
2025-11-06 15:27:52 - utils - INFO - Progress: 3,250,000/10,062,926 (32.3%) - Labeled: 269
2025-11-06 15:27:52 - utils - INFO - Progress: 3,300,000/10,062,926 (32.8%) - Labeled: 269
2025-11-06 15:27:53 - utils - INFO - Progress: 3,350,000/10,062,926 (33.3%) - Labeled: 269
2025-11-06 15:27:53 - utils - INFO - Progress: 3,400,000/10,062,926 (33.8%) - Labeled: 269
2025-11-06 15:27:53 - utils - INFO - Progress: 3,450,000/10,062,926 (34.3%) - Labeled: 269
2025-11-06 15:27:54 - utils - INFO - Progress: 3,500,000/10,062,926 (34.8%) - Labeled: 269
2025-11-06 15:27:54 - utils - INFO - Progress: 3,550,000/10,062,926 (35.3%) - Labeled: 269
2025-11-06 15:27:54 - utils - INFO - Progress: 3,600,000/10,062,926 (35.8%) - Labeled: 269
2025-11-06 15:27:55 - utils - INFO - Progress: 3,650,000/10,062,926 (36.3%) - Labeled: 269
2025-11-06 15:27:55 - utils - INFO - Progress: 3,700,000/10,062,926 (36.8%) - Labeled: 269
2025-11-06 15:27:55 - utils - INFO - Progress: 3,750,000/10,062,926 (37.3%) - Labeled: 269
2025-11-06 15:27:56 - utils - INFO - Progress: 3,800,000/10,062,926 (37.8%) - Labeled: 269
2025-11-06 15:27:56 - utils - INFO - Progress: 3,850,000/10,062,926 (38.3%) - Labeled: 269
2025-11-06 15:27:56 - utils - INFO - Progress: 3,900,000/10,062,926 (38.8%) - Labeled: 269
2025-11-06 15:27:56 - utils - INFO - Progress: 3,950,000/10,062,926 (39.3%) - Labeled: 269
2025-11-06 15:27:57 - utils - INFO - Progress: 4,000,000/10,062,926 (39.7%) - Labeled: 269
2025-11-06 15:27:57 - utils - INFO - Progress: 4,050,000/10,062,926 (40.2%) - Labeled: 269
2025-11-06 15:27:57 - utils - INFO - Progress: 4,100,000/10,062,926 (40.7%) - Labeled: 269
2025-11-06 15:27:58 - utils - INFO - Progress: 4,150,000/10,062,926 (41.2%) - Labeled: 269
2025-11-06 15:27:58 - utils - INFO - Progress: 4,200,000/10,062,926 (41.7%) - Labeled: 269
2025-11-06 15:27:58 - utils - INFO - Progress: 4,250,000/10,062,926 (42.2%) - Labeled: 269
2025-11-06 15:27:59 - utils - INFO - Progress: 4,300,000/10,062,926 (42.7%) - Labeled: 269
2025-11-06 15:27:59 - utils - INFO - Progress: 4,350,000/10,062,926 (43.2%) - Labeled: 269
2025-11-06 15:27:59 - utils - INFO - Progress: 4,400,000/10,062,926 (43.7%) - Labeled: 269
2025-11-06 15:28:00 - utils - INFO - Progress: 4,450,000/10,062,926 (44.2%) - Labeled: 269
2025-11-06 15:28:00 - utils - INFO - Progress: 4,500,000/10,062,926 (44.7%) - Labeled: 269
2025-11-06 15:28:00 - utils - INFO - Progress: 4,550,000/10,062,926 (45.2%) - Labeled: 269
2025-11-06 15:28:01 - utils - INFO - Progress: 4,600,000/10,062,926 (45.7%) - Labeled: 269
2025-11-06 15:28:01 - utils - INFO - Progress: 4,650,000/10,062,926 (46.2%) - Labeled: 269
2025-11-06 15:28:01 - utils - INFO - Progress: 4,700,000/10,062,926 (46.7%) - Labeled: 269
2025-11-06 15:28:01 - utils - INFO - Progress: 4,750,000/10,062,926 (47.2%) - Labeled: 269
2025-11-06 15:28:02 - utils - INFO - Progress: 4,800,000/10,062,926 (47.7%) - Labeled: 269
2025-11-06 15:28:02 - utils - INFO - Progress: 4,850,000/10,062,926 (48.2%) - Labeled: 269
2025-11-06 15:28:02 - utils - INFO - Progress: 4,900,000/10,062,926 (48.7%) - Labeled: 269
2025-11-06 15:28:03 - utils - INFO - Progress: 4,950,000/10,062,926 (49.2%) - Labeled: 269
2025-11-06 15:28:03 - utils - INFO - Progress: 5,000,000/10,062,926 (49.7%) - Labeled: 269
2025-11-06 15:28:03 - utils - INFO - Progress: 5,050,000/10,062,926 (50.2%) - Labeled: 269
2025-11-06 15:28:04 - utils - INFO - Progress: 5,100,000/10,062,926 (50.7%) - Labeled: 269
2025-11-06 15:28:04 - utils - INFO - Progress: 5,150,000/10,062,926 (51.2%) - Labeled: 269
2025-11-06 15:28:04 - utils - INFO - Progress: 5,200,000/10,062,926 (51.7%) - Labeled: 269
2025-11-06 15:28:05 - utils - INFO - Progress: 5,250,000/10,062,926 (52.2%) - Labeled: 269
2025-11-06 15:28:05 - utils - INFO - Progress: 5,300,000/10,062,926 (52.7%) - Labeled: 269
2025-11-06 15:28:05 - utils - INFO - Progress: 5,350,000/10,062,926 (53.2%) - Labeled: 269
2025-11-06 15:28:06 - utils - INFO - Progress: 5,400,000/10,062,926 (53.7%) - Labeled: 269
2025-11-06 15:28:06 - utils - INFO - Progress: 5,450,000/10,062,926 (54.2%) - Labeled: 269
2025-11-06 15:28:06 - utils - INFO - Progress: 5,500,000/10,062,926 (54.7%) - Labeled: 269
2025-11-06 15:28:06 - utils - INFO - Progress: 5,550,000/10,062,926 (55.2%) - Labeled: 269
2025-11-06 15:28:07 - utils - INFO - Progress: 5,600,000/10,062,926 (55.6%) - Labeled: 269
2025-11-06 15:28:07 - utils - INFO - Progress: 5,650,000/10,062,926 (56.1%) - Labeled: 269
2025-11-06 15:28:07 - utils - INFO - Progress: 5,700,000/10,062,926 (56.6%) - Labeled: 269
2025-11-06 15:28:08 - utils - INFO - Progress: 5,750,000/10,062,926 (57.1%) - Labeled: 269
2025-11-06 15:28:08 - utils - INFO - Progress: 5,800,000/10,062,926 (57.6%) - Labeled: 269
2025-11-06 15:28:08 - utils - INFO - Progress: 5,850,000/10,062,926 (58.1%) - Labeled: 269
2025-11-06 15:28:09 - utils - INFO - Progress: 5,900,000/10,062,926 (58.6%) - Labeled: 269
2025-11-06 15:28:09 - utils - INFO - Progress: 5,950,000/10,062,926 (59.1%) - Labeled: 269
2025-11-06 15:28:09 - utils - INFO - Progress: 6,000,000/10,062,926 (59.6%) - Labeled: 269
2025-11-06 15:28:10 - utils - INFO - Progress: 6,050,000/10,062,926 (60.1%) - Labeled: 269
2025-11-06 15:28:10 - utils - INFO - Progress: 6,100,000/10,062,926 (60.6%) - Labeled: 269
2025-11-06 15:28:10 - utils - INFO - Progress: 6,150,000/10,062,926 (61.1%) - Labeled: 269
2025-11-06 15:28:11 - utils - INFO - Progress: 6,200,000/10,062,926 (61.6%) - Labeled: 269
2025-11-06 15:28:11 - utils - INFO - Progress: 6,250,000/10,062,926 (62.1%) - Labeled: 269
2025-11-06 15:28:11 - utils - INFO - Progress: 6,300,000/10,062,926 (62.6%) - Labeled: 269
2025-11-06 15:28:11 - utils - INFO - Progress: 6,350,000/10,062,926 (63.1%) - Labeled: 269
2025-11-06 15:28:12 - utils - INFO - Progress: 6,400,000/10,062,926 (63.6%) - Labeled: 269
2025-11-06 15:28:12 - utils - INFO - Progress: 6,450,000/10,062,926 (64.1%) - Labeled: 269
2025-11-06 15:28:12 - utils - INFO - Progress: 6,500,000/10,062,926 (64.6%) - Labeled: 269
2025-11-06 15:28:13 - utils - INFO - Progress: 6,550,000/10,062,926 (65.1%) - Labeled: 269
2025-11-06 15:28:13 - utils - INFO - Progress: 6,600,000/10,062,926 (65.6%) - Labeled: 269
2025-11-06 15:28:13 - utils - INFO - Progress: 6,650,000/10,062,926 (66.1%) - Labeled: 269
2025-11-06 15:28:14 - utils - INFO - Progress: 6,700,000/10,062,926 (66.6%) - Labeled: 269
2025-11-06 15:28:14 - utils - INFO - Progress: 6,750,000/10,062,926 (67.1%) - Labeled: 269
2025-11-06 15:28:14 - utils - INFO - Progress: 6,800,000/10,062,926 (67.6%) - Labeled: 269
2025-11-06 15:28:15 - utils - INFO - Progress: 6,850,000/10,062,926 (68.1%) - Labeled: 269
2025-11-06 15:28:15 - utils - INFO - Progress: 6,900,000/10,062,926 (68.6%) - Labeled: 269
2025-11-06 15:28:15 - utils - INFO - Progress: 6,950,000/10,062,926 (69.1%) - Labeled: 269
2025-11-06 15:28:16 - utils - INFO - Progress: 7,000,000/10,062,926 (69.6%) - Labeled: 269
2025-11-06 15:28:16 - utils - INFO - Progress: 7,050,000/10,062,926 (70.1%) - Labeled: 269
2025-11-06 15:28:16 - utils - INFO - Progress: 7,100,000/10,062,926 (70.6%) - Labeled: 269
2025-11-06 15:28:16 - utils - INFO - Progress: 7,150,000/10,062,926 (71.1%) - Labeled: 269
2025-11-06 15:28:17 - utils - INFO - Progress: 7,200,000/10,062,926 (71.5%) - Labeled: 269
2025-11-06 15:28:17 - utils - INFO - Progress: 7,250,000/10,062,926 (72.0%) - Labeled: 269
2025-11-06 15:28:17 - utils - INFO - Progress: 7,300,000/10,062,926 (72.5%) - Labeled: 269
2025-11-06 15:28:18 - utils - INFO - Progress: 7,350,000/10,062,926 (73.0%) - Labeled: 269
2025-11-06 15:28:18 - utils - INFO - Progress: 7,400,000/10,062,926 (73.5%) - Labeled: 269
2025-11-06 15:28:18 - utils - INFO - Progress: 7,450,000/10,062,926 (74.0%) - Labeled: 269
2025-11-06 15:28:19 - utils - INFO - Progress: 7,500,000/10,062,926 (74.5%) - Labeled: 269
2025-11-06 15:28:19 - utils - INFO - Progress: 7,550,000/10,062,926 (75.0%) - Labeled: 269
2025-11-06 15:28:19 - utils - INFO - Progress: 7,600,000/10,062,926 (75.5%) - Labeled: 269
2025-11-06 15:28:20 - utils - INFO - Progress: 7,650,000/10,062,926 (76.0%) - Labeled: 269
2025-11-06 15:28:20 - utils - INFO - Progress: 7,700,000/10,062,926 (76.5%) - Labeled: 269
2025-11-06 15:28:20 - utils - INFO - Progress: 7,750,000/10,062,926 (77.0%) - Labeled: 269
2025-11-06 15:28:21 - utils - INFO - Progress: 7,800,000/10,062,926 (77.5%) - Labeled: 269
2025-11-06 15:28:21 - utils - INFO - Progress: 7,850,000/10,062,926 (78.0%) - Labeled: 269
2025-11-06 15:28:21 - utils - INFO - Progress: 7,900,000/10,062,926 (78.5%) - Labeled: 269
2025-11-06 15:28:22 - utils - INFO - Progress: 7,950,000/10,062,926 (79.0%) - Labeled: 269
2025-11-06 15:28:22 - utils - INFO - Progress: 8,000,000/10,062,926 (79.5%) - Labeled: 269
2025-11-06 15:28:22 - utils - INFO - Progress: 8,050,000/10,062,926 (80.0%) - Labeled: 269
2025-11-06 15:28:23 - utils - INFO - Progress: 8,100,000/10,062,926 (80.5%) - Labeled: 269
2025-11-06 15:28:23 - utils - INFO - Progress: 8,150,000/10,062,926 (81.0%) - Labeled: 269
2025-11-06 15:28:23 - utils - INFO - Progress: 8,200,000/10,062,926 (81.5%) - Labeled: 269
2025-11-06 15:28:23 - utils - INFO - Progress: 8,250,000/10,062,926 (82.0%) - Labeled: 269
2025-11-06 15:28:24 - utils - INFO - Progress: 8,300,000/10,062,926 (82.5%) - Labeled: 269
2025-11-06 15:28:24 - utils - INFO - Progress: 8,350,000/10,062,926 (83.0%) - Labeled: 269
2025-11-06 15:28:24 - utils - INFO - Progress: 8,400,000/10,062,926 (83.5%) - Labeled: 269
2025-11-06 15:28:25 - utils - INFO - Progress: 8,450,000/10,062,926 (84.0%) - Labeled: 269
2025-11-06 15:28:25 - utils - INFO - Progress: 8,500,000/10,062,926 (84.5%) - Labeled: 269
2025-11-06 15:28:25 - utils - INFO - Progress: 8,550,000/10,062,926 (85.0%) - Labeled: 269
2025-11-06 15:28:26 - utils - INFO - Progress: 8,600,000/10,062,926 (85.5%) - Labeled: 269
2025-11-06 15:28:26 - utils - INFO - Progress: 8,650,000/10,062,926 (86.0%) - Labeled: 269
2025-11-06 15:28:26 - utils - INFO - Progress: 8,700,000/10,062,926 (86.5%) - Labeled: 269
2025-11-06 15:28:27 - utils - INFO - Progress: 8,750,000/10,062,926 (87.0%) - Labeled: 269
2025-11-06 15:28:27 - utils - INFO - Progress: 8,800,000/10,062,926 (87.4%) - Labeled: 269
2025-11-06 15:28:27 - utils - INFO - Progress: 8,850,000/10,062,926 (87.9%) - Labeled: 269
2025-11-06 15:28:28 - utils - INFO - Progress: 8,900,000/10,062,926 (88.4%) - Labeled: 269
2025-11-06 15:28:28 - utils - INFO - Progress: 8,950,000/10,062,926 (88.9%) - Labeled: 269
2025-11-06 15:28:28 - utils - INFO - Progress: 9,000,000/10,062,926 (89.4%) - Labeled: 269
2025-11-06 15:28:28 - utils - INFO - Progress: 9,050,000/10,062,926 (89.9%) - Labeled: 269
2025-11-06 15:28:29 - utils - INFO - Progress: 9,100,000/10,062,926 (90.4%) - Labeled: 269
2025-11-06 15:28:29 - utils - INFO - Progress: 9,150,000/10,062,926 (90.9%) - Labeled: 269
2025-11-06 15:28:29 - utils - INFO - Progress: 9,200,000/10,062,926 (91.4%) - Labeled: 269
2025-11-06 15:28:30 - utils - INFO - Progress: 9,250,000/10,062,926 (91.9%) - Labeled: 269
2025-11-06 15:28:30 - utils - INFO - Progress: 9,300,000/10,062,926 (92.4%) - Labeled: 269
2025-11-06 15:28:30 - utils - INFO - Progress: 9,350,000/10,062,926 (92.9%) - Labeled: 269
2025-11-06 15:28:31 - utils - INFO - Progress: 9,400,000/10,062,926 (93.4%) - Labeled: 269
2025-11-06 15:28:31 - utils - INFO - Progress: 9,450,000/10,062,926 (93.9%) - Labeled: 269
2025-11-06 15:28:31 - utils - INFO - Progress: 9,500,000/10,062,926 (94.4%) - Labeled: 269
2025-11-06 15:28:32 - utils - INFO - Progress: 9,550,000/10,062,926 (94.9%) - Labeled: 269
2025-11-06 15:28:32 - utils - INFO - Progress: 9,600,000/10,062,926 (95.4%) - Labeled: 269
2025-11-06 15:28:32 - utils - INFO - Progress: 9,650,000/10,062,926 (95.9%) - Labeled: 269
2025-11-06 15:28:33 - utils - INFO - Progress: 9,700,000/10,062,926 (96.4%) - Labeled: 269
2025-11-06 15:28:33 - utils - INFO - Progress: 9,750,000/10,062,926 (96.9%) - Labeled: 269
2025-11-06 15:28:33 - utils - INFO - Progress: 9,800,000/10,062,926 (97.4%) - Labeled: 269
2025-11-06 15:28:34 - utils - INFO - Progress: 9,850,000/10,062,926 (97.9%) - Labeled: 269
2025-11-06 15:28:34 - utils - INFO - Progress: 9,900,000/10,062,926 (98.4%) - Labeled: 269
2025-11-06 15:28:34 - utils - INFO - Progress: 9,950,000/10,062,926 (98.9%) - Labeled: 269
2025-11-06 15:28:35 - utils - INFO - Progress: 10,000,000/10,062,926 (99.4%) - Labeled: 269
2025-11-06 15:28:35 - utils - INFO - Progress: 10,050,000/10,062,926 (99.9%) - Labeled: 269
2025-11-06 15:28:35 - utils - INFO - Progress: 10,062,926/10,062,926 (100.0%) - Labeled: 269
2025-11-06 15:28:35 - utils - INFO - 
Labeling complete!
2025-11-06 15:28:35 - utils - INFO -   Total rows:     10,062,926
2025-11-06 15:28:35 - utils - INFO -   Insider rows:   269 (0.0027%)
2025-11-06 15:28:35 - utils - INFO -   Normal rows:    10,062,657 (100.00%)
2025-11-06 15:28:35 - utils - INFO - 
Verifying labels (sampling 10,000 rows)...
2025-11-06 15:28:44 - utils - INFO - Sample statistics:
2025-11-06 15:28:44 - utils - INFO -   Normal (0):   9,999
2025-11-06 15:28:44 - utils - INFO -   Insider (1):  1
2025-11-06 15:28:44 - utils - INFO -   Unique insiders in sample: 1
2025-11-06 15:28:45 - utils - INFO - 
Replacing original file with labeled version...
2025-11-06 15:28:52 - utils - INFO - Utility functions loaded successfully
2025-11-06 15:28:52 - utils - INFO - Loading detailed observable files...
2025-11-06 15:28:52 - utils - INFO - Loaded master file: 191 insider incidents
2025-11-06 15:28:52 - utils - INFO -   Loaded r2.csv: 26 events for ONS0995
2025-11-06 15:28:52 - utils - WARNING -   Could not find r3.1-1.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r3.1-2.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r3.2-1.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r3.2-2.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.1-1.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.1-2.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.1-3.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.2-1-AAM0658.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.2-1-AJR0932.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.2-1-BDV0168.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.2-1-BIH0745.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.2-1-BLS0678.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.2-1-BTL0226.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.2-1-CAH0936.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.2-1-DCH0843.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.2-1-EHB0824.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.2-1-EHD0584.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.2-1-FMG0527.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.2-1-FTM0406.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.2-1-GHL0460.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.2-1-HJB0742.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.2-1-JMB0308.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.2-1-JRG0207.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.2-1-KLH0596.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.2-1-KPC0073.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.2-1-LJR0523.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.2-1-LQC0479.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.2-1-MAR0955.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.2-1-MAS0025.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.2-1-MCF0600.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.2-1-MYD0978.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.2-1-PPF0435.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.2-1-RAB0589.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.2-1-RGG0064.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.2-1-RKD0604.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.2-1-TAP0551.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.2-1-WDD0366.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.2-2-AAF0535.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.2-2-ABC0174.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.2-2-AKR0057.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.2-2-CCL0068.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.2-2-CEJ0109.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.2-2-CQW0652.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.2-2-DIB0285.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.2-2-DRR0162.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.2-2-EDB0714.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.2-2-EGD0132.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.2-2-FSC0601.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.2-2-HBO0413.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.2-2-HXL0968.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.2-2-IJM0776.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.2-2-IKR0401.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.2-2-IUB0565.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.2-2-JJM0203.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.2-2-KRL0501.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.2-2-LCC0819.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.2-2-MDH0580.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.2-2-MOS0047.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.2-2-NWT0098.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.2-2-PNL0301.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.2-2-PSF0133.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.2-2-RAR0725.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.2-2-RHL0992.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.2-2-RMW0542.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.2-2-TNM0961.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.2-2-VSS0154.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.2-2-XHW0498.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.2-3-BBS0039.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.2-3-BSS0369.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.2-3-CCA0046.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.2-3-CSC0217.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.2-3-GTD0219.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.2-3-JGT0221.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.2-3-JLM0364.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.2-3-JTM0223.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.2-3-MPM0220.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r4.2-3-MSO0222.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.1-1.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.1-2.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.1-3.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.1-4.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-1-ALT1465.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-1-ALW0764.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-1-AYG1697.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-1-DAS1320.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-1-DNJ0740.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-1-ELT1370.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-1-EPG1196.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-1-ETW0002.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-1-FZG0389.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-1-GFM1815.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-1-IHC0561.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-1-ISW0738.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-1-JKB0287.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-1-JUP1472.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-1-KBC1390.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-1-KEW0198.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-1-MIB0203.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-1-NIV1608.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-1-PBC0077.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-1-PTH0005.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-1-REF1924.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-1-SAF1942.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-1-SLL0193.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-1-TMC0934.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-1-VAH1292.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-1-WHB1247.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-1-WSK1857.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-1-WWW0701.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-1-ZKP0542.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-2-VCF1602.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-2-KSS1005.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-2-MCP0611.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-2-TNB1616.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-2-ZIE0741.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-2-HXP0976.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-2-HIS1394.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-2-JAL0811.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-2-ITA0159.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-2-CIF1430.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-2-RRS0056.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-2-MDS0680.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-2-TMT0851.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-2-OSS1463.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-2-HSN0675.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-2-WDT1634.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-2-OKM1092.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-2-CKP0630.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-2-ICB1354.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-2-TRC1838.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-2-NAH1366.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-2-BYO1846.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-2-GWG0497.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-2-MGB1235.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-2-CHP1711.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-2-SNK1280.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-2-LVF1626.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-2-HMS1658.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-2-DCC1119.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-2-SIS0042.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-3-ACA1126.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-3-CRD0272.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-3-CWW1120.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-3-ELM1123.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-3-GKW0043.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-3-KCM0466.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-3-LAH0463.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-3-MPF0690.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-3-VRP0267.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-3-ZEH0685.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-4-ACM1770.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-4-AMC1883.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-4-ASH0298.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-4-ASH0458.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-4-BDP0096.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-4-CBW1826.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-4-CGF1056.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-4-CPD1525.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-4-DIM0330.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-4-DKG0161.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-4-DQM0809.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-4-GCD0194.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-4-GMB0400.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-4-HBP1076.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-4-IRH1224.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-4-JCC0016.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-4-JIG1593.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-4-JMM0613.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-4-JNR1592.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-4-KDC0996.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-4-MJR0711.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-4-MTP1582.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-4-NKM1738.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-4-NKN1405.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-4-NZL1395.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-4-OFS0030.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-4-OHS0036.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-4-RCG0584.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-4-WCW1013.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r5.2-4-WOS1834.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r6.1-1.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r6.1-2.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r6.1-3.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r6.1-4.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r6.1-5.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r6.2-1.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r6.2-2.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r6.2-3.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r6.2-4.csv
2025-11-06 15:28:52 - utils - WARNING -   Could not find r6.2-5.csv
2025-11-06 15:28:52 - utils - INFO - Loaded 1 observable files
2025-11-06 15:28:52 - utils - INFO - 
================================================================================
                           VALIDATING INSIDER LABELS                            
================================================================================

2025-11-06 15:28:52 - utils - INFO - Loaded master file: 191 insider incidents
2025-11-06 15:28:52 - utils - INFO - 
Validating 191 unique insider users...
2025-11-06 15:28:52 - utils - INFO - Checking for user ONS0995 (sampling 50,000 rows)...
2025-11-06 15:28:53 - utils - INFO -   Found 5 records for ONS0995 (chunk 1)
2025-11-06 15:28:53 - utils - INFO -   5 labeled as insider
2025-11-06 15:28:53 - utils - INFO - Checking for user CSF0929 (sampling 50,000 rows)...
2025-11-06 15:29:08 - utils - WARNING -   User CSF0929 NOT FOUND in processed data!
2025-11-06 15:29:08 - utils - INFO - Checking for user CCH0959 (sampling 50,000 rows)...
2025-11-06 15:29:23 - utils - WARNING -   User CCH0959 NOT FOUND in processed data!
2025-11-06 15:29:23 - utils - INFO - Checking for user RCW0822 (sampling 50,000 rows)...
2025-11-06 15:29:40 - utils - WARNING -   User RCW0822 NOT FOUND in processed data!
2025-11-06 15:29:40 - utils - INFO - Checking for user JCE0258 (sampling 50,000 rows)...
2025-11-06 15:29:56 - utils - WARNING -   User JCE0258 NOT FOUND in processed data!
2025-11-06 15:29:56 - utils - INFO - Checking for user ABB0427 (sampling 50,000 rows)...
2025-11-06 15:30:11 - utils - WARNING -   User ABB0427 NOT FOUND in processed data!
2025-11-06 15:30:11 - utils - INFO - Checking for user HFC0492 (sampling 50,000 rows)...
2025-11-06 15:30:26 - utils - WARNING -   User HFC0492 NOT FOUND in processed data!
2025-11-06 15:30:26 - utils - INFO - Checking for user KTW0365 (sampling 50,000 rows)...
2025-11-06 15:30:42 - utils - WARNING -   User KTW0365 NOT FOUND in processed data!
2025-11-06 15:30:42 - utils - INFO - Checking for user AAM0658 (sampling 50,000 rows)...
2025-11-06 15:30:57 - utils - WARNING -   User AAM0658 NOT FOUND in processed data!
2025-11-06 15:30:57 - utils - INFO - Checking for user AJR0932 (sampling 50,000 rows)...
2025-11-06 15:31:12 - utils - WARNING -   User AJR0932 NOT FOUND in processed data!
2025-11-06 15:31:12 - utils - INFO - 
Comparing observables for ONS0995 with processed data...
2025-11-06 15:31:12 - utils - INFO - Ground truth: 26 malicious events
2025-11-06 15:32:15 - utils - INFO - Utility functions loaded successfully
2025-11-06 15:32:30 - utils - INFO - Loaded dataframe from /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv
2025-11-06 15:32:30 - utils - INFO - 
================================================================================
                          FEATURE ENGINEERING PIPELINE                          
================================================================================

2025-11-06 15:32:30 - utils - INFO - Creating temporal features...
2025-11-06 15:32:32 - utils - INFO - Temporal features created
2025-11-06 15:32:32 - utils - INFO - Creating user aggregated features with window: 1D
2025-11-06 15:32:47 - utils - INFO - Created 8 aggregated features
2025-11-06 15:32:48 - utils - INFO - Creating behavioral ratio features...
2025-11-06 15:32:48 - utils - INFO - Behavioral ratio features created
2025-11-06 15:32:48 - utils - INFO - Creating statistical features per user...
2025-11-06 15:32:48 - utils - INFO - Created 50 statistical features
2025-11-06 15:32:48 - utils - INFO - Scaling features (fit=True)...
2025-11-06 15:32:48 - utils - INFO - Scaled 60 features
2025-11-06 15:32:48 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/feature_scaler.pkl
2025-11-06 15:32:48 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/label_encoders.pkl
2025-11-06 15:32:48 - utils - INFO - Feature engineering artifacts saved
2025-11-06 15:32:48 - utils - INFO - Feature engineering completed: 331144 samples, 60 features
2025-11-06 15:32:57 - utils - INFO - Saved dataframe to /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_features.csv
2025-11-06 15:32:57 - utils - INFO - Creating sequences with length=15, stride=10
2025-11-06 15:40:45 - utils - INFO - Created 1005335 sequences from 1000 users
2025-11-06 15:40:46 - utils - INFO - Sequences saved for LSTM training
2025-11-06 15:43:42 - utils - INFO - Utility functions loaded successfully
2025-11-06 15:43:42 - utils - INFO - 
================================================================================
                           ISOLATION FOREST TRAINING                            
================================================================================

2025-11-06 15:43:43 - utils - INFO - Loaded dataframe from /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_features.csv
2025-11-06 15:43:43 - utils - INFO - Initialized Isolation Forest with params: {'n_estimators': 50, 'max_samples': 256, 'contamination': 0.01, 'max_features': 1.0, 'bootstrap': False, 'n_jobs': -1, 'random_state': 42, 'verbose': 0}
2025-11-06 15:43:44 - utils - INFO - Data split: Train=231800, Val=49672, Test=49672
2025-11-06 15:43:44 - utils - INFO - Training Isolation Forest...
2025-11-06 15:43:44 - utils - INFO - Isolation Forest training completed
2025-11-06 15:43:44 - utils - INFO - Calibrating threshold for target FPR=0.05
2025-11-06 15:43:44 - utils - INFO - Calibrated threshold: 0.5855
2025-11-06 15:43:44 - utils - INFO - Evaluating Isolation Forest...
2025-11-06 15:43:44 - utils - INFO - 
============================================================
2025-11-06 15:43:44 - utils - INFO - Isolation Forest Performance Metrics
2025-11-06 15:43:44 - utils - INFO - ============================================================
2025-11-06 15:43:44 - utils - INFO - Accuracy:  0.9901
2025-11-06 15:43:44 - utils - INFO - Precision: 0.0000
2025-11-06 15:43:44 - utils - INFO - Recall:    0.0000
2025-11-06 15:43:44 - utils - INFO - F1-Score:  0.0000
2025-11-06 15:43:44 - utils - INFO - AUC-ROC:   0.9129
2025-11-06 15:43:44 - utils - INFO - ============================================================

2025-11-06 15:43:44 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest.pkl
2025-11-06 15:43:44 - utils - INFO - Isolation Forest model saved to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest.pkl
2025-11-06 15:43:44 - utils - INFO - Isolation Forest training and evaluation completed!
2025-11-06 15:43:52 - utils - INFO - Utility functions loaded successfully
2025-11-06 15:43:52 - utils - INFO - 
================================================================================
                      LIGHTWEIGHT DEEP CLUSTERING TRAINING                      
================================================================================

2025-11-06 15:43:53 - utils - INFO - Loaded dataframe from /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_features.csv
2025-11-06 15:43:53 - utils - INFO - Dataset: 331144 samples, 60 features
2025-11-06 15:43:53 - utils - INFO - Data split: Train=231800, Val=49672, Test=49672
2025-11-06 15:43:53 - utils - INFO - Initialized Lightweight Deep Clustering (n_clusters=5, encoding_dim=30)
2025-11-06 15:43:53 - utils - INFO - Training lightweight deep clustering model...
2025-11-06 15:43:53 - utils - INFO - Fitting MiniBatch K-Means clustering...
2025-11-06 15:43:54 - utils - INFO - Lightweight deep clustering training completed
2025-11-06 15:43:54 - utils - INFO - Training completed in 0.20 seconds
2025-11-06 15:43:54 - utils - INFO - Calibrating threshold for target FPR=0.05
2025-11-06 15:43:54 - utils - INFO - Calibrated threshold: 0.7906
2025-11-06 15:43:54 - utils - INFO - Evaluating lightweight deep clustering model...
2025-11-06 15:43:54 - utils - INFO - 
============================================================
2025-11-06 15:43:54 - utils - INFO - Deep Clustering (Lightweight) Performance Metrics
2025-11-06 15:43:54 - utils - INFO - ============================================================
2025-11-06 15:43:54 - utils - INFO - Accuracy:  0.9459
2025-11-06 15:43:54 - utils - INFO - Precision: 0.0000
2025-11-06 15:43:54 - utils - INFO - Recall:    0.0000
2025-11-06 15:43:54 - utils - INFO - F1-Score:  0.0000
2025-11-06 15:43:54 - utils - INFO - AUC-ROC:   0.5560
2025-11-06 15:43:54 - utils - INFO - ============================================================

2025-11-06 15:43:54 - utils - INFO - Lightweight deep clustering model saved to /Users/bipinrimal/Downloads/Thesis_work/models/deep_clustering.pkl
2025-11-06 15:43:54 - utils - INFO - Lightweight deep clustering training and evaluation completed!
2025-11-06 15:43:54 - utils - INFO - Total time: 0.20 seconds
2025-11-06 15:44:02 - utils - INFO - Utility functions loaded successfully
2025-11-06 15:44:05 - utils - INFO - 
================================================================================
                     LIGHTWEIGHT LSTM AUTOENCODER TRAINING                      
================================================================================

2025-11-06 15:44:05 - utils - INFO - Loaded sequences: (1005335, 15, 27)
2025-11-06 15:44:06 - utils - INFO - Data split: Train=703734, Val=150800, Test=150801
2025-11-06 15:44:06 - utils - INFO - Training on 703716 normal sequences
2025-11-06 15:44:06 - utils - INFO - Initialized Lightweight LSTM Autoencoder (15, 27)
2025-11-06 15:44:06 - utils - INFO - Training lightweight LSTM Autoencoder...
2025-11-06 15:44:06 - utils - INFO - Building lightweight LSTM Autoencoder...
2025-11-06 15:44:06 - utils - INFO - Model built with 20,363 parameters
2025-11-06 15:44:06 - utils - INFO - Training on 703716 sequences...
2025-11-06 15:57:10 - utils - INFO - Training completed
2025-11-06 15:57:10 - utils - INFO - Training completed in 784.03 seconds
2025-11-06 15:57:10 - utils - INFO - Calibrating threshold for target FPR=0.05
2025-11-06 15:57:13 - utils - INFO - Calibrated threshold: 0.6197
2025-11-06 15:57:13 - utils - INFO - Evaluating lightweight LSTM Autoencoder...
2025-11-06 15:57:45 - utils - INFO - 
============================================================
2025-11-06 15:57:45 - utils - INFO - LSTM Autoencoder (Lightweight) Performance Metrics
2025-11-06 15:57:45 - utils - INFO - ============================================================
2025-11-06 15:57:45 - utils - INFO - Accuracy:  0.9638
2025-11-06 15:57:45 - utils - INFO - Precision: 0.0000
2025-11-06 15:57:45 - utils - INFO - Recall:    0.0000
2025-11-06 15:57:45 - utils - INFO - F1-Score:  0.0000
2025-11-06 15:57:45 - utils - INFO - AUC-ROC:   0.3885
2025-11-06 15:57:45 - utils - INFO - ============================================================

2025-11-06 16:08:36 - utils - INFO - Utility functions loaded successfully
2025-11-06 16:08:38 - utils - INFO - 
================================================================================
                     LIGHTWEIGHT LSTM AUTOENCODER TRAINING                      
================================================================================

2025-11-06 16:08:38 - utils - INFO - Loaded sequences: (1005335, 15, 27)
2025-11-06 16:08:39 - utils - INFO - Data split: Train=703734, Val=150800, Test=150801
2025-11-06 16:08:39 - utils - INFO - Insider labels split: Train=18, Val=4, Test=4
2025-11-06 16:08:40 - utils - INFO - Training on 703716 normal sequences
2025-11-06 16:08:40 - utils - INFO - Initialized Lightweight LSTM Autoencoder (15, 27)
2025-11-06 16:08:40 - utils - INFO - Training lightweight LSTM Autoencoder...
2025-11-06 16:08:40 - utils - INFO - Building lightweight LSTM Autoencoder...
2025-11-06 16:08:40 - utils - INFO - Model built with 20,363 parameters
2025-11-06 16:08:40 - utils - INFO - Training on 703716 sequences...
2025-11-06 16:21:58 - utils - INFO - Training completed
2025-11-06 16:21:58 - utils - INFO - Training completed in 798.28 seconds
2025-11-06 16:21:58 - utils - INFO - Calibrating threshold for target FPR=0.05
2025-11-06 16:22:01 - utils - INFO - Calibrated threshold: 0.6197
2025-11-06 16:22:01 - utils - INFO - Evaluating lightweight LSTM Autoencoder...
2025-11-06 16:22:05 - utils - INFO - 
============================================================
2025-11-06 16:22:05 - utils - INFO - LSTM Autoencoder (Lightweight) Performance Metrics
2025-11-06 16:22:05 - utils - INFO - ============================================================
2025-11-06 16:22:05 - utils - INFO - Accuracy:  0.9638
2025-11-06 16:22:05 - utils - INFO - Precision: 0.0000
2025-11-06 16:22:05 - utils - INFO - Recall:    0.0000
2025-11-06 16:22:05 - utils - INFO - F1-Score:  0.0000
2025-11-06 16:22:05 - utils - INFO - AUC-ROC:   0.3885
2025-11-06 16:22:05 - utils - INFO - ============================================================

2025-11-06 16:22:05 - utils - WARNING - Filepath updated to /Users/bipinrimal/Downloads/Thesis_work/models/lstm_autoencoder.keras for Keras model
2025-11-06 16:22:05 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/lstm_autoencoder.keras
2025-11-06 16:22:07 - utils - INFO - Lightweight LSTM Autoencoder completed!
2025-11-06 16:22:07 - utils - INFO - Total time: 798.28 seconds
2025-11-06 16:22:24 - utils - INFO - Utility functions loaded successfully
2025-11-06 16:22:27 - utils - INFO - ================================================================================
2025-11-06 16:22:27 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-11-06 16:22:27 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-11-06 16:22:27 - utils - INFO - ================================================================================
2025-11-06 16:22:27 - utils - INFO - 
================================================================================
                           STAGE 4: MODEL EVALUATION                            
================================================================================

2025-11-06 16:22:27 - utils - INFO - 
================================================================================
                         COMPREHENSIVE MODEL EVALUATION                         
================================================================================

2025-11-06 16:22:27 - utils - INFO - Loading results for all models...
2025-11-06 16:22:27 - utils - INFO - Loaded results for isolation_forest
2025-11-06 16:22:27 - utils - INFO - Loaded results for lstm_autoencoder
2025-11-06 16:22:27 - utils - INFO - Loaded results for deep_clustering
2025-11-06 16:22:27 - utils - INFO - Loaded results for 3 models
2025-11-06 16:22:27 - utils - INFO - Creating metrics comparison table...
2025-11-06 16:22:27 - utils - INFO - Metrics comparison table created
2025-11-06 16:22:27 - utils - INFO - Creating confusion matrix plots...
2025-11-06 16:22:28 - utils - INFO - Confusion matrices saved to /Users/bipinrimal/Downloads/Thesis_work/results/confusion_matrices/all_models.png
2025-11-06 16:22:28 - utils - INFO - Creating ROC curves...
2025-11-06 16:22:28 - utils - INFO - ROC curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/roc_curves/roc_comparison.png
2025-11-06 16:22:28 - utils - INFO - Creating Precision-Recall curves...
2025-11-06 16:22:28 - utils - INFO - Precision-Recall curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/precision_recall_comparison.png
2025-11-06 16:22:28 - utils - INFO - Creating metrics comparison bar chart...
2025-11-06 16:22:28 - utils - INFO - Metrics comparison bar chart saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/metrics_comparison_bar.png
2025-11-06 16:22:28 - utils - INFO - Creating anomaly score distribution plots...
2025-11-06 16:22:28 - utils - INFO - Score distributions saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/score_distributions.png
2025-11-06 16:22:28 - utils - INFO - Generating evaluation report...
2025-11-06 16:22:28 - utils - INFO - Evaluation report saved to /Users/bipinrimal/Downloads/Thesis_work/results/evaluation_report.txt
2025-11-06 16:22:28 - utils - INFO - Comprehensive evaluation completed!
2025-11-06 16:22:28 - utils - INFO - ✓ Stage 4 completed: Comprehensive evaluation report generated
2025-11-06 16:24:50 - utils - INFO - Utility functions loaded successfully
2025-11-06 16:24:53 - utils - INFO - ================================================================================
2025-11-06 16:24:53 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-11-06 16:24:53 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-11-06 16:24:53 - utils - INFO - ================================================================================
2025-11-06 16:24:53 - utils - INFO - No arguments provided. Running full pipeline...
2025-11-06 16:24:53 - utils - INFO - 
================================================================================
2025-11-06 16:24:53 - utils - INFO - STARTING FULL PIPELINE EXECUTION
2025-11-06 16:24:53 - utils - INFO - ================================================================================

2025-11-06 16:24:53 - utils - INFO - 
================================================================================
                          STAGE 1: DATA PREPROCESSING                           
================================================================================

2025-11-06 16:24:53 - utils - INFO - 
================================================================================
                          DATA PREPROCESSING PIPELINE                           
================================================================================

2025-11-06 16:24:53 - utils - INFO - Starting data loading process...
2025-11-06 16:24:53 - utils - INFO - Loading CMU-CERT dataset...
2025-11-06 16:24:53 - utils - INFO - Loaded logon: 840141 records
2025-11-06 16:24:54 - utils - INFO - Loaded device: 712308 records
2025-11-06 16:24:54 - utils - INFO - Loaded email: 1189372 records
2025-11-06 16:24:57 - utils - INFO - Loaded http: 7321105 records
2025-11-06 16:24:57 - utils - INFO - Loaded psychometric: 1000 records
2025-11-06 16:24:57 - utils - INFO - Merging all log sources...
2025-11-06 16:24:57 - utils - INFO - Preprocessing logon data...
2025-11-06 16:24:58 - utils - INFO - Parsed datetime column: date
2025-11-06 16:24:58 - utils - INFO - Cleaning dataframe with 840141 rows
2025-11-06 16:24:58 - utils - INFO - Removed 0 duplicate rows
2025-11-06 16:24:59 - utils - INFO - Pseudonymized column: user
2025-11-06 16:24:59 - utils - INFO - Pseudonymized column: pc
2025-11-06 16:24:59 - utils - INFO - Logon data processed: 840141 records
2025-11-06 16:24:59 - utils - INFO - Preprocessing device data...
2025-11-06 16:25:00 - utils - INFO - Parsed datetime column: date
2025-11-06 16:25:00 - utils - INFO - Cleaning dataframe with 712308 rows
2025-11-06 16:25:00 - utils - INFO - Removed 0 duplicate rows
2025-11-06 16:25:00 - utils - INFO - Pseudonymized column: user
2025-11-06 16:25:01 - utils - INFO - Pseudonymized column: pc
2025-11-06 16:25:01 - utils - INFO - Device data processed: 712308 records
2025-11-06 16:25:01 - utils - WARNING - file.csv not found, skipping file data.
2025-11-06 16:25:01 - utils - INFO - Preprocessing email data...
2025-11-06 16:25:02 - utils - INFO - Parsed datetime column: date
2025-11-06 16:25:02 - utils - INFO - Cleaning dataframe with 1189372 rows
2025-11-06 16:25:02 - utils - INFO - Removed 0 duplicate rows
2025-11-06 16:25:03 - utils - INFO - Pseudonymized column: from
2025-11-06 16:25:04 - utils - INFO - Email data processed: 1189372 records
2025-11-06 16:25:04 - utils - INFO - Preprocessing HTTP data...
2025-11-06 16:25:11 - utils - INFO - Parsed datetime column: date
2025-11-06 16:25:11 - utils - INFO - Cleaning dataframe with 7321105 rows
2025-11-06 16:25:14 - utils - INFO - Removed 0 duplicate rows
2025-11-06 16:25:18 - utils - INFO - Pseudonymized column: user
2025-11-06 16:25:21 - utils - INFO - Pseudonymized column: pc
2025-11-06 16:25:27 - utils - INFO - HTTP data processed: 7321105 records
2025-11-06 16:25:30 - utils - INFO - All event logs merged: 10062926 total records
2025-11-06 16:25:30 - utils - INFO - Loading LDAP data...
2025-11-06 16:25:30 - utils - INFO - Reading latest LDAP file: 2011-05.csv
2025-11-06 16:25:30 - utils - ERROR - Failed to read LDAP file /Users/bipinrimal/Downloads/Thesis_work/data/raw/LDAP/2011-05.csv: "['domain'] not in index"
2025-11-06 16:25:30 - utils - INFO - Preprocessing psychometric data...
2025-11-06 16:25:30 - utils - INFO - Loaded 1000 psychometric profiles
2025-11-06 16:25:30 - utils - INFO - Pseudonymized column: user
2025-11-06 16:25:30 - utils - INFO - Merging static user data (LDAP, Psychometric) into event logs...
2025-11-06 16:25:32 - utils - INFO - Static data merged. Total columns: 31
2025-11-06 16:25:32 - utils - INFO - min_user_activity_threshold is 0, skipping user filtering.
2025-11-06 16:25:32 - utils - INFO - Initializing 'is_insider' column (all set to 0)...
2025-11-06 16:26:10 - utils - INFO - Handled missing values using strategy: fill_mode
2025-11-06 16:27:05 - utils - INFO - Saved dataframe to /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv
2025-11-06 16:27:05 - utils - INFO - Processed data saved to processed_unified_logs.csv
2025-11-06 16:27:05 - utils - INFO - Preprocessing pipeline completed successfully!
2025-11-06 16:27:05 - utils - INFO - Final dataset: 10062926 records, 32 features
2025-11-06 16:27:05 - utils - INFO - ✓ Stage 1 completed: 10062926 records processed
2025-11-06 16:27:05 - utils - INFO - 
================================================================================
                          STAGE 2: FEATURE ENGINEERING                          
================================================================================

2025-11-06 16:27:05 - utils - INFO - 
================================================================================
                          FEATURE ENGINEERING PIPELINE                          
================================================================================

2025-11-06 16:27:05 - utils - INFO - Creating temporal features...
2025-11-06 16:27:09 - utils - INFO - Temporal features created
2025-11-06 16:27:09 - utils - INFO - Creating user aggregated features with window: 1D
2025-11-06 16:27:27 - utils - INFO - Created 8 aggregated features
2025-11-06 16:27:28 - utils - INFO - Creating behavioral ratio features...
2025-11-06 16:27:28 - utils - INFO - Behavioral ratio features created
2025-11-06 16:27:28 - utils - INFO - Creating statistical features per user...
2025-11-06 16:27:28 - utils - INFO - Created 50 statistical features
2025-11-06 16:27:28 - utils - INFO - Scaling features (fit=True)...
2025-11-06 16:27:28 - utils - INFO - Scaled 60 features
2025-11-06 16:27:28 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/feature_scaler.pkl
2025-11-06 16:27:28 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/label_encoders.pkl
2025-11-06 16:27:28 - utils - INFO - Feature engineering artifacts saved
2025-11-06 16:27:28 - utils - INFO - Feature engineering completed: 331144 samples, 60 features
2025-11-06 16:27:29 - utils - INFO - Creating sequences with length=15, stride=10
2025-11-06 16:56:53 - utils - INFO - Created 1005335 sequences from 1000 users
2025-11-06 16:56:55 - utils - INFO - ✓ Stage 2 completed: 331144 feature vectors, 1005335 sequences
2025-11-06 16:56:55 - utils - INFO - 
================================================================================
                            STAGE 3: MODEL TRAINING                             
================================================================================

2025-11-06 16:56:55 - utils - INFO - 
>>> Training Isolation Forest...
2025-11-06 16:56:55 - utils - INFO - 
================================================================================
                           ISOLATION FOREST TRAINING                            
================================================================================

2025-11-06 16:56:55 - utils - INFO - Loaded dataframe from /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_static_features.csv
2025-11-06 16:56:55 - utils - INFO - Data split: Train=699, Val=150, Test=151
2025-11-06 16:56:55 - utils - INFO - Insider labels split: Train=1, Val=0, Test=1
2025-11-06 16:56:55 - utils - INFO - Initialized Isolation Forest with params: {'n_estimators': 50, 'max_samples': 256, 'contamination': 'auto', 'max_features': 1.0, 'bootstrap': False, 'n_jobs': -1, 'random_state': 42, 'verbose': 0}
2025-11-06 16:56:55 - utils - INFO - Training Isolation Forest...
2025-11-06 16:56:55 - utils - INFO - Isolation Forest training completed
2025-11-06 16:56:55 - utils - INFO - Calibrating threshold for target FPR=0.05
2025-11-06 16:56:55 - utils - INFO - Calibrated threshold: 0.6282
2025-11-06 16:56:55 - utils - INFO - Evaluating Isolation Forest...
2025-11-06 16:56:55 - utils - INFO - 
============================================================
2025-11-06 16:56:55 - utils - INFO - Isolation Forest Performance Metrics
2025-11-06 16:56:55 - utils - INFO - ============================================================
2025-11-06 16:56:55 - utils - INFO - Accuracy:  0.9536
2025-11-06 16:56:55 - utils - INFO - Precision: 0.0000
2025-11-06 16:56:55 - utils - INFO - Recall:    0.0000
2025-11-06 16:56:55 - utils - INFO - F1-Score:  0.0000
2025-11-06 16:56:55 - utils - INFO - AUC-ROC:   0.8000
2025-11-06 16:56:55 - utils - INFO - ============================================================

2025-11-06 16:56:55 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest.pkl
2025-11-06 16:56:55 - utils - INFO - Isolation Forest model saved to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest.pkl
2025-11-06 16:56:55 - utils - INFO - Isolation Forest training and evaluation completed!
2025-11-06 16:56:55 - utils - INFO - ✓ Isolation Forest training completed
2025-11-06 16:56:55 - utils - INFO - 
>>> Training LSTM Autoencoder...
2025-11-06 16:56:55 - utils - INFO - 
================================================================================
                     LIGHTWEIGHT LSTM AUTOENCODER TRAINING                      
================================================================================

2025-11-06 16:56:56 - utils - INFO - Loaded sequences: (1005335, 15, 27)
2025-11-06 16:56:58 - utils - INFO - Data split: Train=703734, Val=150800, Test=150801
2025-11-06 16:56:58 - utils - INFO - Insider labels split: Train=18, Val=4, Test=4
2025-11-06 16:56:59 - utils - INFO - Training on 703716 normal sequences
2025-11-06 16:56:59 - utils - INFO - Initialized Lightweight LSTM Autoencoder (15, 27)
2025-11-06 16:56:59 - utils - INFO - Training lightweight LSTM Autoencoder...
2025-11-06 16:56:59 - utils - INFO - Building lightweight LSTM Autoencoder...
2025-11-06 16:56:59 - utils - INFO - Model built with 20,363 parameters
2025-11-06 16:56:59 - utils - INFO - Training on 703716 sequences...
2025-11-06 17:10:25 - utils - INFO - Training completed
2025-11-06 17:10:25 - utils - INFO - Training completed in 805.29 seconds
2025-11-06 17:10:25 - utils - INFO - Calibrating threshold for target FPR=0.05
2025-11-06 17:10:27 - utils - INFO - Calibrated threshold: 0.6197
2025-11-06 17:10:27 - utils - INFO - Evaluating lightweight LSTM Autoencoder...
2025-11-06 17:10:32 - utils - INFO - 
============================================================
2025-11-06 17:10:32 - utils - INFO - LSTM Autoencoder (Lightweight) Performance Metrics
2025-11-06 17:10:32 - utils - INFO - ============================================================
2025-11-06 17:10:32 - utils - INFO - Accuracy:  0.9638
2025-11-06 17:10:32 - utils - INFO - Precision: 0.0000
2025-11-06 17:10:32 - utils - INFO - Recall:    0.0000
2025-11-06 17:10:32 - utils - INFO - F1-Score:  0.0000
2025-11-06 17:10:32 - utils - INFO - AUC-ROC:   0.3885
2025-11-06 17:10:32 - utils - INFO - ============================================================

2025-11-06 17:10:32 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/lstm_autoencoder.keras
2025-11-06 17:10:34 - utils - INFO - Lightweight LSTM Autoencoder completed!
2025-11-06 17:10:34 - utils - INFO - Total time: 805.29 seconds
2025-11-06 17:10:34 - utils - INFO - ✓ LSTM Autoencoder training completed
2025-11-06 17:10:34 - utils - INFO - 
>>> Training Deep Clustering...
2025-11-06 17:10:34 - utils - INFO - 
================================================================================
                      LIGHTWEIGHT DEEP CLUSTERING TRAINING                      
================================================================================

2025-11-06 17:10:34 - utils - INFO - Loaded dataframe from /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_static_features.csv
2025-11-06 17:10:34 - utils - INFO - Dataset: 1000 samples, 70 features
2025-11-06 17:10:34 - utils - INFO - Data split: Train=699, Val=150, Test=151
2025-11-06 17:10:34 - utils - INFO - Insider labels split: Train=1, Val=0, Test=1
2025-11-06 17:10:34 - utils - INFO - Initialized Lightweight Deep Clustering (n_clusters=5, encoding_dim=32)
2025-11-06 17:10:34 - utils - INFO - Training lightweight deep clustering model...
2025-11-06 17:10:34 - utils - INFO - Fitting MiniBatch K-Means clustering...
2025-11-06 17:10:34 - utils - INFO - Lightweight deep clustering training completed
2025-11-06 17:10:34 - utils - INFO - Training completed in 0.15 seconds
2025-11-06 17:10:34 - utils - INFO - Evaluating lightweight deep clustering model...
2025-11-06 17:10:34 - utils - INFO - 
============================================================
2025-11-06 17:10:34 - utils - INFO - Deep Clustering (Lightweight) Performance Metrics
2025-11-06 17:10:34 - utils - INFO - ============================================================
2025-11-06 17:10:34 - utils - INFO - Accuracy:  0.9404
2025-11-06 17:10:34 - utils - INFO - Precision: 0.0000
2025-11-06 17:10:34 - utils - INFO - Recall:    0.0000
2025-11-06 17:10:34 - utils - INFO - F1-Score:  0.0000
2025-11-06 17:10:34 - utils - INFO - AUC-ROC:   0.8667
2025-11-06 17:10:34 - utils - INFO - ============================================================

2025-11-06 17:10:34 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/deep_clustering.pkl
2025-11-06 17:10:34 - utils - INFO - Lightweight deep clustering model saved to /Users/bipinrimal/Downloads/Thesis_work/models/deep_clustering.pkl
2025-11-06 17:10:34 - utils - INFO - Lightweight deep clustering training and evaluation completed!
2025-11-06 17:10:34 - utils - INFO - Total time: 0.15 seconds
2025-11-06 17:10:34 - utils - INFO - ✓ Deep Clustering training completed
2025-11-06 17:10:34 - utils - INFO - 
✓ Stage 3 completed: 3 models trained
2025-11-06 17:10:34 - utils - INFO - 
================================================================================
                           STAGE 4: MODEL EVALUATION                            
================================================================================

2025-11-06 17:10:34 - utils - INFO - 
================================================================================
                         COMPREHENSIVE MODEL EVALUATION                         
================================================================================

2025-11-06 17:10:34 - utils - INFO - Loading results for all models...
2025-11-06 17:10:34 - utils - INFO - Loaded results for isolation_forest
2025-11-06 17:10:34 - utils - INFO - Loaded results for lstm_autoencoder
2025-11-06 17:10:34 - utils - INFO - Loaded results for deep_clustering
2025-11-06 17:10:34 - utils - INFO - Loaded results for 3 models
2025-11-06 17:10:34 - utils - INFO - Creating metrics comparison table...
2025-11-06 17:10:34 - utils - INFO - Metrics comparison table created
2025-11-06 17:10:34 - utils - INFO - Creating confusion matrix plots...
2025-11-06 17:10:34 - utils - INFO - Confusion matrices saved to /Users/bipinrimal/Downloads/Thesis_work/results/confusion_matrices/all_models.png
2025-11-06 17:10:34 - utils - INFO - Creating ROC curves...
2025-11-06 17:10:35 - utils - INFO - ROC curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/roc_curves/roc_comparison.png
2025-11-06 17:10:35 - utils - INFO - Creating Precision-Recall curves...
2025-11-06 17:10:35 - utils - INFO - Precision-Recall curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/precision_recall_comparison.png
2025-11-06 17:10:35 - utils - INFO - Creating metrics comparison bar chart...
2025-11-06 17:10:35 - utils - INFO - Metrics comparison bar chart saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/metrics_comparison_bar.png
2025-11-06 17:10:35 - utils - INFO - Creating anomaly score distribution plots...
2025-11-06 17:10:35 - utils - INFO - Score distributions saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/score_distributions.png
2025-11-06 17:10:35 - utils - INFO - Generating evaluation report...
2025-11-06 17:10:35 - utils - INFO - Evaluation report saved to /Users/bipinrimal/Downloads/Thesis_work/results/evaluation_report.txt
2025-11-06 17:10:35 - utils - INFO - Comprehensive evaluation completed!
2025-11-06 17:10:35 - utils - INFO - ✓ Stage 4 completed: Comprehensive evaluation report generated
2025-11-06 17:10:35 - utils - INFO - 
================================================================================
                         STAGE 5: ENSEMBLE INTEGRATION                          
================================================================================

2025-11-06 17:10:35 - utils - INFO - Initialized Ensemble Detector with method: weighted
2025-11-06 17:10:35 - utils - INFO - 
================================================================================
                            ENSEMBLE SYSTEM PIPELINE                            
================================================================================

2025-11-06 17:10:35 - utils - INFO - Loading predictions from individual models...
2025-11-06 17:10:35 - utils - INFO - Loaded isolation_forest predictions: 151 samples
2025-11-06 17:10:35 - utils - INFO - Loaded lstm_autoencoder predictions: 150801 samples
2025-11-06 17:10:35 - utils - INFO - Loaded deep_clustering predictions: 151 samples
2025-11-06 17:10:35 - utils - WARNING - Models have different sample counts: {'isolation_forest': 151, 'lstm_autoencoder': 150801, 'deep_clustering': 151}
2025-11-06 17:10:35 - utils - INFO - Will use aggregation strategy to align predictions...
2025-11-06 17:10:35 - utils - INFO - Aligning predictions across models...
2025-11-06 17:10:35 - utils - INFO - Using isolation_forest as reference (151 samples)
2025-11-06 17:10:35 - utils - INFO - Aggregating lstm_autoencoder from 150801 to 151 samples
2025-11-06 17:10:35 - utils - INFO - Predictions aligned successfully
2025-11-06 17:10:35 - utils - INFO - Loaded predictions from 3 models
2025-11-06 17:10:35 - utils - INFO - Computing weighted ensemble...
2025-11-06 17:10:35 - utils - INFO - Weighted ensemble: 1 anomalies detected
2025-11-06 17:10:35 - utils - INFO - Evaluating ensemble performance...
2025-11-06 17:10:35 - utils - INFO - 
============================================================
2025-11-06 17:10:35 - utils - INFO - Ensemble (weighted) Performance Metrics
2025-11-06 17:10:35 - utils - INFO - ============================================================
2025-11-06 17:10:35 - utils - INFO - Accuracy:  0.9868
2025-11-06 17:10:35 - utils - INFO - Precision: 0.0000
2025-11-06 17:10:35 - utils - INFO - Recall:    0.0000
2025-11-06 17:10:35 - utils - INFO - F1-Score:  0.0000
2025-11-06 17:10:35 - utils - INFO - AUC-ROC:   0.7867
2025-11-06 17:10:35 - utils - INFO - ============================================================

2025-11-06 17:10:35 - utils - INFO - Comparing ensemble with individual models...
2025-11-06 17:10:35 - utils - INFO - Evaluating ensemble performance...
2025-11-06 17:10:35 - utils - INFO - 
============================================================
2025-11-06 17:10:35 - utils - INFO - Ensemble (weighted) Performance Metrics
2025-11-06 17:10:35 - utils - INFO - ============================================================
2025-11-06 17:10:35 - utils - INFO - Accuracy:  0.9868
2025-11-06 17:10:35 - utils - INFO - Precision: 0.0000
2025-11-06 17:10:35 - utils - INFO - Recall:    0.0000
2025-11-06 17:10:35 - utils - INFO - F1-Score:  0.0000
2025-11-06 17:10:35 - utils - INFO - AUC-ROC:   0.7867
2025-11-06 17:10:35 - utils - INFO - ============================================================

2025-11-06 17:10:35 - utils - INFO - 
Comparison Results:
2025-11-06 17:10:35 - utils - INFO - 
              model  accuracy  precision  recall  f1_score  auc_roc
   Isolation Forest    0.9536        0.0     0.0       0.0   0.8000
   Lstm Autoencoder    0.9735        0.0     0.0       0.0   0.3800
    Deep Clustering    0.9404        0.0     0.0       0.0   0.8667
Ensemble (weighted)    0.9868        0.0     0.0       0.0   0.7867
2025-11-06 17:10:35 - utils - INFO - Ensemble predictions saved
2025-11-06 17:10:35 - utils - INFO - Generating alerts...
2025-11-06 17:10:35 - utils - INFO - Generated 1 alerts
2025-11-06 17:10:35 - utils - INFO - Severity distribution:
severity
medium    1
Name: count, dtype: int64
2025-11-06 17:10:35 - utils - INFO - Alerts saved to /Users/bipinrimal/Downloads/Thesis_work/results/generated_alerts.csv
2025-11-06 17:10:35 - utils - INFO - Ensemble pipeline completed!
2025-11-06 17:10:35 - utils - INFO - Initialized Ensemble Detector with method: majority
2025-11-06 17:10:35 - utils - INFO - 
================================================================================
                            ENSEMBLE SYSTEM PIPELINE                            
================================================================================

2025-11-06 17:10:35 - utils - INFO - Loading predictions from individual models...
2025-11-06 17:10:35 - utils - INFO - Loaded isolation_forest predictions: 151 samples
2025-11-06 17:10:35 - utils - INFO - Loaded lstm_autoencoder predictions: 150801 samples
2025-11-06 17:10:35 - utils - INFO - Loaded deep_clustering predictions: 151 samples
2025-11-06 17:10:35 - utils - WARNING - Models have different sample counts: {'isolation_forest': 151, 'lstm_autoencoder': 150801, 'deep_clustering': 151}
2025-11-06 17:10:35 - utils - INFO - Will use aggregation strategy to align predictions...
2025-11-06 17:10:35 - utils - INFO - Aligning predictions across models...
2025-11-06 17:10:35 - utils - INFO - Using isolation_forest as reference (151 samples)
2025-11-06 17:10:35 - utils - INFO - Aggregating lstm_autoencoder from 150801 to 151 samples
2025-11-06 17:10:35 - utils - INFO - Predictions aligned successfully
2025-11-06 17:10:35 - utils - INFO - Loaded predictions from 3 models
2025-11-06 17:10:35 - utils - INFO - Computing majority voting ensemble...
2025-11-06 17:10:35 - utils - INFO - Majority voting: 3 anomalies detected
2025-11-06 17:10:35 - utils - INFO - Evaluating ensemble performance...
2025-11-06 17:10:35 - utils - INFO - 
============================================================
2025-11-06 17:10:35 - utils - INFO - Ensemble (majority) Performance Metrics
2025-11-06 17:10:35 - utils - INFO - ============================================================
2025-11-06 17:10:35 - utils - INFO - Accuracy:  0.9735
2025-11-06 17:10:35 - utils - INFO - Precision: 0.0000
2025-11-06 17:10:35 - utils - INFO - Recall:    0.0000
2025-11-06 17:10:35 - utils - INFO - F1-Score:  0.0000
2025-11-06 17:10:35 - utils - INFO - AUC-ROC:   0.7733
2025-11-06 17:10:35 - utils - INFO - ============================================================

2025-11-06 17:10:35 - utils - INFO - Comparing ensemble with individual models...
2025-11-06 17:10:35 - utils - INFO - Evaluating ensemble performance...
2025-11-06 17:10:35 - utils - INFO - 
============================================================
2025-11-06 17:10:35 - utils - INFO - Ensemble (majority) Performance Metrics
2025-11-06 17:10:35 - utils - INFO - ============================================================
2025-11-06 17:10:35 - utils - INFO - Accuracy:  0.9735
2025-11-06 17:10:35 - utils - INFO - Precision: 0.0000
2025-11-06 17:10:35 - utils - INFO - Recall:    0.0000
2025-11-06 17:10:35 - utils - INFO - F1-Score:  0.0000
2025-11-06 17:10:35 - utils - INFO - AUC-ROC:   0.7733
2025-11-06 17:10:35 - utils - INFO - ============================================================

2025-11-06 17:10:35 - utils - INFO - 
Comparison Results:
2025-11-06 17:10:35 - utils - INFO - 
              model  accuracy  precision  recall  f1_score  auc_roc
   Isolation Forest    0.9536        0.0     0.0       0.0   0.8000
   Lstm Autoencoder    0.9735        0.0     0.0       0.0   0.3800
    Deep Clustering    0.9404        0.0     0.0       0.0   0.8667
Ensemble (majority)    0.9735        0.0     0.0       0.0   0.7733
2025-11-06 17:10:35 - utils - INFO - Ensemble predictions saved
2025-11-06 17:10:35 - utils - INFO - Generating alerts...
2025-11-06 17:10:35 - utils - INFO - Generated 1 alerts
2025-11-06 17:10:35 - utils - INFO - Severity distribution:
severity
medium    1
Name: count, dtype: int64
2025-11-06 17:10:35 - utils - INFO - Alerts saved to /Users/bipinrimal/Downloads/Thesis_work/results/generated_alerts.csv
2025-11-06 17:10:35 - utils - INFO - Ensemble pipeline completed!
2025-11-06 17:10:35 - utils - INFO - Initialized Ensemble Detector with method: cascade
2025-11-06 17:10:35 - utils - INFO - 
================================================================================
                            ENSEMBLE SYSTEM PIPELINE                            
================================================================================

2025-11-06 17:10:35 - utils - INFO - Loading predictions from individual models...
2025-11-06 17:10:35 - utils - INFO - Loaded isolation_forest predictions: 151 samples
2025-11-06 17:10:35 - utils - INFO - Loaded lstm_autoencoder predictions: 150801 samples
2025-11-06 17:10:35 - utils - INFO - Loaded deep_clustering predictions: 151 samples
2025-11-06 17:10:35 - utils - WARNING - Models have different sample counts: {'isolation_forest': 151, 'lstm_autoencoder': 150801, 'deep_clustering': 151}
2025-11-06 17:10:35 - utils - INFO - Will use aggregation strategy to align predictions...
2025-11-06 17:10:35 - utils - INFO - Aligning predictions across models...
2025-11-06 17:10:35 - utils - INFO - Using isolation_forest as reference (151 samples)
2025-11-06 17:10:35 - utils - INFO - Aggregating lstm_autoencoder from 150801 to 151 samples
2025-11-06 17:10:35 - utils - INFO - Predictions aligned successfully
2025-11-06 17:10:35 - utils - INFO - Loaded predictions from 3 models
2025-11-06 17:10:35 - utils - INFO - Computing cascade ensemble...
2025-11-06 17:10:35 - utils - INFO - Cascade ensemble: 0 anomalies detected
2025-11-06 17:10:35 - utils - INFO - Evaluating ensemble performance...
2025-11-06 17:10:35 - utils - INFO - 
============================================================
2025-11-06 17:10:35 - utils - INFO - Ensemble (cascade) Performance Metrics
2025-11-06 17:10:35 - utils - INFO - ============================================================
2025-11-06 17:10:35 - utils - INFO - Accuracy:  0.9934
2025-11-06 17:10:35 - utils - INFO - Precision: 0.0000
2025-11-06 17:10:35 - utils - INFO - Recall:    0.0000
2025-11-06 17:10:35 - utils - INFO - F1-Score:  0.0000
2025-11-06 17:10:35 - utils - INFO - AUC-ROC:   0.3400
2025-11-06 17:10:35 - utils - INFO - ============================================================

2025-11-06 17:10:35 - utils - INFO - Comparing ensemble with individual models...
2025-11-06 17:10:35 - utils - INFO - Evaluating ensemble performance...
2025-11-06 17:10:35 - utils - INFO - 
============================================================
2025-11-06 17:10:35 - utils - INFO - Ensemble (cascade) Performance Metrics
2025-11-06 17:10:35 - utils - INFO - ============================================================
2025-11-06 17:10:35 - utils - INFO - Accuracy:  0.9934
2025-11-06 17:10:35 - utils - INFO - Precision: 0.0000
2025-11-06 17:10:35 - utils - INFO - Recall:    0.0000
2025-11-06 17:10:35 - utils - INFO - F1-Score:  0.0000
2025-11-06 17:10:35 - utils - INFO - AUC-ROC:   0.3400
2025-11-06 17:10:35 - utils - INFO - ============================================================

2025-11-06 17:10:35 - utils - INFO - 
Comparison Results:
2025-11-06 17:10:35 - utils - INFO - 
             model  accuracy  precision  recall  f1_score  auc_roc
  Isolation Forest    0.9536        0.0     0.0       0.0   0.8000
  Lstm Autoencoder    0.9735        0.0     0.0       0.0   0.3800
   Deep Clustering    0.9404        0.0     0.0       0.0   0.8667
Ensemble (cascade)    0.9934        0.0     0.0       0.0   0.3400
2025-11-06 17:10:35 - utils - INFO - Ensemble predictions saved
2025-11-06 17:10:35 - utils - INFO - Generating alerts...
2025-11-06 17:10:35 - utils - INFO - Generated 4 alerts
2025-11-06 17:10:35 - utils - INFO - Severity distribution:
severity
high        2
critical    1
medium      1
Name: count, dtype: int64
2025-11-06 17:10:35 - utils - INFO - Alerts saved to /Users/bipinrimal/Downloads/Thesis_work/results/generated_alerts.csv
2025-11-06 17:10:35 - utils - INFO - Ensemble pipeline completed!
2025-11-06 17:10:35 - utils - INFO - 
✓ Stage 5 completed: Best ensemble method = None (F1=0.0000)
2025-11-06 17:10:35 - utils - INFO - 
================================================================================
                             STAGE 6: VISUALIZATION                             
================================================================================

2025-11-06 17:10:35 - utils - INFO - 
================================================================================
                           GENERATING VISUALIZATIONS                            
================================================================================

2025-11-06 17:10:35 - utils - INFO - Creating alert severity distribution plot...
2025-11-06 17:10:35 - utils - INFO - Alert severity distribution plot saved
2025-11-06 17:10:35 - utils - INFO - Creating model agreement plot...
2025-11-06 17:10:35 - utils - INFO - Model agreement plot saved
2025-11-06 17:10:35 - utils - INFO - Creating anomaly score timeline for ensemble_weighted...
2025-11-06 17:10:35 - utils - INFO - Anomaly score timeline saved for ensemble_weighted
2025-11-06 17:10:35 - utils - INFO - Creating feature importance visualization...
2025-11-06 17:10:36 - utils - INFO - Feature importance heatmap saved
2025-11-06 17:10:36 - utils - INFO - Creating executive summary chart...
2025-11-06 17:10:36 - utils - INFO - Executive summary chart saved
2025-11-06 17:10:36 - utils - INFO - All visualizations saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations
2025-11-06 17:10:36 - utils - INFO - Visualization generation completed!
2025-11-06 17:10:36 - utils - INFO - ✓ Stage 6 completed: All visualizations generated
2025-11-06 17:10:36 - utils - INFO - 
================================================================================
2025-11-06 17:10:36 - utils - INFO - FINAL SUMMARY
2025-11-06 17:10:36 - utils - INFO - ================================================================================
2025-11-06 17:10:36 - utils - INFO - 
Model Performance:
2025-11-06 17:10:36 - utils - INFO - 
Isolation Forest:
2025-11-06 17:10:36 - utils - INFO -   Accuracy:  0.9536
2025-11-06 17:10:36 - utils - INFO -   Precision: 0.0000
2025-11-06 17:10:36 - utils - INFO -   Recall:    0.0000
2025-11-06 17:10:36 - utils - INFO -   F1-Score:  0.0000
2025-11-06 17:10:36 - utils - INFO -   AUC-ROC:   0.8000
2025-11-06 17:10:36 - utils - INFO - 
Lstm Autoencoder:
2025-11-06 17:10:36 - utils - INFO -   Accuracy:  0.9638
2025-11-06 17:10:36 - utils - INFO -   Precision: 0.0000
2025-11-06 17:10:36 - utils - INFO -   Recall:    0.0000
2025-11-06 17:10:36 - utils - INFO -   F1-Score:  0.0000
2025-11-06 17:10:36 - utils - INFO -   AUC-ROC:   0.3885
2025-11-06 17:10:36 - utils - INFO - 
Deep Clustering:
2025-11-06 17:10:36 - utils - INFO -   Accuracy:  0.9404
2025-11-06 17:10:36 - utils - INFO -   Precision: 0.0000
2025-11-06 17:10:36 - utils - INFO -   Recall:    0.0000
2025-11-06 17:10:36 - utils - INFO -   F1-Score:  0.0000
2025-11-06 17:10:36 - utils - INFO -   AUC-ROC:   0.8667
2025-11-06 17:10:36 - utils - INFO - 
Generated Output Files:
2025-11-06 17:10:36 - utils - INFO -   - Processed Data: /Users/bipinrimal/Downloads/Thesis_work/data/processed
2025-11-06 17:10:36 - utils - INFO -   - Trained Models: /Users/bipinrimal/Downloads/Thesis_work/models
2025-11-06 17:10:36 - utils - INFO -   - Results & Metrics: /Users/bipinrimal/Downloads/Thesis_work/results
2025-11-06 17:10:36 - utils - INFO -   - Visualizations: /Users/bipinrimal/Downloads/Thesis_work/results/visualizations
2025-11-06 17:10:36 - utils - INFO -   - Alerts: /Users/bipinrimal/Downloads/Thesis_work/results/generated_alerts.csv
2025-11-06 17:10:36 - utils - INFO -   - Logs: /Users/bipinrimal/Downloads/Thesis_work/logs/insider_threat_detection.log
2025-11-06 17:10:36 - utils - INFO - 
================================================================================

2025-11-06 17:10:36 - utils - INFO - 
================================================================================
2025-11-06 17:10:36 - utils - INFO - ✓ PIPELINE EXECUTION COMPLETED SUCCESSFULLY
2025-11-06 17:10:36 - utils - INFO - ================================================================================

2025-11-06 17:11:34 - utils - INFO - Utility functions loaded successfully
2025-11-06 17:11:43 - utils - INFO - Utility functions loaded successfully
2025-11-06 17:11:46 - utils - INFO - ================================================================================
2025-11-06 17:11:46 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-11-06 17:11:46 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-11-06 17:11:46 - utils - INFO - ================================================================================
2025-11-06 17:11:46 - utils - INFO - 
================================================================================
                           STAGE 4: MODEL EVALUATION                            
================================================================================

2025-11-06 17:11:46 - utils - INFO - 
================================================================================
                         COMPREHENSIVE MODEL EVALUATION                         
================================================================================

2025-11-06 17:11:46 - utils - INFO - Loading results for all models...
2025-11-06 17:11:46 - utils - INFO - Loaded results for isolation_forest
2025-11-06 17:11:46 - utils - INFO - Loaded results for lstm_autoencoder
2025-11-06 17:11:46 - utils - INFO - Loaded results for deep_clustering
2025-11-06 17:11:46 - utils - INFO - Loaded results for 3 models
2025-11-06 17:11:46 - utils - INFO - Creating metrics comparison table...
2025-11-06 17:11:46 - utils - INFO - Metrics comparison table created
2025-11-06 17:11:46 - utils - INFO - Creating confusion matrix plots...
2025-11-06 17:11:46 - utils - INFO - Confusion matrices saved to /Users/bipinrimal/Downloads/Thesis_work/results/confusion_matrices/all_models.png
2025-11-06 17:11:46 - utils - INFO - Creating ROC curves...
2025-11-06 17:11:46 - utils - INFO - ROC curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/roc_curves/roc_comparison.png
2025-11-06 17:11:46 - utils - INFO - Creating Precision-Recall curves...
2025-11-06 17:11:46 - utils - INFO - Precision-Recall curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/precision_recall_comparison.png
2025-11-06 17:11:46 - utils - INFO - Creating metrics comparison bar chart...
2025-11-06 17:11:46 - utils - INFO - Metrics comparison bar chart saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/metrics_comparison_bar.png
2025-11-06 17:11:46 - utils - INFO - Creating anomaly score distribution plots...
2025-11-06 17:11:47 - utils - INFO - Score distributions saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/score_distributions.png
2025-11-06 17:11:47 - utils - INFO - Generating evaluation report...
2025-11-06 17:11:47 - utils - INFO - Evaluation report saved to /Users/bipinrimal/Downloads/Thesis_work/results/evaluation_report.txt
2025-11-06 17:11:47 - utils - INFO - Comprehensive evaluation completed!
2025-11-06 17:11:47 - utils - INFO - ✓ Stage 4 completed: Comprehensive evaluation report generated
2025-11-06 17:22:35 - utils - INFO - Utility functions loaded successfully
2025-11-06 17:22:51 - utils - INFO - Utility functions loaded successfully
2025-11-06 17:23:34 - utils - INFO - Utility functions loaded successfully
2025-11-06 17:29:30 - utils - INFO - Utility functions loaded successfully
2025-11-06 17:29:43 - utils - INFO - Loaded dataframe from /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv
2025-11-06 17:29:43 - utils - INFO - 
================================================================================
                          FEATURE ENGINEERING PIPELINE                          
================================================================================

2025-11-06 17:29:43 - utils - INFO - Creating temporal features...
2025-11-06 17:29:45 - utils - INFO - Temporal features created
2025-11-06 17:29:45 - utils - INFO - Creating DAILY aggregated features with window: 1D
2025-11-06 17:29:49 - utils - INFO - Aggregating activity type counts...
2025-11-06 17:29:58 - utils - INFO - Created 8 daily aggregated features
2025-11-06 17:29:59 - utils - INFO - Creating behavioral ratio features...
2025-11-06 17:29:59 - utils - INFO - Behavioral ratio features created
2025-11-06 17:30:02 - utils - INFO - Creating STATIC statistical features per user...
2025-11-06 17:30:02 - utils - INFO - Created 60 static statistical features
2025-11-06 17:30:02 - utils - INFO - Scaling features (fit=True)...
2025-11-06 17:30:02 - utils - INFO - Scaled 10 features
2025-11-06 17:30:02 - utils - INFO - Scaling features (fit=True)...
2025-11-06 17:30:02 - utils - INFO - Scaled 65 features
2025-11-06 17:30:02 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/static_scaler.pkl
2025-11-06 17:30:02 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/daily_scaler.pkl
2025-11-06 17:30:02 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/label_encoders.pkl
2025-11-06 17:30:02 - utils - INFO - Feature engineering artifacts saved
2025-11-06 17:30:02 - utils - INFO - Daily aggregation completed: 331144 samples, 10 features
2025-11-06 17:30:02 - utils - INFO - Static features completed: 1000 samples, 65 features
2025-11-06 17:30:02 - utils - INFO - Saved dataframe to /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_static_features.csv
2025-11-06 17:30:04 - utils - INFO - Saved dataframe to /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_daily_features.csv
2025-11-06 17:30:04 - utils - INFO - Creating sequences from *scaled* daily aggregated data...
2025-11-06 17:30:04 - utils - INFO - Creating sequences from aggregated data (length=15, stride=10)
2025-11-06 17:30:15 - utils - INFO - Created 32531 sequences from 1000 users
2025-11-06 17:30:15 - utils - INFO - Sequences saved for LSTM training
2025-11-06 17:31:33 - utils - INFO - Utility functions loaded successfully
2025-11-06 17:31:33 - utils - INFO - 
================================================================================
                           ISOLATION FOREST TRAINING                            
================================================================================

2025-11-06 17:31:33 - utils - INFO - Loaded dataframe from /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_static_features.csv
2025-11-06 17:31:33 - utils - INFO - Model loaded from /Users/bipinrimal/Downloads/Thesis_work/models/static_scaler.pkl
2025-11-06 17:31:33 - utils - INFO - Initialized Isolation Forest with params: {'n_estimators': 50, 'max_samples': 256, 'contamination': 'auto', 'max_features': 1.0, 'bootstrap': False, 'n_jobs': -1, 'random_state': 42, 'verbose': 0}
2025-11-06 17:31:33 - utils - INFO - Data split: Train=699, Val=150, Test=151
2025-11-06 17:31:33 - utils - INFO - Insider labels split: Train=0, Val=0, Test=0
2025-11-06 17:31:33 - utils - INFO - Training Isolation Forest...
2025-11-06 17:31:33 - utils - INFO - Isolation Forest training completed
2025-11-06 17:31:33 - utils - INFO - Calibrating threshold for target FPR=0.05
2025-11-06 17:31:33 - utils - INFO - Calibrated threshold: 0.6457
2025-11-06 17:31:33 - utils - INFO - Evaluating Isolation Forest...
2025-11-06 17:31:33 - utils - INFO - 
============================================================
2025-11-06 17:31:33 - utils - INFO - Isolation Forest Performance Metrics
2025-11-06 17:31:33 - utils - INFO - ============================================================
2025-11-06 17:31:33 - utils - INFO - Accuracy:  0.9404
2025-11-06 17:31:33 - utils - INFO - Precision: 0.0000
2025-11-06 17:31:33 - utils - INFO - Recall:    0.0000
2025-11-06 17:31:33 - utils - INFO - F1-Score:  0.0000
2025-11-06 17:31:33 - utils - INFO - AUC-ROC:   nan
2025-11-06 17:31:33 - utils - INFO - ============================================================

2025-11-06 17:31:33 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest.pkl
2025-11-06 17:31:33 - utils - INFO - Isolation Forest model saved to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest.pkl
2025-11-06 17:31:33 - utils - INFO - Isolation Forest training and evaluation completed!
2025-11-06 17:31:38 - utils - INFO - Utility functions loaded successfully
2025-11-06 17:31:38 - utils - INFO - 
================================================================================
                      LIGHTWEIGHT DEEP CLUSTERING TRAINING                      
================================================================================

2025-11-06 17:31:39 - utils - INFO - Loaded dataframe from /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_features.csv
2025-11-06 17:31:39 - utils - INFO - Dataset: 331144 samples, 60 features
2025-11-06 17:31:40 - utils - INFO - Data split: Train=231800, Val=49672, Test=49672
2025-11-06 17:31:40 - utils - INFO - Initialized Lightweight Deep Clustering (n_clusters=5, encoding_dim=30)
2025-11-06 17:31:40 - utils - INFO - Training lightweight deep clustering model...
2025-11-06 17:31:40 - utils - INFO - Fitting MiniBatch K-Means clustering...
2025-11-06 17:31:40 - utils - INFO - Lightweight deep clustering training completed
2025-11-06 17:31:40 - utils - INFO - Training completed in 0.28 seconds
2025-11-06 17:31:40 - utils - INFO - Calibrating threshold for target FPR=0.05
2025-11-06 17:31:40 - utils - INFO - Calibrated threshold: 0.7906
2025-11-06 17:31:40 - utils - INFO - Evaluating lightweight deep clustering model...
2025-11-06 17:31:40 - utils - INFO - 
============================================================
2025-11-06 17:31:40 - utils - INFO - Deep Clustering (Lightweight) Performance Metrics
2025-11-06 17:31:40 - utils - INFO - ============================================================
2025-11-06 17:31:40 - utils - INFO - Accuracy:  0.9459
2025-11-06 17:31:40 - utils - INFO - Precision: 0.0000
2025-11-06 17:31:40 - utils - INFO - Recall:    0.0000
2025-11-06 17:31:40 - utils - INFO - F1-Score:  0.0000
2025-11-06 17:31:40 - utils - INFO - AUC-ROC:   0.5560
2025-11-06 17:31:40 - utils - INFO - ============================================================

2025-11-06 17:31:40 - utils - INFO - Lightweight deep clustering model saved to /Users/bipinrimal/Downloads/Thesis_work/models/deep_clustering.pkl
2025-11-06 17:31:40 - utils - INFO - Lightweight deep clustering training and evaluation completed!
2025-11-06 17:31:40 - utils - INFO - Total time: 0.28 seconds
2025-11-06 17:49:11 - utils - INFO - Utility functions loaded successfully
2025-11-06 17:49:25 - utils - INFO - Loaded dataframe from /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv
2025-11-06 17:49:25 - utils - INFO - 
================================================================================
                          FEATURE ENGINEERING PIPELINE                          
================================================================================

2025-11-06 17:49:25 - utils - INFO - --- Starting Daily Features Pipeline (for LSTM) ---
2025-11-06 17:49:25 - utils - INFO - Creating temporal features...
2025-11-06 17:49:27 - utils - INFO - Temporal features created
2025-11-06 17:49:27 - utils - INFO - Creating user aggregated features with window: 1D
2025-11-06 17:49:30 - utils - INFO - Running aggregation...
2025-11-06 17:54:02 - utils - INFO - Utility functions loaded successfully
2025-11-06 17:54:17 - utils - INFO - Loaded dataframe from /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv
2025-11-06 17:54:17 - utils - INFO - 
================================================================================
                          FEATURE ENGINEERING PIPELINE                          
================================================================================

2025-11-06 17:54:17 - utils - INFO - --- Starting Daily Features Pipeline (for LSTM) ---
2025-11-06 17:54:17 - utils - INFO - Creating temporal features...
2025-11-06 17:54:19 - utils - INFO - Temporal features created
2025-11-06 17:54:19 - utils - INFO - Creating user aggregated features with window: 1D
2025-11-06 17:54:22 - utils - INFO - Running aggregation...
2025-11-06 17:54:30 - utils - INFO - Aggregating activity type counts (this may be slow)...
2025-11-06 17:54:30 - utils - INFO - Created 14 aggregated daily features
2025-11-06 17:54:33 - utils - INFO - Scaling daily features (fit=True)...
2025-11-06 17:54:33 - utils - INFO - Scaled 14 daily features
2025-11-06 17:54:33 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/daily_feature_scaler.pkl
2025-11-06 17:54:33 - utils - INFO - 
--- Starting Static Features Pipeline (for IF/Clustering) ---
2025-11-06 17:54:33 - utils - INFO - Creating statistical features per user...
2025-11-06 17:54:33 - utils - INFO - Created 70 statistical features
2025-11-06 17:54:33 - utils - INFO - Scaling static features (fit=True)...
2025-11-06 17:54:33 - utils - INFO - Scaled 70 static features
2025-11-06 17:54:33 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/static_feature_scaler.pkl
2025-11-06 17:54:33 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/label_encoders.pkl
2025-11-06 17:54:33 - utils - INFO - Static features (scaled) completed: 1000 samples, 70 features
2025-11-06 17:54:33 - utils - INFO - Daily features (scaled) completed: 331144 samples
2025-11-06 17:54:33 - utils - INFO - Saved dataframe to /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_static_features.csv
2025-11-06 17:54:35 - utils - INFO - Saved dataframe to /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_daily_features.csv
2025-11-06 17:54:35 - utils - INFO - Creating sequences from *scaled daily aggregated data*...
2025-11-06 17:54:35 - utils - INFO - Creating sequences from scaled daily data (length=15, stride=10)
2025-11-06 17:54:41 - utils - INFO - Created 32531 sequences from 1000 users
2025-11-06 17:54:41 - utils - INFO - Sequences saved for LSTM training
2025-11-06 17:55:13 - utils - INFO - Utility functions loaded successfully
2025-11-06 17:55:13 - utils - INFO - 
================================================================================
                           ISOLATION FOREST TRAINING                            
================================================================================

2025-11-06 17:55:13 - utils - INFO - Loaded dataframe from /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_static_features.csv
2025-11-06 17:55:13 - utils - INFO - Model loaded from /Users/bipinrimal/Downloads/Thesis_work/models/static_feature_scaler.pkl
2025-11-06 17:55:13 - utils - INFO - Data split: 1000 samples, 0 insiders
2025-11-06 17:55:13 - utils - INFO - Data split: Train=700, Val=150, Test=150
2025-11-06 17:55:13 - utils - INFO - Insider labels split: Train=0, Val=0, Test=0
2025-11-06 17:55:13 - utils - INFO - Model loaded from /Users/bipinrimal/Downloads/Thesis_work/models/static_feature_scaler.pkl
2025-11-06 17:55:13 - utils - INFO - Initialized Isolation Forest with params: {'n_estimators': 50, 'max_samples': 256, 'contamination': 0.01, 'max_features': 1.0, 'bootstrap': False, 'n_jobs': -1, 'random_state': 42, 'verbose': 0}
2025-11-06 17:55:13 - utils - INFO - Training Isolation Forest...
2025-11-06 17:55:13 - utils - INFO - Isolation Forest training completed
2025-11-06 17:55:13 - utils - INFO - Calibrating threshold for target FPR=0.05
2025-11-06 17:55:13 - utils - INFO - Calibrated threshold: 0.7208
2025-11-06 17:55:13 - utils - INFO - Evaluating Isolation Forest...
2025-11-06 17:55:13 - utils - INFO - 
============================================================
2025-11-06 17:55:13 - utils - INFO - Isolation Forest Performance Metrics
2025-11-06 17:55:13 - utils - INFO - ============================================================
2025-11-06 17:55:13 - utils - INFO - Accuracy:  0.9600
2025-11-06 17:55:13 - utils - INFO - Precision: 0.0000
2025-11-06 17:55:13 - utils - INFO - Recall:    0.0000
2025-11-06 17:55:13 - utils - INFO - F1-Score:  0.0000
2025-11-06 17:55:13 - utils - INFO - AUC-ROC:   nan
2025-11-06 17:55:13 - utils - INFO - ============================================================

2025-11-06 17:55:13 - utils - INFO - Saving Isolation Forest model to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest.pkl
2025-11-06 17:55:13 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest.pkl
2025-11-06 17:55:13 - utils - INFO - Isolation Forest training and evaluation completed!
2025-11-06 17:55:29 - utils - INFO - Utility functions loaded successfully
2025-11-06 17:55:29 - utils - INFO - 
================================================================================
                           ISOLATION FOREST TRAINING                            
================================================================================

2025-11-06 17:55:29 - utils - INFO - Loaded dataframe from /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_static_features.csv
2025-11-06 17:55:29 - utils - INFO - Model loaded from /Users/bipinrimal/Downloads/Thesis_work/models/static_feature_scaler.pkl
2025-11-06 17:55:29 - utils - INFO - Data split: 1000 samples, 0 insiders
2025-11-06 17:55:29 - utils - INFO - Data split: Train=700, Val=150, Test=150
2025-11-06 17:55:29 - utils - INFO - Insider labels split: Train=0, Val=0, Test=0
2025-11-06 17:55:29 - utils - INFO - Model loaded from /Users/bipinrimal/Downloads/Thesis_work/models/static_feature_scaler.pkl
2025-11-06 17:55:29 - utils - INFO - Initialized Isolation Forest with params: {'n_estimators': 50, 'max_samples': 256, 'contamination': 0.01, 'max_features': 1.0, 'bootstrap': False, 'n_jobs': -1, 'random_state': 42, 'verbose': 0}
2025-11-06 17:55:29 - utils - INFO - Training Isolation Forest...
2025-11-06 17:55:29 - utils - INFO - Isolation Forest training completed
2025-11-06 17:55:29 - utils - INFO - Calibrating threshold for target FPR=0.05
2025-11-06 17:55:29 - utils - INFO - Calibrated threshold: 0.7208
2025-11-06 17:55:29 - utils - INFO - Evaluating Isolation Forest...
2025-11-06 17:55:29 - utils - INFO - 
============================================================
2025-11-06 17:55:29 - utils - INFO - Isolation Forest Performance Metrics
2025-11-06 17:55:29 - utils - INFO - ============================================================
2025-11-06 17:55:29 - utils - INFO - Accuracy:  0.9600
2025-11-06 17:55:29 - utils - INFO - Precision: 0.0000
2025-11-06 17:55:29 - utils - INFO - Recall:    0.0000
2025-11-06 17:55:29 - utils - INFO - F1-Score:  0.0000
2025-11-06 17:55:29 - utils - INFO - AUC-ROC:   nan
2025-11-06 17:55:29 - utils - INFO - ============================================================

2025-11-06 17:55:29 - utils - INFO - Saving Isolation Forest model to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest.pkl
2025-11-06 17:55:29 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest.pkl
2025-11-06 17:55:29 - utils - INFO - Isolation Forest training and evaluation completed!
2025-11-06 17:55:37 - utils - INFO - Utility functions loaded successfully
2025-11-06 17:55:40 - utils - INFO - 
================================================================================
                      LIGHTWEIGHT DEEP CLUSTERING TRAINING                      
================================================================================

2025-11-06 17:55:40 - utils - INFO - Loaded dataframe from /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_static_features.csv
2025-11-06 17:55:40 - utils - INFO - Model loaded from /Users/bipinrimal/Downloads/Thesis_work/models/static_feature_scaler.pkl
2025-11-06 17:55:40 - utils - INFO - Dataset: 1000 samples, 70 features
2025-11-06 17:55:40 - utils - INFO - Data split: Train=700, Val=150, Test=150
2025-11-06 17:55:40 - utils - INFO - Insider labels split: Train=0, Val=0, Test=0
2025-11-06 17:55:40 - utils - INFO - Model loaded from /Users/bipinrimal/Downloads/Thesis_work/models/static_feature_scaler.pkl
2025-11-06 17:55:40 - utils - INFO - Initialized Lightweight Deep Clustering (n_clusters=5, encoding_dim=32)
2025-11-06 17:55:40 - utils - INFO - Training lightweight deep clustering model...
2025-11-06 17:55:40 - utils - INFO - Pre-training autoencoder...
2025-11-06 17:55:41 - utils - INFO - Autoencoder pre-training completed
2025-11-06 17:55:41 - utils - INFO - Fitting MiniBatch K-Means clustering...
2025-11-06 17:55:41 - utils - INFO - Lightweight deep clustering training completed
2025-11-06 17:55:41 - utils - INFO - Training completed in 1.15 seconds
2025-11-06 17:55:41 - utils - INFO - Calibrating threshold for target FPR=0.05
2025-11-06 17:55:41 - utils - INFO - Calibrated threshold: 0.1994
2025-11-06 17:55:41 - utils - INFO - Evaluating lightweight deep clustering model...
2025-11-06 17:55:41 - utils - INFO - 
============================================================
2025-11-06 17:55:41 - utils - INFO - Deep Clustering (Lightweight) Performance Metrics
2025-11-06 17:55:41 - utils - INFO - ============================================================
2025-11-06 17:55:41 - utils - INFO - Accuracy:  0.9933
2025-11-06 17:55:41 - utils - INFO - Precision: 0.0000
2025-11-06 17:55:41 - utils - INFO - Recall:    0.0000
2025-11-06 17:55:41 - utils - INFO - F1-Score:  0.0000
2025-11-06 17:55:41 - utils - INFO - AUC-ROC:   nan
2025-11-06 17:55:41 - utils - INFO - ============================================================

2025-11-06 17:55:41 - utils - INFO - Saving lightweight deep clustering model to /Users/bipinrimal/Downloads/Thesis_work/models/deep_clustering.pkl
2025-11-06 17:55:41 - utils - INFO - Encoder model saved to /Users/bipinrimal/Downloads/Thesis_work/models/deep_clustering_encoder.keras
2025-11-06 17:55:41 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/deep_clustering.pkl
2025-11-06 17:55:41 - utils - INFO - Lightweight deep clustering training and evaluation completed!
2025-11-06 17:55:41 - utils - INFO - Total time: 1.15 seconds
2025-11-06 17:55:52 - utils - INFO - Utility functions loaded successfully
2025-11-06 17:55:54 - utils - INFO - 
================================================================================
                     LIGHTWEIGHT LSTM AUTOENCODER TRAINING                      
================================================================================

2025-11-06 17:55:54 - utils - INFO - Loaded sequences: (32531, 15, 14)
2025-11-06 17:55:54 - utils - INFO - Data split: Train=22771, Val=4880, Test=4880
2025-11-06 17:55:54 - utils - INFO - Insider labels split: Train=0, Val=0, Test=0
2025-11-06 17:55:54 - utils - INFO - Training on 22771 normal sequences
2025-11-06 17:55:54 - utils - INFO - Model loaded from /Users/bipinrimal/Downloads/Thesis_work/models/daily_scaler.pkl
2025-11-06 17:55:54 - utils - INFO - Initialized Lightweight LSTM Autoencoder (15, 14)
2025-11-06 17:55:54 - utils - INFO - Training lightweight LSTM Autoencoder...
2025-11-06 17:55:54 - utils - INFO - Building lightweight LSTM Autoencoder...
2025-11-06 17:55:54 - utils - INFO - Model built with 18,270 parameters
2025-11-06 17:55:54 - utils - INFO - Training on 22771 sequences...
2025-11-06 17:56:21 - utils - INFO - Training completed
2025-11-06 17:56:21 - utils - INFO - Training completed in 27.58 seconds
2025-11-06 17:56:21 - utils - INFO - Calibrating threshold for target FPR=0.05
2025-11-06 17:56:22 - utils - INFO - Calibrated threshold: 0.0288
2025-11-06 17:56:22 - utils - INFO - Evaluating lightweight LSTM Autoencoder...
2025-11-06 17:56:22 - utils - INFO - 
============================================================
2025-11-06 17:56:22 - utils - INFO - LSTM Autoencoder (Lightweight) Performance Metrics
2025-11-06 17:56:22 - utils - INFO - ============================================================
2025-11-06 17:56:22 - utils - INFO - Accuracy:  0.8830
2025-11-06 17:56:22 - utils - INFO - Precision: 0.0000
2025-11-06 17:56:22 - utils - INFO - Recall:    0.0000
2025-11-06 17:56:22 - utils - INFO - F1-Score:  0.0000
2025-11-06 17:56:22 - utils - INFO - AUC-ROC:   nan
2025-11-06 17:56:22 - utils - INFO - ============================================================

2025-11-06 17:56:22 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/lstm_autoencoder.keras
2025-11-06 17:56:22 - utils - INFO - Lightweight LSTM Autoencoder completed!
2025-11-06 17:56:22 - utils - INFO - Total time: 27.58 seconds
2025-11-06 18:00:26 - utils - INFO - Utility functions loaded successfully
2025-11-06 18:00:26 - utils - INFO - 
================================================================================
                       MEMORY-EFFICIENT INSIDER LABELING                        
================================================================================

2025-11-06 18:00:26 - utils - INFO - Loaded 191 insider users from answers file
2025-11-06 18:00:26 - utils - INFO - Processing /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv in chunks of 50,000 rows...
2025-11-06 18:00:26 - utils - INFO - Scanning file...
2025-11-06 18:00:27 - utils - INFO - Total rows to process: 10,062,926
2025-11-06 18:00:27 - utils - INFO - Using user column: user_pseudo
2025-11-06 18:00:27 - utils - INFO - Pseudonymized insider user IDs for matching
2025-11-06 18:00:27 - utils - INFO - Progress: 50,000/10,062,926 (0.5%) - Labeled: 5
2025-11-06 18:00:28 - utils - INFO - Progress: 100,000/10,062,926 (1.0%) - Labeled: 12
2025-11-06 18:00:28 - utils - INFO - Progress: 150,000/10,062,926 (1.5%) - Labeled: 20
2025-11-06 18:00:28 - utils - INFO - Progress: 200,000/10,062,926 (2.0%) - Labeled: 24
2025-11-06 18:00:29 - utils - INFO - Progress: 250,000/10,062,926 (2.5%) - Labeled: 28
2025-11-06 18:00:29 - utils - INFO - Progress: 300,000/10,062,926 (3.0%) - Labeled: 36
2025-11-06 18:00:29 - utils - INFO - Progress: 350,000/10,062,926 (3.5%) - Labeled: 44
2025-11-06 18:00:30 - utils - INFO - Progress: 400,000/10,062,926 (4.0%) - Labeled: 49
2025-11-06 18:00:30 - utils - INFO - Progress: 450,000/10,062,926 (4.5%) - Labeled: 55
2025-11-06 18:00:30 - utils - INFO - Progress: 500,000/10,062,926 (5.0%) - Labeled: 59
2025-11-06 18:00:30 - utils - INFO - Progress: 550,000/10,062,926 (5.5%) - Labeled: 63
2025-11-06 18:00:31 - utils - INFO - Progress: 600,000/10,062,926 (6.0%) - Labeled: 68
2025-11-06 18:00:31 - utils - INFO - Progress: 650,000/10,062,926 (6.5%) - Labeled: 75
2025-11-06 18:00:31 - utils - INFO - Progress: 700,000/10,062,926 (7.0%) - Labeled: 83
2025-11-06 18:00:32 - utils - INFO - Progress: 750,000/10,062,926 (7.5%) - Labeled: 89
2025-11-06 18:00:32 - utils - INFO - Progress: 800,000/10,062,926 (7.9%) - Labeled: 94
2025-11-06 18:00:32 - utils - INFO - Progress: 850,000/10,062,926 (8.4%) - Labeled: 101
2025-11-06 18:00:33 - utils - INFO - Progress: 900,000/10,062,926 (8.9%) - Labeled: 107
2025-11-06 18:00:33 - utils - INFO - Progress: 950,000/10,062,926 (9.4%) - Labeled: 114
2025-11-06 18:00:33 - utils - INFO - Progress: 1,000,000/10,062,926 (9.9%) - Labeled: 125
2025-11-06 18:00:34 - utils - INFO - Progress: 1,050,000/10,062,926 (10.4%) - Labeled: 132
2025-11-06 18:00:34 - utils - INFO - Progress: 1,100,000/10,062,926 (10.9%) - Labeled: 135
2025-11-06 18:00:34 - utils - INFO - Progress: 1,150,000/10,062,926 (11.4%) - Labeled: 141
2025-11-06 18:00:34 - utils - INFO - Progress: 1,200,000/10,062,926 (11.9%) - Labeled: 150
2025-11-06 18:00:35 - utils - INFO - Progress: 1,250,000/10,062,926 (12.4%) - Labeled: 155
2025-11-06 18:00:35 - utils - INFO - Progress: 1,300,000/10,062,926 (12.9%) - Labeled: 160
2025-11-06 18:00:35 - utils - INFO - Progress: 1,350,000/10,062,926 (13.4%) - Labeled: 171
2025-11-06 18:00:36 - utils - INFO - Progress: 1,400,000/10,062,926 (13.9%) - Labeled: 185
2025-11-06 18:00:36 - utils - INFO - Progress: 1,450,000/10,062,926 (14.4%) - Labeled: 189
2025-11-06 18:00:36 - utils - INFO - Progress: 1,500,000/10,062,926 (14.9%) - Labeled: 202
2025-11-06 18:00:37 - utils - INFO - Progress: 1,550,000/10,062,926 (15.4%) - Labeled: 210
2025-11-06 18:00:37 - utils - INFO - Progress: 1,600,000/10,062,926 (15.9%) - Labeled: 216
2025-11-06 18:00:37 - utils - INFO - Progress: 1,650,000/10,062,926 (16.4%) - Labeled: 226
2025-11-06 18:00:38 - utils - INFO - Progress: 1,700,000/10,062,926 (16.9%) - Labeled: 241
2025-11-06 18:00:38 - utils - INFO - Progress: 1,750,000/10,062,926 (17.4%) - Labeled: 246
2025-11-06 18:00:38 - utils - INFO - Progress: 1,800,000/10,062,926 (17.9%) - Labeled: 254
2025-11-06 18:00:39 - utils - INFO - Progress: 1,850,000/10,062,926 (18.4%) - Labeled: 261
2025-11-06 18:00:39 - utils - INFO - Progress: 1,900,000/10,062,926 (18.9%) - Labeled: 266
2025-11-06 18:00:39 - utils - INFO - Progress: 1,950,000/10,062,926 (19.4%) - Labeled: 269
2025-11-06 18:00:39 - utils - INFO - Progress: 2,000,000/10,062,926 (19.9%) - Labeled: 269
2025-11-06 18:00:40 - utils - INFO - Progress: 2,050,000/10,062,926 (20.4%) - Labeled: 269
2025-11-06 18:00:40 - utils - INFO - Progress: 2,100,000/10,062,926 (20.9%) - Labeled: 269
2025-11-06 18:00:40 - utils - INFO - Progress: 2,150,000/10,062,926 (21.4%) - Labeled: 269
2025-11-06 18:00:41 - utils - INFO - Progress: 2,200,000/10,062,926 (21.9%) - Labeled: 269
2025-11-06 18:00:41 - utils - INFO - Progress: 2,250,000/10,062,926 (22.4%) - Labeled: 269
2025-11-06 18:00:41 - utils - INFO - Progress: 2,300,000/10,062,926 (22.9%) - Labeled: 269
2025-11-06 18:00:42 - utils - INFO - Progress: 2,350,000/10,062,926 (23.4%) - Labeled: 269
2025-11-06 18:00:42 - utils - INFO - Progress: 2,400,000/10,062,926 (23.8%) - Labeled: 269
2025-11-06 18:00:42 - utils - INFO - Progress: 2,450,000/10,062,926 (24.3%) - Labeled: 269
2025-11-06 18:00:43 - utils - INFO - Progress: 2,500,000/10,062,926 (24.8%) - Labeled: 269
2025-11-06 18:00:43 - utils - INFO - Progress: 2,550,000/10,062,926 (25.3%) - Labeled: 269
2025-11-06 18:00:43 - utils - INFO - Progress: 2,600,000/10,062,926 (25.8%) - Labeled: 269
2025-11-06 18:00:43 - utils - INFO - Progress: 2,650,000/10,062,926 (26.3%) - Labeled: 269
2025-11-06 18:00:44 - utils - INFO - Progress: 2,700,000/10,062,926 (26.8%) - Labeled: 269
2025-11-06 18:00:44 - utils - INFO - Progress: 2,750,000/10,062,926 (27.3%) - Labeled: 269
2025-11-06 18:00:44 - utils - INFO - Progress: 2,800,000/10,062,926 (27.8%) - Labeled: 269
2025-11-06 18:00:45 - utils - INFO - Progress: 2,850,000/10,062,926 (28.3%) - Labeled: 269
2025-11-06 18:00:45 - utils - INFO - Progress: 2,900,000/10,062,926 (28.8%) - Labeled: 269
2025-11-06 18:00:45 - utils - INFO - Progress: 2,950,000/10,062,926 (29.3%) - Labeled: 269
2025-11-06 18:00:46 - utils - INFO - Progress: 3,000,000/10,062,926 (29.8%) - Labeled: 269
2025-11-06 18:00:46 - utils - INFO - Progress: 3,050,000/10,062,926 (30.3%) - Labeled: 269
2025-11-06 18:00:46 - utils - INFO - Progress: 3,100,000/10,062,926 (30.8%) - Labeled: 269
2025-11-06 18:00:47 - utils - INFO - Progress: 3,150,000/10,062,926 (31.3%) - Labeled: 269
2025-11-06 18:00:47 - utils - INFO - Progress: 3,200,000/10,062,926 (31.8%) - Labeled: 269
2025-11-06 18:00:47 - utils - INFO - Progress: 3,250,000/10,062,926 (32.3%) - Labeled: 269
2025-11-06 18:00:48 - utils - INFO - Progress: 3,300,000/10,062,926 (32.8%) - Labeled: 269
2025-11-06 18:00:48 - utils - INFO - Progress: 3,350,000/10,062,926 (33.3%) - Labeled: 269
2025-11-06 18:00:48 - utils - INFO - Progress: 3,400,000/10,062,926 (33.8%) - Labeled: 269
2025-11-06 18:00:48 - utils - INFO - Progress: 3,450,000/10,062,926 (34.3%) - Labeled: 269
2025-11-06 18:00:49 - utils - INFO - Progress: 3,500,000/10,062,926 (34.8%) - Labeled: 269
2025-11-06 18:00:49 - utils - INFO - Progress: 3,550,000/10,062,926 (35.3%) - Labeled: 269
2025-11-06 18:00:49 - utils - INFO - Progress: 3,600,000/10,062,926 (35.8%) - Labeled: 269
2025-11-06 18:00:50 - utils - INFO - Progress: 3,650,000/10,062,926 (36.3%) - Labeled: 269
2025-11-06 18:00:50 - utils - INFO - Progress: 3,700,000/10,062,926 (36.8%) - Labeled: 269
2025-11-06 18:00:50 - utils - INFO - Progress: 3,750,000/10,062,926 (37.3%) - Labeled: 269
2025-11-06 18:00:51 - utils - INFO - Progress: 3,800,000/10,062,926 (37.8%) - Labeled: 269
2025-11-06 18:00:51 - utils - INFO - Progress: 3,850,000/10,062,926 (38.3%) - Labeled: 269
2025-11-06 18:00:51 - utils - INFO - Progress: 3,900,000/10,062,926 (38.8%) - Labeled: 269
2025-11-06 18:00:52 - utils - INFO - Progress: 3,950,000/10,062,926 (39.3%) - Labeled: 269
2025-11-06 18:00:52 - utils - INFO - Progress: 4,000,000/10,062,926 (39.7%) - Labeled: 269
2025-11-06 18:00:52 - utils - INFO - Progress: 4,050,000/10,062,926 (40.2%) - Labeled: 269
2025-11-06 18:00:52 - utils - INFO - Progress: 4,100,000/10,062,926 (40.7%) - Labeled: 269
2025-11-06 18:00:53 - utils - INFO - Progress: 4,150,000/10,062,926 (41.2%) - Labeled: 269
2025-11-06 18:00:53 - utils - INFO - Progress: 4,200,000/10,062,926 (41.7%) - Labeled: 269
2025-11-06 18:00:53 - utils - INFO - Progress: 4,250,000/10,062,926 (42.2%) - Labeled: 269
2025-11-06 18:00:54 - utils - INFO - Progress: 4,300,000/10,062,926 (42.7%) - Labeled: 269
2025-11-06 18:00:54 - utils - INFO - Progress: 4,350,000/10,062,926 (43.2%) - Labeled: 269
2025-11-06 18:00:54 - utils - INFO - Progress: 4,400,000/10,062,926 (43.7%) - Labeled: 269
2025-11-06 18:00:55 - utils - INFO - Progress: 4,450,000/10,062,926 (44.2%) - Labeled: 269
2025-11-06 18:00:55 - utils - INFO - Progress: 4,500,000/10,062,926 (44.7%) - Labeled: 269
2025-11-06 18:00:55 - utils - INFO - Progress: 4,550,000/10,062,926 (45.2%) - Labeled: 269
2025-11-06 18:00:56 - utils - INFO - Progress: 4,600,000/10,062,926 (45.7%) - Labeled: 269
2025-11-06 18:00:56 - utils - INFO - Progress: 4,650,000/10,062,926 (46.2%) - Labeled: 269
2025-11-06 18:00:56 - utils - INFO - Progress: 4,700,000/10,062,926 (46.7%) - Labeled: 269
2025-11-06 18:00:57 - utils - INFO - Progress: 4,750,000/10,062,926 (47.2%) - Labeled: 269
2025-11-06 18:00:57 - utils - INFO - Progress: 4,800,000/10,062,926 (47.7%) - Labeled: 269
2025-11-06 18:00:57 - utils - INFO - Progress: 4,850,000/10,062,926 (48.2%) - Labeled: 269
2025-11-06 18:00:57 - utils - INFO - Progress: 4,900,000/10,062,926 (48.7%) - Labeled: 269
2025-11-06 18:00:58 - utils - INFO - Progress: 4,950,000/10,062,926 (49.2%) - Labeled: 269
2025-11-06 18:00:58 - utils - INFO - Progress: 5,000,000/10,062,926 (49.7%) - Labeled: 269
2025-11-06 18:00:58 - utils - INFO - Progress: 5,050,000/10,062,926 (50.2%) - Labeled: 269
2025-11-06 18:00:59 - utils - INFO - Progress: 5,100,000/10,062,926 (50.7%) - Labeled: 269
2025-11-06 18:00:59 - utils - INFO - Progress: 5,150,000/10,062,926 (51.2%) - Labeled: 269
2025-11-06 18:00:59 - utils - INFO - Progress: 5,200,000/10,062,926 (51.7%) - Labeled: 269
2025-11-06 18:01:00 - utils - INFO - Progress: 5,250,000/10,062,926 (52.2%) - Labeled: 269
2025-11-06 18:01:00 - utils - INFO - Progress: 5,300,000/10,062,926 (52.7%) - Labeled: 269
2025-11-06 18:01:00 - utils - INFO - Progress: 5,350,000/10,062,926 (53.2%) - Labeled: 269
2025-11-06 18:01:01 - utils - INFO - Progress: 5,400,000/10,062,926 (53.7%) - Labeled: 269
2025-11-06 18:01:01 - utils - INFO - Progress: 5,450,000/10,062,926 (54.2%) - Labeled: 269
2025-11-06 18:01:01 - utils - INFO - Progress: 5,500,000/10,062,926 (54.7%) - Labeled: 269
2025-11-06 18:01:02 - utils - INFO - Progress: 5,550,000/10,062,926 (55.2%) - Labeled: 269
2025-11-06 18:01:02 - utils - INFO - Progress: 5,600,000/10,062,926 (55.6%) - Labeled: 269
2025-11-06 18:01:02 - utils - INFO - Progress: 5,650,000/10,062,926 (56.1%) - Labeled: 269
2025-11-06 18:01:02 - utils - INFO - Progress: 5,700,000/10,062,926 (56.6%) - Labeled: 269
2025-11-06 18:01:03 - utils - INFO - Progress: 5,750,000/10,062,926 (57.1%) - Labeled: 269
2025-11-06 18:01:03 - utils - INFO - Progress: 5,800,000/10,062,926 (57.6%) - Labeled: 269
2025-11-06 18:01:03 - utils - INFO - Progress: 5,850,000/10,062,926 (58.1%) - Labeled: 269
2025-11-06 18:01:04 - utils - INFO - Progress: 5,900,000/10,062,926 (58.6%) - Labeled: 269
2025-11-06 18:01:04 - utils - INFO - Progress: 5,950,000/10,062,926 (59.1%) - Labeled: 269
2025-11-06 18:01:04 - utils - INFO - Progress: 6,000,000/10,062,926 (59.6%) - Labeled: 269
2025-11-06 18:01:05 - utils - INFO - Progress: 6,050,000/10,062,926 (60.1%) - Labeled: 269
2025-11-06 18:01:05 - utils - INFO - Progress: 6,100,000/10,062,926 (60.6%) - Labeled: 269
2025-11-06 18:01:05 - utils - INFO - Progress: 6,150,000/10,062,926 (61.1%) - Labeled: 269
2025-11-06 18:01:06 - utils - INFO - Progress: 6,200,000/10,062,926 (61.6%) - Labeled: 269
2025-11-06 18:01:06 - utils - INFO - Progress: 6,250,000/10,062,926 (62.1%) - Labeled: 269
2025-11-06 18:01:06 - utils - INFO - Progress: 6,300,000/10,062,926 (62.6%) - Labeled: 269
2025-11-06 18:01:07 - utils - INFO - Progress: 6,350,000/10,062,926 (63.1%) - Labeled: 269
2025-11-06 18:01:07 - utils - INFO - Progress: 6,400,000/10,062,926 (63.6%) - Labeled: 269
2025-11-06 18:01:07 - utils - INFO - Progress: 6,450,000/10,062,926 (64.1%) - Labeled: 269
2025-11-06 18:01:07 - utils - INFO - Progress: 6,500,000/10,062,926 (64.6%) - Labeled: 269
2025-11-06 18:01:08 - utils - INFO - Progress: 6,550,000/10,062,926 (65.1%) - Labeled: 269
2025-11-06 18:01:08 - utils - INFO - Progress: 6,600,000/10,062,926 (65.6%) - Labeled: 269
2025-11-06 18:01:08 - utils - INFO - Progress: 6,650,000/10,062,926 (66.1%) - Labeled: 269
2025-11-06 18:01:09 - utils - INFO - Progress: 6,700,000/10,062,926 (66.6%) - Labeled: 269
2025-11-06 18:01:09 - utils - INFO - Progress: 6,750,000/10,062,926 (67.1%) - Labeled: 269
2025-11-06 18:01:09 - utils - INFO - Progress: 6,800,000/10,062,926 (67.6%) - Labeled: 269
2025-11-06 18:01:10 - utils - INFO - Progress: 6,850,000/10,062,926 (68.1%) - Labeled: 269
2025-11-06 18:01:10 - utils - INFO - Progress: 6,900,000/10,062,926 (68.6%) - Labeled: 269
2025-11-06 18:01:10 - utils - INFO - Progress: 6,950,000/10,062,926 (69.1%) - Labeled: 269
2025-11-06 18:01:11 - utils - INFO - Progress: 7,000,000/10,062,926 (69.6%) - Labeled: 269
2025-11-06 18:01:11 - utils - INFO - Progress: 7,050,000/10,062,926 (70.1%) - Labeled: 269
2025-11-06 18:01:11 - utils - INFO - Progress: 7,100,000/10,062,926 (70.6%) - Labeled: 269
2025-11-06 18:01:12 - utils - INFO - Progress: 7,150,000/10,062,926 (71.1%) - Labeled: 269
2025-11-06 18:01:12 - utils - INFO - Progress: 7,200,000/10,062,926 (71.5%) - Labeled: 269
2025-11-06 18:01:12 - utils - INFO - Progress: 7,250,000/10,062,926 (72.0%) - Labeled: 269
2025-11-06 18:01:12 - utils - INFO - Progress: 7,300,000/10,062,926 (72.5%) - Labeled: 269
2025-11-06 18:01:13 - utils - INFO - Progress: 7,350,000/10,062,926 (73.0%) - Labeled: 269
2025-11-06 18:01:13 - utils - INFO - Progress: 7,400,000/10,062,926 (73.5%) - Labeled: 269
2025-11-06 18:01:13 - utils - INFO - Progress: 7,450,000/10,062,926 (74.0%) - Labeled: 269
2025-11-06 18:01:14 - utils - INFO - Progress: 7,500,000/10,062,926 (74.5%) - Labeled: 269
2025-11-06 18:01:14 - utils - INFO - Progress: 7,550,000/10,062,926 (75.0%) - Labeled: 269
2025-11-06 18:01:14 - utils - INFO - Progress: 7,600,000/10,062,926 (75.5%) - Labeled: 269
2025-11-06 18:01:15 - utils - INFO - Progress: 7,650,000/10,062,926 (76.0%) - Labeled: 269
2025-11-06 18:01:15 - utils - INFO - Progress: 7,700,000/10,062,926 (76.5%) - Labeled: 269
2025-11-06 18:01:15 - utils - INFO - Progress: 7,750,000/10,062,926 (77.0%) - Labeled: 269
2025-11-06 18:01:16 - utils - INFO - Progress: 7,800,000/10,062,926 (77.5%) - Labeled: 269
2025-11-06 18:01:16 - utils - INFO - Progress: 7,850,000/10,062,926 (78.0%) - Labeled: 269
2025-11-06 18:01:16 - utils - INFO - Progress: 7,900,000/10,062,926 (78.5%) - Labeled: 269
2025-11-06 18:01:17 - utils - INFO - Progress: 7,950,000/10,062,926 (79.0%) - Labeled: 269
2025-11-06 18:01:17 - utils - INFO - Progress: 8,000,000/10,062,926 (79.5%) - Labeled: 269
2025-11-06 18:01:17 - utils - INFO - Progress: 8,050,000/10,062,926 (80.0%) - Labeled: 269
2025-11-06 18:01:17 - utils - INFO - Progress: 8,100,000/10,062,926 (80.5%) - Labeled: 269
2025-11-06 18:01:18 - utils - INFO - Progress: 8,150,000/10,062,926 (81.0%) - Labeled: 269
2025-11-06 18:01:18 - utils - INFO - Progress: 8,200,000/10,062,926 (81.5%) - Labeled: 269
2025-11-06 18:01:18 - utils - INFO - Progress: 8,250,000/10,062,926 (82.0%) - Labeled: 269
2025-11-06 18:01:19 - utils - INFO - Progress: 8,300,000/10,062,926 (82.5%) - Labeled: 269
2025-11-06 18:01:19 - utils - INFO - Progress: 8,350,000/10,062,926 (83.0%) - Labeled: 269
2025-11-06 18:01:19 - utils - INFO - Progress: 8,400,000/10,062,926 (83.5%) - Labeled: 269
2025-11-06 18:01:20 - utils - INFO - Progress: 8,450,000/10,062,926 (84.0%) - Labeled: 269
2025-11-06 18:01:20 - utils - INFO - Progress: 8,500,000/10,062,926 (84.5%) - Labeled: 269
2025-11-06 18:01:20 - utils - INFO - Progress: 8,550,000/10,062,926 (85.0%) - Labeled: 269
2025-11-06 18:01:21 - utils - INFO - Progress: 8,600,000/10,062,926 (85.5%) - Labeled: 269
2025-11-06 18:01:21 - utils - INFO - Progress: 8,650,000/10,062,926 (86.0%) - Labeled: 269
2025-11-06 18:01:21 - utils - INFO - Progress: 8,700,000/10,062,926 (86.5%) - Labeled: 269
2025-11-06 18:01:22 - utils - INFO - Progress: 8,750,000/10,062,926 (87.0%) - Labeled: 269
2025-11-06 18:01:22 - utils - INFO - Progress: 8,800,000/10,062,926 (87.4%) - Labeled: 269
2025-11-06 18:01:22 - utils - INFO - Progress: 8,850,000/10,062,926 (87.9%) - Labeled: 269
2025-11-06 18:01:22 - utils - INFO - Progress: 8,900,000/10,062,926 (88.4%) - Labeled: 269
2025-11-06 18:01:23 - utils - INFO - Progress: 8,950,000/10,062,926 (88.9%) - Labeled: 269
2025-11-06 18:01:23 - utils - INFO - Progress: 9,000,000/10,062,926 (89.4%) - Labeled: 269
2025-11-06 18:01:23 - utils - INFO - Progress: 9,050,000/10,062,926 (89.9%) - Labeled: 269
2025-11-06 18:01:24 - utils - INFO - Progress: 9,100,000/10,062,926 (90.4%) - Labeled: 269
2025-11-06 18:01:24 - utils - INFO - Progress: 9,150,000/10,062,926 (90.9%) - Labeled: 269
2025-11-06 18:01:24 - utils - INFO - Progress: 9,200,000/10,062,926 (91.4%) - Labeled: 269
2025-11-06 18:01:25 - utils - INFO - Progress: 9,250,000/10,062,926 (91.9%) - Labeled: 269
2025-11-06 18:01:25 - utils - INFO - Progress: 9,300,000/10,062,926 (92.4%) - Labeled: 269
2025-11-06 18:01:25 - utils - INFO - Progress: 9,350,000/10,062,926 (92.9%) - Labeled: 269
2025-11-06 18:01:26 - utils - INFO - Progress: 9,400,000/10,062,926 (93.4%) - Labeled: 269
2025-11-06 18:01:26 - utils - INFO - Progress: 9,450,000/10,062,926 (93.9%) - Labeled: 269
2025-11-06 18:01:26 - utils - INFO - Progress: 9,500,000/10,062,926 (94.4%) - Labeled: 269
2025-11-06 18:01:27 - utils - INFO - Progress: 9,550,000/10,062,926 (94.9%) - Labeled: 269
2025-11-06 18:01:27 - utils - INFO - Progress: 9,600,000/10,062,926 (95.4%) - Labeled: 269
2025-11-06 18:01:27 - utils - INFO - Progress: 9,650,000/10,062,926 (95.9%) - Labeled: 269
2025-11-06 18:01:27 - utils - INFO - Progress: 9,700,000/10,062,926 (96.4%) - Labeled: 269
2025-11-06 18:01:28 - utils - INFO - Progress: 9,750,000/10,062,926 (96.9%) - Labeled: 269
2025-11-06 18:01:28 - utils - INFO - Progress: 9,800,000/10,062,926 (97.4%) - Labeled: 269
2025-11-06 18:01:28 - utils - INFO - Progress: 9,850,000/10,062,926 (97.9%) - Labeled: 269
2025-11-06 18:01:29 - utils - INFO - Progress: 9,900,000/10,062,926 (98.4%) - Labeled: 269
2025-11-06 18:01:29 - utils - INFO - Progress: 9,950,000/10,062,926 (98.9%) - Labeled: 269
2025-11-06 18:01:29 - utils - INFO - Progress: 10,000,000/10,062,926 (99.4%) - Labeled: 269
2025-11-06 18:01:30 - utils - INFO - Progress: 10,050,000/10,062,926 (99.9%) - Labeled: 269
2025-11-06 18:01:30 - utils - INFO - Progress: 10,062,926/10,062,926 (100.0%) - Labeled: 269
2025-11-06 18:01:30 - utils - INFO - 
Labeling complete!
2025-11-06 18:01:30 - utils - INFO -   Total rows:     10,062,926
2025-11-06 18:01:30 - utils - INFO -   Insider rows:   269 (0.0027%)
2025-11-06 18:01:30 - utils - INFO -   Normal rows:    10,062,657 (100.00%)
2025-11-06 18:01:30 - utils - INFO - 
Verifying labels (sampling 10,000 rows)...
2025-11-06 18:01:39 - utils - INFO - Sample statistics:
2025-11-06 18:01:39 - utils - INFO -   Normal (0):   9,999
2025-11-06 18:01:39 - utils - INFO -   Insider (1):  1
2025-11-06 18:01:39 - utils - INFO -   Unique insiders in sample: 1
2025-11-06 18:01:39 - utils - INFO - 
Replacing original file with labeled version...
2025-11-06 18:03:44 - utils - INFO - Utility functions loaded successfully
2025-11-06 18:03:59 - utils - INFO - Loaded dataframe from /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv
2025-11-06 18:03:59 - utils - INFO - 
================================================================================
                          FEATURE ENGINEERING PIPELINE                          
================================================================================

2025-11-06 18:03:59 - utils - INFO - --- Starting Daily Features Pipeline (for LSTM) ---
2025-11-06 18:03:59 - utils - INFO - Creating temporal features...
2025-11-06 18:04:01 - utils - INFO - Temporal features created
2025-11-06 18:04:01 - utils - INFO - Creating user aggregated features with window: 1D
2025-11-06 18:04:04 - utils - INFO - Running aggregation...
2025-11-06 18:04:11 - utils - INFO - Aggregating activity type counts (this may be slow)...
2025-11-06 18:04:12 - utils - INFO - Created 14 aggregated daily features
2025-11-06 18:04:15 - utils - INFO - Scaling daily features (fit=True)...
2025-11-06 18:04:15 - utils - INFO - Scaled 14 daily features
2025-11-06 18:04:15 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/daily_feature_scaler.pkl
2025-11-06 18:04:15 - utils - INFO - 
--- Starting Static Features Pipeline (for IF/Clustering) ---
2025-11-06 18:04:15 - utils - INFO - Creating statistical features per user...
2025-11-06 18:04:15 - utils - INFO - Created 70 statistical features
2025-11-06 18:04:15 - utils - INFO - Scaling static features (fit=True)...
2025-11-06 18:04:15 - utils - INFO - Scaled 70 static features
2025-11-06 18:04:15 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/static_feature_scaler.pkl
2025-11-06 18:04:15 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/label_encoders.pkl
2025-11-06 18:04:15 - utils - INFO - Static features (scaled) completed: 1000 samples, 70 features
2025-11-06 18:04:15 - utils - INFO - Daily features (scaled) completed: 331144 samples
2025-11-06 18:04:15 - utils - INFO - Saved dataframe to /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_static_features.csv
2025-11-06 18:04:17 - utils - INFO - Saved dataframe to /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_daily_features.csv
2025-11-06 18:04:17 - utils - INFO - Creating sequences from *scaled daily aggregated data*...
2025-11-06 18:04:17 - utils - INFO - Creating sequences from scaled daily data (length=15, stride=10)
2025-11-06 18:04:23 - utils - INFO - Created 32531 sequences from 1000 users
2025-11-06 18:04:23 - utils - INFO - Sequences saved for LSTM training
2025-11-06 18:04:53 - utils - INFO - Utility functions loaded successfully
2025-11-06 18:04:53 - utils - INFO - 
================================================================================
                           ISOLATION FOREST TRAINING                            
================================================================================

2025-11-06 18:04:53 - utils - INFO - Loaded dataframe from /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_static_features.csv
2025-11-06 18:04:53 - utils - INFO - Model loaded from /Users/bipinrimal/Downloads/Thesis_work/models/static_feature_scaler.pkl
2025-11-06 18:04:53 - utils - INFO - Data split: 1000 samples, 1 insiders
2025-11-06 18:04:53 - utils - INFO - Data split: Train=700, Val=150, Test=150
2025-11-06 18:04:53 - utils - INFO - Insider labels split: Train=1, Val=0, Test=0
2025-11-06 18:04:53 - utils - INFO - Model loaded from /Users/bipinrimal/Downloads/Thesis_work/models/static_feature_scaler.pkl
2025-11-06 18:04:53 - utils - INFO - Initialized Isolation Forest with params: {'n_estimators': 50, 'max_samples': 256, 'contamination': 0.01, 'max_features': 1.0, 'bootstrap': False, 'n_jobs': -1, 'random_state': 42, 'verbose': 0}
2025-11-06 18:04:53 - utils - INFO - Training Isolation Forest...
2025-11-06 18:04:53 - utils - INFO - Isolation Forest training completed
2025-11-06 18:04:53 - utils - INFO - Calibrating threshold for target FPR=0.05
2025-11-06 18:04:53 - utils - INFO - Calibrated threshold: 0.6307
2025-11-06 18:04:53 - utils - INFO - Evaluating Isolation Forest...
2025-11-06 18:04:53 - utils - INFO - 
============================================================
2025-11-06 18:04:53 - utils - INFO - Isolation Forest Performance Metrics
2025-11-06 18:04:53 - utils - INFO - ============================================================
2025-11-06 18:04:53 - utils - INFO - Accuracy:  0.9267
2025-11-06 18:04:53 - utils - INFO - Precision: 0.0000
2025-11-06 18:04:53 - utils - INFO - Recall:    0.0000
2025-11-06 18:04:53 - utils - INFO - F1-Score:  0.0000
2025-11-06 18:04:53 - utils - INFO - AUC-ROC:   nan
2025-11-06 18:04:53 - utils - INFO - ============================================================

2025-11-06 18:04:53 - utils - INFO - Saving Isolation Forest model to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest.pkl
2025-11-06 18:04:53 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest.pkl
2025-11-06 18:04:53 - utils - INFO - Isolation Forest training and evaluation completed!
2025-11-06 18:05:00 - utils - INFO - Utility functions loaded successfully
2025-11-06 18:05:03 - utils - INFO - 
================================================================================
                      LIGHTWEIGHT DEEP CLUSTERING TRAINING                      
================================================================================

2025-11-06 18:05:03 - utils - INFO - Loaded dataframe from /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_static_features.csv
2025-11-06 18:05:03 - utils - INFO - Model loaded from /Users/bipinrimal/Downloads/Thesis_work/models/static_feature_scaler.pkl
2025-11-06 18:05:03 - utils - INFO - Dataset: 1000 samples, 70 features
2025-11-06 18:05:03 - utils - INFO - Data split: Train=700, Val=150, Test=150
2025-11-06 18:05:03 - utils - INFO - Insider labels split: Train=1, Val=0, Test=0
2025-11-06 18:05:03 - utils - INFO - Model loaded from /Users/bipinrimal/Downloads/Thesis_work/models/static_feature_scaler.pkl
2025-11-06 18:05:03 - utils - INFO - Initialized Lightweight Deep Clustering (n_clusters=5, encoding_dim=32)
2025-11-06 18:05:03 - utils - INFO - Training lightweight deep clustering model...
2025-11-06 18:05:03 - utils - INFO - Pre-training autoencoder...
2025-11-06 18:05:04 - utils - INFO - Autoencoder pre-training completed
2025-11-06 18:05:04 - utils - INFO - Fitting MiniBatch K-Means clustering...
2025-11-06 18:05:04 - utils - INFO - Lightweight deep clustering training completed
2025-11-06 18:05:04 - utils - INFO - Training completed in 1.14 seconds
2025-11-06 18:05:04 - utils - INFO - Calibrating threshold for target FPR=0.05
2025-11-06 18:05:04 - utils - INFO - Calibrated threshold: 0.3268
2025-11-06 18:05:04 - utils - INFO - Evaluating lightweight deep clustering model...
2025-11-06 18:05:04 - utils - INFO - 
============================================================
2025-11-06 18:05:04 - utils - INFO - Deep Clustering (Lightweight) Performance Metrics
2025-11-06 18:05:04 - utils - INFO - ============================================================
2025-11-06 18:05:04 - utils - INFO - Accuracy:  0.9933
2025-11-06 18:05:04 - utils - INFO - Precision: 0.0000
2025-11-06 18:05:04 - utils - INFO - Recall:    0.0000
2025-11-06 18:05:04 - utils - INFO - F1-Score:  0.0000
2025-11-06 18:05:04 - utils - INFO - AUC-ROC:   nan
2025-11-06 18:05:04 - utils - INFO - ============================================================

2025-11-06 18:05:04 - utils - INFO - Saving lightweight deep clustering model to /Users/bipinrimal/Downloads/Thesis_work/models/deep_clustering.pkl
2025-11-06 18:05:04 - utils - INFO - Encoder model saved to /Users/bipinrimal/Downloads/Thesis_work/models/deep_clustering_encoder.keras
2025-11-06 18:05:04 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/deep_clustering.pkl
2025-11-06 18:05:04 - utils - INFO - Lightweight deep clustering training and evaluation completed!
2025-11-06 18:05:04 - utils - INFO - Total time: 1.14 seconds
2025-11-06 18:05:14 - utils - INFO - Utility functions loaded successfully
2025-11-06 18:05:16 - utils - INFO - 
================================================================================
                     LIGHTWEIGHT LSTM AUTOENCODER TRAINING                      
================================================================================

2025-11-06 18:05:16 - utils - INFO - Loaded sequences: (32531, 15, 14)
2025-11-06 18:05:16 - utils - INFO - Data split: Train=22771, Val=4880, Test=4880
2025-11-06 18:05:16 - utils - INFO - Insider labels split: Train=4, Val=1, Test=1
2025-11-06 18:05:16 - utils - INFO - Training on 22767 normal sequences
2025-11-06 18:05:16 - utils - INFO - Model loaded from /Users/bipinrimal/Downloads/Thesis_work/models/daily_scaler.pkl
2025-11-06 18:05:16 - utils - INFO - Initialized Lightweight LSTM Autoencoder (15, 14)
2025-11-06 18:05:16 - utils - INFO - Training lightweight LSTM Autoencoder...
2025-11-06 18:05:16 - utils - INFO - Building lightweight LSTM Autoencoder...
2025-11-06 18:05:16 - utils - INFO - Model built with 18,270 parameters
2025-11-06 18:05:16 - utils - INFO - Training on 22767 sequences...
2025-11-06 18:05:44 - utils - INFO - Training completed
2025-11-06 18:05:44 - utils - INFO - Training completed in 27.95 seconds
2025-11-06 18:05:44 - utils - INFO - Calibrating threshold for target FPR=0.05
2025-11-06 18:05:44 - utils - INFO - Calibrated threshold: 0.0377
2025-11-06 18:05:44 - utils - INFO - Evaluating lightweight LSTM Autoencoder...
2025-11-06 18:05:45 - utils - INFO - 
============================================================
2025-11-06 18:05:45 - utils - INFO - LSTM Autoencoder (Lightweight) Performance Metrics
2025-11-06 18:05:45 - utils - INFO - ============================================================
2025-11-06 18:05:45 - utils - INFO - Accuracy:  0.9611
2025-11-06 18:05:45 - utils - INFO - Precision: 0.0052
2025-11-06 18:05:45 - utils - INFO - Recall:    1.0000
2025-11-06 18:05:45 - utils - INFO - F1-Score:  0.0104
2025-11-06 18:05:45 - utils - INFO - AUC-ROC:   0.9824
2025-11-06 18:05:45 - utils - INFO - ============================================================

2025-11-06 18:05:45 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/lstm_autoencoder.keras
2025-11-06 18:05:45 - utils - INFO - Lightweight LSTM Autoencoder completed!
2025-11-06 18:05:45 - utils - INFO - Total time: 27.95 seconds
2025-11-06 18:06:36 - utils - INFO - Utility functions loaded successfully
2025-11-06 18:06:39 - utils - INFO - ================================================================================
2025-11-06 18:06:39 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-11-06 18:06:39 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-11-06 18:06:39 - utils - INFO - ================================================================================
2025-11-06 18:06:39 - utils - INFO - 
================================================================================
                           STAGE 4: MODEL EVALUATION                            
================================================================================

2025-11-06 18:06:39 - utils - INFO - 
================================================================================
                         COMPREHENSIVE MODEL EVALUATION                         
================================================================================

2025-11-06 18:06:39 - utils - INFO - Loading results for all models...
2025-11-06 18:06:39 - utils - INFO - Loaded results for isolation_forest
2025-11-06 18:06:39 - utils - INFO - Loaded results for lstm_autoencoder
2025-11-06 18:06:39 - utils - INFO - Loaded results for deep_clustering
2025-11-06 18:06:39 - utils - INFO - Loaded results for 3 models
2025-11-06 18:06:39 - utils - INFO - Creating metrics comparison table...
2025-11-06 18:06:39 - utils - INFO - Metrics comparison table created
2025-11-06 18:06:39 - utils - INFO - Creating confusion matrix plots...
2025-11-06 18:06:39 - utils - INFO - Confusion matrices saved to /Users/bipinrimal/Downloads/Thesis_work/results/confusion_matrices/all_models.png
2025-11-06 18:06:39 - utils - INFO - Creating ROC curves...
2025-11-06 18:06:39 - utils - INFO - ROC curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/roc_curves/roc_comparison.png
2025-11-06 18:06:39 - utils - INFO - Creating Precision-Recall curves...
2025-11-06 18:06:39 - utils - INFO - Precision-Recall curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/precision_recall_comparison.png
2025-11-06 18:06:39 - utils - INFO - Creating metrics comparison bar chart...
2025-11-06 18:06:39 - utils - INFO - Metrics comparison bar chart saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/metrics_comparison_bar.png
2025-11-06 18:06:39 - utils - INFO - Creating anomaly score distribution plots...
2025-11-06 18:06:39 - utils - INFO - Score distributions saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/score_distributions.png
2025-11-06 18:06:39 - utils - INFO - Generating evaluation report...
2025-11-06 18:06:39 - utils - INFO - Evaluation report saved to /Users/bipinrimal/Downloads/Thesis_work/results/evaluation_report.txt
2025-11-06 18:06:39 - utils - INFO - Comprehensive evaluation completed!
2025-11-06 18:06:39 - utils - INFO - ✓ Stage 4 completed: Comprehensive evaluation report generated
2025-11-06 18:09:19 - utils - INFO - Utility functions loaded successfully
2025-11-06 18:09:19 - utils - INFO - 
================================================================================
                            LABELING INSIDER THREATS                            
================================================================================

2025-11-06 18:09:19 - utils - INFO - Loading CMU-CERT answers file...
2025-11-06 18:09:19 - utils - INFO - Loaded 191 insider incidents
2025-11-06 18:09:19 - utils - WARNING - Could not parse dates for CDE1846: month must be in 1..12: /21/2011 11:43:39, at position 0
2025-11-06 18:09:19 - utils - INFO - Parsed 190 insider activity periods
2025-11-06 18:09:19 - utils - INFO - Loading processed data from /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv...
2025-11-06 18:09:34 - utils - INFO - Loaded 10,062,926 records
2025-11-06 18:09:35 - utils - INFO - Labeling based on 'user_pseudo' column
2025-11-06 18:09:35 - utils - INFO - Applying temporal labels (only during attack periods)...
2025-11-06 18:09:35 - utils - INFO -   LABELED ONS0995 (USER_66812153cf8e): 70 records (2010-03-06 to 2010-03-20)
2025-11-06 18:10:11 - utils - INFO - 
Temporal labeling complete:
2025-11-06 18:10:11 - utils - INFO -   Total records labeled: 70
2025-11-06 18:10:11 - utils - INFO -   Normal records:   10,062,856 (100.00%)
2025-11-06 18:10:11 - utils - INFO -   Insider records:  70 (0.0007%)
2025-11-06 18:10:11 - utils - INFO - Saving labeled data back to /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv...
2025-11-06 18:11:07 - utils - INFO - File save complete.
2025-11-06 18:13:16 - utils - INFO - Utility functions loaded successfully
2025-11-06 18:13:30 - utils - INFO - Loaded dataframe from /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv
2025-11-06 18:13:30 - utils - INFO - 
================================================================================
                          FEATURE ENGINEERING PIPELINE                          
================================================================================

2025-11-06 18:13:30 - utils - INFO - --- Starting Daily Features Pipeline (for LSTM) ---
2025-11-06 18:13:30 - utils - INFO - Creating temporal features...
2025-11-06 18:13:32 - utils - INFO - Temporal features created
2025-11-06 18:13:32 - utils - INFO - Creating user aggregated features with window: 1D
2025-11-06 18:13:35 - utils - INFO - Running aggregation...
2025-11-06 18:13:43 - utils - INFO - Aggregating activity type counts (this may be slow)...
2025-11-06 18:13:44 - utils - INFO - Created 14 aggregated daily features
2025-11-06 18:13:46 - utils - INFO - Scaling daily features (fit=True)...
2025-11-06 18:13:46 - utils - INFO - Scaled 14 daily features
2025-11-06 18:13:46 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/daily_feature_scaler.pkl
2025-11-06 18:13:46 - utils - INFO - 
--- Starting Static Features Pipeline (for IF/Clustering) ---
2025-11-06 18:13:46 - utils - INFO - Creating statistical features per user...
2025-11-06 18:13:47 - utils - INFO - Created 70 statistical features
2025-11-06 18:13:47 - utils - INFO - Scaling static features (fit=True)...
2025-11-06 18:13:47 - utils - INFO - Scaled 70 static features
2025-11-06 18:13:47 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/static_feature_scaler.pkl
2025-11-06 18:13:47 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/label_encoders.pkl
2025-11-06 18:13:47 - utils - INFO - Static features (scaled) completed: 1000 samples, 70 features
2025-11-06 18:13:47 - utils - INFO - Daily features (scaled) completed: 331144 samples
2025-11-06 18:13:47 - utils - INFO - Saved dataframe to /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_static_features.csv
2025-11-06 18:13:49 - utils - INFO - Saved dataframe to /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_daily_features.csv
2025-11-06 18:13:49 - utils - INFO - Creating sequences from *scaled daily aggregated data*...
2025-11-06 18:13:49 - utils - INFO - Creating sequences from scaled daily data (length=15, stride=10)
2025-11-06 18:13:55 - utils - INFO - Created 32531 sequences from 1000 users
2025-11-06 18:13:55 - utils - INFO - Sequences saved for LSTM training
2025-11-06 18:15:04 - utils - INFO - Utility functions loaded successfully
2025-11-06 18:15:04 - utils - INFO - 
================================================================================
                           ISOLATION FOREST TRAINING                            
================================================================================

2025-11-06 18:15:04 - utils - INFO - Loaded dataframe from /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_static_features.csv
2025-11-06 18:15:04 - utils - INFO - Model loaded from /Users/bipinrimal/Downloads/Thesis_work/models/static_feature_scaler.pkl
2025-11-06 18:15:04 - utils - INFO - Data split: 1000 samples, 1 insiders
2025-11-06 18:15:04 - utils - INFO - Data split: Train=700, Val=150, Test=150
2025-11-06 18:15:04 - utils - INFO - Insider labels split: Train=1, Val=0, Test=0
2025-11-06 18:15:04 - utils - INFO - Model loaded from /Users/bipinrimal/Downloads/Thesis_work/models/static_feature_scaler.pkl
2025-11-06 18:15:04 - utils - INFO - Initialized Isolation Forest with params: {'n_estimators': 50, 'max_samples': 256, 'contamination': 0.01, 'max_features': 1.0, 'bootstrap': False, 'n_jobs': -1, 'random_state': 42, 'verbose': 0}
2025-11-06 18:15:04 - utils - INFO - Training Isolation Forest...
2025-11-06 18:15:04 - utils - INFO - Isolation Forest training completed
2025-11-06 18:15:04 - utils - INFO - Calibrating threshold for target FPR=0.05
2025-11-06 18:15:04 - utils - INFO - Calibrated threshold: 0.6307
2025-11-06 18:15:04 - utils - INFO - Evaluating Isolation Forest...
2025-11-06 18:15:04 - utils - INFO - 
============================================================
2025-11-06 18:15:04 - utils - INFO - Isolation Forest Performance Metrics
2025-11-06 18:15:04 - utils - INFO - ============================================================
2025-11-06 18:15:04 - utils - INFO - Accuracy:  0.9267
2025-11-06 18:15:04 - utils - INFO - Precision: 0.0000
2025-11-06 18:15:04 - utils - INFO - Recall:    0.0000
2025-11-06 18:15:04 - utils - INFO - F1-Score:  0.0000
2025-11-06 18:15:04 - utils - INFO - AUC-ROC:   nan
2025-11-06 18:15:04 - utils - INFO - ============================================================

2025-11-06 18:15:04 - utils - INFO - Saving Isolation Forest model to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest.pkl
2025-11-06 18:15:04 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest.pkl
2025-11-06 18:15:04 - utils - INFO - Isolation Forest training and evaluation completed!
2025-11-06 18:15:16 - utils - INFO - Utility functions loaded successfully
2025-11-06 18:15:19 - utils - INFO - 
================================================================================
                      LIGHTWEIGHT DEEP CLUSTERING TRAINING                      
================================================================================

2025-11-06 18:15:19 - utils - INFO - Loaded dataframe from /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_static_features.csv
2025-11-06 18:15:19 - utils - INFO - Model loaded from /Users/bipinrimal/Downloads/Thesis_work/models/static_feature_scaler.pkl
2025-11-06 18:15:19 - utils - INFO - Dataset: 1000 samples, 70 features
2025-11-06 18:15:19 - utils - INFO - Data split: Train=700, Val=150, Test=150
2025-11-06 18:15:19 - utils - INFO - Insider labels split: Train=1, Val=0, Test=0
2025-11-06 18:15:19 - utils - INFO - Model loaded from /Users/bipinrimal/Downloads/Thesis_work/models/static_feature_scaler.pkl
2025-11-06 18:15:19 - utils - INFO - Initialized Lightweight Deep Clustering (n_clusters=5, encoding_dim=32)
2025-11-06 18:15:19 - utils - INFO - Training lightweight deep clustering model...
2025-11-06 18:15:19 - utils - INFO - Pre-training autoencoder...
2025-11-06 18:15:20 - utils - INFO - Autoencoder pre-training completed
2025-11-06 18:15:20 - utils - INFO - Fitting MiniBatch K-Means clustering...
2025-11-06 18:15:20 - utils - INFO - Lightweight deep clustering training completed
2025-11-06 18:15:20 - utils - INFO - Training completed in 1.13 seconds
2025-11-06 18:15:20 - utils - INFO - Calibrating threshold for target FPR=0.05
2025-11-06 18:15:20 - utils - INFO - Calibrated threshold: 0.3004
2025-11-06 18:15:20 - utils - INFO - Evaluating lightweight deep clustering model...
2025-11-06 18:15:20 - utils - INFO - 
============================================================
2025-11-06 18:15:20 - utils - INFO - Deep Clustering (Lightweight) Performance Metrics
2025-11-06 18:15:20 - utils - INFO - ============================================================
2025-11-06 18:15:20 - utils - INFO - Accuracy:  0.9933
2025-11-06 18:15:20 - utils - INFO - Precision: 0.0000
2025-11-06 18:15:20 - utils - INFO - Recall:    0.0000
2025-11-06 18:15:20 - utils - INFO - F1-Score:  0.0000
2025-11-06 18:15:20 - utils - INFO - AUC-ROC:   nan
2025-11-06 18:15:20 - utils - INFO - ============================================================

2025-11-06 18:15:20 - utils - INFO - Saving lightweight deep clustering model to /Users/bipinrimal/Downloads/Thesis_work/models/deep_clustering.pkl
2025-11-06 18:15:20 - utils - INFO - Encoder model saved to /Users/bipinrimal/Downloads/Thesis_work/models/deep_clustering_encoder.keras
2025-11-06 18:15:20 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/deep_clustering.pkl
2025-11-06 18:15:20 - utils - INFO - Lightweight deep clustering training and evaluation completed!
2025-11-06 18:15:20 - utils - INFO - Total time: 1.13 seconds
2025-11-06 18:15:26 - utils - INFO - Utility functions loaded successfully
2025-11-06 18:15:28 - utils - INFO - 
================================================================================
                     LIGHTWEIGHT LSTM AUTOENCODER TRAINING                      
================================================================================

2025-11-06 18:15:28 - utils - INFO - Loaded sequences: (32531, 15, 14)
2025-11-06 18:15:28 - utils - INFO - Data split: Train=22771, Val=4880, Test=4880
2025-11-06 18:15:28 - utils - INFO - Insider labels split: Train=1, Val=1, Test=0
2025-11-06 18:15:28 - utils - INFO - Training on 22770 normal sequences
2025-11-06 18:15:28 - utils - INFO - Model loaded from /Users/bipinrimal/Downloads/Thesis_work/models/daily_scaler.pkl
2025-11-06 18:15:28 - utils - INFO - Initialized Lightweight LSTM Autoencoder (15, 14)
2025-11-06 18:15:28 - utils - INFO - Training lightweight LSTM Autoencoder...
2025-11-06 18:15:28 - utils - INFO - Building lightweight LSTM Autoencoder...
2025-11-06 18:15:28 - utils - INFO - Model built with 18,270 parameters
2025-11-06 18:15:28 - utils - INFO - Training on 22770 sequences...
2025-11-06 18:15:55 - utils - INFO - Training completed
2025-11-06 18:15:55 - utils - INFO - Training completed in 27.03 seconds
2025-11-06 18:15:55 - utils - INFO - Calibrating threshold for target FPR=0.05
2025-11-06 18:15:55 - utils - INFO - Calibrated threshold: 0.0288
2025-11-06 18:15:55 - utils - INFO - Evaluating lightweight LSTM Autoencoder...
2025-11-06 18:15:56 - utils - INFO - 
============================================================
2025-11-06 18:15:56 - utils - INFO - LSTM Autoencoder (Lightweight) Performance Metrics
2025-11-06 18:15:56 - utils - INFO - ============================================================
2025-11-06 18:15:56 - utils - INFO - Accuracy:  0.9516
2025-11-06 18:15:56 - utils - INFO - Precision: 0.0000
2025-11-06 18:15:56 - utils - INFO - Recall:    0.0000
2025-11-06 18:15:56 - utils - INFO - F1-Score:  0.0000
2025-11-06 18:15:56 - utils - INFO - AUC-ROC:   nan
2025-11-06 18:15:56 - utils - INFO - ============================================================

2025-11-06 18:15:56 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/lstm_autoencoder.keras
2025-11-06 18:15:56 - utils - INFO - Lightweight LSTM Autoencoder completed!
2025-11-06 18:15:56 - utils - INFO - Total time: 27.03 seconds
2025-11-06 18:17:10 - utils - INFO - Utility functions loaded successfully
2025-11-06 18:17:12 - utils - INFO - ================================================================================
2025-11-06 18:17:12 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-11-06 18:17:12 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-11-06 18:17:12 - utils - INFO - ================================================================================
2025-11-06 18:17:12 - utils - INFO - 
================================================================================
                           STAGE 4: MODEL EVALUATION                            
================================================================================

2025-11-06 18:17:12 - utils - INFO - 
================================================================================
                         COMPREHENSIVE MODEL EVALUATION                         
================================================================================

2025-11-06 18:17:12 - utils - INFO - Loading results for all models...
2025-11-06 18:17:12 - utils - INFO - Loaded results for isolation_forest
2025-11-06 18:17:12 - utils - INFO - Loaded results for lstm_autoencoder
2025-11-06 18:17:12 - utils - INFO - Loaded results for deep_clustering
2025-11-06 18:17:12 - utils - INFO - Loaded results for 3 models
2025-11-06 18:17:12 - utils - INFO - Creating metrics comparison table...
2025-11-06 18:17:12 - utils - INFO - Metrics comparison table created
2025-11-06 18:17:12 - utils - INFO - Creating confusion matrix plots...
2025-11-06 18:17:13 - utils - INFO - Confusion matrices saved to /Users/bipinrimal/Downloads/Thesis_work/results/confusion_matrices/all_models.png
2025-11-06 18:17:13 - utils - INFO - Creating ROC curves...
2025-11-06 18:17:13 - utils - INFO - ROC curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/roc_curves/roc_comparison.png
2025-11-06 18:17:13 - utils - INFO - Creating Precision-Recall curves...
2025-11-06 18:17:13 - utils - INFO - Precision-Recall curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/precision_recall_comparison.png
2025-11-06 18:17:13 - utils - INFO - Creating metrics comparison bar chart...
2025-11-06 18:17:13 - utils - INFO - Metrics comparison bar chart saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/metrics_comparison_bar.png
2025-11-06 18:17:13 - utils - INFO - Creating anomaly score distribution plots...
2025-11-06 18:17:13 - utils - INFO - Score distributions saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/score_distributions.png
2025-11-06 18:17:13 - utils - INFO - Generating evaluation report...
2025-11-06 18:17:13 - utils - INFO - Evaluation report saved to /Users/bipinrimal/Downloads/Thesis_work/results/evaluation_report.txt
2025-11-06 18:17:13 - utils - INFO - Comprehensive evaluation completed!
2025-11-06 18:17:13 - utils - INFO - ✓ Stage 4 completed: Comprehensive evaluation report generated
2025-11-06 18:23:07 - utils - INFO - Utility functions loaded successfully
2025-11-06 18:23:07 - utils - INFO - 
================================================================================
                           ISOLATION FOREST TRAINING                            
================================================================================

2025-11-06 18:23:07 - utils - INFO - Loaded dataframe from /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_static_features.csv
2025-11-06 18:23:07 - utils - INFO - Model loaded from /Users/bipinrimal/Downloads/Thesis_work/models/static_feature_scaler.pkl
2025-11-06 18:23:07 - utils - INFO - Data split: 1000 samples, 1 insiders
2025-11-06 18:23:07 - utils - INFO - Training on: 799 normal samples
2025-11-06 18:23:07 - utils - INFO - Calibrating on: 200 normal samples
2025-11-06 18:23:07 - utils - INFO - Testing on: 1000 total samples (including 1 insiders)
2025-11-06 18:23:07 - utils - INFO - Initialized Isolation Forest with params: {'n_estimators': 50, 'max_samples': 256, 'contamination': 0.01, 'max_features': 1.0, 'bootstrap': False, 'n_jobs': -1, 'random_state': 42, 'verbose': 0}
2025-11-06 18:23:07 - utils - INFO - Training Isolation Forest on 799 normal samples...
2025-11-06 18:23:07 - utils - INFO - Isolation Forest training completed
2025-11-06 18:23:07 - utils - INFO - Calibrating threshold for target FPR=0.05...
2025-11-06 18:23:07 - utils - INFO - Calibrated threshold: 0.5520
2025-11-06 18:23:07 - utils - INFO - Evaluating Isolation Forest...
2025-11-06 18:23:07 - utils - INFO - Test set contains 1 positive samples.
2025-11-06 18:23:58 - utils - INFO - Utility functions loaded successfully
2025-11-06 18:23:58 - utils - INFO - 
================================================================================
                           ISOLATION FOREST TRAINING                            
================================================================================

2025-11-06 18:23:58 - utils - INFO - Loaded dataframe from /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_static_features.csv
2025-11-06 18:23:58 - utils - INFO - Model loaded from /Users/bipinrimal/Downloads/Thesis_work/models/static_feature_scaler.pkl
2025-11-06 18:23:58 - utils - INFO - Data split: 1000 samples, 1 insiders
2025-11-06 18:23:58 - utils - INFO - Training on: 799 normal samples
2025-11-06 18:23:58 - utils - INFO - Calibrating on: 200 normal samples
2025-11-06 18:23:58 - utils - INFO - Testing on: 1000 total samples (including 1 insiders)
2025-11-06 18:23:58 - utils - INFO - Initialized Isolation Forest with params: {'n_estimators': 50, 'max_samples': 256, 'contamination': 0.01, 'max_features': 1.0, 'bootstrap': False, 'n_jobs': -1, 'random_state': 42, 'verbose': 0}
2025-11-06 18:23:58 - utils - INFO - Training Isolation Forest on 799 normal samples...
2025-11-06 18:23:58 - utils - INFO - Isolation Forest training completed
2025-11-06 18:23:58 - utils - INFO - Calibrating threshold for target FPR=0.05...
2025-11-06 18:23:58 - utils - INFO - Calibrated threshold: 0.5520
2025-11-06 18:23:58 - utils - INFO - Evaluating Isolation Forest...
2025-11-06 18:23:58 - utils - INFO - Test set contains 1 positive samples.
2025-11-06 18:25:44 - utils - INFO - Utility functions loaded successfully
2025-11-06 18:25:44 - utils - INFO - 
================================================================================
                           ISOLATION FOREST TRAINING                            
================================================================================

2025-11-06 18:25:44 - utils - INFO - Loaded dataframe from /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_static_features.csv
2025-11-06 18:25:44 - utils - INFO - Model loaded from /Users/bipinrimal/Downloads/Thesis_work/models/static_feature_scaler.pkl
2025-11-06 18:25:44 - utils - INFO - Data split: 1000 samples, 1 insiders
2025-11-06 18:25:44 - utils - INFO - Training on: 799 normal samples
2025-11-06 18:25:44 - utils - INFO - Calibrating on: 200 normal samples
2025-11-06 18:25:44 - utils - INFO - Testing on: 1000 total samples (including 1 insiders)
2025-11-06 18:25:44 - utils - INFO - Initialized Isolation Forest with params: {'n_estimators': 50, 'max_samples': 256, 'contamination': 0.01, 'max_features': 1.0, 'bootstrap': False, 'n_jobs': -1, 'random_state': 42, 'verbose': 0}
2025-11-06 18:25:44 - utils - INFO - Training Isolation Forest on 799 normal samples...
2025-11-06 18:25:44 - utils - INFO - Isolation Forest training completed
2025-11-06 18:25:44 - utils - INFO - Calibrating threshold for target FPR=0.05...
2025-11-06 18:25:44 - utils - INFO - Calibrated threshold: 0.5520
2025-11-06 18:25:44 - utils - INFO - Evaluating Isolation Forest...
2025-11-06 18:25:44 - utils - INFO - Test set contains 1 positive samples.
2025-11-06 18:27:58 - utils - INFO - Utility functions loaded successfully
2025-11-06 18:27:58 - utils - INFO - 
================================================================================
                           ISOLATION FOREST TRAINING                            
================================================================================

2025-11-06 18:27:58 - utils - INFO - Loaded dataframe from /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_static_features.csv
2025-11-06 18:27:58 - utils - INFO - Model loaded from /Users/bipinrimal/Downloads/Thesis_work/models/static_feature_scaler.pkl
2025-11-06 18:27:58 - utils - INFO - Data split: 1000 samples, 1 insiders
2025-11-06 18:27:58 - utils - INFO - Training on: 799 normal samples
2025-11-06 18:27:58 - utils - INFO - Calibrating on: 200 normal samples
2025-11-06 18:27:58 - utils - INFO - Testing on: 1000 total samples (including 1 insiders)
2025-11-06 18:27:58 - utils - INFO - Initialized Isolation Forest with params: {'n_estimators': 50, 'max_samples': 256, 'contamination': 0.01, 'max_features': 1.0, 'bootstrap': False, 'n_jobs': -1, 'random_state': 42, 'verbose': 0}
2025-11-06 18:27:58 - utils - INFO - Training Isolation Forest on 799 normal samples...
2025-11-06 18:27:59 - utils - INFO - Isolation Forest training completed
2025-11-06 18:27:59 - utils - INFO - Calibrating threshold for target FPR=0.05...
2025-11-06 18:27:59 - utils - INFO - Calibrated threshold: 0.5520
2025-11-06 18:27:59 - utils - INFO - Evaluating Isolation Forest...
2025-11-06 18:27:59 - utils - INFO - Test set contains 1 positive samples.
2025-11-06 18:27:59 - utils - INFO - 
============================================================
2025-11-06 18:27:59 - utils - INFO - Isolation Forest Performance Metrics
2025-11-06 18:27:59 - utils - INFO - ============================================================
2025-11-06 18:27:59 - utils - INFO - Accuracy:  0.9450
2025-11-06 18:27:59 - utils - INFO - Precision: 0.0000
2025-11-06 18:27:59 - utils - INFO - Recall:    0.0000
2025-11-06 18:27:59 - utils - INFO - F1-Score:  0.0000
2025-11-06 18:27:59 - utils - INFO - AUC-ROC:   0.8208
2025-11-06 18:27:59 - utils - INFO - ============================================================

2025-11-06 18:27:59 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest.pkl
2025-11-06 18:27:59 - utils - INFO - Saving Isolation Forest model to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest.pkl
2025-11-06 18:27:59 - utils - INFO - Isolation Forest training and evaluation completed!
2025-11-06 18:28:11 - utils - INFO - Utility functions loaded successfully
2025-11-06 18:28:11 - utils - INFO - 
================================================================================
                           ISOLATION FOREST TRAINING                            
================================================================================

2025-11-06 18:28:11 - utils - INFO - Loaded dataframe from /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_static_features.csv
2025-11-06 18:28:11 - utils - INFO - Model loaded from /Users/bipinrimal/Downloads/Thesis_work/models/static_feature_scaler.pkl
2025-11-06 18:28:11 - utils - INFO - Data split: 1000 samples, 1 insiders
2025-11-06 18:28:11 - utils - INFO - Training on: 799 normal samples
2025-11-06 18:28:11 - utils - INFO - Calibrating on: 200 normal samples
2025-11-06 18:28:11 - utils - INFO - Testing on: 1000 total samples (including 1 insiders)
2025-11-06 18:28:11 - utils - INFO - Initialized Isolation Forest with params: {'n_estimators': 50, 'max_samples': 256, 'contamination': 0.01, 'max_features': 1.0, 'bootstrap': False, 'n_jobs': -1, 'random_state': 42, 'verbose': 0}
2025-11-06 18:28:11 - utils - INFO - Training Isolation Forest on 799 normal samples...
2025-11-06 18:28:11 - utils - INFO - Isolation Forest training completed
2025-11-06 18:28:11 - utils - INFO - Calibrating threshold for target FPR=0.05...
2025-11-06 18:28:11 - utils - INFO - Calibrated threshold: 0.5520
2025-11-06 18:28:11 - utils - INFO - Evaluating Isolation Forest...
2025-11-06 18:28:11 - utils - INFO - Test set contains 1 positive samples.
2025-11-06 18:28:11 - utils - INFO - 
============================================================
2025-11-06 18:28:11 - utils - INFO - Isolation Forest Performance Metrics
2025-11-06 18:28:11 - utils - INFO - ============================================================
2025-11-06 18:28:11 - utils - INFO - Accuracy:  0.9450
2025-11-06 18:28:11 - utils - INFO - Precision: 0.0000
2025-11-06 18:28:11 - utils - INFO - Recall:    0.0000
2025-11-06 18:28:11 - utils - INFO - F1-Score:  0.0000
2025-11-06 18:28:11 - utils - INFO - AUC-ROC:   0.8208
2025-11-06 18:28:11 - utils - INFO - ============================================================

2025-11-06 18:28:11 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest.pkl
2025-11-06 18:28:11 - utils - INFO - Saving Isolation Forest model to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest.pkl
2025-11-06 18:28:11 - utils - INFO - Isolation Forest training and evaluation completed!
2025-11-06 18:28:17 - utils - INFO - Utility functions loaded successfully
2025-11-06 18:29:03 - utils - INFO - Utility functions loaded successfully
2025-11-06 18:29:05 - utils - INFO - 
================================================================================
                      LIGHTWEIGHT DEEP CLUSTERING TRAINING                      
================================================================================

2025-11-06 18:29:05 - utils - INFO - Loaded dataframe from /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_static_features.csv
2025-11-06 18:29:05 - utils - INFO - Model loaded from /Users/bipinrimal/Downloads/Thesis_work/models/static_feature_scaler.pkl
2025-11-06 18:29:05 - utils - INFO - Dataset: 1000 samples, 70 features
2025-11-06 18:29:05 - utils - INFO - Training on: 799 normal samples
2025-11-06 18:29:05 - utils - INFO - Calibrating on: 200 normal samples
2025-11-06 18:29:05 - utils - INFO - Testing on: 1000 total samples (including 1 insiders)
2025-11-06 18:29:05 - utils - INFO - Initialized Lightweight Deep Clustering (n_clusters=5, encoding_dim=32)
2025-11-06 18:29:05 - utils - INFO - Training lightweight deep clustering model...
2025-11-06 18:29:05 - utils - INFO - Pre-training autoencoder...
2025-11-06 18:29:07 - utils - INFO - Autoencoder pre-training completed
2025-11-06 18:29:07 - utils - INFO - Fitting MiniBatch K-Means clustering...
2025-11-06 18:29:07 - utils - INFO - Lightweight deep clustering training completed
2025-11-06 18:29:07 - utils - INFO - Training completed in 1.32 seconds
2025-11-06 18:29:07 - utils - INFO - Calibrating threshold for target FPR=0.05...
2025-11-06 18:29:07 - utils - INFO - Calibrated threshold: 1.4221
2025-11-06 18:29:07 - utils - INFO - Evaluating lightweight deep clustering model...
2025-11-06 18:29:07 - utils - INFO - Test set contains 1 positive samples.
2025-11-06 18:29:07 - utils - INFO - 
============================================================
2025-11-06 18:29:07 - utils - INFO - Deep Clustering (Lightweight) Performance Metrics
2025-11-06 18:29:07 - utils - INFO - ============================================================
2025-11-06 18:29:07 - utils - INFO - Accuracy:  0.9610
2025-11-06 18:29:07 - utils - INFO - Precision: 0.0000
2025-11-06 18:29:07 - utils - INFO - Recall:    0.0000
2025-11-06 18:29:07 - utils - INFO - F1-Score:  0.0000
2025-11-06 18:29:07 - utils - INFO - AUC-ROC:   0.3113
2025-11-06 18:29:07 - utils - INFO - ============================================================

2025-11-06 18:29:07 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/deep_clustering.pkl
2025-11-06 18:29:07 - utils - INFO - Encoder model saved to /Users/bipinrimal/Downloads/Thesis_work/models/deep_clustering_encoder.keras
2025-11-06 18:29:07 - utils - INFO - Lightweight deep clustering training and evaluation completed!
2025-11-06 18:29:07 - utils - INFO - Total time: 1.32 seconds
2025-11-06 18:29:22 - utils - INFO - Utility functions loaded successfully
2025-11-06 18:29:22 - utils - INFO - 
================================================================================
                           ISOLATION FOREST TRAINING                            
================================================================================

2025-11-06 18:29:22 - utils - INFO - Loaded dataframe from /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_static_features.csv
2025-11-06 18:29:22 - utils - INFO - Model loaded from /Users/bipinrimal/Downloads/Thesis_work/models/static_feature_scaler.pkl
2025-11-06 18:29:22 - utils - INFO - Data split: 1000 samples, 1 insiders
2025-11-06 18:29:22 - utils - INFO - Training on: 799 normal samples
2025-11-06 18:29:22 - utils - INFO - Calibrating on: 200 normal samples
2025-11-06 18:29:22 - utils - INFO - Testing on: 1000 total samples (including 1 insiders)
2025-11-06 18:29:22 - utils - INFO - Initialized Isolation Forest with params: {'n_estimators': 50, 'max_samples': 256, 'contamination': 0.01, 'max_features': 1.0, 'bootstrap': False, 'n_jobs': -1, 'random_state': 42, 'verbose': 0}
2025-11-06 18:29:22 - utils - INFO - Training Isolation Forest on 799 normal samples...
2025-11-06 18:29:22 - utils - INFO - Isolation Forest training completed
2025-11-06 18:29:22 - utils - INFO - Calibrating threshold for target FPR=0.05...
2025-11-06 18:29:22 - utils - INFO - Calibrated threshold: 0.5520
2025-11-06 18:29:22 - utils - INFO - Evaluating Isolation Forest...
2025-11-06 18:29:22 - utils - INFO - Test set contains 1 positive samples.
2025-11-06 18:29:22 - utils - INFO - 
============================================================
2025-11-06 18:29:22 - utils - INFO - Isolation Forest Performance Metrics
2025-11-06 18:29:22 - utils - INFO - ============================================================
2025-11-06 18:29:22 - utils - INFO - Accuracy:  0.9450
2025-11-06 18:29:22 - utils - INFO - Precision: 0.0000
2025-11-06 18:29:22 - utils - INFO - Recall:    0.0000
2025-11-06 18:29:22 - utils - INFO - F1-Score:  0.0000
2025-11-06 18:29:22 - utils - INFO - AUC-ROC:   0.8208
2025-11-06 18:29:22 - utils - INFO - ============================================================

2025-11-06 18:29:22 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest.pkl
2025-11-06 18:29:22 - utils - INFO - Saving Isolation Forest model to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest.pkl
2025-11-06 18:29:22 - utils - INFO - Isolation Forest training and evaluation completed!
2025-11-06 18:29:30 - utils - INFO - Utility functions loaded successfully
2025-11-06 18:29:32 - utils - INFO - 
================================================================================
                      LIGHTWEIGHT DEEP CLUSTERING TRAINING                      
================================================================================

2025-11-06 18:29:32 - utils - INFO - Loaded dataframe from /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_static_features.csv
2025-11-06 18:29:32 - utils - INFO - Model loaded from /Users/bipinrimal/Downloads/Thesis_work/models/static_feature_scaler.pkl
2025-11-06 18:29:32 - utils - INFO - Dataset: 1000 samples, 70 features
2025-11-06 18:29:32 - utils - INFO - Training on: 799 normal samples
2025-11-06 18:29:32 - utils - INFO - Calibrating on: 200 normal samples
2025-11-06 18:29:32 - utils - INFO - Testing on: 1000 total samples (including 1 insiders)
2025-11-06 18:29:32 - utils - INFO - Initialized Lightweight Deep Clustering (n_clusters=5, encoding_dim=32)
2025-11-06 18:29:32 - utils - INFO - Training lightweight deep clustering model...
2025-11-06 18:29:32 - utils - INFO - Pre-training autoencoder...
2025-11-06 18:29:33 - utils - INFO - Autoencoder pre-training completed
2025-11-06 18:29:33 - utils - INFO - Fitting MiniBatch K-Means clustering...
2025-11-06 18:29:33 - utils - INFO - Lightweight deep clustering training completed
2025-11-06 18:29:33 - utils - INFO - Training completed in 1.31 seconds
2025-11-06 18:29:33 - utils - INFO - Calibrating threshold for target FPR=0.05...
2025-11-06 18:29:33 - utils - INFO - Calibrated threshold: 1.7640
2025-11-06 18:29:33 - utils - INFO - Evaluating lightweight deep clustering model...
2025-11-06 18:29:33 - utils - INFO - Test set contains 1 positive samples.
2025-11-06 18:29:33 - utils - INFO - 
============================================================
2025-11-06 18:29:33 - utils - INFO - Deep Clustering (Lightweight) Performance Metrics
2025-11-06 18:29:33 - utils - INFO - ============================================================
2025-11-06 18:29:33 - utils - INFO - Accuracy:  0.9590
2025-11-06 18:29:33 - utils - INFO - Precision: 0.0000
2025-11-06 18:29:33 - utils - INFO - Recall:    0.0000
2025-11-06 18:29:33 - utils - INFO - F1-Score:  0.0000
2025-11-06 18:29:33 - utils - INFO - AUC-ROC:   0.7407
2025-11-06 18:29:33 - utils - INFO - ============================================================

2025-11-06 18:29:33 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/deep_clustering.pkl
2025-11-06 18:29:33 - utils - INFO - Encoder model saved to /Users/bipinrimal/Downloads/Thesis_work/models/deep_clustering_encoder.keras
2025-11-06 18:29:33 - utils - INFO - Lightweight deep clustering training and evaluation completed!
2025-11-06 18:29:33 - utils - INFO - Total time: 1.31 seconds
2025-11-06 18:30:21 - utils - INFO - Utility functions loaded successfully
2025-11-06 18:30:23 - utils - INFO - 
================================================================================
                     LIGHTWEIGHT LSTM AUTOENCODER TRAINING                      
================================================================================

2025-11-06 18:30:23 - utils - INFO - Loaded sequences: (32531, 15, 14), with 2 insider sequences
2025-11-06 18:30:23 - utils - INFO - Training on: 26023 normal sequences
2025-11-06 18:30:23 - utils - INFO - Calibrating on: 6506 normal sequences
2025-11-06 18:30:23 - utils - INFO - Testing on: 32531 total sequences (including 2 insider sequences)
2025-11-06 18:30:23 - utils - INFO - Model loaded from /Users/bipinrimal/Downloads/Thesis_work/models/daily_feature_scaler.pkl
2025-11-06 18:30:23 - utils - INFO - Initialized Lightweight LSTM Autoencoder (15, 14)
2025-11-06 18:30:23 - utils - INFO - Training lightweight LSTM Autoencoder...
2025-11-06 18:30:23 - utils - INFO - Building lightweight LSTM Autoencoder...
2025-11-06 18:30:23 - utils - INFO - Model built with 18,270 parameters
2025-11-06 18:30:23 - utils - INFO - Training on 26023 sequences...
2025-11-06 18:30:55 - utils - INFO - Training completed
2025-11-06 18:30:55 - utils - INFO - Training completed in 31.94 seconds
2025-11-06 18:30:55 - utils - INFO - Calibrating threshold for target FPR=0.05
2025-11-06 18:30:56 - utils - INFO - Calibrated threshold: 0.0253
2025-11-06 18:30:56 - utils - INFO - Evaluating lightweight LSTM Autoencoder...
2025-11-06 18:30:56 - utils - INFO - Test set contains 2 positive samples.
2025-11-06 18:30:57 - utils - INFO - 
============================================================
2025-11-06 18:30:57 - utils - INFO - LSTM Autoencoder (Lightweight) Performance Metrics
2025-11-06 18:30:57 - utils - INFO - ============================================================
2025-11-06 18:30:57 - utils - INFO - Accuracy:  0.9522
2025-11-06 18:30:57 - utils - INFO - Precision: 0.0013
2025-11-06 18:30:57 - utils - INFO - Recall:    1.0000
2025-11-06 18:30:57 - utils - INFO - F1-Score:  0.0026
2025-11-06 18:30:57 - utils - INFO - AUC-ROC:   0.9849
2025-11-06 18:30:57 - utils - INFO - ============================================================

2025-11-06 18:30:57 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/lstm_autoencoder.keras
2025-11-06 18:30:57 - utils - INFO - Lightweight LSTM Autoencoder completed!
2025-11-06 18:30:57 - utils - INFO - Total time: 31.94 seconds
2025-11-06 18:32:17 - utils - INFO - Utility functions loaded successfully
2025-11-06 18:32:19 - utils - INFO - ================================================================================
2025-11-06 18:32:19 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-11-06 18:32:19 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-11-06 18:32:19 - utils - INFO - ================================================================================
2025-11-06 18:32:19 - utils - INFO - 
================================================================================
                           STAGE 4: MODEL EVALUATION                            
================================================================================

2025-11-06 18:32:19 - utils - INFO - 
================================================================================
                         COMPREHENSIVE MODEL EVALUATION                         
================================================================================

2025-11-06 18:32:19 - utils - INFO - Loading results for all models...
2025-11-06 18:32:19 - utils - INFO - Loaded results for isolation_forest
2025-11-06 18:32:19 - utils - INFO - Loaded results for lstm_autoencoder
2025-11-06 18:32:19 - utils - INFO - Loaded results for deep_clustering
2025-11-06 18:32:19 - utils - INFO - Loaded results for 3 models
2025-11-06 18:32:19 - utils - INFO - Creating metrics comparison table...
2025-11-06 18:32:19 - utils - INFO - Metrics comparison table created
2025-11-06 18:32:19 - utils - INFO - Creating confusion matrix plots...
2025-11-06 18:32:20 - utils - INFO - Confusion matrices saved to /Users/bipinrimal/Downloads/Thesis_work/results/confusion_matrices/all_models.png
2025-11-06 18:32:20 - utils - INFO - Creating ROC curves...
2025-11-06 18:32:20 - utils - INFO - ROC curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/roc_curves/roc_comparison.png
2025-11-06 18:32:20 - utils - INFO - Creating Precision-Recall curves...
2025-11-06 18:32:20 - utils - INFO - Precision-Recall curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/precision_recall_comparison.png
2025-11-06 18:32:20 - utils - INFO - Creating metrics comparison bar chart...
2025-11-06 18:32:20 - utils - INFO - Metrics comparison bar chart saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/metrics_comparison_bar.png
2025-11-06 18:32:20 - utils - INFO - Creating anomaly score distribution plots...
2025-11-06 18:32:20 - utils - INFO - Score distributions saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/score_distributions.png
2025-11-06 18:32:20 - utils - INFO - Generating evaluation report...
2025-11-06 18:32:20 - utils - INFO - Evaluation report saved to /Users/bipinrimal/Downloads/Thesis_work/results/evaluation_report.txt
2025-11-06 18:32:20 - utils - INFO - Comprehensive evaluation completed!
2025-11-06 18:32:20 - utils - INFO - ✓ Stage 4 completed: Comprehensive evaluation report generated
2025-11-06 18:34:16 - utils - INFO - Utility functions loaded successfully
2025-11-06 18:34:57 - utils - INFO - Utility functions loaded successfully
2025-11-06 18:35:55 - utils - INFO - Utility functions loaded successfully
2025-11-06 18:37:21 - utils - INFO - Utility functions loaded successfully
2025-11-06 18:37:21 - utils - INFO - 
================================================================================
                       MODEL DIAGNOSIS & THRESHOLD TUNING                       
================================================================================

2025-11-06 18:37:21 - utils - INFO - 
================================================================================
2025-11-06 18:37:21 - utils - INFO - Diagnosing: Isolation Forest
2025-11-06 18:37:21 - utils - INFO - ================================================================================
2025-11-06 18:37:21 - utils - INFO - Loaded 1000 predictions for isolation_forest
2025-11-06 18:37:21 - utils - INFO - --- Optimal Threshold Found ---
2025-11-06 18:37:21 - utils - INFO - Best F1-Score: 0.0105
2025-11-06 18:37:21 - utils - INFO - Precision:     0.0053
2025-11-06 18:37:21 - utils - INFO - Recall:        1.0000
2025-11-06 18:37:21 - utils - INFO - Threshold:     0.3838
2025-11-06 18:37:21 - utils - INFO - Threshold analysis plot saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/isolation_forest_threshold_analysis.png
2025-11-06 18:37:21 - utils - INFO - 
================================================================================
2025-11-06 18:37:21 - utils - INFO - Diagnosing: Deep Clustering
2025-11-06 18:37:21 - utils - INFO - ================================================================================
2025-11-06 18:37:21 - utils - INFO - Loaded 1000 predictions for deep_clustering
2025-11-06 18:37:21 - utils - INFO - --- Optimal Threshold Found ---
2025-11-06 18:37:21 - utils - INFO - Best F1-Score: 0.0076
2025-11-06 18:37:21 - utils - INFO - Precision:     0.0038
2025-11-06 18:37:21 - utils - INFO - Recall:        1.0000
2025-11-06 18:37:21 - utils - INFO - Threshold:     0.3535
2025-11-06 18:37:21 - utils - INFO - Threshold analysis plot saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/deep_clustering_threshold_analysis.png
2025-11-06 18:37:21 - utils - INFO - 
================================================================================
2025-11-06 18:37:21 - utils - INFO - Diagnosing: Lstm Autoencoder
2025-11-06 18:37:21 - utils - INFO - ================================================================================
2025-11-06 18:37:21 - utils - INFO - Loaded 32531 predictions for lstm_autoencoder
2025-11-06 18:37:22 - utils - INFO - --- Optimal Threshold Found ---
2025-11-06 18:37:22 - utils - INFO - Best F1-Score: 0.0060
2025-11-06 18:37:22 - utils - INFO - Precision:     0.0030
2025-11-06 18:37:22 - utils - INFO - Recall:        1.0000
2025-11-06 18:37:22 - utils - INFO - Threshold:     0.0808
2025-11-06 18:37:22 - utils - INFO - Threshold analysis plot saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/lstm_autoencoder_threshold_analysis.png
2025-11-06 18:37:22 - utils - INFO - 
================================================================================
2025-11-06 18:37:22 - utils - INFO - OPTIMAL PERFORMANCE SUMMARY
2025-11-06 18:37:22 - utils - INFO - ================================================================================
2025-11-06 18:37:41 - utils - INFO - Utility functions loaded successfully
2025-11-06 18:37:41 - utils - INFO - 
================================================================================
                       MODEL DIAGNOSIS & THRESHOLD TUNING                       
================================================================================

2025-11-06 18:37:41 - utils - INFO - 
================================================================================
2025-11-06 18:37:41 - utils - INFO - Diagnosing: Isolation Forest
2025-11-06 18:37:41 - utils - INFO - ================================================================================
2025-11-06 18:37:41 - utils - INFO - Loaded 1000 predictions for isolation_forest
2025-11-06 18:37:41 - utils - INFO - --- Optimal Threshold Found ---
2025-11-06 18:37:41 - utils - INFO - Best F1-Score: 0.0105
2025-11-06 18:37:41 - utils - INFO - Precision:     0.0053
2025-11-06 18:37:41 - utils - INFO - Recall:        1.0000
2025-11-06 18:37:41 - utils - INFO - Threshold:     0.3838
2025-11-06 18:37:42 - utils - INFO - Threshold analysis plot saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/isolation_forest_threshold_analysis.png
2025-11-06 18:37:42 - utils - INFO - 
================================================================================
2025-11-06 18:37:42 - utils - INFO - Diagnosing: Deep Clustering
2025-11-06 18:37:42 - utils - INFO - ================================================================================
2025-11-06 18:37:42 - utils - INFO - Loaded 1000 predictions for deep_clustering
2025-11-06 18:37:42 - utils - INFO - --- Optimal Threshold Found ---
2025-11-06 18:37:42 - utils - INFO - Best F1-Score: 0.0076
2025-11-06 18:37:42 - utils - INFO - Precision:     0.0038
2025-11-06 18:37:42 - utils - INFO - Recall:        1.0000
2025-11-06 18:37:42 - utils - INFO - Threshold:     0.3535
2025-11-06 18:37:42 - utils - INFO - Threshold analysis plot saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/deep_clustering_threshold_analysis.png
2025-11-06 18:37:42 - utils - INFO - 
================================================================================
2025-11-06 18:37:42 - utils - INFO - Diagnosing: Lstm Autoencoder
2025-11-06 18:37:42 - utils - INFO - ================================================================================
2025-11-06 18:37:42 - utils - INFO - Loaded 32531 predictions for lstm_autoencoder
2025-11-06 18:37:42 - utils - INFO - --- Optimal Threshold Found ---
2025-11-06 18:37:42 - utils - INFO - Best F1-Score: 0.0060
2025-11-06 18:37:42 - utils - INFO - Precision:     0.0030
2025-11-06 18:37:42 - utils - INFO - Recall:        1.0000
2025-11-06 18:37:42 - utils - INFO - Threshold:     0.0808
2025-11-06 18:37:43 - utils - INFO - Threshold analysis plot saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/lstm_autoencoder_threshold_analysis.png
2025-11-06 18:37:43 - utils - INFO - 
================================================================================
2025-11-06 18:37:43 - utils - INFO - OPTIMAL PERFORMANCE SUMMARY
2025-11-06 18:37:43 - utils - INFO - ================================================================================
2025-11-06 18:38:00 - utils - INFO - Utility functions loaded successfully
2025-11-06 18:38:00 - utils - INFO - 
================================================================================
                       MODEL DIAGNOSIS & THRESHOLD TUNING                       
================================================================================

2025-11-06 18:38:00 - utils - INFO - 
================================================================================
2025-11-06 18:38:00 - utils - INFO - Diagnosing: Isolation Forest
2025-11-06 18:38:00 - utils - INFO - ================================================================================
2025-11-06 18:38:00 - utils - INFO - Loaded 1000 predictions for isolation_forest
2025-11-06 18:38:00 - utils - INFO - --- Optimal Threshold Found ---
2025-11-06 18:38:00 - utils - INFO - Best F1-Score: 0.0105
2025-11-06 18:38:00 - utils - INFO - Precision:     0.0053
2025-11-06 18:38:00 - utils - INFO - Recall:        1.0000
2025-11-06 18:38:00 - utils - INFO - Threshold:     0.3838
2025-11-06 18:38:01 - utils - INFO - Threshold analysis plot saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/isolation_forest_threshold_analysis.png
2025-11-06 18:38:01 - utils - INFO - 
================================================================================
2025-11-06 18:38:01 - utils - INFO - Diagnosing: Deep Clustering
2025-11-06 18:38:01 - utils - INFO - ================================================================================
2025-11-06 18:38:01 - utils - INFO - Loaded 1000 predictions for deep_clustering
2025-11-06 18:38:01 - utils - INFO - --- Optimal Threshold Found ---
2025-11-06 18:38:01 - utils - INFO - Best F1-Score: 0.0076
2025-11-06 18:38:01 - utils - INFO - Precision:     0.0038
2025-11-06 18:38:01 - utils - INFO - Recall:        1.0000
2025-11-06 18:38:01 - utils - INFO - Threshold:     0.3535
2025-11-06 18:38:01 - utils - INFO - Threshold analysis plot saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/deep_clustering_threshold_analysis.png
2025-11-06 18:38:01 - utils - INFO - 
================================================================================
2025-11-06 18:38:01 - utils - INFO - Diagnosing: Lstm Autoencoder
2025-11-06 18:38:01 - utils - INFO - ================================================================================
2025-11-06 18:38:01 - utils - INFO - Loaded 32531 predictions for lstm_autoencoder
2025-11-06 18:38:01 - utils - INFO - --- Optimal Threshold Found ---
2025-11-06 18:38:01 - utils - INFO - Best F1-Score: 0.0060
2025-11-06 18:38:01 - utils - INFO - Precision:     0.0030
2025-11-06 18:38:01 - utils - INFO - Recall:        1.0000
2025-11-06 18:38:01 - utils - INFO - Threshold:     0.0808
2025-11-06 18:38:02 - utils - INFO - Threshold analysis plot saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/lstm_autoencoder_threshold_analysis.png
2025-11-06 18:38:02 - utils - INFO - 
================================================================================
2025-11-06 18:38:02 - utils - INFO - OPTIMAL PERFORMANCE SUMMARY
2025-11-06 18:38:02 - utils - INFO - ================================================================================
2025-11-06 18:39:39 - utils - INFO - Utility functions loaded successfully
2025-11-06 18:39:39 - utils - INFO - 
================================================================================
                       MODEL DIAGNOSIS & THRESHOLD TUNING                       
================================================================================

2025-11-06 18:39:39 - utils - INFO - 
================================================================================
2025-11-06 18:39:39 - utils - INFO - Diagnosing: Isolation Forest
2025-11-06 18:39:39 - utils - INFO - ================================================================================
2025-11-06 18:39:39 - utils - INFO - Loaded 1000 predictions for isolation_forest
2025-11-06 18:39:39 - utils - INFO - --- Optimal Threshold Found ---
2025-11-06 18:39:39 - utils - INFO - Best F1-Score: 0.0105
2025-11-06 18:39:39 - utils - INFO - Precision:     0.0053
2025-11-06 18:39:39 - utils - INFO - Recall:        1.0000
2025-11-06 18:39:39 - utils - INFO - Threshold:     0.3838
2025-11-06 18:39:40 - utils - INFO - Threshold analysis plot saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/isolation_forest_threshold_analysis.png
2025-11-06 18:39:40 - utils - INFO - 
================================================================================
2025-11-06 18:39:40 - utils - INFO - Diagnosing: Deep Clustering
2025-11-06 18:39:40 - utils - INFO - ================================================================================
2025-11-06 18:39:40 - utils - INFO - Loaded 1000 predictions for deep_clustering
2025-11-06 18:39:40 - utils - INFO - --- Optimal Threshold Found ---
2025-11-06 18:39:40 - utils - INFO - Best F1-Score: 0.0076
2025-11-06 18:39:40 - utils - INFO - Precision:     0.0038
2025-11-06 18:39:40 - utils - INFO - Recall:        1.0000
2025-11-06 18:39:40 - utils - INFO - Threshold:     0.3535
2025-11-06 18:39:40 - utils - INFO - Threshold analysis plot saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/deep_clustering_threshold_analysis.png
2025-11-06 18:39:40 - utils - INFO - 
================================================================================
2025-11-06 18:39:40 - utils - INFO - Diagnosing: Lstm Autoencoder
2025-11-06 18:39:40 - utils - INFO - ================================================================================
2025-11-06 18:39:40 - utils - INFO - Loaded 32531 predictions for lstm_autoencoder
2025-11-06 18:39:40 - utils - INFO - --- Optimal Threshold Found ---
2025-11-06 18:39:40 - utils - INFO - Best F1-Score: 0.0060
2025-11-06 18:39:40 - utils - INFO - Precision:     0.0030
2025-11-06 18:39:40 - utils - INFO - Recall:        1.0000
2025-11-06 18:39:40 - utils - INFO - Threshold:     0.0808
2025-11-06 18:39:41 - utils - INFO - Threshold analysis plot saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/lstm_autoencoder_threshold_analysis.png
2025-11-06 18:39:41 - utils - INFO - 
================================================================================
2025-11-06 18:39:41 - utils - INFO - OPTIMAL PERFORMANCE SUMMARY
2025-11-06 18:39:41 - utils - INFO - ================================================================================
2025-11-06 18:39:41 - utils - INFO - 
Optimal report saved to /Users/bipinrimal/Downloads/Thesis_work/results/optimal_evaluation_report.csv
2025-11-06 18:51:50 - utils - INFO - Utility functions loaded successfully
2025-11-06 18:51:52 - utils - INFO - ================================================================================
2025-11-06 18:51:52 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-11-06 18:51:52 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-11-06 18:51:52 - utils - INFO - ================================================================================
2025-11-06 18:51:52 - utils - INFO - 
================================================================================
                         STAGE 5: ENSEMBLE INTEGRATION                          
================================================================================

2025-11-06 18:51:52 - utils - INFO - Initialized Ensemble Detector with method: weighted
2025-11-06 18:51:52 - utils - INFO - 
================================================================================
                            ENSEMBLE SYSTEM PIPELINE                            
================================================================================

2025-11-06 18:51:52 - utils - INFO - Loading predictions from individual models...
2025-11-06 18:51:52 - utils - INFO - Loaded isolation_forest predictions: 1000 samples
2025-11-06 18:51:52 - utils - INFO - Loaded lstm_autoencoder predictions: 32531 samples
2025-11-06 18:51:52 - utils - INFO - Loaded deep_clustering predictions: 1000 samples
2025-11-06 18:51:52 - utils - WARNING - Models have different sample counts: {'isolation_forest': 1000, 'lstm_autoencoder': 32531, 'deep_clustering': 1000}
2025-11-06 18:51:52 - utils - INFO - Will use aggregation strategy to align predictions...
2025-11-06 18:51:52 - utils - INFO - Aligning predictions across models...
2025-11-06 18:51:52 - utils - INFO - Using isolation_forest as reference (1000 samples)
2025-11-06 18:51:52 - utils - INFO - Aggregating lstm_autoencoder from 32531 to 1000 samples
2025-11-06 18:51:52 - utils - INFO - Predictions aligned successfully
2025-11-06 18:51:52 - utils - INFO - Loaded predictions from 3 models
2025-11-06 18:51:52 - utils - INFO - Computing weighted ensemble...
2025-11-06 18:51:52 - utils - INFO - Weighted ensemble: 0 anomalies detected
2025-11-06 18:51:52 - utils - INFO - Evaluating ensemble performance...
2025-11-06 18:51:52 - utils - INFO - 
============================================================
2025-11-06 18:51:52 - utils - INFO - Ensemble (weighted) Performance Metrics
2025-11-06 18:51:52 - utils - INFO - ============================================================
2025-11-06 18:51:52 - utils - INFO - Accuracy:  0.9990
2025-11-06 18:51:52 - utils - INFO - Precision: 0.0000
2025-11-06 18:51:52 - utils - INFO - Recall:    0.0000
2025-11-06 18:51:52 - utils - INFO - F1-Score:  0.0000
2025-11-06 18:51:52 - utils - INFO - AUC-ROC:   0.8128
2025-11-06 18:51:52 - utils - INFO - ============================================================

2025-11-06 18:51:52 - utils - INFO - Comparing ensemble with individual models...
2025-11-06 18:51:52 - utils - INFO - Evaluating ensemble performance...
2025-11-06 18:51:52 - utils - INFO - 
============================================================
2025-11-06 18:51:52 - utils - INFO - Ensemble (weighted) Performance Metrics
2025-11-06 18:51:52 - utils - INFO - ============================================================
2025-11-06 18:51:52 - utils - INFO - Accuracy:  0.9990
2025-11-06 18:51:52 - utils - INFO - Precision: 0.0000
2025-11-06 18:51:52 - utils - INFO - Recall:    0.0000
2025-11-06 18:51:52 - utils - INFO - F1-Score:  0.0000
2025-11-06 18:51:52 - utils - INFO - AUC-ROC:   0.8128
2025-11-06 18:51:52 - utils - INFO - ============================================================

2025-11-06 18:51:52 - utils - INFO - 
Comparison Results:
2025-11-06 18:51:52 - utils - INFO - 
              model  accuracy  precision  recall  f1_score  auc_roc
   Isolation Forest     0.945        0.0     0.0       0.0   0.8208
   Lstm Autoencoder     0.946        0.0     0.0       0.0   0.1842
    Deep Clustering     0.959        0.0     0.0       0.0   0.7407
Ensemble (weighted)     0.999        0.0     0.0       0.0   0.8128
2025-11-06 18:51:52 - utils - INFO - Ensemble predictions saved
2025-11-06 18:51:52 - utils - INFO - Generating alerts...
2025-11-06 18:51:52 - utils - ERROR - Error with weighted ensemble: 'severity'
2025-11-06 18:51:52 - utils - INFO - Initialized Ensemble Detector with method: majority
2025-11-06 18:51:52 - utils - INFO - 
================================================================================
                            ENSEMBLE SYSTEM PIPELINE                            
================================================================================

2025-11-06 18:51:52 - utils - INFO - Loading predictions from individual models...
2025-11-06 18:51:52 - utils - INFO - Loaded isolation_forest predictions: 1000 samples
2025-11-06 18:51:52 - utils - INFO - Loaded lstm_autoencoder predictions: 32531 samples
2025-11-06 18:51:52 - utils - INFO - Loaded deep_clustering predictions: 1000 samples
2025-11-06 18:51:52 - utils - WARNING - Models have different sample counts: {'isolation_forest': 1000, 'lstm_autoencoder': 32531, 'deep_clustering': 1000}
2025-11-06 18:51:52 - utils - INFO - Will use aggregation strategy to align predictions...
2025-11-06 18:51:52 - utils - INFO - Aligning predictions across models...
2025-11-06 18:51:52 - utils - INFO - Using isolation_forest as reference (1000 samples)
2025-11-06 18:51:52 - utils - INFO - Aggregating lstm_autoencoder from 32531 to 1000 samples
2025-11-06 18:51:52 - utils - INFO - Predictions aligned successfully
2025-11-06 18:51:52 - utils - INFO - Loaded predictions from 3 models
2025-11-06 18:51:52 - utils - INFO - Computing majority voting ensemble...
2025-11-06 18:51:52 - utils - INFO - Majority voting: 11 anomalies detected
2025-11-06 18:51:52 - utils - INFO - Evaluating ensemble performance...
2025-11-06 18:51:52 - utils - INFO - 
============================================================
2025-11-06 18:51:52 - utils - INFO - Ensemble (majority) Performance Metrics
2025-11-06 18:51:52 - utils - INFO - ============================================================
2025-11-06 18:51:52 - utils - INFO - Accuracy:  0.9880
2025-11-06 18:51:52 - utils - INFO - Precision: 0.0000
2025-11-06 18:51:52 - utils - INFO - Recall:    0.0000
2025-11-06 18:51:52 - utils - INFO - F1-Score:  0.0000
2025-11-06 18:51:52 - utils - INFO - AUC-ROC:   0.8018
2025-11-06 18:51:52 - utils - INFO - ============================================================

2025-11-06 18:51:52 - utils - INFO - Comparing ensemble with individual models...
2025-11-06 18:51:52 - utils - INFO - Evaluating ensemble performance...
2025-11-06 18:51:52 - utils - INFO - 
============================================================
2025-11-06 18:51:52 - utils - INFO - Ensemble (majority) Performance Metrics
2025-11-06 18:51:52 - utils - INFO - ============================================================
2025-11-06 18:51:52 - utils - INFO - Accuracy:  0.9880
2025-11-06 18:51:52 - utils - INFO - Precision: 0.0000
2025-11-06 18:51:52 - utils - INFO - Recall:    0.0000
2025-11-06 18:51:52 - utils - INFO - F1-Score:  0.0000
2025-11-06 18:51:52 - utils - INFO - AUC-ROC:   0.8018
2025-11-06 18:51:52 - utils - INFO - ============================================================

2025-11-06 18:51:52 - utils - INFO - 
Comparison Results:
2025-11-06 18:51:52 - utils - INFO - 
              model  accuracy  precision  recall  f1_score  auc_roc
   Isolation Forest     0.945        0.0     0.0       0.0   0.8208
   Lstm Autoencoder     0.946        0.0     0.0       0.0   0.1842
    Deep Clustering     0.959        0.0     0.0       0.0   0.7407
Ensemble (majority)     0.988        0.0     0.0       0.0   0.8018
2025-11-06 18:51:52 - utils - INFO - Ensemble predictions saved
2025-11-06 18:51:52 - utils - INFO - Generating alerts...
2025-11-06 18:51:52 - utils - ERROR - Error with majority ensemble: 'severity'
2025-11-06 18:51:52 - utils - INFO - Initialized Ensemble Detector with method: cascade
2025-11-06 18:51:52 - utils - INFO - 
================================================================================
                            ENSEMBLE SYSTEM PIPELINE                            
================================================================================

2025-11-06 18:51:52 - utils - INFO - Loading predictions from individual models...
2025-11-06 18:51:52 - utils - INFO - Loaded isolation_forest predictions: 1000 samples
2025-11-06 18:51:52 - utils - INFO - Loaded lstm_autoencoder predictions: 32531 samples
2025-11-06 18:51:52 - utils - INFO - Loaded deep_clustering predictions: 1000 samples
2025-11-06 18:51:52 - utils - WARNING - Models have different sample counts: {'isolation_forest': 1000, 'lstm_autoencoder': 32531, 'deep_clustering': 1000}
2025-11-06 18:51:52 - utils - INFO - Will use aggregation strategy to align predictions...
2025-11-06 18:51:52 - utils - INFO - Aligning predictions across models...
2025-11-06 18:51:52 - utils - INFO - Using isolation_forest as reference (1000 samples)
2025-11-06 18:51:52 - utils - INFO - Aggregating lstm_autoencoder from 32531 to 1000 samples
2025-11-06 18:51:52 - utils - INFO - Predictions aligned successfully
2025-11-06 18:51:52 - utils - INFO - Loaded predictions from 3 models
2025-11-06 18:51:52 - utils - INFO - Computing cascade ensemble...
2025-11-06 18:51:52 - utils - INFO - Cascade ensemble: 0 anomalies detected
2025-11-06 18:51:52 - utils - INFO - Evaluating ensemble performance...
2025-11-06 18:51:52 - utils - INFO - 
============================================================
2025-11-06 18:51:52 - utils - INFO - Ensemble (cascade) Performance Metrics
2025-11-06 18:51:52 - utils - INFO - ============================================================
2025-11-06 18:51:52 - utils - INFO - Accuracy:  0.9990
2025-11-06 18:51:52 - utils - INFO - Precision: 0.0000
2025-11-06 18:51:52 - utils - INFO - Recall:    0.0000
2025-11-06 18:51:52 - utils - INFO - F1-Score:  0.0000
2025-11-06 18:51:52 - utils - INFO - AUC-ROC:   0.7067
2025-11-06 18:51:52 - utils - INFO - ============================================================

2025-11-06 18:51:52 - utils - INFO - Comparing ensemble with individual models...
2025-11-06 18:51:52 - utils - INFO - Evaluating ensemble performance...
2025-11-06 18:51:52 - utils - INFO - 
============================================================
2025-11-06 18:51:52 - utils - INFO - Ensemble (cascade) Performance Metrics
2025-11-06 18:51:52 - utils - INFO - ============================================================
2025-11-06 18:51:52 - utils - INFO - Accuracy:  0.9990
2025-11-06 18:51:52 - utils - INFO - Precision: 0.0000
2025-11-06 18:51:52 - utils - INFO - Recall:    0.0000
2025-11-06 18:51:52 - utils - INFO - F1-Score:  0.0000
2025-11-06 18:51:52 - utils - INFO - AUC-ROC:   0.7067
2025-11-06 18:51:52 - utils - INFO - ============================================================

2025-11-06 18:51:52 - utils - INFO - 
Comparison Results:
2025-11-06 18:51:52 - utils - INFO - 
             model  accuracy  precision  recall  f1_score  auc_roc
  Isolation Forest     0.945        0.0     0.0       0.0   0.8208
  Lstm Autoencoder     0.946        0.0     0.0       0.0   0.1842
   Deep Clustering     0.959        0.0     0.0       0.0   0.7407
Ensemble (cascade)     0.999        0.0     0.0       0.0   0.7067
2025-11-06 18:51:52 - utils - INFO - Ensemble predictions saved
2025-11-06 18:51:52 - utils - INFO - Generating alerts...
2025-11-06 18:51:52 - utils - INFO - Generated 35 alerts
2025-11-06 18:51:52 - utils - INFO - Severity distribution:
severity
medium      26
critical     6
high         3
Name: count, dtype: int64
2025-11-06 18:51:52 - utils - INFO - Alerts saved to /Users/bipinrimal/Downloads/Thesis_work/results/generated_alerts.csv
2025-11-06 18:51:52 - utils - INFO - Ensemble pipeline completed!
2025-11-06 18:51:52 - utils - INFO - 
✓ Stage 5 completed: Best ensemble method = None (F1=0.0000)
2025-11-06 18:56:35 - utils - INFO - Utility functions loaded successfully
2025-11-06 18:56:38 - utils - INFO - ================================================================================
2025-11-06 18:56:38 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-11-06 18:56:38 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-11-06 18:56:38 - utils - INFO - ================================================================================
2025-11-06 18:56:38 - utils - INFO - 
================================================================================
                           STAGE 4: MODEL EVALUATION                            
================================================================================

2025-11-06 18:56:55 - utils - INFO - Utility functions loaded successfully
2025-11-06 18:56:58 - utils - INFO - ================================================================================
2025-11-06 18:56:58 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-11-06 18:56:58 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-11-06 18:56:58 - utils - INFO - ================================================================================
2025-11-06 18:56:58 - utils - INFO - 
================================================================================
                           STAGE 4: MODEL EVALUATION                            
================================================================================

2025-11-06 18:57:18 - utils - INFO - Utility functions loaded successfully
2025-11-06 18:57:18 - utils - INFO - 
================================================================================
                       MODEL DIAGNOSIS & THRESHOLD TUNING                       
================================================================================

2025-11-06 18:57:18 - utils - INFO - 
================================================================================
2025-11-06 18:57:18 - utils - INFO - Diagnosing: Isolation Forest
2025-11-06 18:57:18 - utils - INFO - ================================================================================
2025-11-06 18:57:18 - utils - INFO - Loaded 1000 predictions for isolation_forest
2025-11-06 18:57:19 - utils - INFO - --- Optimal Threshold Found ---
2025-11-06 18:57:19 - utils - INFO - Best F1-Score: 0.0105
2025-11-06 18:57:19 - utils - INFO - Precision:     0.0053
2025-11-06 18:57:19 - utils - INFO - Recall:        1.0000
2025-11-06 18:57:19 - utils - INFO - Threshold:     0.3838
2025-11-06 18:57:19 - utils - INFO - Threshold analysis plot saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/isolation_forest_threshold_analysis.png
2025-11-06 18:57:19 - utils - INFO - 
================================================================================
2025-11-06 18:57:19 - utils - INFO - Diagnosing: Deep Clustering
2025-11-06 18:57:19 - utils - INFO - ================================================================================
2025-11-06 18:57:19 - utils - INFO - Loaded 1000 predictions for deep_clustering
2025-11-06 18:57:19 - utils - INFO - --- Optimal Threshold Found ---
2025-11-06 18:57:19 - utils - INFO - Best F1-Score: 0.0076
2025-11-06 18:57:19 - utils - INFO - Precision:     0.0038
2025-11-06 18:57:19 - utils - INFO - Recall:        1.0000
2025-11-06 18:57:19 - utils - INFO - Threshold:     0.3535
2025-11-06 18:57:19 - utils - INFO - Threshold analysis plot saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/deep_clustering_threshold_analysis.png
2025-11-06 18:57:19 - utils - INFO - 
================================================================================
2025-11-06 18:57:19 - utils - INFO - Diagnosing: Lstm Autoencoder
2025-11-06 18:57:19 - utils - INFO - ================================================================================
2025-11-06 18:57:19 - utils - INFO - Loaded 32531 predictions for lstm_autoencoder
2025-11-06 18:57:20 - utils - INFO - --- Optimal Threshold Found ---
2025-11-06 18:57:20 - utils - INFO - Best F1-Score: 0.0060
2025-11-06 18:57:20 - utils - INFO - Precision:     0.0030
2025-11-06 18:57:20 - utils - INFO - Recall:        1.0000
2025-11-06 18:57:20 - utils - INFO - Threshold:     0.0808
2025-11-06 18:57:20 - utils - INFO - Threshold analysis plot saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/lstm_autoencoder_threshold_analysis.png
2025-11-06 18:57:20 - utils - INFO - 
================================================================================
2025-11-06 18:57:20 - utils - INFO - OPTIMAL PERFORMANCE SUMMARY
2025-11-06 18:57:20 - utils - INFO - ================================================================================
2025-11-06 18:57:20 - utils - INFO - 
Optimal report saved to /Users/bipinrimal/Downloads/Thesis_work/results/optimal_evaluation_report.csv
2025-11-06 18:58:31 - utils - INFO - Utility functions loaded successfully
2025-11-06 18:58:34 - utils - INFO - ================================================================================
2025-11-06 18:58:34 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-11-06 18:58:34 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-11-06 18:58:34 - utils - INFO - ================================================================================
2025-11-06 18:58:34 - utils - INFO - 
================================================================================
                           STAGE 4: MODEL EVALUATION                            
================================================================================

2025-11-06 19:00:24 - utils - INFO - Utility functions loaded successfully
2025-11-06 19:00:26 - utils - INFO - ================================================================================
2025-11-06 19:00:26 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-11-06 19:00:26 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-11-06 19:00:26 - utils - INFO - ================================================================================
2025-11-06 19:00:26 - utils - INFO - 
================================================================================
                           STAGE 4: MODEL EVALUATION                            
================================================================================

2025-11-06 19:00:26 - utils - INFO - 
================================================================================
                         COMPREHENSIVE MODEL EVALUATION                         
================================================================================

2025-11-06 19:00:26 - utils - INFO - Loading results for all models...
2025-11-06 19:00:26 - utils - INFO - Loaded results for isolation_forest
2025-11-06 19:00:26 - utils - INFO - Loaded results for lstm_autoencoder
2025-11-06 19:00:26 - utils - INFO - Loaded results for deep_clustering
2025-11-06 19:00:26 - utils - INFO - Loaded results for 3 models
2025-11-06 19:00:26 - utils - INFO - Creating metrics comparison table...
2025-11-06 19:00:26 - utils - INFO - Metrics comparison table created
2025-11-06 19:00:26 - utils - INFO - Creating confusion matrix plots...
2025-11-06 19:00:26 - utils - INFO - Confusion matrices saved to /Users/bipinrimal/Downloads/Thesis_work/results/confusion_matrices/all_models.png
2025-11-06 19:00:26 - utils - INFO - Creating ROC curves...
2025-11-06 19:00:26 - utils - INFO - ROC curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/roc_curves/roc_comparison.png
2025-11-06 19:00:26 - utils - INFO - Creating Precision-Recall curves...
2025-11-06 19:00:26 - utils - INFO - Precision-Recall curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/precision_recall_comparison.png
2025-11-06 19:00:26 - utils - INFO - Creating metrics comparison bar chart...
2025-11-06 19:00:27 - utils - INFO - Metrics comparison bar chart saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/metrics_comparison_bar.png
2025-11-06 19:00:27 - utils - INFO - Creating anomaly score distribution plots...
2025-11-06 19:00:27 - utils - INFO - Score distributions saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/score_distributions.png
2025-11-06 19:00:27 - utils - INFO - Generating evaluation report...
2025-11-06 19:00:27 - utils - INFO - Evaluation report saved to /Users/bipinrimal/Downloads/Thesis_work/results/evaluation_report.txt
2025-11-06 19:00:27 - utils - INFO - Comprehensive evaluation completed!
2025-11-06 19:00:27 - utils - INFO - ✓ Stage 4 completed: Comprehensive evaluation report generated
2025-11-06 19:00:59 - utils - INFO - Utility functions loaded successfully
2025-11-06 19:01:02 - utils - INFO - ================================================================================
2025-11-06 19:01:02 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-11-06 19:01:02 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-11-06 19:01:02 - utils - INFO - ================================================================================
2025-11-06 19:01:02 - utils - INFO - 
================================================================================
                             STAGE 6: VISUALIZATION                             
================================================================================

2025-11-06 19:01:02 - utils - INFO - 
================================================================================
                           GENERATING VISUALIZATIONS                            
================================================================================

2025-11-06 19:01:02 - utils - INFO - Creating alert severity distribution plot...
2025-11-06 19:01:02 - utils - INFO - Alert severity distribution plot saved
2025-11-06 19:01:02 - utils - INFO - Creating model agreement plot...
2025-11-06 19:01:02 - utils - INFO - Model agreement plot saved
2025-11-06 19:01:02 - utils - INFO - Creating anomaly score timeline for ensemble_weighted...
2025-11-06 19:01:02 - utils - INFO - Anomaly score timeline saved for ensemble_weighted
2025-11-06 19:01:02 - utils - INFO - Creating feature importance visualization...
2025-11-06 19:01:02 - utils - INFO - Feature importance heatmap saved
2025-11-06 19:01:02 - utils - INFO - Creating executive summary chart...
2025-11-06 19:01:03 - utils - INFO - Executive summary chart saved
2025-11-06 19:01:03 - utils - INFO - All visualizations saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations
2025-11-06 19:01:03 - utils - INFO - Visualization generation completed!
2025-11-06 19:01:03 - utils - INFO - ✓ Stage 6 completed: All visualizations generated
2025-11-09 11:07:31 - utils - INFO - Utility functions loaded successfully
2025-11-09 11:07:35 - utils - INFO - ================================================================================
2025-11-09 11:07:35 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-11-09 11:07:35 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-11-09 11:07:35 - utils - INFO - ================================================================================
2025-11-09 11:07:35 - utils - INFO - 
================================================================================
                           STAGE 4: MODEL EVALUATION                            
================================================================================

2025-11-09 11:07:35 - utils - INFO - 
================================================================================
                         COMPREHENSIVE MODEL EVALUATION                         
================================================================================

2025-11-09 11:07:35 - utils - INFO - Loading results for all models...
2025-11-09 11:07:35 - utils - INFO - Loaded results for isolation_forest
2025-11-09 11:07:35 - utils - INFO - Loaded results for lstm_autoencoder
2025-11-09 11:07:35 - utils - INFO - Loaded results for deep_clustering
2025-11-09 11:07:35 - utils - INFO - Loaded results for 3 models
2025-11-09 11:07:35 - utils - INFO - Creating metrics comparison table...
2025-11-09 11:07:35 - utils - INFO - Metrics comparison table created
2025-11-09 11:07:35 - utils - INFO - Creating confusion matrix plots...
2025-11-09 11:07:35 - utils - INFO - Confusion matrices saved to /Users/bipinrimal/Downloads/Thesis_work/results/confusion_matrices/all_models.png
2025-11-09 11:07:35 - utils - INFO - Creating ROC curves...
2025-11-09 11:07:35 - utils - INFO - ROC curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/roc_curves/roc_comparison.png
2025-11-09 11:07:35 - utils - INFO - Creating Precision-Recall curves...
2025-11-09 11:07:35 - utils - INFO - Precision-Recall curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/precision_recall_comparison.png
2025-11-09 11:07:35 - utils - INFO - Creating metrics comparison bar chart...
2025-11-09 11:07:35 - utils - INFO - Metrics comparison bar chart saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/metrics_comparison_bar.png
2025-11-09 11:07:35 - utils - INFO - Creating anomaly score distribution plots...
2025-11-09 11:07:35 - utils - INFO - Score distributions saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/score_distributions.png
2025-11-09 11:07:35 - utils - INFO - Generating evaluation report...
2025-11-09 11:07:35 - utils - INFO - Evaluation report saved to /Users/bipinrimal/Downloads/Thesis_work/results/evaluation_report.txt
2025-11-09 11:07:35 - utils - INFO - Comprehensive evaluation completed!
2025-11-09 11:07:35 - utils - INFO - ✓ Stage 4 completed: Comprehensive evaluation report generated
2025-11-09 11:07:48 - utils - INFO - Utility functions loaded successfully
2025-11-09 11:08:41 - utils - INFO - Utility functions loaded successfully
2025-11-09 11:08:41 - utils - INFO - 
================================================================================
                       MODEL DIAGNOSIS & THRESHOLD TUNING                       
================================================================================

2025-11-09 11:08:41 - utils - INFO - 
================================================================================
2025-11-09 11:08:41 - utils - INFO - Diagnosing: Isolation Forest
2025-11-09 11:08:41 - utils - INFO - ================================================================================
2025-11-09 11:08:41 - utils - INFO - Loaded 1000 predictions for isolation_forest
2025-11-09 11:08:41 - utils - INFO - --- Optimal Threshold Found ---
2025-11-09 11:08:41 - utils - INFO - Best F1-Score: 0.0105
2025-11-09 11:08:41 - utils - INFO - Precision:     0.0053
2025-11-09 11:08:41 - utils - INFO - Recall:        1.0000
2025-11-09 11:08:41 - utils - INFO - Threshold:     0.3838
2025-11-09 11:08:41 - utils - INFO - Threshold analysis plot saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/isolation_forest_threshold_analysis.png
2025-11-09 11:08:41 - utils - INFO - 
================================================================================
2025-11-09 11:08:41 - utils - INFO - Diagnosing: Deep Clustering
2025-11-09 11:08:41 - utils - INFO - ================================================================================
2025-11-09 11:08:42 - utils - INFO - Loaded 1000 predictions for deep_clustering
2025-11-09 11:08:42 - utils - INFO - --- Optimal Threshold Found ---
2025-11-09 11:08:42 - utils - INFO - Best F1-Score: 0.0076
2025-11-09 11:08:42 - utils - INFO - Precision:     0.0038
2025-11-09 11:08:42 - utils - INFO - Recall:        1.0000
2025-11-09 11:08:42 - utils - INFO - Threshold:     0.3535
2025-11-09 11:08:42 - utils - INFO - Threshold analysis plot saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/deep_clustering_threshold_analysis.png
2025-11-09 11:08:42 - utils - INFO - 
================================================================================
2025-11-09 11:08:42 - utils - INFO - Diagnosing: Lstm Autoencoder
2025-11-09 11:08:42 - utils - INFO - ================================================================================
2025-11-09 11:08:42 - utils - INFO - Loaded 32531 predictions for lstm_autoencoder
2025-11-09 11:08:42 - utils - INFO - --- Optimal Threshold Found ---
2025-11-09 11:08:42 - utils - INFO - Best F1-Score: 0.0060
2025-11-09 11:08:42 - utils - INFO - Precision:     0.0030
2025-11-09 11:08:42 - utils - INFO - Recall:        1.0000
2025-11-09 11:08:42 - utils - INFO - Threshold:     0.0808
2025-11-09 11:08:43 - utils - INFO - Threshold analysis plot saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/lstm_autoencoder_threshold_analysis.png
2025-11-09 11:08:43 - utils - INFO - 
================================================================================
2025-11-09 11:08:43 - utils - INFO - OPTIMAL PERFORMANCE SUMMARY
2025-11-09 11:08:43 - utils - INFO - ================================================================================
2025-11-09 11:08:43 - utils - INFO - 
Optimal report saved to /Users/bipinrimal/Downloads/Thesis_work/results/optimal_evaluation_report.csv
2025-11-09 11:09:21 - utils - INFO - Utility functions loaded successfully
2025-11-09 11:09:24 - utils - INFO - ================================================================================
2025-11-09 11:09:24 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-11-09 11:09:24 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-11-09 11:09:24 - utils - INFO - ================================================================================
2025-11-09 11:09:24 - utils - INFO - 
================================================================================
                             STAGE 6: VISUALIZATION                             
================================================================================

2025-11-09 11:09:41 - utils - INFO - Utility functions loaded successfully
2025-11-09 11:09:44 - utils - INFO - ================================================================================
2025-11-09 11:09:44 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-11-09 11:09:44 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-11-09 11:09:44 - utils - INFO - ================================================================================
2025-11-09 11:09:44 - utils - INFO - 
================================================================================
                             STAGE 6: VISUALIZATION                             
================================================================================

2025-11-09 11:09:44 - utils - INFO - 
================================================================================
                           GENERATING VISUALIZATIONS                            
================================================================================

2025-11-09 11:09:44 - utils - INFO - Creating alert severity distribution plot...
2025-11-09 11:09:44 - utils - INFO - Alert severity distribution plot saved
2025-11-09 11:09:44 - utils - INFO - Creating model agreement plot...
2025-11-09 11:09:44 - utils - INFO - Model agreement plot saved
2025-11-09 11:09:44 - utils - INFO - Creating anomaly score timeline for ensemble_weighted...
2025-11-09 11:09:44 - utils - INFO - Anomaly score timeline saved for ensemble_weighted
2025-11-09 11:09:44 - utils - INFO - Creating feature importance visualization...
2025-11-09 11:09:44 - utils - INFO - Feature importance heatmap saved
2025-11-09 11:09:44 - utils - INFO - Creating executive summary chart...
2025-11-09 11:09:45 - utils - INFO - Executive summary chart saved
2025-11-09 11:09:45 - utils - INFO - All visualizations saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations
2025-11-09 11:09:45 - utils - INFO - Visualization generation completed!
2025-11-09 11:09:45 - utils - INFO - ✓ Stage 6 completed: All visualizations generated
2025-11-09 11:14:17 - utils - INFO - Utility functions loaded successfully
2025-11-09 11:14:17 - utils - INFO - 
================================================================================
                           IMBALANCED DATA EVALUATION                           
================================================================================

2025-11-09 11:14:17 - utils - INFO - 
================================================================================
2025-11-09 11:14:17 - utils - INFO - Evaluating: Isolation Forest
2025-11-09 11:14:17 - utils - INFO - ================================================================================
2025-11-09 11:14:17 - utils - INFO - Loaded isolation_forest: 1000 samples, 1 insiders
2025-11-09 11:14:17 - utils - INFO - 
Dataset: 1,000 samples, 1 insiders (0.1000%)
2025-11-09 11:14:17 - utils - INFO - AUC-ROC: 0.8208
2025-11-09 11:14:17 - utils - INFO - 
Precision at K (Top K alerts):
2025-11-09 11:14:17 - utils - INFO -   Top 10: 0.00% of alerts are real threats
2025-11-09 11:14:17 - utils - INFO -   Top 50: 0.00% of alerts are real threats
2025-11-09 11:14:17 - utils - INFO -   Top 100: 0.00% of alerts are real threats
2025-11-09 11:14:17 - utils - INFO -   Top 500: 0.20% of alerts are real threats
2025-11-09 11:14:17 - utils - INFO - 
Recall at Fixed False Positive Rate:
2025-11-09 11:14:17 - utils - INFO -   At 1% FPR: Catch 0.0% of insiders
2025-11-09 11:14:17 - utils - INFO -   At 5% FPR: Catch 0.0% of insiders
2025-11-09 11:14:17 - utils - INFO -   At 10% FPR: Catch 0.0% of insiders
2025-11-09 11:14:17 - utils - INFO - 
Insider Rankings (lower is better):
2025-11-09 11:14:17 - utils - INFO -   Insider #1 ranked: #180 / 1000 (top 18.00%)
2025-11-09 11:14:17 - utils - INFO - 
================================================================================
2025-11-09 11:14:17 - utils - INFO - Evaluating: Deep Clustering
2025-11-09 11:14:17 - utils - INFO - ================================================================================
2025-11-09 11:14:17 - utils - INFO - Loaded deep_clustering: 1000 samples, 1 insiders
2025-11-09 11:14:17 - utils - INFO - 
Dataset: 1,000 samples, 1 insiders (0.1000%)
2025-11-09 11:14:17 - utils - INFO - AUC-ROC: 0.7407
2025-11-09 11:14:17 - utils - INFO - 
Precision at K (Top K alerts):
2025-11-09 11:14:17 - utils - INFO -   Top 10: 0.00% of alerts are real threats
2025-11-09 11:14:17 - utils - INFO -   Top 50: 0.00% of alerts are real threats
2025-11-09 11:14:17 - utils - INFO -   Top 100: 0.00% of alerts are real threats
2025-11-09 11:14:17 - utils - INFO -   Top 500: 0.20% of alerts are real threats
2025-11-09 11:14:17 - utils - INFO - 
Recall at Fixed False Positive Rate:
2025-11-09 11:14:17 - utils - INFO -   At 1% FPR: Catch 0.0% of insiders
2025-11-09 11:14:17 - utils - INFO -   At 5% FPR: Catch 0.0% of insiders
2025-11-09 11:14:17 - utils - INFO -   At 10% FPR: Catch 0.0% of insiders
2025-11-09 11:14:17 - utils - INFO - 
Insider Rankings (lower is better):
2025-11-09 11:14:17 - utils - INFO -   Insider #1 ranked: #260 / 1000 (top 26.00%)
2025-11-09 11:14:17 - utils - INFO - 
================================================================================
2025-11-09 11:14:17 - utils - INFO - Evaluating: Lstm Autoencoder
2025-11-09 11:14:17 - utils - INFO - ================================================================================
2025-11-09 11:14:17 - utils - INFO - Loaded lstm_autoencoder: 32531 samples, 2 insiders
2025-11-09 11:14:17 - utils - INFO - 
Dataset: 32,531 samples, 2 insiders (0.0061%)
2025-11-09 11:14:17 - utils - INFO - AUC-ROC: 0.9849
2025-11-09 11:14:17 - utils - INFO - 
Precision at K (Top K alerts):
2025-11-09 11:14:17 - utils - INFO -   Top 10: 0.00% of alerts are real threats
2025-11-09 11:14:17 - utils - INFO -   Top 50: 0.00% of alerts are real threats
2025-11-09 11:14:17 - utils - INFO -   Top 100: 0.00% of alerts are real threats
2025-11-09 11:14:17 - utils - INFO -   Top 500: 0.20% of alerts are real threats
2025-11-09 11:14:17 - utils - INFO - 
Recall at Fixed False Positive Rate:
2025-11-09 11:14:17 - utils - INFO -   At 1% FPR: Catch 0.0% of insiders
2025-11-09 11:14:17 - utils - INFO -   At 5% FPR: Catch 100.0% of insiders
2025-11-09 11:14:17 - utils - INFO -   At 10% FPR: Catch 100.0% of insiders
2025-11-09 11:14:17 - utils - INFO - 
Insider Rankings (lower is better):
2025-11-09 11:14:17 - utils - INFO -   Insider #1 ranked: #567 / 32531 (top 1.74%)
2025-11-09 11:14:17 - utils - INFO -   Insider #2 ranked: #418 / 32531 (top 1.28%)
2025-11-09 11:14:17 - utils - INFO - 
================================================================================
2025-11-09 11:14:17 - utils - INFO - COMPREHENSIVE COMPARISON
2025-11-09 11:14:17 - utils - INFO - ================================================================================

2025-11-09 11:14:17 - utils - INFO - 
Saved to: /Users/bipinrimal/Downloads/Thesis_work/results/proper_evaluation_metrics.csv
2025-11-09 11:14:17 - utils - INFO - Loaded isolation_forest: 1000 samples, 1 insiders
2025-11-09 11:14:17 - utils - INFO - Loaded deep_clustering: 1000 samples, 1 insiders
2025-11-09 11:14:17 - utils - INFO - Loaded lstm_autoencoder: 32531 samples, 2 insiders
2025-11-09 11:14:17 - utils - INFO - 
Ranking analysis saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/insider_ranking_analysis.png
2025-11-09 11:17:14 - utils - INFO - Utility functions loaded successfully
2025-11-09 11:17:28 - utils - INFO - Utility functions loaded successfully
2025-11-09 11:17:28 - utils - INFO - 
================================================================================
                       MODEL DIAGNOSIS & THRESHOLD TUNING                       
================================================================================

2025-11-09 11:17:28 - utils - INFO - 
================================================================================
2025-11-09 11:17:28 - utils - INFO - Diagnosing: Isolation Forest
2025-11-09 11:17:28 - utils - INFO - ================================================================================
2025-11-09 11:17:28 - utils - INFO - Loaded 1000 predictions for isolation_forest
2025-11-09 11:17:28 - utils - INFO - --- Optimal Threshold Found ---
2025-11-09 11:17:28 - utils - INFO - Best F1-Score: 0.0105
2025-11-09 11:17:28 - utils - INFO - Precision:     0.0053
2025-11-09 11:17:28 - utils - INFO - Recall:        1.0000
2025-11-09 11:17:28 - utils - INFO - Threshold:     0.3838
2025-11-09 11:17:29 - utils - INFO - Threshold analysis plot saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/isolation_forest_threshold_analysis.png
2025-11-09 11:17:29 - utils - INFO - 
================================================================================
2025-11-09 11:17:29 - utils - INFO - Diagnosing: Deep Clustering
2025-11-09 11:17:29 - utils - INFO - ================================================================================
2025-11-09 11:17:29 - utils - INFO - Loaded 1000 predictions for deep_clustering
2025-11-09 11:17:29 - utils - INFO - --- Optimal Threshold Found ---
2025-11-09 11:17:29 - utils - INFO - Best F1-Score: 0.0076
2025-11-09 11:17:29 - utils - INFO - Precision:     0.0038
2025-11-09 11:17:29 - utils - INFO - Recall:        1.0000
2025-11-09 11:17:29 - utils - INFO - Threshold:     0.3535
2025-11-09 11:17:29 - utils - INFO - Threshold analysis plot saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/deep_clustering_threshold_analysis.png
2025-11-09 11:17:29 - utils - INFO - 
================================================================================
2025-11-09 11:17:29 - utils - INFO - Diagnosing: Lstm Autoencoder
2025-11-09 11:17:29 - utils - INFO - ================================================================================
2025-11-09 11:17:29 - utils - INFO - Loaded 32531 predictions for lstm_autoencoder
2025-11-09 11:17:29 - utils - INFO - --- Optimal Threshold Found ---
2025-11-09 11:17:29 - utils - INFO - Best F1-Score: 0.0060
2025-11-09 11:17:29 - utils - INFO - Precision:     0.0030
2025-11-09 11:17:29 - utils - INFO - Recall:        1.0000
2025-11-09 11:17:29 - utils - INFO - Threshold:     0.0808
2025-11-09 11:17:30 - utils - INFO - Threshold analysis plot saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/lstm_autoencoder_threshold_analysis.png
2025-11-09 11:17:30 - utils - INFO - 
================================================================================
2025-11-09 11:17:30 - utils - INFO - OPTIMAL PERFORMANCE SUMMARY
2025-11-09 11:17:30 - utils - INFO - ================================================================================
2025-11-09 11:17:30 - utils - INFO - 
Optimal report saved to /Users/bipinrimal/Downloads/Thesis_work/results/optimal_evaluation_report.csv
2025-11-09 11:25:54 - utils - INFO - Utility functions loaded successfully
2025-11-09 11:25:59 - utils - INFO - ================================================================================
2025-11-09 11:25:59 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-11-09 11:25:59 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-11-09 11:25:59 - utils - INFO - ================================================================================
2025-11-09 11:25:59 - utils - INFO - 
================================================================================
                           STAGE 4: MODEL EVALUATION                            
================================================================================

2025-11-09 11:26:07 - utils - INFO - Utility functions loaded successfully
2025-11-09 11:26:10 - utils - INFO - ================================================================================
2025-11-09 11:26:10 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-11-09 11:26:10 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-11-09 11:26:10 - utils - INFO - ================================================================================
2025-11-09 11:26:10 - utils - INFO - 
================================================================================
                           STAGE 4: MODEL EVALUATION                            
================================================================================

2025-11-09 11:26:10 - utils - INFO - 
================================================================================
                         COMPREHENSIVE MODEL EVALUATION                         
================================================================================

2025-11-09 11:26:10 - utils - INFO - Loading results for all models...
2025-11-09 11:26:10 - utils - INFO - Loaded results for isolation_forest
2025-11-09 11:26:10 - utils - INFO - Loaded results for lstm_autoencoder
2025-11-09 11:26:10 - utils - INFO - Loaded results for deep_clustering
2025-11-09 11:26:10 - utils - INFO - Loaded results for 3 models
2025-11-09 11:26:10 - utils - INFO - Creating metrics comparison table...
2025-11-09 11:26:10 - utils - INFO - Metrics comparison table created
2025-11-09 11:26:10 - utils - INFO - Creating confusion matrix plots...
2025-11-09 11:26:10 - utils - INFO - Confusion matrices saved to /Users/bipinrimal/Downloads/Thesis_work/results/confusion_matrices/all_models.png
2025-11-09 11:26:10 - utils - INFO - Creating ROC curves...
2025-11-09 11:26:10 - utils - INFO - ROC curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/roc_curves/roc_comparison.png
2025-11-09 11:26:10 - utils - INFO - Creating Precision-Recall curves...
2025-11-09 11:26:10 - utils - INFO - Precision-Recall curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/precision_recall_comparison.png
2025-11-09 11:26:10 - utils - INFO - Creating metrics comparison bar chart...
2025-11-09 11:26:10 - utils - INFO - Metrics comparison bar chart saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/metrics_comparison_bar.png
2025-11-09 11:26:10 - utils - INFO - Creating anomaly score distribution plots...
2025-11-09 11:26:10 - utils - INFO - Score distributions saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/score_distributions.png
2025-11-09 11:26:10 - utils - INFO - Generating evaluation report...
2025-11-09 11:26:10 - utils - INFO - Evaluation report saved to /Users/bipinrimal/Downloads/Thesis_work/results/evaluation_report.txt
2025-11-09 11:26:10 - utils - INFO - Comprehensive evaluation completed!
2025-11-09 11:26:10 - utils - INFO - ✓ Stage 4 completed: Comprehensive evaluation report generated
2025-11-09 12:54:12 - utils - INFO - Utility functions loaded successfully
2025-11-09 12:54:12 - utils - INFO - Found 8 dataset folders in /Users/bipinrimal/Downloads/Thesis_work/data/all_data
2025-11-09 12:54:12 - utils - INFO - 
================================================================================
                DATA PREPROCESSING PIPELINE (V2: MULTI-DATASET)                 
================================================================================

2025-11-09 12:54:12 - utils - INFO - --- Processing folder: r4.2 ---
2025-11-09 12:54:13 - utils - INFO - Loaded logon.csv (854859 rows)
2025-11-09 12:54:13 - utils - INFO - Loaded device.csv (405380 rows)
2025-11-09 12:54:14 - utils - INFO - Loaded file.csv (445581 rows)
2025-11-09 12:54:22 - utils - INFO - Loaded email.csv (2629979 rows)
2025-11-09 13:03:43 - utils - INFO - Loaded http.csv (28434423 rows)
2025-11-09 13:03:43 - utils - INFO - --- Processing folder: r3.2 ---
2025-11-09 13:03:43 - utils - INFO - Loaded logon.csv (845351 rows)
2025-11-09 13:03:44 - utils - INFO - Loaded device.csv (407908 rows)
2025-11-09 13:03:45 - utils - INFO - Loaded file.csv (434769 rows)
2025-11-09 13:03:53 - utils - INFO - Loaded email.csv (1975101 rows)
2025-11-09 13:08:45 - utils - INFO - Loaded http.csv (23845079 rows)
2025-11-09 13:08:45 - utils - INFO - --- Processing folder: r1 ---
2025-11-09 13:08:47 - utils - INFO - Loaded logon.csv (849579 rows)
2025-11-09 13:08:47 - utils - INFO - Loaded device.csv (65668 rows)
2025-11-09 13:08:47 - utils - WARNING - file.csv not found in r1, skipping.
2025-11-09 13:08:47 - utils - WARNING - email.csv not found in r1, skipping.
2025-11-09 13:08:51 - utils - INFO - Loaded http.csv (3451664 rows)
2025-11-09 13:08:51 - utils - INFO - --- Processing folder: r5.1 ---
2025-11-09 13:08:53 - utils - INFO - Loaded logon.csv (1829996 rows)
2025-11-09 13:08:54 - utils - INFO - Loaded device.csv (908379 rows)
2025-11-09 13:08:57 - utils - INFO - Loaded file.csv (947613 rows)
2025-11-09 13:10:17 - utils - INFO - Loaded email.csv (17608751 rows)
2025-11-09 13:12:30 - utils - INFO - Utility functions loaded successfully
2025-11-09 13:12:30 - utils - INFO - Found 8 dataset folders in /Users/bipinrimal/Downloads/Thesis_work/data/all_data
2025-11-09 13:12:30 - utils - INFO - 
================================================================================
                DATA PREPROCESSING PIPELINE (V2: MULTI-DATASET)                 
================================================================================

2025-11-09 13:12:30 - utils - INFO - --- Processing folder: r4.2 ---
2025-11-09 13:12:31 - utils - INFO - Loaded logon.csv (854859 rows)
2025-11-09 13:12:31 - utils - INFO - Loaded device.csv (405380 rows)
2025-11-09 13:12:32 - utils - INFO - Loaded file.csv (445581 rows)
2025-11-09 13:12:41 - utils - INFO - Loaded email.csv (2629979 rows)
2025-11-09 13:20:54 - utils - INFO - Loaded http.csv (28434423 rows)
2025-11-09 13:20:54 - utils - INFO - --- Processing folder: r3.2 ---
2025-11-09 13:20:55 - utils - INFO - Loaded logon.csv (845351 rows)
2025-11-09 13:20:55 - utils - INFO - Loaded device.csv (407908 rows)
2025-11-09 13:20:57 - utils - INFO - Loaded file.csv (434769 rows)
2025-11-09 13:21:04 - utils - INFO - Loaded email.csv (1975101 rows)
2025-11-09 13:24:52 - utils - INFO - Loaded http.csv (23845079 rows)
2025-11-09 13:24:52 - utils - INFO - --- Processing folder: r1 ---
2025-11-09 13:24:53 - utils - INFO - Loaded logon.csv (849579 rows)
2025-11-09 13:24:53 - utils - INFO - Loaded device.csv (65668 rows)
2025-11-09 13:24:53 - utils - WARNING - file.csv not found in r1, skipping.
2025-11-09 13:24:53 - utils - WARNING - email.csv not found in r1, skipping.
2025-11-09 13:24:57 - utils - INFO - Loaded http.csv (3451664 rows)
2025-11-09 13:24:57 - utils - INFO - --- Processing folder: r5.1 ---
2025-11-09 13:24:58 - utils - INFO - Loaded logon.csv (1829996 rows)
2025-11-09 13:24:59 - utils - INFO - Loaded device.csv (908379 rows)
2025-11-09 13:25:01 - utils - INFO - Loaded file.csv (947613 rows)
2025-11-09 13:26:20 - utils - INFO - Loaded email.csv (17608751 rows)
2025-11-09 13:39:18 - utils - INFO - Utility functions loaded successfully
2025-11-09 13:39:18 - utils - INFO - Found 8 dataset folders in /Users/bipinrimal/Downloads/Thesis_work/data/all_data
2025-11-09 13:39:18 - utils - INFO - 
================================================================================
                 DATA PREPROCESSING PIPELINE (V2: MEMORY-SAFE)                  
================================================================================

2025-11-09 13:39:18 - utils - INFO - --- Processing single dataset: r1 ---
2025-11-09 13:39:19 - utils - INFO - Loaded logon.csv (849579 rows)
2025-11-09 13:39:19 - utils - INFO - Parsed datetime column: date
2025-11-09 13:39:19 - utils - ERROR - Failed to process /Users/bipinrimal/Downloads/Thesis_work/data/all_data/r1/logon.csv: pseudonymize_column() takes 2 positional arguments but 3 were given
2025-11-09 13:39:19 - utils - INFO - Loaded device.csv (65668 rows)
2025-11-09 13:39:20 - utils - INFO - Parsed datetime column: date
2025-11-09 13:39:20 - utils - ERROR - Failed to process /Users/bipinrimal/Downloads/Thesis_work/data/all_data/r1/device.csv: pseudonymize_column() takes 2 positional arguments but 3 were given
2025-11-09 13:39:20 - utils - WARNING - file.csv not found in r1, skipping.
2025-11-09 13:39:20 - utils - WARNING - email.csv not found in r1, skipping.
2025-11-09 13:39:22 - utils - INFO - Loaded http.csv (3451664 rows)
2025-11-09 13:39:22 - utils - ERROR - Failed to process /Users/bipinrimal/Downloads/Thesis_work/data/all_data/r1/http.csv: 'date'
2025-11-09 13:39:22 - utils - WARNING - No data processed for r1.
2025-11-09 13:39:22 - utils - INFO - --- Processing single dataset: r2 ---
2025-11-09 13:39:22 - utils - INFO - Loaded logon.csv (840141 rows)
2025-11-09 13:39:23 - utils - INFO - Parsed datetime column: date
2025-11-09 13:39:23 - utils - ERROR - Failed to process /Users/bipinrimal/Downloads/Thesis_work/data/all_data/r2/logon.csv: pseudonymize_column() takes 2 positional arguments but 3 were given
2025-11-09 13:39:24 - utils - INFO - Loaded device.csv (712308 rows)
2025-11-09 13:39:24 - utils - INFO - Parsed datetime column: date
2025-11-09 13:39:24 - utils - ERROR - Failed to process /Users/bipinrimal/Downloads/Thesis_work/data/all_data/r2/device.csv: pseudonymize_column() takes 2 positional arguments but 3 were given
2025-11-09 13:39:24 - utils - WARNING - file.csv not found in r2, skipping.
2025-11-09 13:39:25 - utils - INFO - Loaded email.csv (1189372 rows)
2025-11-09 13:39:26 - utils - INFO - Parsed datetime column: date
2025-11-09 13:39:26 - utils - ERROR - Failed to process /Users/bipinrimal/Downloads/Thesis_work/data/all_data/r2/email.csv: pseudonymize_column() takes 2 positional arguments but 3 were given
2025-11-09 13:39:32 - utils - INFO - Loaded http.csv (7321105 rows)
2025-11-09 13:39:38 - utils - INFO - Parsed datetime column: date
2025-11-09 13:39:38 - utils - ERROR - Failed to process /Users/bipinrimal/Downloads/Thesis_work/data/all_data/r2/http.csv: pseudonymize_column() takes 2 positional arguments but 3 were given
2025-11-09 13:39:38 - utils - WARNING - No data processed for r2.
2025-11-09 13:39:39 - utils - INFO - --- Processing single dataset: r3.1 ---
2025-11-09 13:39:39 - utils - INFO - Loaded logon.csv (842109 rows)
2025-11-09 13:39:40 - utils - INFO - Parsed datetime column: date
2025-11-09 13:39:40 - utils - ERROR - Failed to process /Users/bipinrimal/Downloads/Thesis_work/data/all_data/r3.1/logon.csv: pseudonymize_column() takes 2 positional arguments but 3 were given
2025-11-09 13:39:40 - utils - INFO - Loaded device.csv (417588 rows)
2025-11-09 13:39:40 - utils - INFO - Parsed datetime column: date
2025-11-09 13:39:40 - utils - ERROR - Failed to process /Users/bipinrimal/Downloads/Thesis_work/data/all_data/r3.1/device.csv: pseudonymize_column() takes 2 positional arguments but 3 were given
2025-11-09 13:39:42 - utils - INFO - Loaded file.csv (457520 rows)
2025-11-09 13:39:42 - utils - INFO - Parsed datetime column: date
2025-11-09 13:39:42 - utils - ERROR - Failed to process /Users/bipinrimal/Downloads/Thesis_work/data/all_data/r3.1/file.csv: pseudonymize_column() takes 2 positional arguments but 3 were given
2025-11-09 13:39:48 - utils - INFO - Loaded email.csv (1994071 rows)
2025-11-09 13:39:50 - utils - INFO - Parsed datetime column: date
2025-11-09 13:39:50 - utils - ERROR - Failed to process /Users/bipinrimal/Downloads/Thesis_work/data/all_data/r3.1/email.csv: pseudonymize_column() takes 2 positional arguments but 3 were given
2025-11-09 13:43:32 - utils - INFO - Loaded http.csv (23555143 rows)
2025-11-09 13:43:57 - utils - INFO - Parsed datetime column: date
2025-11-09 13:44:00 - utils - ERROR - Failed to process /Users/bipinrimal/Downloads/Thesis_work/data/all_data/r3.1/http.csv: pseudonymize_column() takes 2 positional arguments but 3 were given
2025-11-09 13:44:00 - utils - WARNING - No data processed for r3.1.
2025-11-09 13:44:01 - utils - INFO - --- Processing single dataset: r3.2 ---
2025-11-09 13:44:02 - utils - INFO - Loaded logon.csv (845351 rows)
2025-11-09 13:44:03 - utils - INFO - Parsed datetime column: date
2025-11-09 13:44:03 - utils - ERROR - Failed to process /Users/bipinrimal/Downloads/Thesis_work/data/all_data/r3.2/logon.csv: pseudonymize_column() takes 2 positional arguments but 3 were given
2025-11-09 13:44:03 - utils - INFO - Loaded device.csv (407908 rows)
2025-11-09 13:44:03 - utils - INFO - Parsed datetime column: date
2025-11-09 13:44:03 - utils - ERROR - Failed to process /Users/bipinrimal/Downloads/Thesis_work/data/all_data/r3.2/device.csv: pseudonymize_column() takes 2 positional arguments but 3 were given
2025-11-09 13:44:05 - utils - INFO - Loaded file.csv (434769 rows)
2025-11-09 13:44:05 - utils - INFO - Parsed datetime column: date
2025-11-09 13:44:05 - utils - ERROR - Failed to process /Users/bipinrimal/Downloads/Thesis_work/data/all_data/r3.2/file.csv: pseudonymize_column() takes 2 positional arguments but 3 were given
2025-11-09 13:44:12 - utils - INFO - Loaded email.csv (1975101 rows)
2025-11-09 13:44:14 - utils - INFO - Parsed datetime column: date
2025-11-09 13:44:14 - utils - ERROR - Failed to process /Users/bipinrimal/Downloads/Thesis_work/data/all_data/r3.2/email.csv: pseudonymize_column() takes 2 positional arguments but 3 were given
2025-11-09 13:45:18 - utils - INFO - Utility functions loaded successfully
2025-11-09 13:45:18 - utils - INFO - Found 8 dataset folders in /Users/bipinrimal/Downloads/Thesis_work/data/all_data
2025-11-09 13:45:18 - utils - INFO - 
================================================================================
                 DATA PREPROCESSING PIPELINE (V2: MEMORY-SAFE)                  
================================================================================

2025-11-09 13:45:18 - utils - INFO - --- Processing single dataset: r1 ---
2025-11-09 13:45:18 - utils - INFO - Loaded logon.csv (849579 rows)
2025-11-09 13:45:19 - utils - INFO - Parsed datetime column: date
2025-11-09 13:45:19 - utils - INFO - Pseudonymized column: user
2025-11-09 13:45:20 - utils - INFO - Pseudonymized column: pc
2025-11-09 13:45:20 - utils - INFO - Loaded device.csv (65668 rows)
2025-11-09 13:45:20 - utils - INFO - Parsed datetime column: date
2025-11-09 13:45:20 - utils - INFO - Pseudonymized column: user
2025-11-09 13:45:20 - utils - INFO - Pseudonymized column: pc
2025-11-09 13:45:20 - utils - WARNING - file.csv not found in r1, skipping.
2025-11-09 13:45:20 - utils - WARNING - email.csv not found in r1, skipping.
2025-11-09 13:45:22 - utils - INFO - Loaded http.csv (3451664 rows)
2025-11-09 13:45:22 - utils - WARNING - 'date' column not found in /Users/bipinrimal/Downloads/Thesis_work/data/all_data/r1/http.csv. Skipping file.
2025-11-09 13:45:22 - utils - INFO - Cleaning dataframe with 915247 rows
2025-11-09 13:45:23 - utils - INFO - Removed 0 duplicate rows
2025-11-09 13:45:23 - utils - INFO - Missing values:
is_connect    849579
dtype: int64
2025-11-09 13:46:06 - utils - INFO - Utility functions loaded successfully
2025-11-09 13:46:06 - utils - INFO - Found 8 dataset folders in /Users/bipinrimal/Downloads/Thesis_work/data/all_data
2025-11-09 13:46:06 - utils - INFO - 
================================================================================
                 DATA PREPROCESSING PIPELINE (V2: MEMORY-SAFE)                  
================================================================================

2025-11-09 13:46:06 - utils - INFO - --- Processing single dataset: r1 ---
2025-11-09 13:46:07 - utils - INFO - Loaded logon.csv (849579 rows)
2025-11-09 13:46:08 - utils - INFO - Parsed datetime column: date
2025-11-09 13:46:08 - utils - INFO - Pseudonymized column: user
2025-11-09 13:46:09 - utils - INFO - Pseudonymized column: pc
2025-11-09 13:46:09 - utils - INFO - Loaded device.csv (65668 rows)
2025-11-09 13:46:09 - utils - INFO - Parsed datetime column: date
2025-11-09 13:46:09 - utils - INFO - Pseudonymized column: user
2025-11-09 13:46:09 - utils - INFO - Pseudonymized column: pc
2025-11-09 13:46:09 - utils - WARNING - file.csv not found in r1, skipping.
2025-11-09 13:46:09 - utils - WARNING - email.csv not found in r1, skipping.
2025-11-09 13:46:11 - utils - INFO - Loaded http.csv (3451664 rows)
2025-11-09 13:46:11 - utils - WARNING - 'date' column not found in /Users/bipinrimal/Downloads/Thesis_work/data/all_data/r1/http.csv. Skipping file.
2025-11-09 13:46:11 - utils - INFO - Cleaning dataframe with 915247 rows
2025-11-09 13:46:11 - utils - INFO - Removed 0 duplicate rows
2025-11-09 13:46:11 - utils - INFO - Missing values:
is_connect    849579
dtype: int64
2025-11-09 13:48:10 - utils - INFO - Utility functions loaded successfully
2025-11-09 13:48:10 - utils - INFO - Found 8 dataset folders in /Users/bipinrimal/Downloads/Thesis_work/data/all_data
2025-11-09 13:48:10 - utils - INFO - 
================================================================================
                 DATA PREPROCESSING PIPELINE (V2: MEMORY-SAFE)                  
================================================================================

2025-11-09 13:48:10 - utils - INFO - --- Processing single dataset: r1 ---
2025-11-09 13:48:11 - utils - INFO - Loaded logon.csv (849579 rows)
2025-11-09 13:48:12 - utils - INFO - Parsed datetime column: date
2025-11-09 13:48:12 - utils - INFO - Pseudonymized column: user
2025-11-09 13:48:13 - utils - INFO - Pseudonymized column: pc
2025-11-09 13:48:13 - utils - INFO - Loaded device.csv (65668 rows)
2025-11-09 13:48:13 - utils - INFO - Parsed datetime column: date
2025-11-09 13:48:13 - utils - INFO - Pseudonymized column: user
2025-11-09 13:48:13 - utils - INFO - Pseudonymized column: pc
2025-11-09 13:48:13 - utils - WARNING - file.csv not found in r1, skipping.
2025-11-09 13:48:13 - utils - WARNING - email.csv not found in r1, skipping.
2025-11-09 13:48:15 - utils - INFO - Loaded http.csv (3451664 rows)
2025-11-09 13:48:15 - utils - WARNING - 'date' column not found in /Users/bipinrimal/Downloads/Thesis_work/data/all_data/r1/http.csv. Skipping file.
2025-11-09 13:48:15 - utils - INFO - Cleaning dataframe with 915247 rows
2025-11-09 13:48:15 - utils - INFO - Removed 0 duplicate rows
2025-11-09 13:48:18 - utils - INFO - Saved dataframe to /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r1.csv
2025-11-09 13:48:18 - utils - INFO - Saved temporary file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r1.csv (915247 rows)
2025-11-09 13:48:18 - utils - INFO - --- Processing single dataset: r2 ---
2025-11-09 13:48:19 - utils - INFO - Loaded logon.csv (840141 rows)
2025-11-09 13:48:19 - utils - INFO - Parsed datetime column: date
2025-11-09 13:48:20 - utils - INFO - Pseudonymized column: user
2025-11-09 13:48:20 - utils - INFO - Pseudonymized column: pc
2025-11-09 13:48:21 - utils - INFO - Loaded device.csv (712308 rows)
2025-11-09 13:48:21 - utils - INFO - Parsed datetime column: date
2025-11-09 13:48:22 - utils - INFO - Pseudonymized column: user
2025-11-09 13:48:22 - utils - INFO - Pseudonymized column: pc
2025-11-09 13:48:22 - utils - WARNING - file.csv not found in r2, skipping.
2025-11-09 13:48:23 - utils - INFO - Loaded email.csv (1189372 rows)
2025-11-09 13:48:24 - utils - INFO - Parsed datetime column: date
2025-11-09 13:48:25 - utils - INFO - Pseudonymized column: from
2025-11-09 13:48:30 - utils - INFO - Loaded http.csv (7321105 rows)
2025-11-09 13:48:37 - utils - INFO - Parsed datetime column: date
2025-11-09 13:48:41 - utils - INFO - Pseudonymized column: user
2025-11-09 13:48:44 - utils - INFO - Pseudonymized column: pc
2025-11-09 13:48:50 - utils - INFO - Cleaning dataframe with 10062926 rows
2025-11-09 13:48:56 - utils - INFO - Removed 0 duplicate rows
2025-11-09 13:48:57 - utils - INFO - Missing values:
user         1189372
pc           1189372
activity     8510477
pc_pseudo    1189372
to           8873554
from         8873554
url          2741821
domain       2741821
dtype: int64
2025-11-09 13:49:30 - utils - INFO - Saved dataframe to /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r2.csv
2025-11-09 13:49:30 - utils - INFO - Saved temporary file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r2.csv (10062926 rows)
2025-11-09 13:49:30 - utils - INFO - --- Processing single dataset: r3.1 ---
2025-11-09 13:49:31 - utils - INFO - Loaded logon.csv (842109 rows)
2025-11-09 13:49:32 - utils - INFO - Parsed datetime column: date
2025-11-09 13:49:32 - utils - INFO - Pseudonymized column: user
2025-11-09 13:49:32 - utils - INFO - Pseudonymized column: pc
2025-11-09 13:49:33 - utils - INFO - Loaded device.csv (417588 rows)
2025-11-09 13:49:33 - utils - INFO - Parsed datetime column: date
2025-11-09 13:49:33 - utils - INFO - Pseudonymized column: user
2025-11-09 13:49:34 - utils - INFO - Pseudonymized column: pc
2025-11-09 13:49:35 - utils - INFO - Loaded file.csv (457520 rows)
2025-11-09 13:49:35 - utils - INFO - Parsed datetime column: date
2025-11-09 13:49:36 - utils - INFO - Pseudonymized column: user
2025-11-09 13:49:36 - utils - INFO - Pseudonymized column: pc
2025-11-09 13:49:42 - utils - INFO - Loaded email.csv (1994071 rows)
2025-11-09 13:49:44 - utils - INFO - Parsed datetime column: date
2025-11-09 13:49:45 - utils - INFO - Pseudonymized column: from
2025-11-09 13:53:31 - utils - INFO - Loaded http.csv (23555143 rows)
2025-11-09 13:53:57 - utils - INFO - Parsed datetime column: date
2025-11-09 13:54:17 - utils - INFO - Pseudonymized column: user
2025-11-09 13:54:46 - utils - INFO - Pseudonymized column: pc
2025-11-09 13:56:21 - utils - INFO - Cleaning dataframe with 27266431 rows
2025-11-09 14:08:02 - utils - INFO - Removed 0 duplicate rows
2025-11-09 14:08:43 - utils - INFO - Missing values:
user            1994071
pc              1994071
activity       26006734
pc_pseudo       1994071
filename       26808911
content         1259697
to             25272360
from           25272360
size           25272360
attachments    25272360
url             3711288
domain          3711288
dtype: int64
2025-11-09 14:14:22 - utils - INFO - Saved dataframe to /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r3.1.csv
2025-11-09 14:14:22 - utils - INFO - Saved temporary file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r3.1.csv (27266431 rows)
2025-11-09 14:15:03 - utils - INFO - --- Processing single dataset: r3.2 ---
2025-11-09 14:15:05 - utils - INFO - Loaded logon.csv (845351 rows)
2025-11-09 14:15:06 - utils - INFO - Parsed datetime column: date
2025-11-09 14:15:07 - utils - INFO - Pseudonymized column: user
2025-11-09 14:15:07 - utils - INFO - Pseudonymized column: pc
2025-11-09 14:15:08 - utils - INFO - Loaded device.csv (407908 rows)
2025-11-09 14:15:08 - utils - INFO - Parsed datetime column: date
2025-11-09 14:15:08 - utils - INFO - Pseudonymized column: user
2025-11-09 14:15:08 - utils - INFO - Pseudonymized column: pc
2025-11-09 14:15:11 - utils - INFO - Loaded file.csv (434769 rows)
2025-11-09 14:15:11 - utils - INFO - Parsed datetime column: date
2025-11-09 14:15:11 - utils - INFO - Pseudonymized column: user
2025-11-09 14:15:12 - utils - INFO - Pseudonymized column: pc
2025-11-09 14:15:28 - utils - INFO - Loaded email.csv (1975101 rows)
2025-11-09 14:15:30 - utils - INFO - Parsed datetime column: date
2025-11-09 14:15:31 - utils - INFO - Pseudonymized column: from
2025-11-09 14:19:23 - utils - INFO - Loaded http.csv (23845079 rows)
2025-11-09 14:20:03 - utils - INFO - Parsed datetime column: date
2025-11-09 14:20:29 - utils - INFO - Pseudonymized column: user
2025-11-09 14:21:00 - utils - INFO - Pseudonymized column: pc
2025-11-09 14:22:58 - utils - INFO - Cleaning dataframe with 27508208 rows
2025-11-09 14:34:20 - utils - INFO - Removed 0 duplicate rows
2025-11-09 14:35:05 - utils - INFO - Missing values:
user            1975101
pc              1975101
activity       26254949
pc_pseudo       1975101
filename       27073439
content         1253259
to             25533107
from           25533107
size           25533107
attachments    25533107
url             3663129
domain          3663129
dtype: int64
2025-11-09 14:40:49 - utils - INFO - Saved dataframe to /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r3.2.csv
2025-11-09 14:40:49 - utils - INFO - Saved temporary file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r3.2.csv (27508208 rows)
2025-11-09 14:41:37 - utils - INFO - --- Processing single dataset: r4.1 ---
2025-11-09 14:41:39 - utils - INFO - Loaded logon.csv (899118 rows)
2025-11-09 14:41:40 - utils - INFO - Parsed datetime column: date
2025-11-09 14:41:41 - utils - INFO - Pseudonymized column: user
2025-11-09 14:41:41 - utils - INFO - Pseudonymized column: pc
2025-11-09 14:41:42 - utils - INFO - Loaded device.csv (437168 rows)
2025-11-09 14:41:43 - utils - INFO - Parsed datetime column: date
2025-11-09 14:41:43 - utils - INFO - Pseudonymized column: user
2025-11-09 14:41:43 - utils - INFO - Pseudonymized column: pc
2025-11-09 14:41:46 - utils - INFO - Loaded file.csv (414556 rows)
2025-11-09 14:41:46 - utils - INFO - Parsed datetime column: date
2025-11-09 14:41:46 - utils - INFO - Pseudonymized column: user
2025-11-09 14:41:47 - utils - INFO - Pseudonymized column: pc
2025-11-09 14:42:01 - utils - INFO - Loaded email.csv (2733360 rows)
2025-11-09 14:42:03 - utils - INFO - Parsed datetime column: date
2025-11-09 14:42:05 - utils - INFO - Pseudonymized column: user
2025-11-09 14:42:07 - utils - INFO - Pseudonymized column: pc
2025-11-09 14:53:55 - utils - INFO - Loaded http.csv (29553383 rows)
2025-11-09 14:54:29 - utils - INFO - Parsed datetime column: date
2025-11-09 14:55:16 - utils - INFO - Pseudonymized column: user
2025-11-09 14:56:15 - utils - INFO - Pseudonymized column: pc
2025-11-09 14:59:49 - utils - INFO - Cleaning dataframe with 34037585 rows
2025-11-09 15:12:51 - utils - INFO - Removed 0 duplicate rows
2025-11-09 15:14:06 - utils - INFO - Missing values:
activity       32701299
filename       33623029
content         1336286
to             31304225
cc             32987711
bcc            33607961
from           31304225
size           31304225
attachments    31304225
url             4484202
domain          4484202
dtype: int64
2025-11-09 15:21:23 - utils - INFO - Saved dataframe to /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r4.1.csv
2025-11-09 15:21:23 - utils - INFO - Saved temporary file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r4.1.csv (34037585 rows)
2025-11-09 15:23:49 - utils - INFO - --- Processing single dataset: r4.2 ---
2025-11-09 15:23:50 - utils - INFO - Loaded logon.csv (854859 rows)
2025-11-09 15:23:51 - utils - INFO - Parsed datetime column: date
2025-11-09 15:23:52 - utils - INFO - Pseudonymized column: user
2025-11-09 15:23:52 - utils - INFO - Pseudonymized column: pc
2025-11-09 15:23:53 - utils - INFO - Loaded device.csv (405380 rows)
2025-11-09 15:23:53 - utils - INFO - Parsed datetime column: date
2025-11-09 15:23:53 - utils - INFO - Pseudonymized column: user
2025-11-09 15:23:54 - utils - INFO - Pseudonymized column: pc
2025-11-09 15:23:57 - utils - INFO - Loaded file.csv (445581 rows)
2025-11-09 15:23:57 - utils - INFO - Parsed datetime column: date
2025-11-09 15:23:57 - utils - INFO - Pseudonymized column: user
2025-11-09 15:23:58 - utils - INFO - Pseudonymized column: pc
2025-11-09 15:24:16 - utils - INFO - Loaded email.csv (2629979 rows)
2025-11-09 15:24:18 - utils - INFO - Parsed datetime column: date
2025-11-09 15:24:20 - utils - INFO - Pseudonymized column: user
2025-11-09 15:24:22 - utils - INFO - Pseudonymized column: pc
2025-11-09 15:32:47 - utils - INFO - Loaded http.csv (28434423 rows)
2025-11-09 15:33:19 - utils - INFO - Parsed datetime column: date
2025-11-09 15:33:47 - utils - INFO - Pseudonymized column: user
2025-11-09 15:34:26 - utils - INFO - Pseudonymized column: pc
2025-11-09 15:38:16 - utils - INFO - Cleaning dataframe with 32770222 rows
2025-11-09 15:51:10 - utils - INFO - Removed 0 duplicate rows
2025-11-09 15:53:14 - utils - INFO - Missing values:
activity       31509983
filename       32324641
content         1260239
to             30140243
cc             31757297
bcc            32353220
from           30140243
size           30140243
attachments    30140243
url             4335799
domain          4335799
dtype: int64
2025-11-09 15:59:59 - utils - INFO - Saved dataframe to /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r4.2.csv
2025-11-09 15:59:59 - utils - INFO - Saved temporary file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r4.2.csv (32770222 rows)
2025-11-09 16:02:02 - utils - INFO - --- Processing single dataset: r5.1 ---
2025-11-09 16:02:04 - utils - INFO - Loaded logon.csv (1829996 rows)
2025-11-09 16:02:06 - utils - INFO - Parsed datetime column: date
2025-11-09 16:02:08 - utils - INFO - Pseudonymized column: user
2025-11-09 16:02:09 - utils - INFO - Pseudonymized column: pc
2025-11-09 16:02:11 - utils - INFO - Loaded device.csv (908379 rows)
2025-11-09 16:02:12 - utils - INFO - Parsed datetime column: date
2025-11-09 16:02:13 - utils - INFO - Pseudonymized column: user
2025-11-09 16:02:14 - utils - INFO - Pseudonymized column: pc
2025-11-09 16:02:17 - utils - INFO - Loaded file.csv (947613 rows)
2025-11-09 16:02:18 - utils - INFO - Parsed datetime column: date
2025-11-09 16:02:19 - utils - INFO - Pseudonymized column: user
2025-11-09 16:02:19 - utils - INFO - Pseudonymized column: pc
2025-11-09 16:03:55 - utils - INFO - Loaded email.csv (17608751 rows)
2025-11-09 16:04:12 - utils - INFO - Parsed datetime column: date
2025-11-09 16:04:23 - utils - INFO - Pseudonymized column: user
2025-11-09 16:04:36 - utils - INFO - Pseudonymized column: pc
2025-11-09 16:10:40 - utils - INFO - Utility functions loaded successfully
2025-11-09 16:10:40 - utils - INFO - Found 8 dataset folders in /Users/bipinrimal/Downloads/Thesis_work/data/all_data
2025-11-09 16:10:40 - utils - INFO - 
================================================================================
                 DATA PREPROCESSING PIPELINE (V2: MEMORY-SAFE)                  
================================================================================

2025-11-09 16:10:40 - utils - INFO - --- Processing single dataset: r1 ---
2025-11-09 16:10:40 - utils - INFO - Loaded logon.csv (849579 rows)
2025-11-09 16:10:41 - utils - INFO - Parsed datetime column: date
2025-11-09 16:10:41 - utils - INFO - Loaded device.csv (65668 rows)
2025-11-09 16:10:41 - utils - INFO - Parsed datetime column: date
2025-11-09 16:10:41 - utils - WARNING - file.csv not found in r1, skipping.
2025-11-09 16:10:41 - utils - WARNING - email.csv not found in r1, skipping.
2025-11-09 16:10:44 - utils - INFO - Loaded http.csv (3451664 rows)
2025-11-09 16:10:44 - utils - WARNING - 'date' column not found in /Users/bipinrimal/Downloads/Thesis_work/data/all_data/r1/http.csv. Skipping file.
2025-11-09 16:10:44 - utils - INFO - Cleaning dataframe with 915247 rows
2025-11-09 16:10:44 - utils - INFO - Removed 0 duplicate rows
2025-11-09 16:10:46 - utils - INFO - Saved dataframe to /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r1.csv
2025-11-09 16:10:46 - utils - INFO - Saved temporary file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r1.csv (915247 rows)
2025-11-09 16:10:46 - utils - INFO - --- Processing single dataset: r2 ---
2025-11-09 16:10:47 - utils - INFO - Loaded logon.csv (840141 rows)
2025-11-09 16:10:47 - utils - INFO - Parsed datetime column: date
2025-11-09 16:10:48 - utils - INFO - Loaded device.csv (712308 rows)
2025-11-09 16:10:49 - utils - INFO - Parsed datetime column: date
2025-11-09 16:10:49 - utils - WARNING - file.csv not found in r2, skipping.
2025-11-09 16:10:50 - utils - INFO - Loaded email.csv (1189372 rows)
2025-11-09 16:10:51 - utils - INFO - Parsed datetime column: date
2025-11-09 16:10:56 - utils - INFO - Loaded http.csv (7321105 rows)
2025-11-09 16:11:03 - utils - INFO - Parsed datetime column: date
2025-11-09 16:11:10 - utils - INFO - Cleaning dataframe with 10062926 rows
2025-11-09 16:11:16 - utils - INFO - Removed 0 duplicate rows
2025-11-09 16:11:17 - utils - INFO - Missing values:
pc_id       1189372
activity    8510477
to          8873554
url         2741821
domain      2741821
dtype: int64
2025-11-09 16:11:49 - utils - INFO - Saved dataframe to /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r2.csv
2025-11-09 16:11:49 - utils - INFO - Saved temporary file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r2.csv (10062926 rows)
2025-11-09 16:11:50 - utils - INFO - --- Processing single dataset: r3.1 ---
2025-11-09 16:11:50 - utils - INFO - Loaded logon.csv (842109 rows)
2025-11-09 16:11:51 - utils - INFO - Parsed datetime column: date
2025-11-09 16:11:52 - utils - INFO - Loaded device.csv (417588 rows)
2025-11-09 16:11:52 - utils - INFO - Parsed datetime column: date
2025-11-09 16:11:54 - utils - INFO - Loaded file.csv (457520 rows)
2025-11-09 16:11:54 - utils - INFO - Parsed datetime column: date
2025-11-09 16:12:02 - utils - INFO - Loaded email.csv (1994071 rows)
2025-11-09 16:12:04 - utils - INFO - Parsed datetime column: date
2025-11-09 16:15:45 - utils - INFO - Loaded http.csv (23555143 rows)
2025-11-09 16:16:17 - utils - INFO - Parsed datetime column: date
2025-11-09 16:17:02 - utils - INFO - Cleaning dataframe with 27266431 rows
2025-11-09 16:19:59 - utils - INFO - Removed 0 duplicate rows
2025-11-09 16:20:18 - utils - INFO - Missing values:
pc_id           1994071
activity       26006734
filename       26808911
content         1259697
to             25272360
size           25272360
attachments    25272360
url             3711288
domain          3711288
dtype: int64
2025-11-09 16:23:52 - utils - INFO - Saved dataframe to /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r3.1.csv
2025-11-09 16:23:52 - utils - INFO - Saved temporary file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r3.1.csv (27266431 rows)
2025-11-09 16:23:58 - utils - INFO - --- Processing single dataset: r3.2 ---
2025-11-09 16:23:59 - utils - INFO - Loaded logon.csv (845351 rows)
2025-11-09 16:24:00 - utils - INFO - Parsed datetime column: date
2025-11-09 16:24:00 - utils - INFO - Loaded device.csv (407908 rows)
2025-11-09 16:24:01 - utils - INFO - Parsed datetime column: date
2025-11-09 16:24:03 - utils - INFO - Loaded file.csv (434769 rows)
2025-11-09 16:24:03 - utils - INFO - Parsed datetime column: date
2025-11-09 16:24:11 - utils - INFO - Loaded email.csv (1975101 rows)
2025-11-09 16:24:13 - utils - INFO - Parsed datetime column: date
2025-11-09 16:28:04 - utils - INFO - Loaded http.csv (23845079 rows)
2025-11-09 16:28:32 - utils - INFO - Parsed datetime column: date
2025-11-09 16:30:15 - utils - INFO - Cleaning dataframe with 27508208 rows
2025-11-09 16:33:34 - utils - INFO - Removed 0 duplicate rows
2025-11-09 16:33:54 - utils - INFO - Missing values:
pc_id           1975101
activity       26254949
filename       27073439
content         1253259
to             25533107
size           25533107
attachments    25533107
url             3663129
domain          3663129
dtype: int64
2025-11-09 16:37:37 - utils - INFO - Saved dataframe to /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r3.2.csv
2025-11-09 16:37:37 - utils - INFO - Saved temporary file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r3.2.csv (27508208 rows)
2025-11-09 16:37:45 - utils - INFO - --- Processing single dataset: r4.1 ---
2025-11-09 16:37:46 - utils - INFO - Loaded logon.csv (899118 rows)
2025-11-09 16:37:47 - utils - INFO - Parsed datetime column: date
2025-11-09 16:37:48 - utils - INFO - Loaded device.csv (437168 rows)
2025-11-09 16:37:49 - utils - INFO - Parsed datetime column: date
2025-11-09 16:37:50 - utils - INFO - Loaded file.csv (414556 rows)
2025-11-09 16:37:51 - utils - INFO - Parsed datetime column: date
2025-11-09 16:38:03 - utils - INFO - Loaded email.csv (2733360 rows)
2025-11-09 16:38:06 - utils - INFO - Parsed datetime column: date
2025-11-09 16:46:32 - utils - INFO - Loaded http.csv (29553383 rows)
2025-11-09 16:47:05 - utils - INFO - Parsed datetime column: date
2025-11-09 16:50:06 - utils - INFO - Cleaning dataframe with 34037585 rows
2025-11-09 17:00:21 - utils - INFO - Removed 0 duplicate rows
2025-11-09 17:01:06 - utils - INFO - Missing values:
activity       32701299
filename       33623029
content         1336286
to             31304225
cc             32987711
bcc            33607961
from           31304225
size           31304225
attachments    31304225
url             4484202
domain          4484202
dtype: int64
2025-11-09 17:07:25 - utils - INFO - Saved dataframe to /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r4.1.csv
2025-11-09 17:07:25 - utils - INFO - Saved temporary file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r4.1.csv (34037585 rows)
2025-11-09 17:08:27 - utils - INFO - --- Processing single dataset: r4.2 ---
2025-11-09 17:08:29 - utils - INFO - Loaded logon.csv (854859 rows)
2025-11-09 17:08:30 - utils - INFO - Parsed datetime column: date
2025-11-09 17:08:30 - utils - INFO - Loaded device.csv (405380 rows)
2025-11-09 17:08:31 - utils - INFO - Parsed datetime column: date
2025-11-09 17:08:33 - utils - INFO - Loaded file.csv (445581 rows)
2025-11-09 17:08:33 - utils - INFO - Parsed datetime column: date
2025-11-09 17:09:00 - utils - INFO - Loaded email.csv (2629979 rows)
2025-11-09 17:09:02 - utils - INFO - Parsed datetime column: date
2025-11-09 17:16:12 - utils - INFO - Loaded http.csv (28434423 rows)
2025-11-09 17:16:44 - utils - INFO - Parsed datetime column: date
2025-11-09 17:18:17 - utils - INFO - Cleaning dataframe with 32770222 rows
2025-11-09 17:26:29 - utils - INFO - Removed 0 duplicate rows
2025-11-09 17:27:02 - utils - INFO - Missing values:
activity       31509983
filename       32324641
content         1260239
to             30140243
cc             31757297
bcc            32353220
from           30140243
size           30140243
attachments    30140243
url             4335799
domain          4335799
dtype: int64
2025-11-09 17:32:22 - utils - INFO - Saved dataframe to /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r4.2.csv
2025-11-09 17:32:22 - utils - INFO - Saved temporary file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r4.2.csv (32770222 rows)
2025-11-09 17:33:06 - utils - INFO - --- Processing single dataset: r5.1 ---
2025-11-09 17:33:06 - utils - WARNING - logon.csv not found in r5.1, skipping.
2025-11-09 17:33:06 - utils - WARNING - device.csv not found in r5.1, skipping.
2025-11-09 17:33:06 - utils - WARNING - file.csv not found in r5.1, skipping.
2025-11-09 17:33:06 - utils - WARNING - email.csv not found in r5.1, skipping.
2025-11-09 17:33:06 - utils - WARNING - http.csv not found in r5.1, skipping.
2025-11-09 17:33:06 - utils - WARNING - No data processed for r5.1.
2025-11-09 17:33:06 - utils - INFO - --- Processing single dataset: r5.2 ---
2025-11-09 17:33:06 - utils - WARNING - logon.csv not found in r5.2, skipping.
2025-11-09 17:33:06 - utils - WARNING - device.csv not found in r5.2, skipping.
2025-11-09 17:33:06 - utils - WARNING - file.csv not found in r5.2, skipping.
2025-11-09 17:33:06 - utils - WARNING - email.csv not found in r5.2, skipping.
2025-11-09 17:33:06 - utils - WARNING - http.csv not found in r5.2, skipping.
2025-11-09 17:33:06 - utils - WARNING - No data processed for r5.2.
2025-11-09 17:33:06 - utils - INFO - Merging 6 processed temp files...
2025-11-09 17:33:06 - utils - ERROR - Failed to read temp file /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r1.csv: [Errno 2] No such file or directory: '/Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r1.csv'
2025-11-09 17:45:51 - utils - INFO - Utility functions loaded successfully
2025-11-09 17:45:51 - utils - INFO - Found 6 dataset folders in /Users/bipinrimal/Downloads/Thesis_work/data/all_data
2025-11-09 17:45:51 - utils - INFO - 
================================================================================
                 DATA PREPROCESSING PIPELINE (V2: MEMORY-SAFE)                  
================================================================================

2025-11-09 17:45:51 - utils - INFO - Cleaning up old temporary files...
2025-11-09 17:45:53 - utils - INFO - Removed 5 old temp files.
2025-11-09 17:45:53 - utils - INFO - --- Processing single dataset: r1 ---
2025-11-09 17:45:54 - utils - INFO - Loaded logon.csv (849579 rows)
2025-11-09 17:45:55 - utils - INFO - Parsed datetime column: date
2025-11-09 17:45:55 - utils - INFO - Loaded device.csv (65668 rows)
2025-11-09 17:45:55 - utils - INFO - Parsed datetime column: date
2025-11-09 17:45:55 - utils - WARNING - file.csv not found in r1, skipping.
2025-11-09 17:45:55 - utils - WARNING - email.csv not found in r1, skipping.
2025-11-09 17:45:57 - utils - INFO - Loaded http.csv (3451664 rows)
2025-11-09 17:45:57 - utils - WARNING - 'date' column not found in /Users/bipinrimal/Downloads/Thesis_work/data/all_data/r1/http.csv. Skipping file.
2025-11-09 17:45:57 - utils - INFO - Cleaning dataframe with 915247 rows
2025-11-09 17:45:58 - utils - INFO - Removed 0 duplicate rows
2025-11-09 17:46:00 - utils - INFO - Saved temporary file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r1.csv (915247 rows)
2025-11-09 17:46:00 - utils - INFO - --- Processing single dataset: r2 ---
2025-11-09 17:46:00 - utils - INFO - Loaded logon.csv (840141 rows)
2025-11-09 17:46:01 - utils - INFO - Parsed datetime column: date
2025-11-09 17:46:02 - utils - INFO - Loaded device.csv (712308 rows)
2025-11-09 17:46:02 - utils - INFO - Parsed datetime column: date
2025-11-09 17:46:02 - utils - WARNING - file.csv not found in r2, skipping.
2025-11-09 17:46:03 - utils - INFO - Loaded email.csv (1189372 rows)
2025-11-09 17:46:05 - utils - INFO - Parsed datetime column: date
2025-11-09 17:46:10 - utils - INFO - Loaded http.csv (7321105 rows)
2025-11-09 17:46:17 - utils - INFO - Parsed datetime column: date
2025-11-09 17:46:22 - utils - INFO - Cleaning dataframe with 10062926 rows
2025-11-09 17:46:28 - utils - INFO - Removed 0 duplicate rows
2025-11-09 17:46:29 - utils - INFO - Missing values:
pc_id       1189372
activity    8510477
to          8873554
url         2741821
domain      2741821
dtype: int64
2025-11-09 17:46:58 - utils - INFO - Saved temporary file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r2.csv (10062926 rows)
2025-11-09 17:46:58 - utils - INFO - --- Processing single dataset: r3.1 ---
2025-11-09 17:46:59 - utils - INFO - Loaded logon.csv (842109 rows)
2025-11-09 17:46:59 - utils - INFO - Parsed datetime column: date
2025-11-09 17:47:00 - utils - INFO - Loaded device.csv (417588 rows)
2025-11-09 17:47:00 - utils - INFO - Parsed datetime column: date
2025-11-09 17:47:02 - utils - INFO - Loaded file.csv (457520 rows)
2025-11-09 17:47:02 - utils - INFO - Parsed datetime column: date
2025-11-09 17:47:09 - utils - INFO - Loaded email.csv (1994071 rows)
2025-11-09 17:47:11 - utils - INFO - Parsed datetime column: date
2025-11-09 17:50:53 - utils - INFO - Loaded http.csv (23555143 rows)
2025-11-09 17:51:19 - utils - INFO - Parsed datetime column: date
2025-11-09 17:52:07 - utils - INFO - Cleaning dataframe with 27266431 rows
2025-11-09 17:55:36 - utils - INFO - Removed 0 duplicate rows
2025-11-09 17:55:54 - utils - INFO - Missing values:
pc_id           1994071
activity       26006734
filename       26808911
content         1259697
to             25272360
size           25272360
attachments    25272360
url             3711288
domain          3711288
dtype: int64
2025-11-09 17:59:32 - utils - INFO - Saved temporary file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r3.1.csv (27266431 rows)
2025-11-09 17:59:39 - utils - INFO - --- Processing single dataset: r3.2 ---
2025-11-09 17:59:40 - utils - INFO - Loaded logon.csv (845351 rows)
2025-11-09 17:59:41 - utils - INFO - Parsed datetime column: date
2025-11-09 17:59:41 - utils - INFO - Loaded device.csv (407908 rows)
2025-11-09 17:59:42 - utils - INFO - Parsed datetime column: date
2025-11-09 17:59:43 - utils - INFO - Loaded file.csv (434769 rows)
2025-11-09 17:59:44 - utils - INFO - Parsed datetime column: date
2025-11-09 17:59:52 - utils - INFO - Loaded email.csv (1975101 rows)
2025-11-09 17:59:54 - utils - INFO - Parsed datetime column: date
2025-11-09 18:03:39 - utils - INFO - Loaded http.csv (23845079 rows)
2025-11-09 18:04:07 - utils - INFO - Parsed datetime column: date
2025-11-09 18:05:45 - utils - INFO - Cleaning dataframe with 27508208 rows
2025-11-09 18:09:31 - utils - INFO - Removed 0 duplicate rows
2025-11-09 18:09:49 - utils - INFO - Missing values:
pc_id           1975101
activity       26254949
filename       27073439
content         1253259
to             25533107
size           25533107
attachments    25533107
url             3663129
domain          3663129
dtype: int64
2025-11-09 18:13:32 - utils - INFO - Saved temporary file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r3.2.csv (27508208 rows)
2025-11-09 18:13:43 - utils - INFO - --- Processing single dataset: r4.1 ---
2025-11-09 18:13:43 - utils - WARNING - logon.csv not found in r4.1, skipping.
2025-11-09 18:13:43 - utils - WARNING - device.csv not found in r4.1, skipping.
2025-11-09 18:13:43 - utils - WARNING - file.csv not found in r4.1, skipping.
2025-11-09 18:13:43 - utils - WARNING - email.csv not found in r4.1, skipping.
2025-11-09 18:13:43 - utils - WARNING - http.csv not found in r4.1, skipping.
2025-11-09 18:13:43 - utils - WARNING - No data processed for r4.1.
2025-11-09 18:13:43 - utils - INFO - --- Processing single dataset: r4.2 ---
2025-11-09 18:13:43 - utils - WARNING - logon.csv not found in r4.2, skipping.
2025-11-09 18:13:43 - utils - WARNING - device.csv not found in r4.2, skipping.
2025-11-09 18:13:43 - utils - WARNING - file.csv not found in r4.2, skipping.
2025-11-09 18:13:43 - utils - WARNING - email.csv not found in r4.2, skipping.
2025-11-09 18:13:43 - utils - WARNING - http.csv not found in r4.2, skipping.
2025-11-09 18:13:43 - utils - WARNING - No data processed for r4.2.
2025-11-09 18:13:43 - utils - INFO - Merging 4 processed temp files...
2025-11-09 20:14:40 - utils - INFO - Utility functions loaded successfully
2025-11-09 20:14:40 - utils - INFO - Found 2 dataset folders in /Users/bipinrimal/Downloads/Thesis_work/data/all_data
2025-11-09 20:14:40 - utils - INFO - 
================================================================================
                 DATA PREPROCESSING PIPELINE (V2: MEMORY-SAFE)                  
================================================================================

2025-11-09 20:14:40 - utils - INFO - Cleaning up old temporary files...
2025-11-09 20:14:40 - utils - INFO - Removed 4 old temp files.
2025-11-09 20:14:40 - utils - INFO - --- Processing single dataset: r1 ---
2025-11-09 20:14:41 - utils - INFO - Loaded logon.csv (849579 rows)
2025-11-09 20:14:42 - utils - INFO - Parsed datetime column: date
2025-11-09 20:14:42 - utils - INFO - Loaded device.csv (65668 rows)
2025-11-09 20:14:42 - utils - INFO - Parsed datetime column: date
2025-11-09 20:14:42 - utils - WARNING - file.csv not found in r1, skipping.
2025-11-09 20:14:42 - utils - WARNING - email.csv not found in r1, skipping.
2025-11-09 20:14:44 - utils - INFO - Loaded http.csv (3451664 rows)
2025-11-09 20:14:44 - utils - WARNING - 'date' column not found in /Users/bipinrimal/Downloads/Thesis_work/data/all_data/r1/http.csv. Skipping file.
2025-11-09 20:14:44 - utils - INFO - Cleaning dataframe with 915247 rows
2025-11-09 20:14:44 - utils - INFO - Removed 0 duplicate rows
2025-11-09 20:14:47 - utils - INFO - Saved temporary file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r1.csv (915247 rows)
2025-11-09 20:14:47 - utils - INFO - --- Processing single dataset: r2 ---
2025-11-09 20:14:47 - utils - INFO - Loaded logon.csv (840141 rows)
2025-11-09 20:14:48 - utils - INFO - Parsed datetime column: date
2025-11-09 20:14:48 - utils - INFO - Loaded device.csv (712308 rows)
2025-11-09 20:14:49 - utils - INFO - Parsed datetime column: date
2025-11-09 20:14:49 - utils - WARNING - file.csv not found in r2, skipping.
2025-11-09 20:14:50 - utils - INFO - Loaded email.csv (1189372 rows)
2025-11-09 20:14:51 - utils - INFO - Parsed datetime column: date
2025-11-09 20:14:56 - utils - INFO - Loaded http.csv (7321105 rows)
2025-11-09 20:15:03 - utils - INFO - Parsed datetime column: date
2025-11-09 20:15:09 - utils - INFO - Cleaning dataframe with 10062926 rows
2025-11-09 20:15:15 - utils - INFO - Removed 0 duplicate rows
2025-11-09 20:15:16 - utils - INFO - Missing values:
pc_id       1189372
activity    8510477
to          8873554
url         2741821
domain      2741821
dtype: int64
2025-11-09 20:15:45 - utils - INFO - Saved temporary file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r2.csv (10062926 rows)
2025-11-09 20:15:45 - utils - INFO - Merging 2 processed temp files...
2025-11-09 20:16:08 - utils - INFO - Master dataframe created: 10978173 total rows
2025-11-09 20:16:08 - utils - INFO - Cleaning up temporary files...
2025-11-09 20:16:09 - utils - INFO - Loading and merging static data (LDAP, Psychometric)...
2025-11-09 20:16:09 - utils - ERROR - Failed to load/merge LDAP data: Usecols do not match columns, columns expected but not found: ['domain']
2025-11-09 20:16:10 - utils - INFO - Merged psychometric data for 1000 users
2025-11-09 20:16:30 - utils - INFO - Handled missing values using strategy: fill_mode
2025-11-09 20:16:31 - utils - INFO - Saving new master file to /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs_ALL.csv...
2025-11-09 20:17:15 - utils - INFO - ================================================================================
2025-11-09 20:17:15 - utils - INFO - V2 Preprocessing Complete!
2025-11-09 20:17:15 - utils - INFO - Master file saved: 10978173 rows
2025-11-09 20:17:15 - utils - INFO - Next step: python label_insiders_v2.py
2025-11-09 20:17:15 - utils - INFO - ================================================================================
2025-11-09 20:23:02 - utils - INFO - Utility functions loaded successfully
2025-11-09 20:23:02 - utils - INFO - 
================================================================================
                  LABELING INSIDER THREATS (V2: MULTI-DATASET)                  
================================================================================

2025-11-09 20:23:02 - utils - INFO - Loading CMU-CERT master answers file (insiders.csv)...
2025-11-09 20:23:02 - utils - INFO - Loaded 191 total insider incidents
2025-11-09 20:23:02 - utils - WARNING - Could not parse dates for CDE1846 in 6.2: month must be in 1..12: /21/2011 11:43:39, at position 0
2025-11-09 20:23:02 - utils - INFO - Parsed 190 insider activity rules
2025-11-09 20:23:04 - utils - INFO - Processing chunk 1 (1000000 rows)...
2025-11-09 20:23:16 - utils - INFO - Processing chunk 2 (1000000 rows)...
2025-11-09 20:23:29 - utils - INFO - Processing chunk 3 (1000000 rows)...
2025-11-09 20:23:42 - utils - INFO - Processing chunk 4 (1000000 rows)...
2025-11-09 20:23:56 - utils - INFO - Processing chunk 5 (1000000 rows)...
2025-11-09 20:24:09 - utils - INFO - Processing chunk 6 (1000000 rows)...
2025-11-09 20:24:22 - utils - INFO - Processing chunk 7 (1000000 rows)...
2025-11-09 20:24:35 - utils - INFO - Processing chunk 8 (1000000 rows)...
2025-11-09 20:24:49 - utils - INFO - Processing chunk 9 (1000000 rows)...
2025-11-09 20:25:02 - utils - INFO - Processing chunk 10 (1000000 rows)...
2025-11-09 20:25:16 - utils - INFO - Processing chunk 11 (978173 rows)...
2025-11-09 20:25:27 - utils - INFO - All chunks processed. Total rows: 10978173
2025-11-09 20:25:27 - utils - INFO - Total insider records labeled: 0
2025-11-09 20:25:27 - utils - INFO - Replacing original file with labeled version...
2025-11-09 20:25:27 - utils - INFO - Successfully created: /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs_ALL.csv
2025-11-09 20:25:27 - utils - INFO - ================================================================================
2025-11-09 20:25:27 - utils - INFO - V2 Labeling Complete!
2025-11-09 20:25:27 - utils - INFO - The file 'processed_unified_logs_ALL.csv' is now labeled.
2025-11-09 20:25:27 - utils - INFO - Next step: Run 'feature_engineering_v2.py'
2025-11-09 20:25:27 - utils - INFO - ================================================================================
2025-11-09 20:26:29 - utils - INFO - Utility functions loaded successfully
2025-11-09 20:26:29 - utils - INFO - Feature Engineer V2 initialized.
2025-11-09 20:26:29 - utils - INFO - 
================================================================================
                  FEATURE ENGINEERING PIPELINE V2 (MULTI-PASS)                  
================================================================================

2025-11-09 20:26:29 - utils - INFO - 
================================================================================
                           PASS 1: DAILY AGGREGATION                            
================================================================================

2025-11-09 20:26:29 - utils - INFO - Reading /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs_ALL.csv in 2000000-row chunks...
2025-11-09 20:28:40 - utils - INFO - Utility functions loaded successfully
2025-11-09 20:28:40 - utils - INFO - Feature Engineer V2 initialized.
2025-11-09 20:28:40 - utils - INFO - 
================================================================================
                  FEATURE ENGINEERING PIPELINE V2 (MULTI-PASS)                  
================================================================================

2025-11-09 20:28:40 - utils - INFO - 
================================================================================
                           PASS 1: DAILY AGGREGATION                            
================================================================================

2025-11-09 20:28:40 - utils - INFO - Reading /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs_ALL.csv in 2000000-row chunks...
2025-11-09 20:28:42 - utils - INFO - Processing chunk 1...
2025-11-09 20:28:50 - utils - INFO - Utility functions loaded successfully
2025-11-09 20:28:50 - utils - INFO - Found 2 dataset folders in /Users/bipinrimal/Downloads/Thesis_work/data/all_data
2025-11-09 20:28:50 - utils - INFO - 
================================================================================
                 DATA PREPROCESSING PIPELINE (V2: MEMORY-SAFE)                  
================================================================================

2025-11-09 20:28:50 - utils - INFO - Cleaning up old temporary files...
2025-11-09 20:28:50 - utils - INFO - Removed 0 old temp files.
2025-11-09 20:28:50 - utils - INFO - --- Processing single dataset: r1 ---
2025-11-09 20:28:50 - utils - INFO - Loaded logon.csv (849579 rows)
2025-11-09 20:28:51 - utils - INFO - Parsed datetime column: date
2025-11-09 20:28:51 - utils - INFO - Loaded device.csv (65668 rows)
2025-11-09 20:28:52 - utils - INFO - Parsed datetime column: date
2025-11-09 20:28:52 - utils - WARNING - file.csv not found in r1, skipping.
2025-11-09 20:28:52 - utils - WARNING - email.csv not found in r1, skipping.
2025-11-09 20:28:54 - utils - INFO - Loaded http.csv (3451664 rows)
2025-11-09 20:28:54 - utils - WARNING - 'date' column not found in /Users/bipinrimal/Downloads/Thesis_work/data/all_data/r1/http.csv. Skipping file.
2025-11-09 20:28:54 - utils - INFO - Cleaning dataframe with 915247 rows
2025-11-09 20:28:54 - utils - INFO - Removed 0 duplicate rows
2025-11-09 20:28:57 - utils - INFO - Saved temporary file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r1.csv (915247 rows)
2025-11-09 20:28:57 - utils - INFO - --- Processing single dataset: r2 ---
2025-11-09 20:28:57 - utils - INFO - Loaded logon.csv (840141 rows)
2025-11-09 20:28:58 - utils - INFO - Parsed datetime column: date
2025-11-09 20:28:58 - utils - INFO - Loaded device.csv (712308 rows)
2025-11-09 20:28:59 - utils - INFO - Parsed datetime column: date
2025-11-09 20:28:59 - utils - WARNING - file.csv not found in r2, skipping.
2025-11-09 20:29:00 - utils - INFO - Loaded email.csv (1189372 rows)
2025-11-09 20:29:01 - utils - INFO - Parsed datetime column: date
2025-11-09 20:29:07 - utils - INFO - Loaded http.csv (7321105 rows)
2025-11-09 20:29:14 - utils - INFO - Parsed datetime column: date
2025-11-09 20:29:20 - utils - INFO - Cleaning dataframe with 10062926 rows
2025-11-09 20:29:26 - utils - INFO - Removed 0 duplicate rows
2025-11-09 20:29:27 - utils - INFO - Missing values:
pc_id       1189372
activity    8510477
to          8873554
url         2741821
domain      2741821
dtype: int64
2025-11-09 20:29:58 - utils - INFO - Saved temporary file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r2.csv (10062926 rows)
2025-11-09 20:29:58 - utils - INFO - Merging 2 processed temp files...
2025-11-09 20:30:23 - utils - INFO - Master dataframe created: 10978173 total rows
2025-11-09 20:30:23 - utils - INFO - Cleaning up temporary files...
2025-11-09 20:30:23 - utils - INFO - Loading and merging static data (LDAP, Psychometric)...
2025-11-09 20:30:23 - utils - ERROR - Failed to load/merge LDAP data: Usecols do not match columns, columns expected but not found: ['domain']
2025-11-09 20:30:24 - utils - INFO - Merged psychometric data for 1000 users
2025-11-09 20:30:45 - utils - INFO - Handled missing values using strategy: fill_mode
2025-11-09 20:30:46 - utils - INFO - Saving new master file to /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs_ALL.csv...
2025-11-09 20:31:32 - utils - INFO - ================================================================================
2025-11-09 20:31:32 - utils - INFO - V2 Preprocessing Complete!
2025-11-09 20:31:32 - utils - INFO - Master file saved: 10978173 rows
2025-11-09 20:31:32 - utils - INFO - Next step: python label_insiders_v2.py
2025-11-09 20:31:32 - utils - INFO - ================================================================================
2025-11-09 20:32:17 - utils - INFO - Utility functions loaded successfully
2025-11-09 20:32:17 - utils - INFO - 
================================================================================
                  LABELING INSIDER THREATS (V2: MULTI-DATASET)                  
================================================================================

2025-11-09 20:32:17 - utils - INFO - Loading CMU-CERT master answers file (insiders.csv)...
2025-11-09 20:32:17 - utils - INFO - Loaded 191 total insider incidents
2025-11-09 20:32:17 - utils - WARNING - Could not parse dates for CDE1846 in 6.2: month must be in 1..12: /21/2011 11:43:39, at position 0
2025-11-09 20:32:17 - utils - INFO - Parsed 190 insider activity rules
2025-11-09 20:32:19 - utils - INFO - Processing chunk 1 (1000000 rows)...
2025-11-09 20:32:32 - utils - INFO - Processing chunk 2 (1000000 rows)...
2025-11-09 20:32:45 - utils - INFO - Processing chunk 3 (1000000 rows)...
2025-11-09 20:32:59 - utils - INFO - Processing chunk 4 (1000000 rows)...
2025-11-09 20:33:12 - utils - INFO - Processing chunk 5 (1000000 rows)...
2025-11-09 20:33:25 - utils - INFO - Processing chunk 6 (1000000 rows)...
2025-11-09 20:33:38 - utils - INFO - Processing chunk 7 (1000000 rows)...
2025-11-09 20:33:52 - utils - INFO - Processing chunk 8 (1000000 rows)...
2025-11-09 20:34:05 - utils - INFO - Processing chunk 9 (1000000 rows)...
2025-11-09 20:34:18 - utils - INFO - Processing chunk 10 (1000000 rows)...
2025-11-09 20:34:31 - utils - INFO - Processing chunk 11 (978173 rows)...
2025-11-09 20:34:43 - utils - INFO - All chunks processed. Total rows: 10978173
2025-11-09 20:34:43 - utils - INFO - Total insider records labeled: 0
2025-11-09 20:34:43 - utils - INFO - Replacing original file with labeled version...
2025-11-09 20:34:43 - utils - INFO - Successfully created: /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs_ALL.csv
2025-11-09 20:34:43 - utils - INFO - ================================================================================
2025-11-09 20:34:43 - utils - INFO - V2 Labeling Complete!
2025-11-09 20:34:43 - utils - INFO - The file 'processed_unified_logs_ALL.csv' is now labeled.
2025-11-09 20:34:43 - utils - INFO - Next step: Run 'feature_engineering_v2.py'
2025-11-09 20:34:43 - utils - INFO - ================================================================================
2025-11-09 20:34:58 - utils - INFO - Utility functions loaded successfully
2025-11-09 20:34:58 - utils - INFO - Feature Engineer V2 initialized.
2025-11-09 20:34:58 - utils - INFO - 
================================================================================
                  FEATURE ENGINEERING PIPELINE V2 (MULTI-PASS)                  
================================================================================

2025-11-09 20:34:58 - utils - INFO - 
================================================================================
                           PASS 1: DAILY AGGREGATION                            
================================================================================

2025-11-09 20:34:58 - utils - INFO - Reading /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs_ALL.csv in 2000000-row chunks...
2025-11-09 20:35:00 - utils - INFO - Processing chunk 1...
2025-11-09 20:38:11 - utils - INFO - Utility functions loaded successfully
2025-11-09 20:38:11 - utils - INFO - Feature Engineer V2 initialized.
2025-11-09 20:38:11 - utils - INFO - 
================================================================================
                  FEATURE ENGINEERING PIPELINE V2 (MULTI-PASS)                  
================================================================================

2025-11-09 20:38:11 - utils - INFO - 
================================================================================
                           PASS 1: DAILY AGGREGATION                            
================================================================================

2025-11-09 20:38:11 - utils - INFO - Reading /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs_ALL.csv in 2000000-row chunks...
2025-11-09 20:38:12 - utils - INFO - Processing chunk 1...
2025-11-09 20:40:33 - utils - INFO - Utility functions loaded successfully
2025-11-09 20:40:33 - utils - INFO - Feature Engineer V2 initialized.
2025-11-09 20:40:33 - utils - INFO - 
================================================================================
                  FEATURE ENGINEERING PIPELINE V2 (MULTI-PASS)                  
================================================================================

2025-11-09 20:40:33 - utils - INFO - 
================================================================================
                           PASS 1: DAILY AGGREGATION                            
================================================================================

2025-11-09 20:40:33 - utils - INFO - Reading /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs_ALL.csv in 2000000-row chunks...
2025-11-09 20:40:35 - utils - INFO - Processing chunk 1...
2025-11-09 20:41:58 - utils - INFO - Utility functions loaded successfully
2025-11-09 20:41:58 - utils - INFO - Found 2 dataset folders in /Users/bipinrimal/Downloads/Thesis_work/data/all_data
2025-11-09 20:41:58 - utils - INFO - 
================================================================================
                 DATA PREPROCESSING PIPELINE (V2: MEMORY-SAFE)                  
================================================================================

2025-11-09 20:41:58 - utils - INFO - Cleaning up old temporary files...
2025-11-09 20:41:58 - utils - INFO - Removed 0 old temp files.
2025-11-09 20:41:58 - utils - INFO - --- Processing single dataset: r1 ---
2025-11-09 20:41:59 - utils - INFO - Loaded logon.csv (849579 rows)
2025-11-09 20:42:00 - utils - INFO - Parsed datetime column: date
2025-11-09 20:42:00 - utils - INFO - Loaded device.csv (65668 rows)
2025-11-09 20:42:00 - utils - INFO - Parsed datetime column: date
2025-11-09 20:42:00 - utils - WARNING - file.csv not found in r1, skipping.
2025-11-09 20:42:00 - utils - WARNING - email.csv not found in r1, skipping.
2025-11-09 20:42:02 - utils - INFO - Loaded http.csv (3451664 rows)
2025-11-09 20:42:02 - utils - WARNING - 'date' column not found in /Users/bipinrimal/Downloads/Thesis_work/data/all_data/r1/http.csv. Skipping file.
2025-11-09 20:42:02 - utils - INFO - Cleaning dataframe with 915247 rows
2025-11-09 20:42:02 - utils - INFO - Removed 0 duplicate rows
2025-11-09 20:42:05 - utils - INFO - Saved temporary file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r1.csv (915247 rows)
2025-11-09 20:42:05 - utils - INFO - --- Processing single dataset: r2 ---
2025-11-09 20:42:05 - utils - INFO - Loaded logon.csv (840141 rows)
2025-11-09 20:42:06 - utils - INFO - Parsed datetime column: date
2025-11-09 20:42:07 - utils - INFO - Loaded device.csv (712308 rows)
2025-11-09 20:42:07 - utils - INFO - Parsed datetime column: date
2025-11-09 20:42:07 - utils - WARNING - file.csv not found in r2, skipping.
2025-11-09 20:42:08 - utils - INFO - Loaded email.csv (1189372 rows)
2025-11-09 20:42:10 - utils - INFO - Parsed datetime column: date
2025-11-09 20:42:15 - utils - INFO - Loaded http.csv (7321105 rows)
2025-11-09 20:42:22 - utils - INFO - Parsed datetime column: date
2025-11-09 20:42:28 - utils - INFO - Cleaning dataframe with 10062926 rows
2025-11-09 20:42:35 - utils - INFO - Removed 0 duplicate rows
2025-11-09 20:42:36 - utils - INFO - Missing values:
pc_id       1189372
activity    8510477
to          8873554
url         2741821
domain      2741821
dtype: int64
2025-11-09 20:43:10 - utils - INFO - Saved temporary file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r2.csv (10062926 rows)
2025-11-09 20:43:10 - utils - INFO - Merging 2 processed temp files...
2025-11-09 20:43:37 - utils - INFO - Master dataframe created: 10978173 total rows
2025-11-09 20:43:37 - utils - INFO - Cleaning up temporary files...
2025-11-09 20:43:37 - utils - INFO - Loading and merging static data (LDAP, Psychometric)...
2025-11-09 20:43:37 - utils - ERROR - Failed to load/merge LDAP data: Usecols do not match columns, columns expected but not found: ['domain']
2025-11-09 20:43:39 - utils - INFO - Merged psychometric data for 1000 users
2025-11-09 20:44:00 - utils - INFO - Handled missing values using strategy: fill_mode
2025-11-09 20:44:01 - utils - INFO - Saving new master file to /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs_ALL.csv...
2025-11-09 20:44:50 - utils - INFO - ================================================================================
2025-11-09 20:44:50 - utils - INFO - V2 Preprocessing Complete!
2025-11-09 20:44:50 - utils - INFO - Master file saved: 10978173 rows
2025-11-09 20:44:50 - utils - INFO - Next step: python label_insiders_v2.py
2025-11-09 20:44:50 - utils - INFO - ================================================================================
2025-11-09 20:45:01 - utils - INFO - Utility functions loaded successfully
2025-11-09 20:45:01 - utils - INFO - 
================================================================================
                  LABELING INSIDER THREATS (V2: MULTI-DATASET)                  
================================================================================

2025-11-09 20:45:01 - utils - INFO - Loading CMU-CERT master answers file (insiders.csv)...
2025-11-09 20:45:01 - utils - INFO - Loaded 191 total insider incidents
2025-11-09 20:45:01 - utils - WARNING - Could not parse dates for CDE1846 in 6.2: month must be in 1..12: /21/2011 11:43:39, at position 0
2025-11-09 20:45:01 - utils - INFO - Parsed 190 insider activity rules
2025-11-09 20:45:03 - utils - INFO - Processing chunk 1 (1000000 rows)...
2025-11-09 20:45:17 - utils - INFO - Processing chunk 2 (1000000 rows)...
2025-11-09 20:45:31 - utils - INFO - Processing chunk 3 (1000000 rows)...
2025-11-09 20:45:45 - utils - INFO - Processing chunk 4 (1000000 rows)...
2025-11-09 20:45:59 - utils - INFO - Processing chunk 5 (1000000 rows)...
2025-11-09 20:46:12 - utils - INFO - Processing chunk 6 (1000000 rows)...
2025-11-09 20:46:26 - utils - INFO - Processing chunk 7 (1000000 rows)...
2025-11-09 20:46:39 - utils - INFO - Processing chunk 8 (1000000 rows)...
2025-11-09 20:46:52 - utils - INFO - Processing chunk 9 (1000000 rows)...
2025-11-09 20:47:06 - utils - INFO - Processing chunk 10 (1000000 rows)...
2025-11-09 20:47:19 - utils - INFO - Processing chunk 11 (978173 rows)...
2025-11-09 20:47:31 - utils - INFO - All chunks processed. Total rows: 10978173
2025-11-09 20:47:31 - utils - INFO - Total insider records labeled: 0
2025-11-09 20:47:31 - utils - INFO - Replacing original file with labeled version...
2025-11-09 20:47:31 - utils - INFO - Successfully created: /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs_ALL.csv
2025-11-09 20:47:31 - utils - INFO - ================================================================================
2025-11-09 20:47:31 - utils - INFO - V2 Labeling Complete!
2025-11-09 20:47:31 - utils - INFO - The file 'processed_unified_logs_ALL.csv' is now labeled.
2025-11-09 20:47:31 - utils - INFO - Next step: Run 'feature_engineering_v2.py'
2025-11-09 20:47:31 - utils - INFO - ================================================================================
2025-11-09 20:48:36 - utils - INFO - Utility functions loaded successfully
2025-11-09 20:48:36 - utils - INFO - Feature Engineer V2 initialized.
2025-11-09 20:48:36 - utils - INFO - 
================================================================================
                  FEATURE ENGINEERING PIPELINE V2 (MULTI-PASS)                  
================================================================================

2025-11-09 20:48:36 - utils - INFO - 
================================================================================
                           PASS 1: DAILY AGGREGATION                            
================================================================================

2025-11-09 20:48:36 - utils - INFO - Reading /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs_ALL.csv in 2000000-row chunks...
2025-11-09 20:48:38 - utils - INFO - Processing chunk 1...
2025-11-09 20:48:40 - utils - INFO - Processing chunk 2...
2025-11-09 20:48:43 - utils - INFO - Processing chunk 3...
2025-11-09 20:48:45 - utils - INFO - Processing chunk 4...
2025-11-09 20:48:48 - utils - INFO - Processing chunk 5...
2025-11-09 20:48:50 - utils - INFO - Processing chunk 6...
2025-11-09 20:48:50 - utils - INFO - All 6 chunks processed. Merging daily summaries...
2025-11-09 20:48:50 - utils - INFO - Cleaning up temporary chunk files...
2025-11-09 20:48:52 - utils - INFO - PASS 1 complete. Saved /Users/bipinrimal/Downloads/Thesis_work/data/processed/daily_features_unscaled_v2.csv (996705 rows)
2025-11-09 20:48:52 - utils - INFO - 
================================================================================
                     PASS 2: FEATURE ENRICHMENT (Z-SCORES)                      
================================================================================

2025-11-09 20:48:52 - utils - INFO - Loaded canonical role data for 1000 users.
2025-11-09 20:48:52 - utils - INFO - Successfully merged 'role' column for Pass 2.
2025-11-09 20:48:52 - utils - INFO - Calculating self-relative Z-Scores (rolling 30-day)...
2025-11-09 20:48:54 - utils - INFO - Calculating peer-relative Z-Scores (by role)...
2025-11-09 20:48:55 - utils - INFO - PASS 2 complete. Enriched features created.
2025-11-09 20:48:55 - utils - INFO - Scaling and saving final daily features (for LSTM)...
2025-11-09 20:54:24 - utils - INFO - Utility functions loaded successfully
2025-11-09 20:54:24 - utils - INFO - Feature Engineer V2 initialized.
2025-11-09 20:54:24 - utils - INFO - 
================================================================================
                  FEATURE ENGINEERING PIPELINE V2 (MULTI-PASS)                  
================================================================================

2025-11-09 20:58:10 - utils - INFO - Utility functions loaded successfully
2025-11-09 20:58:10 - utils - INFO - Feature Engineer V2 initialized.
2025-11-09 20:58:10 - utils - INFO - 
================================================================================
                  FEATURE ENGINEERING PIPELINE V2 (MULTI-PASS)                  
================================================================================

2025-11-09 20:58:16 - utils - INFO - Utility functions loaded successfully
2025-11-09 20:58:16 - utils - INFO - Feature Engineer V2 initialized.
2025-11-09 20:58:16 - utils - INFO - 
================================================================================
                  FEATURE ENGINEERING PIPELINE V2 (MULTI-PASS)                  
================================================================================

2025-11-09 20:58:38 - utils - INFO - Utility functions loaded successfully
2025-11-09 20:58:38 - utils - INFO - Feature Engineer V2 initialized.
2025-11-09 20:58:38 - utils - INFO - 
================================================================================
                  FEATURE ENGINEERING PIPELINE V2 (MULTI-PASS)                  
================================================================================

2025-11-09 20:59:13 - utils - INFO - Utility functions loaded successfully
2025-11-09 20:59:13 - utils - INFO - Feature Engineer V2 initialized.
2025-11-09 20:59:13 - utils - INFO - 
================================================================================
                  FEATURE ENGINEERING PIPELINE V2 (MULTI-PASS)                  
================================================================================

2025-11-09 21:01:11 - utils - INFO - Utility functions loaded successfully
2025-11-09 21:01:11 - utils - INFO - Feature Engineer V2 initialized.
2025-11-09 21:01:11 - utils - INFO - 
================================================================================
                  FEATURE ENGINEERING PIPELINE V2 (MULTI-PASS)                  
================================================================================

2025-11-09 21:01:30 - utils - INFO - Utility functions loaded successfully
2025-11-09 21:01:30 - utils - INFO - Feature Engineer V2 initialized.
2025-11-09 21:01:30 - utils - INFO - 
================================================================================
                  FEATURE ENGINEERING PIPELINE V2 (MULTI-PASS)                  
================================================================================

2025-11-09 21:03:49 - utils - INFO - Utility functions loaded successfully
2025-11-09 21:03:49 - utils - INFO - Feature Engineer V2 initialized.
2025-11-09 21:03:49 - utils - INFO - 
================================================================================
                  FEATURE ENGINEERING PIPELINE V2 (MULTI-PASS)                  
================================================================================

2025-11-09 21:04:18 - utils - INFO - Utility functions loaded successfully
2025-11-09 21:04:18 - utils - INFO - Feature Engineer V2 initialized.
2025-11-09 21:04:18 - utils - INFO - 
================================================================================
                  FEATURE ENGINEERING PIPELINE V2 (MULTI-PASS)                  
================================================================================

2025-11-09 21:04:41 - utils - INFO - Utility functions loaded successfully
2025-11-09 21:04:41 - utils - INFO - Feature Engineer V2 initialized.
2025-11-09 21:04:41 - utils - INFO - 
================================================================================
                  FEATURE ENGINEERING PIPELINE V2 (MULTI-PASS)                  
================================================================================

2025-11-09 21:07:23 - utils - INFO - Utility functions loaded successfully
2025-11-09 21:07:23 - utils - INFO - Feature Engineer V2 initialized.
2025-11-09 21:07:23 - utils - INFO - 
================================================================================
                  FEATURE ENGINEERING PIPELINE V2 (MULTI-PASS)                  
================================================================================

2025-11-09 21:09:14 - utils - INFO - Utility functions loaded successfully
2025-11-09 21:09:14 - utils - INFO - Feature Engineer V2 initialized.
2025-11-09 21:09:14 - utils - INFO - 
================================================================================
                  FEATURE ENGINEERING PIPELINE V2 (MULTI-PASS)                  
================================================================================

2025-11-09 21:09:18 - utils - INFO - Utility functions loaded successfully
2025-11-09 21:09:18 - utils - INFO - Feature Engineer V2 initialized.
2025-11-09 21:09:18 - utils - INFO - 
================================================================================
                  FEATURE ENGINEERING PIPELINE V2 (MULTI-PASS)                  
================================================================================

2025-11-09 21:09:57 - utils - INFO - Utility functions loaded successfully
2025-11-09 21:09:57 - utils - INFO - Feature Engineer V2 initialized.
2025-11-09 21:09:57 - utils - INFO - 
================================================================================
                  FEATURE ENGINEERING PIPELINE V2 (MULTI-PASS)                  
================================================================================

2025-11-09 21:16:56 - utils - INFO - Utility functions loaded successfully
2025-11-09 21:16:56 - utils - INFO - Found 2 dataset folders in /Users/bipinrimal/Downloads/Thesis_work/data/all_data
2025-11-09 21:16:56 - utils - INFO - 
================================================================================
                 DATA PREPROCESSING PIPELINE (V2: MEMORY-SAFE)                  
================================================================================

2025-11-09 21:16:56 - utils - INFO - Cleaning up old temporary files...
2025-11-09 21:16:56 - utils - INFO - Removed 0 old temp files.
2025-11-09 21:16:56 - utils - INFO - --- Processing single dataset: r1 ---
2025-11-09 21:16:57 - utils - INFO - Loaded logon.csv (849579 rows)
2025-11-09 21:16:57 - utils - INFO - Parsed datetime column: date
2025-11-09 21:16:58 - utils - INFO - Loaded device.csv (65668 rows)
2025-11-09 21:16:58 - utils - INFO - Parsed datetime column: date
2025-11-09 21:16:58 - utils - WARNING - file.csv not found in r1, skipping.
2025-11-09 21:16:58 - utils - WARNING - email.csv not found in r1, skipping.
2025-11-09 21:17:00 - utils - INFO - Loaded http.csv (3451664 rows)
2025-11-09 21:17:00 - utils - WARNING - 'date' column not found in /Users/bipinrimal/Downloads/Thesis_work/data/all_data/r1/http.csv. Skipping file.
2025-11-09 21:17:00 - utils - INFO - Cleaning dataframe with 915247 rows
2025-11-09 21:17:00 - utils - INFO - Removed 0 duplicate rows
2025-11-09 21:17:03 - utils - INFO - Saved temporary file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r1.csv (915247 rows)
2025-11-09 21:17:03 - utils - INFO - --- Processing single dataset: r2 ---
2025-11-09 21:17:03 - utils - INFO - Loaded logon.csv (840141 rows)
2025-11-09 21:17:04 - utils - INFO - Parsed datetime column: date
2025-11-09 21:17:05 - utils - INFO - Loaded device.csv (712308 rows)
2025-11-09 21:17:05 - utils - INFO - Parsed datetime column: date
2025-11-09 21:17:05 - utils - WARNING - file.csv not found in r2, skipping.
2025-11-09 21:17:06 - utils - INFO - Loaded email.csv (1189372 rows)
2025-11-09 21:17:07 - utils - INFO - Parsed datetime column: date
2025-11-09 21:17:13 - utils - INFO - Loaded http.csv (7321105 rows)
2025-11-09 21:17:20 - utils - INFO - Parsed datetime column: date
2025-11-09 21:17:26 - utils - INFO - Cleaning dataframe with 10062926 rows
2025-11-09 21:17:32 - utils - INFO - Removed 0 duplicate rows
2025-11-09 21:17:33 - utils - INFO - Missing values:
pc_id       1189372
activity    8510477
to          8873554
url         2741821
domain      2741821
dtype: int64
2025-11-09 21:18:07 - utils - INFO - Saved temporary file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r2.csv (10062926 rows)
2025-11-09 21:18:07 - utils - INFO - Merging 2 processed temp files...
2025-11-09 21:18:35 - utils - INFO - Master dataframe created: 10978173 total rows
2025-11-09 21:18:35 - utils - INFO - Cleaning up temporary files...
2025-11-09 21:18:36 - utils - INFO - Loading and merging static data (LDAP, Psychometric)...
2025-11-09 21:18:36 - utils - ERROR - Failed to load/merge LDAP data: No LDAP CSVs found in /Users/bipinrimal/Downloads/Thesis_work/data/all_data/LDAP
2025-11-09 21:18:37 - utils - INFO - Merged psychometric data for 1000 users
2025-11-09 21:18:58 - utils - INFO - Handled missing values using strategy: fill_mode
2025-11-09 21:18:58 - utils - INFO - Saving new master file to /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs_ALL.csv...
2025-11-09 21:19:46 - utils - INFO - ================================================================================
2025-11-09 21:19:46 - utils - INFO - V2 Preprocessing Complete!
2025-11-09 21:19:46 - utils - INFO - Master file saved: 10978173 rows
2025-11-09 21:19:46 - utils - INFO - Next step: python label_insiders_v2.py
2025-11-09 21:19:46 - utils - INFO - ================================================================================
2025-11-09 21:25:35 - utils - INFO - Utility functions loaded successfully
2025-11-09 21:25:35 - utils - INFO - 
================================================================================
                  LABELING INSIDER THREATS (V2: MULTI-DATASET)                  
================================================================================

2025-11-09 21:25:35 - utils - INFO - Loading CMU-CERT master answers file (insiders.csv)...
2025-11-09 21:25:35 - utils - INFO - Loaded 191 total insider incidents
2025-11-09 21:25:35 - utils - WARNING - Could not parse dates for CDE1846 in 6.2: month must be in 1..12: /21/2011 11:43:39, at position 0
2025-11-09 21:25:35 - utils - INFO - Parsed 190 insider activity rules
2025-11-09 21:25:37 - utils - INFO - Processing chunk 1 (1000000 rows)...
2025-11-09 21:25:50 - utils - INFO - Processing chunk 2 (1000000 rows)...
2025-11-09 21:26:03 - utils - INFO - Processing chunk 3 (1000000 rows)...
2025-11-09 21:26:16 - utils - INFO - Processing chunk 4 (1000000 rows)...
2025-11-09 21:26:29 - utils - INFO - Processing chunk 5 (1000000 rows)...
2025-11-09 21:26:43 - utils - INFO - Processing chunk 6 (1000000 rows)...
2025-11-09 21:26:56 - utils - INFO - Processing chunk 7 (1000000 rows)...
2025-11-09 21:27:10 - utils - INFO - Processing chunk 8 (1000000 rows)...
2025-11-09 21:27:23 - utils - INFO - Processing chunk 9 (1000000 rows)...
2025-11-09 21:27:37 - utils - INFO - Processing chunk 10 (1000000 rows)...
2025-11-09 21:27:50 - utils - INFO - Processing chunk 11 (978173 rows)...
2025-11-09 21:28:02 - utils - INFO - All chunks processed. Total rows: 10978173
2025-11-09 21:28:02 - utils - INFO - Total insider records labeled: 0
2025-11-09 21:28:02 - utils - INFO - Replacing original file with labeled version...
2025-11-09 21:28:02 - utils - INFO - Successfully created: /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs_ALL.csv
2025-11-09 21:28:02 - utils - INFO - ================================================================================
2025-11-09 21:28:02 - utils - INFO - V2 Labeling Complete!
2025-11-09 21:28:02 - utils - INFO - The file 'processed_unified_logs_ALL.csv' is now labeled.
2025-11-09 21:28:02 - utils - INFO - Next step: Run 'feature_engineering_v2.py'
2025-11-09 21:28:02 - utils - INFO - ================================================================================
2025-11-09 21:33:14 - utils - INFO - Utility functions loaded successfully
2025-11-09 21:33:14 - utils - INFO - Feature Engineer V2 initialized.
2025-11-09 21:33:14 - utils - INFO - 
================================================================================
                  FEATURE ENGINEERING PIPELINE V2 (MULTI-PASS)                  
================================================================================

2025-11-09 21:33:29 - utils - INFO - Utility functions loaded successfully
2025-11-09 21:33:29 - utils - INFO - Feature Engineer V2 initialized.
2025-11-09 21:33:29 - utils - INFO - 
================================================================================
                  FEATURE ENGINEERING PIPELINE V2 (MULTI-PASS)                  
================================================================================

2025-11-09 21:39:11 - utils - INFO - Utility functions loaded successfully
2025-11-09 21:39:11 - utils - INFO - Feature Engineer V2 initialized.
2025-11-09 21:39:11 - utils - INFO - 
================================================================================
                  FEATURE ENGINEERING PIPELINE V2 (MULTI-PASS)                  
================================================================================

2025-11-09 21:39:19 - utils - INFO - Utility functions loaded successfully
2025-11-09 21:39:19 - utils - INFO - Feature Engineer V2 initialized.
2025-11-09 21:39:19 - utils - INFO - 
================================================================================
                  FEATURE ENGINEERING PIPELINE V2 (MULTI-PASS)                  
================================================================================

2025-11-09 21:40:56 - utils - INFO - Utility functions loaded successfully
2025-11-09 21:40:56 - utils - INFO - Feature Engineer V2 initialized.
2025-11-09 21:40:56 - utils - INFO - 
================================================================================
                  FEATURE ENGINEERING PIPELINE V2 (MULTI-PASS)                  
================================================================================

2025-11-09 21:40:56 - utils - INFO - Found /Users/bipinrimal/Downloads/Thesis_work/data/processed/daily_features_unscaled_v2.csv, skipping Pass 1.
2025-11-09 21:40:56 - utils - INFO - 
================================================================================
                     PASS 2: FEATURE ENRICHMENT (Z-SCORES)                      
================================================================================

2025-11-09 21:40:56 - utils - ERROR - Failed to load LDAP data for role enrichment: No LDAP CSVs found in /Users/bipinrimal/Downloads/Thesis_work/data/all_data/LDAP
2025-11-09 21:40:56 - utils - WARNING - Could not load LDAP data. Peer-relative features will be skipped.
2025-11-09 21:40:56 - utils - INFO - Calculating self-relative Z-Scores (rolling 30-day)...
2025-11-09 21:40:58 - utils - INFO - Calculating peer-relative Z-Scores (by role)...
2025-11-09 21:40:58 - utils - INFO - PASS 2 complete. Enriched features created.
2025-11-09 21:40:58 - utils - INFO - Scaling and saving final daily features (for LSTM)...
2025-11-09 21:40:58 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/daily_feature_scaler_v2.pkl
2025-11-09 21:41:09 - utils - INFO - Saved /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_daily_features_v2.csv
2025-11-09 21:41:09 - utils - INFO - 
================================================================================
                        PASS 3: STATIC FEATURE CREATION                         
================================================================================

2025-11-09 21:41:10 - utils - INFO - Created static features for 3000 users
2025-11-09 21:41:10 - utils - INFO - Scaling and saving static features...
2025-11-09 21:41:10 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/static_feature_scaler_v2.pkl
2025-11-09 21:41:10 - utils - INFO - PASS 3 complete. Saved /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_static_features_v2.csv
2025-11-09 21:41:10 - utils - INFO - 
================================================================================
                           PASS 4: SEQUENCE CREATION                            
================================================================================

2025-11-09 21:41:10 - utils - INFO - Creating sequences (length=15, stride=10)...
2025-11-09 21:42:01 - utils - INFO - Created 97962 sequences from 3000 users
2025-11-09 21:42:01 - utils - INFO - PASS 4 complete. Saved sequence files to /Users/bipinrimal/Downloads/Thesis_work/data/processed
2025-11-09 21:42:01 - utils - INFO - ================================================================================
2025-11-09 21:42:01 - utils - INFO - V2 Feature Engineering Complete!
2025-11-09 21:42:01 - utils - INFO -   Static features created: /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_static_features_v2.csv
2025-11-09 21:42:01 - utils - INFO -   Sequence files created: /Users/bipinrimal/Downloads/Thesis_work/data/processed
2025-11-09 21:42:01 - utils - INFO - Next step: Train V2 models.
2025-11-09 21:42:01 - utils - INFO - ================================================================================
2025-11-09 22:10:03 - utils - INFO - Utility functions loaded successfully
2025-11-09 22:10:03 - utils - INFO - 
================================================================================
                 ISOLATION FOREST TRAINING (V2: MULTI-DATASET)                  
================================================================================

2025-11-09 22:10:03 - utils - INFO - Model loaded from /Users/bipinrimal/Downloads/Thesis_work/models/static_feature_scaler_v2.pkl
2025-11-09 22:10:03 - utils - INFO - Data split: 3000 total samples, 0 insiders
2025-11-09 22:10:03 - utils - INFO - Training on: 2400 normal samples
2025-11-09 22:10:03 - utils - INFO - Calibrating on: 600 normal samples
2025-11-09 22:10:03 - utils - INFO - Testing on: 3000 total samples (including 0 insiders)
2025-11-09 22:10:03 - utils - INFO - Initialized Isolation Forest (V2) with params: {'n_estimators': 50, 'max_samples': 256, 'contamination': 'auto', 'max_features': 1.0, 'bootstrap': False, 'n_jobs': -1, 'random_state': 42, 'verbose': 0}
2025-11-09 22:10:03 - utils - INFO - Training Isolation Forest on 2400 normal samples...
2025-11-09 22:10:03 - utils - INFO - Isolation Forest training completed
2025-11-09 22:10:03 - utils - INFO - Calibrating threshold for target FPR=0.05...
2025-11-09 22:10:03 - utils - INFO - Calibrated threshold: 0.5793
2025-11-09 22:10:03 - utils - INFO - Evaluating Isolation Forest (V2)...
2025-11-09 22:10:03 - utils - WARNING - No positive samples in test set. Metrics (Precision, Recall, F1, AUC-ROC) will be 0 or NaN.
2025-11-09 22:10:03 - utils - INFO - 
============================================================
2025-11-09 22:10:03 - utils - INFO - Isolation Forest (V2) Performance Metrics
2025-11-09 22:10:03 - utils - INFO - ============================================================
2025-11-09 22:10:03 - utils - INFO - Accuracy:  0.9547
2025-11-09 22:10:03 - utils - INFO - Precision: 0.0000
2025-11-09 22:10:03 - utils - INFO - Recall:    0.0000
2025-11-09 22:10:03 - utils - INFO - F1-Score:  0.0000
2025-11-09 22:10:03 - utils - INFO - AUC-ROC:   nan
2025-11-09 22:10:03 - utils - INFO - ============================================================

2025-11-09 22:10:03 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest_v2.pkl
2025-11-09 22:10:03 - utils - INFO - Saving Isolation Forest model to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest_v2.pkl
2025-11-09 22:10:03 - utils - INFO - Isolation Forest (V2) training and evaluation completed!
2025-11-09 22:40:03 - utils - INFO - Utility functions loaded successfully
2025-11-09 22:40:03 - utils - INFO - 
================================================================================
                  LABELING INSIDER THREATS (V2: MULTI-DATASET)                  
================================================================================

2025-11-09 22:40:03 - utils - INFO - Loading CMU-CERT master answers file (insiders.csv)...
2025-11-09 22:40:03 - utils - INFO - Loaded 191 total insider incidents
2025-11-09 22:40:03 - utils - WARNING - Could not parse dates for CDE1846 in 6.2: month must be in 1..12: /21/2011 11:43:39, at position 0
2025-11-09 22:40:03 - utils - INFO - Parsed 190 insider activity rules
2025-11-09 22:40:05 - utils - INFO - Processing chunk 1 (1000000 rows)...
2025-11-09 22:40:20 - utils - INFO - Processing chunk 2 (1000000 rows)...
2025-11-09 22:40:34 - utils - INFO - Processing chunk 3 (1000000 rows)...
2025-11-09 22:40:48 - utils - INFO - Processing chunk 4 (1000000 rows)...
2025-11-09 22:41:01 - utils - INFO - Processing chunk 5 (1000000 rows)...
2025-11-09 22:41:14 - utils - INFO - Processing chunk 6 (1000000 rows)...
2025-11-09 22:41:28 - utils - INFO - Processing chunk 7 (1000000 rows)...
2025-11-09 22:41:41 - utils - INFO - Processing chunk 8 (1000000 rows)...
2025-11-09 22:41:55 - utils - INFO - Processing chunk 9 (1000000 rows)...
2025-11-09 22:42:08 - utils - INFO - Processing chunk 10 (1000000 rows)...
2025-11-09 22:42:22 - utils - INFO - Processing chunk 11 (978173 rows)...
2025-11-09 22:42:33 - utils - INFO - All chunks processed. Total rows: 10978173
2025-11-09 22:42:33 - utils - INFO - Total insider records labeled: 0
2025-11-09 22:42:33 - utils - INFO - Replacing original file with labeled version...
2025-11-09 22:42:33 - utils - INFO - Successfully created: /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs_ALL.csv
2025-11-09 22:42:33 - utils - INFO - ================================================================================
2025-11-09 22:42:33 - utils - INFO - V2 Labeling Complete!
2025-11-09 22:42:33 - utils - INFO - The file 'processed_unified_logs_ALL.csv' is now labeled.
2025-11-09 22:42:33 - utils - INFO - Next step: Run 'feature_engineering_v2.py'
2025-11-09 22:42:33 - utils - INFO - ================================================================================
2025-11-09 22:46:38 - utils - INFO - Utility functions loaded successfully
2025-11-09 22:46:38 - utils - INFO - Feature Engineer V2 initialized.
2025-11-09 22:46:38 - utils - INFO - 
================================================================================
                  FEATURE ENGINEERING PIPELINE V2 (MULTI-PASS)                  
================================================================================

2025-11-09 22:46:38 - utils - INFO - Found /Users/bipinrimal/Downloads/Thesis_work/data/processed/daily_features_unscaled_v2.csv, skipping Pass 1.
2025-11-09 22:46:38 - utils - INFO - 
================================================================================
                     PASS 2: FEATURE ENRICHMENT (Z-SCORES)                      
================================================================================

2025-11-09 22:46:38 - utils - ERROR - Failed to load LDAP data for role enrichment: No LDAP CSVs found in /Users/bipinrimal/Downloads/Thesis_work/data/all_data/LDAP
2025-11-09 22:46:38 - utils - WARNING - Could not load LDAP data. Peer-relative features will be skipped.
2025-11-09 22:46:38 - utils - INFO - Calculating self-relative Z-Scores (rolling 30-day)...
2025-11-09 22:46:40 - utils - INFO - Calculating peer-relative Z-Scores (by role)...
2025-11-09 22:46:41 - utils - INFO - PASS 2 complete. Enriched features created.
2025-11-09 22:46:41 - utils - INFO - Scaling and saving final daily features (for LSTM)...
2025-11-09 22:46:41 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/daily_feature_scaler_v2.pkl
2025-11-09 22:46:52 - utils - INFO - Saved /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_daily_features_v2.csv
2025-11-09 22:46:52 - utils - INFO - 
================================================================================
                        PASS 3: STATIC FEATURE CREATION                         
================================================================================

2025-11-09 22:46:52 - utils - INFO - Created static features for 3000 users
2025-11-09 22:46:52 - utils - INFO - Scaling and saving static features...
2025-11-09 22:46:52 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/static_feature_scaler_v2.pkl
2025-11-09 22:46:52 - utils - INFO - PASS 3 complete. Saved /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_static_features_v2.csv
2025-11-09 22:46:52 - utils - INFO - 
================================================================================
                           PASS 4: SEQUENCE CREATION                            
================================================================================

2025-11-09 22:46:52 - utils - INFO - Creating sequences (length=15, stride=10)...
2025-11-09 22:47:45 - utils - INFO - Created 97962 sequences from 3000 users
2025-11-09 22:47:45 - utils - INFO - PASS 4 complete. Saved sequence files to /Users/bipinrimal/Downloads/Thesis_work/data/processed
2025-11-09 22:47:45 - utils - INFO - ================================================================================
2025-11-09 22:47:45 - utils - INFO - V2 Feature Engineering Complete!
2025-11-09 22:47:45 - utils - INFO -   Static features created: /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_static_features_v2.csv
2025-11-09 22:47:45 - utils - INFO -   Sequence files created: /Users/bipinrimal/Downloads/Thesis_work/data/processed
2025-11-09 22:47:45 - utils - INFO - Next step: Train V2 models.
2025-11-09 22:47:45 - utils - INFO - ================================================================================
2025-11-09 22:55:47 - utils - INFO - Utility functions loaded successfully
2025-11-09 22:55:47 - utils - INFO - 
================================================================================
                 ISOLATION FOREST TRAINING (V2: MULTI-DATASET)                  
================================================================================

2025-11-09 22:55:47 - utils - INFO - Model loaded from /Users/bipinrimal/Downloads/Thesis_work/models/static_feature_scaler_v2.pkl
2025-11-09 22:55:47 - utils - INFO - Data split: 3000 total samples, 0 insiders
2025-11-09 22:55:47 - utils - INFO - Training on: 2400 normal samples
2025-11-09 22:55:47 - utils - INFO - Calibrating on: 600 normal samples
2025-11-09 22:55:47 - utils - INFO - Testing on: 3000 total samples (including 0 insiders)
2025-11-09 22:55:47 - utils - INFO - Initialized Isolation Forest (V2) with params: {'n_estimators': 50, 'max_samples': 256, 'contamination': 'auto', 'max_features': 1.0, 'bootstrap': False, 'n_jobs': -1, 'random_state': 42, 'verbose': 0}
2025-11-09 22:55:47 - utils - INFO - Training Isolation Forest on 2400 normal samples...
2025-11-09 22:55:47 - utils - INFO - Isolation Forest training completed
2025-11-09 22:55:47 - utils - INFO - Calibrating threshold for target FPR=0.05...
2025-11-09 22:55:47 - utils - INFO - Calibrated threshold: 0.5793
2025-11-09 22:55:47 - utils - INFO - Evaluating Isolation Forest (V2)...
2025-11-09 22:55:47 - utils - WARNING - No positive samples in test set. Metrics (Precision, Recall, F1, AUC-ROC) will be 0 or NaN.
2025-11-09 22:55:47 - utils - INFO - 
============================================================
2025-11-09 22:55:47 - utils - INFO - Isolation Forest (V2) Performance Metrics
2025-11-09 22:55:47 - utils - INFO - ============================================================
2025-11-09 22:55:47 - utils - INFO - Accuracy:  0.9547
2025-11-09 22:55:47 - utils - INFO - Precision: 0.0000
2025-11-09 22:55:47 - utils - INFO - Recall:    0.0000
2025-11-09 22:55:47 - utils - INFO - F1-Score:  0.0000
2025-11-09 22:55:47 - utils - INFO - AUC-ROC:   nan
2025-11-09 22:55:47 - utils - INFO - ============================================================

2025-11-09 22:55:47 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest_v2.pkl
2025-11-09 22:55:47 - utils - INFO - Saving Isolation Forest model to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest_v2.pkl
2025-11-09 22:55:47 - utils - INFO - Isolation Forest (V2) training and evaluation completed!
2025-11-10 07:29:51 - utils - INFO - Utility functions loaded successfully
2025-11-10 07:29:51 - utils - INFO - 
================================================================================
                 ISOLATION FOREST TRAINING (V2: MULTI-DATASET)                  
================================================================================

2025-11-10 07:29:51 - utils - INFO - Model loaded from /Users/bipinrimal/Downloads/Thesis_work/models/static_feature_scaler_v2.pkl
2025-11-10 07:29:51 - utils - INFO - Data split: 3000 total samples, 0 insiders
2025-11-10 07:29:51 - utils - INFO - Training on: 2400 normal samples
2025-11-10 07:29:51 - utils - INFO - Calibrating on: 600 normal samples
2025-11-10 07:29:51 - utils - INFO - Testing on: 3000 total samples (including 0 insiders)
2025-11-10 07:29:51 - utils - INFO - Initialized Isolation Forest (V2) with params: {'n_estimators': 50, 'max_samples': 256, 'contamination': 'auto', 'max_features': 1.0, 'bootstrap': False, 'n_jobs': -1, 'random_state': 42, 'verbose': 0}
2025-11-10 07:29:51 - utils - INFO - Training Isolation Forest on 2400 normal samples...
2025-11-10 07:29:51 - utils - INFO - Isolation Forest training completed
2025-11-10 07:29:51 - utils - INFO - Calibrating threshold for target FPR=0.05...
2025-11-10 07:29:51 - utils - INFO - Calibrated threshold: 0.5793
2025-11-10 07:29:51 - utils - INFO - Evaluating Isolation Forest (V2)...
2025-11-10 07:29:51 - utils - WARNING - No positive samples in test set. Metrics (Precision, Recall, F1, AUC-ROC) will be 0 or NaN.
2025-11-10 07:29:51 - utils - INFO - 
============================================================
2025-11-10 07:29:51 - utils - INFO - Isolation Forest (V2) Performance Metrics
2025-11-10 07:29:51 - utils - INFO - ============================================================
2025-11-10 07:29:51 - utils - INFO - Accuracy:  0.9547
2025-11-10 07:29:51 - utils - INFO - Precision: 0.0000
2025-11-10 07:29:51 - utils - INFO - Recall:    0.0000
2025-11-10 07:29:51 - utils - INFO - F1-Score:  0.0000
2025-11-10 07:29:51 - utils - INFO - AUC-ROC:   nan
2025-11-10 07:29:51 - utils - INFO - ============================================================

2025-11-10 07:29:51 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest_v2.pkl
2025-11-10 07:29:51 - utils - INFO - Saving Isolation Forest model to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest_v2.pkl
2025-11-10 07:29:51 - utils - INFO - Isolation Forest (V2) training and evaluation completed!
2025-11-10 07:30:24 - utils - INFO - Utility functions loaded successfully
2025-11-10 07:30:24 - utils - INFO - 
================================================================================
                  LABELING INSIDER THREATS (V2: MULTI-DATASET)                  
================================================================================

2025-11-10 07:30:24 - utils - INFO - Loading CMU-CERT master answers file (insiders.csv)...
2025-11-10 07:30:24 - utils - INFO - Loaded 191 total insider incidents
2025-11-10 07:30:24 - utils - WARNING - Could not parse dates for CDE1846 in 6.2: month must be in 1..12: /21/2011 11:43:39, at position 0
2025-11-10 07:30:24 - utils - INFO - Parsed 190 insider activity rules
2025-11-10 07:30:26 - utils - INFO - Processing chunk 1 (1000000 rows)...
2025-11-10 07:30:38 - utils - INFO - Processing chunk 2 (1000000 rows)...
2025-11-10 07:30:51 - utils - INFO - Processing chunk 3 (1000000 rows)...
2025-11-10 07:31:03 - utils - INFO - Processing chunk 4 (1000000 rows)...
2025-11-10 07:31:16 - utils - INFO - Processing chunk 5 (1000000 rows)...
2025-11-10 07:31:29 - utils - INFO - Processing chunk 6 (1000000 rows)...
2025-11-10 07:31:42 - utils - INFO - Processing chunk 7 (1000000 rows)...
2025-11-10 07:31:55 - utils - INFO - Processing chunk 8 (1000000 rows)...
2025-11-10 07:32:09 - utils - INFO - Processing chunk 9 (1000000 rows)...
2025-11-10 07:32:22 - utils - INFO - Processing chunk 10 (1000000 rows)...
2025-11-10 07:32:35 - utils - INFO - Processing chunk 11 (978173 rows)...
2025-11-10 07:32:47 - utils - INFO - All chunks processed. Total rows: 10978173
2025-11-10 07:32:47 - utils - INFO - Total insider records labeled: 0
2025-11-10 07:32:47 - utils - INFO - Replacing original file with labeled version...
2025-11-10 07:32:47 - utils - INFO - Successfully created: /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs_ALL.csv
2025-11-10 07:32:47 - utils - INFO - ================================================================================
2025-11-10 07:32:47 - utils - INFO - V2 Labeling Complete!
2025-11-10 07:32:47 - utils - INFO - The file 'processed_unified_logs_ALL.csv' is now labeled.
2025-11-10 07:32:47 - utils - INFO - Next step: Run 'feature_engineering_v2.py'
2025-11-10 07:32:47 - utils - INFO - ================================================================================
2025-11-10 07:44:51 - utils - INFO - Utility functions loaded successfully
2025-11-10 07:44:51 - utils - INFO - Feature Engineer V2 initialized.
2025-11-10 07:44:51 - utils - INFO - 
================================================================================
                  FEATURE ENGINEERING PIPELINE V2 (MULTI-PASS)                  
================================================================================

2025-11-10 07:44:51 - utils - INFO - Found /Users/bipinrimal/Downloads/Thesis_work/data/processed/daily_features_unscaled_v2.csv, skipping Pass 1.
2025-11-10 07:44:51 - utils - INFO - 
================================================================================
                     PASS 2: FEATURE ENRICHMENT (Z-SCORES)                      
================================================================================

2025-11-10 07:44:51 - utils - ERROR - Failed to load LDAP data for role enrichment: No LDAP CSVs found in /Users/bipinrimal/Downloads/Thesis_work/data/all_data/LDAP
2025-11-10 07:44:51 - utils - WARNING - Could not load LDAP data. Peer-relative features will be skipped.
2025-11-10 07:44:51 - utils - INFO - Calculating self-relative Z-Scores (rolling 30-day)...
2025-11-10 07:44:53 - utils - INFO - Calculating peer-relative Z-Scores (by role)...
2025-11-10 07:44:53 - utils - INFO - PASS 2 complete. Enriched features created.
2025-11-10 07:44:53 - utils - INFO - Scaling and saving final daily features (for LSTM)...
2025-11-10 07:44:54 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/daily_feature_scaler_v2.pkl
2025-11-10 07:45:04 - utils - INFO - Saved /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_daily_features_v2.csv
2025-11-10 07:45:04 - utils - INFO - 
================================================================================
                        PASS 3: STATIC FEATURE CREATION                         
================================================================================

2025-11-10 07:45:05 - utils - INFO - Created static features for 3000 users
2025-11-10 07:45:05 - utils - INFO - Scaling and saving static features...
2025-11-10 07:45:05 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/static_feature_scaler_v2.pkl
2025-11-10 07:45:05 - utils - INFO - PASS 3 complete. Saved /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_static_features_v2.csv
2025-11-10 07:45:05 - utils - INFO - 
================================================================================
                           PASS 4: SEQUENCE CREATION                            
================================================================================

2025-11-10 07:45:05 - utils - INFO - Creating sequences (length=15, stride=10)...
2025-11-10 07:45:56 - utils - INFO - Created 97962 sequences from 3000 users
2025-11-10 07:45:56 - utils - INFO - PASS 4 complete. Saved sequence files to /Users/bipinrimal/Downloads/Thesis_work/data/processed
2025-11-10 07:45:56 - utils - INFO - ================================================================================
2025-11-10 07:45:56 - utils - INFO - V2 Feature Engineering Complete!
2025-11-10 07:45:56 - utils - INFO -   Static features created: /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_static_features_v2.csv
2025-11-10 07:45:56 - utils - INFO -   Sequence files created: /Users/bipinrimal/Downloads/Thesis_work/data/processed
2025-11-10 07:45:56 - utils - INFO - Next step: Train V2 models.
2025-11-10 07:45:56 - utils - INFO - ================================================================================
2025-11-10 07:46:54 - utils - INFO - Utility functions loaded successfully
2025-11-10 07:46:54 - utils - INFO - 
================================================================================
                 ISOLATION FOREST TRAINING (V2: MULTI-DATASET)                  
================================================================================

2025-11-10 07:46:54 - utils - INFO - Model loaded from /Users/bipinrimal/Downloads/Thesis_work/models/static_feature_scaler_v2.pkl
2025-11-10 07:46:54 - utils - INFO - Data split: 3000 total samples, 0 insiders
2025-11-10 07:46:54 - utils - INFO - Training on: 2400 normal samples
2025-11-10 07:46:54 - utils - INFO - Calibrating on: 600 normal samples
2025-11-10 07:46:54 - utils - INFO - Testing on: 3000 total samples (including 0 insiders)
2025-11-10 07:46:54 - utils - INFO - Initialized Isolation Forest (V2) with params: {'n_estimators': 50, 'max_samples': 256, 'contamination': 'auto', 'max_features': 1.0, 'bootstrap': False, 'n_jobs': -1, 'random_state': 42, 'verbose': 0}
2025-11-10 07:46:54 - utils - INFO - Training Isolation Forest on 2400 normal samples...
2025-11-10 07:46:54 - utils - INFO - Isolation Forest training completed
2025-11-10 07:46:54 - utils - INFO - Calibrating threshold for target FPR=0.05...
2025-11-10 07:46:54 - utils - INFO - Calibrated threshold: 0.5793
2025-11-10 07:46:54 - utils - INFO - Evaluating Isolation Forest (V2)...
2025-11-10 07:46:54 - utils - WARNING - No positive samples in test set. Metrics (Precision, Recall, F1, AUC-ROC) will be 0 or NaN.
2025-11-10 07:46:54 - utils - INFO - 
============================================================
2025-11-10 07:46:54 - utils - INFO - Isolation Forest (V2) Performance Metrics
2025-11-10 07:46:54 - utils - INFO - ============================================================
2025-11-10 07:46:54 - utils - INFO - Accuracy:  0.9547
2025-11-10 07:46:54 - utils - INFO - Precision: 0.0000
2025-11-10 07:46:54 - utils - INFO - Recall:    0.0000
2025-11-10 07:46:54 - utils - INFO - F1-Score:  0.0000
2025-11-10 07:46:54 - utils - INFO - AUC-ROC:   nan
2025-11-10 07:46:54 - utils - INFO - ============================================================

2025-11-10 07:46:54 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest_v2.pkl
2025-11-10 07:46:54 - utils - INFO - Saving Isolation Forest model to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest_v2.pkl
2025-11-10 07:46:54 - utils - INFO - Isolation Forest (V2) training and evaluation completed!
2025-11-11 11:27:20 - utils - INFO - Utility functions loaded successfully
2025-11-11 11:27:20 - utils - INFO - 
================================================================================
                 ISOLATION FOREST TRAINING (V2: MULTI-DATASET)                  
================================================================================

2025-11-11 11:27:20 - utils - INFO - Model loaded from /Users/bipinrimal/Downloads/Thesis_work/models/static_feature_scaler_v2.pkl
2025-11-11 11:27:20 - utils - INFO - Data split: 3000 total samples, 0 insiders
2025-11-11 11:27:20 - utils - INFO - Training on: 2400 normal samples
2025-11-11 11:27:20 - utils - INFO - Calibrating on: 600 normal samples
2025-11-11 11:27:20 - utils - INFO - Testing on: 3000 total samples (including 0 insiders)
2025-11-11 11:27:20 - utils - INFO - Initialized Isolation Forest (V2) with params: {'n_estimators': 50, 'max_samples': 256, 'contamination': 'auto', 'max_features': 1.0, 'bootstrap': False, 'n_jobs': -1, 'random_state': 42, 'verbose': 0}
2025-11-11 11:27:20 - utils - INFO - Training Isolation Forest on 2400 normal samples...
2025-11-11 11:27:20 - utils - INFO - Isolation Forest training completed
2025-11-11 11:27:20 - utils - INFO - Calibrating threshold for target FPR=0.05...
2025-11-11 11:27:20 - utils - INFO - Calibrated threshold: 0.5793
2025-11-11 11:27:20 - utils - INFO - Evaluating Isolation Forest (V2)...
2025-11-11 11:27:20 - utils - WARNING - No positive samples in test set. Metrics (Precision, Recall, F1, AUC-ROC) will be 0 or NaN.
2025-11-11 11:27:20 - utils - INFO - 
============================================================
2025-11-11 11:27:20 - utils - INFO - Isolation Forest (V2) Performance Metrics
2025-11-11 11:27:20 - utils - INFO - ============================================================
2025-11-11 11:27:20 - utils - INFO - Accuracy:  0.9547
2025-11-11 11:27:20 - utils - INFO - Precision: 0.0000
2025-11-11 11:27:20 - utils - INFO - Recall:    0.0000
2025-11-11 11:27:20 - utils - INFO - F1-Score:  0.0000
2025-11-11 11:27:20 - utils - INFO - AUC-ROC:   nan
2025-11-11 11:27:20 - utils - INFO - ============================================================

2025-11-11 11:27:20 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest_v2.pkl
2025-11-11 11:27:20 - utils - INFO - Saving Isolation Forest model to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest_v2.pkl
2025-11-11 11:27:20 - utils - INFO - Isolation Forest (V2) training and evaluation completed!
2025-11-11 11:29:09 - utils - INFO - Utility functions loaded successfully
2025-11-11 11:29:13 - utils - INFO - 
================================================================================
            LIGHTWEIGHT DEEP CLUSTERING TRAINING (V2: MULTI-DATASET)            
================================================================================

2025-11-11 11:29:13 - utils - INFO - Model loaded from /Users/bipinrimal/Downloads/Thesis_work/models/static_feature_scaler_v2.pkl
2025-11-11 11:29:13 - utils - INFO - Dataset: 3000 samples, 0 insiders
2025-11-11 11:29:13 - utils - INFO - Training on: 2400 normal samples
2025-11-11 11:29:13 - utils - INFO - Calibrating on: 600 normal samples
2025-11-11 11:29:13 - utils - INFO - Testing on: 3000 total samples (including 0 insiders)
2025-11-11 11:29:13 - utils - INFO - Initialized Lightweight Deep Clustering (V2) (n_clusters=5, encoding_dim=32)
2025-11-11 11:29:13 - utils - INFO - Training lightweight deep clustering model (V2)...
2025-11-11 11:29:13 - utils - INFO - Pre-training autoencoder...
2025-11-11 11:29:14 - utils - INFO - Autoencoder pre-training completed
2025-11-11 11:29:14 - utils - INFO - Fitting MiniBatch K-Means clustering...
2025-11-11 11:29:14 - utils - INFO - Deep clustering training completed
2025-11-11 11:29:14 - utils - INFO - Training completed in 1.49 seconds
2025-11-11 11:29:14 - utils - INFO - Calibrating threshold for target FPR=0.05...
2025-11-11 11:29:14 - utils - INFO - Calibrated threshold: 1.7272
2025-11-11 11:29:14 - utils - INFO - Evaluating lightweight deep clustering model (V2)...
2025-11-11 11:29:14 - utils - WARNING - No positive samples in test set. Metrics will be 0 or NaN.
2025-11-11 11:29:14 - utils - INFO - 
============================================================
2025-11-11 11:29:14 - utils - INFO - Deep Clustering (V2) Performance Metrics
2025-11-11 11:29:14 - utils - INFO - ============================================================
2025-11-11 11:29:14 - utils - INFO - Accuracy:  0.9390
2025-11-11 11:29:14 - utils - INFO - Precision: 0.0000
2025-11-11 11:29:14 - utils - INFO - Recall:    0.0000
2025-11-11 11:29:14 - utils - INFO - F1-Score:  0.0000
2025-11-11 11:29:14 - utils - INFO - AUC-ROC:   nan
2025-11-11 11:29:14 - utils - INFO - ============================================================

2025-11-11 11:29:14 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/deep_clustering_v2.pkl
2025-11-11 11:29:14 - utils - INFO - Encoder model saved to /Users/bipinrimal/Downloads/Thesis_work/models/deep_clustering_v2_encoder.keras
2025-11-11 11:29:14 - utils - INFO - Deep Clustering (V2) training and evaluation completed!
2025-11-11 11:30:00 - utils - INFO - Utility functions loaded successfully
2025-11-11 11:30:02 - utils - INFO - 
================================================================================
           LIGHTWEIGHT LSTM AUTOENCODER TRAINING (V2: MULTI-DATASET)            
================================================================================

2025-11-11 11:30:02 - utils - INFO - Loaded sequences: (97962, 15, 33), with 0 insider sequences
2025-11-11 11:30:02 - utils - INFO - Training on: 78369 normal sequences
2025-11-11 11:30:02 - utils - INFO - Calibrating on: 19593 normal sequences
2025-11-11 11:30:02 - utils - INFO - Testing on: 97962 total sequences (including 0 insider sequences)
2025-11-11 11:30:02 - utils - INFO - Initialized LSTM Autoencoder (V2) (15, 33)
2025-11-11 11:30:02 - utils - INFO - Training lightweight LSTM Autoencoder (V2)...
2025-11-11 11:30:02 - utils - INFO - Building lightweight LSTM Autoencoder...
2025-11-11 11:30:02 - utils - INFO - Model built with 21,329 parameters
2025-11-11 11:30:02 - utils - INFO - Training on 78369 sequences...
2025-11-11 11:31:35 - utils - INFO - Training completed
2025-11-11 11:31:35 - utils - INFO - Training completed in 93.14 seconds
2025-11-11 11:31:35 - utils - INFO - Calibrating threshold for target FPR=0.05
2025-11-11 11:31:36 - utils - INFO - Calibrated threshold: 0.2633
2025-11-11 11:31:36 - utils - INFO - Evaluating lightweight LSTM Autoencoder (V2)...
2025-11-11 11:31:37 - utils - WARNING - No positive samples in test set. Metrics (Precision, Recall, F1, AUC-ROC) will be 0 or NaN.
2025-11-11 11:31:39 - utils - INFO - 
============================================================
2025-11-11 11:31:39 - utils - INFO - LSTM Autoencoder (V2) Performance Metrics
2025-11-11 11:31:39 - utils - INFO - ============================================================
2025-11-11 11:31:39 - utils - INFO - Accuracy:  0.9533
2025-11-11 11:31:39 - utils - INFO - Precision: 0.0000
2025-11-11 11:31:39 - utils - INFO - Recall:    0.0000
2025-11-11 11:31:39 - utils - INFO - F1-Score:  0.0000
2025-11-11 11:31:39 - utils - INFO - AUC-ROC:   nan
2025-11-11 11:31:39 - utils - INFO - ============================================================

2025-11-11 11:31:39 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/lstm_autoencoder_v2.keras
2025-11-11 11:31:40 - utils - INFO - Lightweight LSTM Autoencoder (V2) completed!
2025-11-11 11:32:20 - utils - INFO - Utility functions loaded successfully
2025-11-11 11:32:20 - utils - INFO - 
================================================================================
                      COMPREHENSIVE MODEL EVALUATION (V2)                       
================================================================================

2025-11-11 11:32:20 - utils - INFO - Loading V2 results for all models...
2025-11-11 11:32:20 - utils - INFO - Loaded results for isolation_forest
2025-11-11 11:32:20 - utils - INFO - Loaded results for deep_clustering
2025-11-11 11:32:20 - utils - INFO - Loaded results for lstm_autoencoder
2025-11-11 11:32:20 - utils - INFO - Loaded results for 3 models
2025-11-11 11:32:20 - utils - INFO - Creating metrics comparison table...
2025-11-11 11:32:20 - utils - INFO - Metrics comparison table created
2025-11-11 11:32:20 - utils - INFO - Creating confusion matrix plots...
2025-11-11 11:32:20 - utils - INFO - Confusion matrices saved to /Users/bipinrimal/Downloads/Thesis_work/results/confusion_matrices/all_models_v2.png
2025-11-11 11:32:20 - utils - INFO - Creating ROC curves...
2025-11-11 11:32:20 - utils - INFO - ROC curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/roc_curves/roc_comparison_v2.png
2025-11-11 11:32:20 - utils - INFO - Creating Precision-Recall curves...
2025-11-11 11:32:20 - utils - INFO - Precision-Recall curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/precision_recall_comparison_v2.png
2025-11-11 11:32:20 - utils - INFO - Generating evaluation report...
2025-11-11 11:32:20 - utils - ERROR - Evaluation failed: name 'target_fpr' is not defined
2025-11-11 11:36:32 - utils - INFO - Utility functions loaded successfully
2025-11-11 11:36:32 - utils - INFO - 
================================================================================
                            LABELING INSIDER THREATS                            
================================================================================

2025-11-11 11:36:32 - utils - INFO - Loading CMU-CERT answers file...
2025-11-11 11:36:32 - utils - INFO - Loaded 191 insider incidents
2025-11-11 11:36:33 - utils - WARNING - Could not parse dates for CDE1846: month must be in 1..12: /21/2011 11:43:39, at position 0
2025-11-11 11:36:33 - utils - INFO - Parsed 190 insider activity periods
2025-11-11 11:36:33 - utils - ERROR - Error: Processed data not found: /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv
2025-11-11 11:37:14 - utils - INFO - Utility functions loaded successfully
2025-11-11 11:37:14 - utils - INFO - 
================================================================================
                            LABELING INSIDER THREATS                            
================================================================================

2025-11-11 11:37:14 - utils - INFO - Loading CMU-CERT answers file...
2025-11-11 11:37:14 - utils - INFO - Loaded 191 insider incidents
2025-11-11 11:37:14 - utils - INFO - Identified 191 unique insider users:
2025-11-11 11:37:14 - utils - INFO -   - AAF0535 (Pseudo: USER_d68ed5d8d06f)
2025-11-11 11:37:14 - utils - INFO -   - AAM0658 (Pseudo: USER_3452dd2784d8)
2025-11-11 11:37:14 - utils - INFO -   - ABB0427 (Pseudo: USER_87c7b648ee57)
2025-11-11 11:37:14 - utils - INFO -   - ABC0174 (Pseudo: USER_dec39bfad54d)
2025-11-11 11:37:14 - utils - INFO -   - ACA1126 (Pseudo: USER_7e4cfa7a3f78)
2025-11-11 11:37:14 - utils - INFO -   - ACM1770 (Pseudo: USER_7c7de75543e3)
2025-11-11 11:37:14 - utils - INFO -   - ACM2278 (Pseudo: USER_0de47f8372c9)
2025-11-11 11:37:14 - utils - INFO -   - ADC1257 (Pseudo: USER_aff6ab10c739)
2025-11-11 11:37:14 - utils - INFO -   - AJR0932 (Pseudo: USER_a5001810136a)
2025-11-11 11:37:14 - utils - INFO -   - AKR0057 (Pseudo: USER_0bf5cbd461eb)
2025-11-11 11:37:14 - utils - INFO -   - ALT1465 (Pseudo: USER_7fd95fed4862)
2025-11-11 11:37:14 - utils - INFO -   - ALW0764 (Pseudo: USER_6338fba96505)
2025-11-11 11:37:14 - utils - INFO -   - AMC1883 (Pseudo: USER_51c7eaea68e5)
2025-11-11 11:37:14 - utils - INFO -   - ASH0298 (Pseudo: USER_246ab13cd334)
2025-11-11 11:37:14 - utils - INFO -   - ASH0458 (Pseudo: USER_9c494db5146a)
2025-11-11 11:37:14 - utils - INFO -   - AYG1697 (Pseudo: USER_f53c5bccc0d3)
2025-11-11 11:37:14 - utils - INFO -   - BBS0039 (Pseudo: USER_f3689477710c)
2025-11-11 11:37:14 - utils - INFO -   - BDP0096 (Pseudo: USER_2bf9c4541101)
2025-11-11 11:37:14 - utils - INFO -   - BDV0168 (Pseudo: USER_f3b873334173)
2025-11-11 11:37:14 - utils - INFO -   - BGC0686 (Pseudo: USER_531fcb99fb66)
2025-11-11 11:37:14 - utils - INFO -   - BIH0745 (Pseudo: USER_f101e79fefcc)
2025-11-11 11:37:14 - utils - INFO -   - BLS0678 (Pseudo: USER_f1c60022c31b)
2025-11-11 11:37:14 - utils - INFO -   - BSS0369 (Pseudo: USER_3f50fbef2a4f)
2025-11-11 11:37:14 - utils - INFO -   - BTL0226 (Pseudo: USER_be12f2a7d4e1)
2025-11-11 11:37:14 - utils - INFO -   - BYO1846 (Pseudo: USER_3d8f25beb887)
2025-11-11 11:37:14 - utils - INFO -   - CAH0936 (Pseudo: USER_903e2d145a06)
2025-11-11 11:37:14 - utils - INFO -   - CBW1826 (Pseudo: USER_b8895bc88ef5)
2025-11-11 11:37:14 - utils - INFO -   - CCA0046 (Pseudo: USER_2bb474e372ad)
2025-11-11 11:37:14 - utils - INFO -   - CCH0959 (Pseudo: USER_4df09a60d356)
2025-11-11 11:37:14 - utils - INFO -   - CCL0068 (Pseudo: USER_61ef344f409a)
2025-11-11 11:37:14 - utils - INFO -   - CDE1846 (Pseudo: USER_984fac414302)
2025-11-11 11:37:14 - utils - INFO -   - CEJ0109 (Pseudo: USER_5d99c811896b)
2025-11-11 11:37:14 - utils - INFO -   - CGF1056 (Pseudo: USER_6f76bd7d2e18)
2025-11-11 11:37:14 - utils - INFO -   - CHP1711 (Pseudo: USER_9067fee1b6b3)
2025-11-11 11:37:14 - utils - INFO -   - CIF1430 (Pseudo: USER_8baf6af35964)
2025-11-11 11:37:14 - utils - INFO -   - CKP0630 (Pseudo: USER_67a6cdd450e1)
2025-11-11 11:37:14 - utils - INFO -   - CMP2946 (Pseudo: USER_333b2199aa14)
2025-11-11 11:37:14 - utils - INFO -   - CPD1525 (Pseudo: USER_5ad7aab43643)
2025-11-11 11:37:14 - utils - INFO -   - CQW0652 (Pseudo: USER_9b09a8eab070)
2025-11-11 11:37:14 - utils - INFO -   - CRD0272 (Pseudo: USER_3f617645b018)
2025-11-11 11:37:14 - utils - INFO -   - CSC0217 (Pseudo: USER_34357cb53591)
2025-11-11 11:37:14 - utils - INFO -   - CSF0929 (Pseudo: USER_144ba1f00146)
2025-11-11 11:37:14 - utils - INFO -   - CSF2712 (Pseudo: USER_37876dca0487)
2025-11-11 11:37:14 - utils - INFO -   - CWW1120 (Pseudo: USER_a609bbec5773)
2025-11-11 11:37:14 - utils - INFO -   - DAS1320 (Pseudo: USER_a253dfdc5e92)
2025-11-11 11:37:14 - utils - INFO -   - DCC1119 (Pseudo: USER_894a66c49c5d)
2025-11-11 11:37:14 - utils - INFO -   - DCH0843 (Pseudo: USER_f791a9b0d81a)
2025-11-11 11:37:14 - utils - INFO -   - DIB0285 (Pseudo: USER_ab70a3fdac9c)
2025-11-11 11:37:14 - utils - INFO -   - DIM0330 (Pseudo: USER_f753f908fb72)
2025-11-11 11:37:14 - utils - INFO -   - DKG0161 (Pseudo: USER_c226c8998c56)
2025-11-11 11:37:14 - utils - INFO -   - DNJ0740 (Pseudo: USER_9dc2c93c685c)
2025-11-11 11:37:14 - utils - INFO -   - DQM0809 (Pseudo: USER_dc6a4ff8a282)
2025-11-11 11:37:14 - utils - INFO -   - DRR0162 (Pseudo: USER_98e7e4e36c45)
2025-11-11 11:37:14 - utils - INFO -   - EDB0714 (Pseudo: USER_fc6c68340cb6)
2025-11-11 11:37:14 - utils - INFO -   - EGD0132 (Pseudo: USER_6f4a3905cd9d)
2025-11-11 11:37:14 - utils - INFO -   - EHB0824 (Pseudo: USER_602b85d0ab3a)
2025-11-11 11:37:14 - utils - INFO -   - EHD0584 (Pseudo: USER_d9191c73e013)
2025-11-11 11:37:14 - utils - INFO -   - ELM1123 (Pseudo: USER_2ee2a2bc17b4)
2025-11-11 11:37:14 - utils - INFO -   - ELT1370 (Pseudo: USER_08c292ff9c22)
2025-11-11 11:37:14 - utils - INFO -   - EPG1196 (Pseudo: USER_4f7ae7479ecc)
2025-11-11 11:37:14 - utils - INFO -   - ETW0002 (Pseudo: USER_e176878ab078)
2025-11-11 11:37:14 - utils - INFO -   - FMG0527 (Pseudo: USER_15b4b7d3bb19)
2025-11-11 11:37:14 - utils - INFO -   - FSC0601 (Pseudo: USER_58e7f72204e2)
2025-11-11 11:37:14 - utils - INFO -   - FTM0406 (Pseudo: USER_75be94c7dd0a)
2025-11-11 11:37:14 - utils - INFO -   - FZG0389 (Pseudo: USER_23f374caeb48)
2025-11-11 11:37:14 - utils - INFO -   - GCD0194 (Pseudo: USER_4000e5ca90fa)
2025-11-11 11:37:14 - utils - INFO -   - GFM1815 (Pseudo: USER_f2a6426a4f70)
2025-11-11 11:37:14 - utils - INFO -   - GHL0460 (Pseudo: USER_16306521dd8c)
2025-11-11 11:37:14 - utils - INFO -   - GKW0043 (Pseudo: USER_075eda6a2381)
2025-11-11 11:37:14 - utils - INFO -   - GMB0400 (Pseudo: USER_4e8498d28459)
2025-11-11 11:37:14 - utils - INFO -   - GTD0219 (Pseudo: USER_32454fe2a301)
2025-11-11 11:37:14 - utils - INFO -   - GWG0497 (Pseudo: USER_8409053903a3)
2025-11-11 11:37:14 - utils - INFO -   - HBO0413 (Pseudo: USER_15e5226c1126)
2025-11-11 11:37:14 - utils - INFO -   - HBP1076 (Pseudo: USER_fa8ecc86e6f3)
2025-11-11 11:37:14 - utils - INFO -   - HFC0492 (Pseudo: USER_f2d2d944eb28)
2025-11-11 11:37:14 - utils - INFO -   - HIS1394 (Pseudo: USER_40f8c65c73ed)
2025-11-11 11:37:14 - utils - INFO -   - HJB0462 (Pseudo: USER_24d0f851769d)
2025-11-11 11:37:14 - utils - INFO -   - HJB0742 (Pseudo: USER_8ca08c0c8912)
2025-11-11 11:37:14 - utils - INFO -   - HMS1658 (Pseudo: USER_e718e3765dc9)
2025-11-11 11:37:14 - utils - INFO -   - HSN0675 (Pseudo: USER_14667206a03f)
2025-11-11 11:37:14 - utils - INFO -   - HXL0968 (Pseudo: USER_fcd14f078c21)
2025-11-11 11:37:14 - utils - INFO -   - HXP0976 (Pseudo: USER_4bd14bd06bd3)
2025-11-11 11:37:14 - utils - INFO -   - ICB1354 (Pseudo: USER_433764620d92)
2025-11-11 11:37:14 - utils - INFO -   - IHC0561 (Pseudo: USER_4dc064a9ec54)
2025-11-11 11:37:14 - utils - INFO -   - IJM0776 (Pseudo: USER_2c2eb603601f)
2025-11-11 11:37:14 - utils - INFO -   - IKR0401 (Pseudo: USER_414f1b5aa942)
2025-11-11 11:37:14 - utils - INFO -   - IRH1224 (Pseudo: USER_a4ecf2c4171d)
2025-11-11 11:37:14 - utils - INFO -   - ISW0738 (Pseudo: USER_680bd0d52669)
2025-11-11 11:37:14 - utils - INFO -   - ITA0159 (Pseudo: USER_e4beb49e24fc)
2025-11-11 11:37:14 - utils - INFO -   - IUB0565 (Pseudo: USER_24b9307b2680)
2025-11-11 11:37:14 - utils - INFO -   - JAK0783 (Pseudo: USER_ae9907309078)
2025-11-11 11:37:14 - utils - INFO -   - JAL0811 (Pseudo: USER_0470760f2c46)
2025-11-11 11:37:14 - utils - INFO -   - JCC0016 (Pseudo: USER_fb9edf4abf1b)
2025-11-11 11:37:14 - utils - INFO -   - JCE0258 (Pseudo: USER_28ddb9dfe958)
2025-11-11 11:37:14 - utils - INFO -   - JGT0221 (Pseudo: USER_ac50e18d730e)
2025-11-11 11:37:14 - utils - INFO -   - JIG1593 (Pseudo: USER_82408bf74aa9)
2025-11-11 11:37:14 - utils - INFO -   - JJM0203 (Pseudo: USER_5d8a2fa697e0)
2025-11-11 11:37:14 - utils - INFO -   - JKB0287 (Pseudo: USER_eef1eb93b3eb)
2025-11-11 11:37:14 - utils - INFO -   - JLM0364 (Pseudo: USER_2368f4420227)
2025-11-11 11:37:14 - utils - INFO -   - JMB0308 (Pseudo: USER_f214015611ba)
2025-11-11 11:37:14 - utils - INFO -   - JMM0613 (Pseudo: USER_1ab8964acbfc)
2025-11-11 11:37:14 - utils - INFO -   - JNR1592 (Pseudo: USER_4db8abb98f78)
2025-11-11 11:37:14 - utils - INFO -   - JPH1910 (Pseudo: USER_e77a7d623dff)
2025-11-11 11:37:14 - utils - INFO -   - JRG0207 (Pseudo: USER_fd6cde269736)
2025-11-11 11:37:14 - utils - INFO -   - JTC1885 (Pseudo: USER_497b547b01a3)
2025-11-11 11:37:14 - utils - INFO -   - JTM0223 (Pseudo: USER_1df3b1c88c0b)
2025-11-11 11:37:14 - utils - INFO -   - JUP1472 (Pseudo: USER_605cf3ade550)
2025-11-11 11:37:14 - utils - INFO -   - KBC1390 (Pseudo: USER_f5aff838d36c)
2025-11-11 11:37:14 - utils - INFO -   - KCM0466 (Pseudo: USER_ab21b6a5e166)
2025-11-11 11:37:14 - utils - INFO -   - KDC0996 (Pseudo: USER_dd9002d4f63a)
2025-11-11 11:37:14 - utils - INFO -   - KEW0198 (Pseudo: USER_798694e47553)
2025-11-11 11:37:14 - utils - INFO -   - KLH0596 (Pseudo: USER_4c86450d2122)
2025-11-11 11:37:14 - utils - INFO -   - KPC0073 (Pseudo: USER_345332180197)
2025-11-11 11:37:14 - utils - INFO -   - KRL0501 (Pseudo: USER_2c10bcfa8b26)
2025-11-11 11:37:14 - utils - INFO -   - KSS1005 (Pseudo: USER_b47cf0fb4858)
2025-11-11 11:37:14 - utils - INFO -   - KTW0365 (Pseudo: USER_b3f4791ddc1d)
2025-11-11 11:37:14 - utils - INFO -   - LAH0463 (Pseudo: USER_062ebba8d8ba)
2025-11-11 11:37:14 - utils - INFO -   - LBE0376 (Pseudo: USER_977bf386df36)
2025-11-11 11:37:14 - utils - INFO -   - LCC0819 (Pseudo: USER_52c145f25202)
2025-11-11 11:37:14 - utils - INFO -   - LJO1360 (Pseudo: USER_4193a35779bd)
2025-11-11 11:37:14 - utils - INFO -   - LJR0523 (Pseudo: USER_997ebbd25d5b)
2025-11-11 11:37:14 - utils - INFO -   - LQC0479 (Pseudo: USER_bbe8923bf047)
2025-11-11 11:37:14 - utils - INFO -   - LVF1626 (Pseudo: USER_d351a3bd8f56)
2025-11-11 11:37:14 - utils - INFO -   - MAR0955 (Pseudo: USER_ac797e5091c7)
2025-11-11 11:37:14 - utils - INFO -   - MAS0025 (Pseudo: USER_f3372d642c05)
2025-11-11 11:37:14 - utils - INFO -   - MBG3183 (Pseudo: USER_6ee68c8e365a)
2025-11-11 11:37:14 - utils - INFO -   - MCF0600 (Pseudo: USER_bd69ae8957a9)
2025-11-11 11:37:14 - utils - INFO -   - MCP0611 (Pseudo: USER_ca0607844948)
2025-11-11 11:37:14 - utils - INFO -   - MDH0580 (Pseudo: USER_1c9a1a2a1897)
2025-11-11 11:37:14 - utils - INFO -   - MDS0680 (Pseudo: USER_95f523cab2c4)
2025-11-11 11:37:14 - utils - INFO -   - MGB1235 (Pseudo: USER_45338152a475)
2025-11-11 11:37:14 - utils - INFO -   - MIB0203 (Pseudo: USER_fc09f285e46e)
2025-11-11 11:37:14 - utils - INFO -   - MJR0711 (Pseudo: USER_52b50e4b7545)
2025-11-11 11:37:14 - utils - INFO -   - MOS0047 (Pseudo: USER_607b30a005b2)
2025-11-11 11:37:14 - utils - INFO -   - MPF0690 (Pseudo: USER_087b5982555e)
2025-11-11 11:37:14 - utils - INFO -   - MPM0220 (Pseudo: USER_58ceb5310b6e)
2025-11-11 11:37:14 - utils - INFO -   - MSO0222 (Pseudo: USER_3e0339ae05dd)
2025-11-11 11:37:14 - utils - INFO -   - MTP1582 (Pseudo: USER_c529c6a8251e)
2025-11-11 11:37:14 - utils - INFO -   - MYD0978 (Pseudo: USER_1941386818da)
2025-11-11 11:37:14 - utils - INFO -   - NAH1366 (Pseudo: USER_924e28545438)
2025-11-11 11:37:14 - utils - INFO -   - NIV1608 (Pseudo: USER_2ac6b1e3a2c0)
2025-11-11 11:37:14 - utils - INFO -   - NKM1738 (Pseudo: USER_308b62a5f3a2)
2025-11-11 11:37:14 - utils - INFO -   - NKN1405 (Pseudo: USER_4132e559bb9e)
2025-11-11 11:37:14 - utils - INFO -   - NWT0098 (Pseudo: USER_0f0040009beb)
2025-11-11 11:37:14 - utils - INFO -   - NZL1395 (Pseudo: USER_2c4540e3e2e8)
2025-11-11 11:37:14 - utils - INFO -   - OFS0030 (Pseudo: USER_cab2fbfab30c)
2025-11-11 11:37:14 - utils - INFO -   - OHS0036 (Pseudo: USER_bcd27dead44c)
2025-11-11 11:37:14 - utils - INFO -   - OKM1092 (Pseudo: USER_53bdc14797b3)
2025-11-11 11:37:14 - utils - INFO -   - ONS0995 (Pseudo: USER_66812153cf8e)
2025-11-11 11:37:14 - utils - INFO -   - OSS1463 (Pseudo: USER_f033d09033d2)
2025-11-11 11:37:14 - utils - INFO -   - PBC0077 (Pseudo: USER_89408a528966)
2025-11-11 11:37:14 - utils - INFO -   - PLJ1771 (Pseudo: USER_9d011e499a11)
2025-11-11 11:37:14 - utils - INFO -   - PNL0301 (Pseudo: USER_5443c24bcb58)
2025-11-11 11:37:14 - utils - INFO -   - PPF0435 (Pseudo: USER_9b40e13bcab6)
2025-11-11 11:37:14 - utils - INFO -   - PSF0133 (Pseudo: USER_1d3f59a8fb0b)
2025-11-11 11:37:14 - utils - INFO -   - PTH0005 (Pseudo: USER_2300c156d1ad)
2025-11-11 11:37:14 - utils - INFO -   - RAB0589 (Pseudo: USER_ea06a1743d82)
2025-11-11 11:37:14 - utils - INFO -   - RAR0725 (Pseudo: USER_859054204bdf)
2025-11-11 11:37:14 - utils - INFO -   - RCG0584 (Pseudo: USER_c70856202d1e)
2025-11-11 11:37:14 - utils - INFO -   - RCW0822 (Pseudo: USER_4e7a0b9a4f3a)
2025-11-11 11:37:14 - utils - INFO -   - REF1924 (Pseudo: USER_647a6301388b)
2025-11-11 11:37:14 - utils - INFO -   - RGG0064 (Pseudo: USER_378ff6e056d2)
2025-11-11 11:37:14 - utils - INFO -   - RHL0992 (Pseudo: USER_2aa256fe1959)
2025-11-11 11:37:14 - utils - INFO -   - RKD0604 (Pseudo: USER_636f04ae08bd)
2025-11-11 11:37:14 - utils - INFO -   - RMW0542 (Pseudo: USER_e396339e7415)
2025-11-11 11:37:14 - utils - INFO -   - RRS0056 (Pseudo: USER_e6b4dedfef6d)
2025-11-11 11:37:14 - utils - INFO -   - SAF1942 (Pseudo: USER_4b2cc9b31992)
2025-11-11 11:37:14 - utils - INFO -   - SIS0042 (Pseudo: USER_ff29a804298f)
2025-11-11 11:37:14 - utils - INFO -   - SLL0193 (Pseudo: USER_7416f04dbd88)
2025-11-11 11:37:14 - utils - INFO -   - SNK1280 (Pseudo: USER_b7671607fd72)
2025-11-11 11:37:14 - utils - INFO -   - TAP0551 (Pseudo: USER_40bea5501bca)
2025-11-11 11:37:14 - utils - INFO -   - TMC0934 (Pseudo: USER_f6bc902f2789)
2025-11-11 11:37:14 - utils - INFO -   - TMT0851 (Pseudo: USER_97a16c06b846)
2025-11-11 11:37:14 - utils - INFO -   - TNB1616 (Pseudo: USER_940da3ecdc09)
2025-11-11 11:37:14 - utils - INFO -   - TNM0961 (Pseudo: USER_818d3cea925a)
2025-11-11 11:37:14 - utils - INFO -   - TRC1838 (Pseudo: USER_ff3df001fc2a)
2025-11-11 11:37:14 - utils - INFO -   - VAH1292 (Pseudo: USER_e4b619ac8833)
2025-11-11 11:37:14 - utils - INFO -   - VCF1602 (Pseudo: USER_027739208e28)
2025-11-11 11:37:14 - utils - INFO -   - VRP0267 (Pseudo: USER_0256aeae191d)
2025-11-11 11:37:14 - utils - INFO -   - VSS0154 (Pseudo: USER_50ab91262f20)
2025-11-11 11:37:14 - utils - INFO -   - WCW1013 (Pseudo: USER_e0ef278a74bd)
2025-11-11 11:37:14 - utils - INFO -   - WDD0366 (Pseudo: USER_938203c1b6fe)
2025-11-11 11:37:14 - utils - INFO -   - WDT1634 (Pseudo: USER_5e8fc00f15c4)
2025-11-11 11:37:14 - utils - INFO -   - WHB1247 (Pseudo: USER_9d79c6caabe6)
2025-11-11 11:37:14 - utils - INFO -   - WOS1834 (Pseudo: USER_af313e3e259c)
2025-11-11 11:37:14 - utils - INFO -   - WSK1857 (Pseudo: USER_938bfd854858)
2025-11-11 11:37:14 - utils - INFO -   - WWW0701 (Pseudo: USER_b56ce7d144c9)
2025-11-11 11:37:14 - utils - INFO -   - XHW0498 (Pseudo: USER_4eb9aaefcb1c)
2025-11-11 11:37:14 - utils - INFO -   - ZEH0685 (Pseudo: USER_038488f8db5b)
2025-11-11 11:37:14 - utils - INFO -   - ZIE0741 (Pseudo: USER_50d1554e0201)
2025-11-11 11:37:14 - utils - INFO -   - ZKP0542 (Pseudo: USER_1b6fa8a78373)
2025-11-11 11:37:14 - utils - WARNING - Could not parse dates for CDE1846: month must be in 1..12: /21/2011 11:43:39, at position 0
2025-11-11 11:37:14 - utils - INFO - Parsed 190 insider activity periods
2025-11-11 11:37:14 - utils - ERROR - Error: Processed data not found: /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv
Run data_preprocessing.py first
2025-11-11 11:38:01 - utils - INFO - Utility functions loaded successfully
2025-11-11 11:38:01 - utils - INFO - 
================================================================================
                      COMPREHENSIVE MODEL EVALUATION (V2)                       
================================================================================

2025-11-11 11:38:01 - utils - INFO - Loading V2 results for all models...
2025-11-11 11:38:01 - utils - INFO - Loaded results for isolation_forest
2025-11-11 11:38:01 - utils - INFO - Loaded results for deep_clustering
2025-11-11 11:38:01 - utils - INFO - Loaded results for lstm_autoencoder
2025-11-11 11:38:01 - utils - INFO - Loaded results for 3 models
2025-11-11 11:38:01 - utils - INFO - Creating metrics comparison table...
2025-11-11 11:38:01 - utils - INFO - Metrics comparison table created
2025-11-11 11:38:01 - utils - INFO - Creating confusion matrix plots...
2025-11-11 11:38:02 - utils - INFO - Confusion matrices saved to /Users/bipinrimal/Downloads/Thesis_work/results/confusion_matrices/all_models_v2.png
2025-11-11 11:38:02 - utils - INFO - Creating ROC curves...
2025-11-11 11:38:02 - utils - WARNING - Skipping ROC for isolation_forest: No positive true labels.
2025-11-11 11:38:02 - utils - WARNING - Skipping ROC for deep_clustering: No positive true labels.
2025-11-11 11:38:02 - utils - WARNING - Skipping ROC for lstm_autoencoder: No positive true labels.
2025-11-11 11:38:02 - utils - INFO - ROC curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/roc_curves/roc_comparison_v2.png
2025-11-11 11:38:02 - utils - INFO - Creating Precision-Recall curves...
2025-11-11 11:38:02 - utils - WARNING - Skipping PR Curve for isolation_forest: No positive true labels.
2025-11-11 11:38:02 - utils - WARNING - Skipping PR Curve for deep_clustering: No positive true labels.
2025-11-11 11:38:02 - utils - WARNING - Skipping PR Curve for lstm_autoencoder: No positive true labels.
2025-11-11 11:38:02 - utils - INFO - Precision-Recall curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/precision_recall_comparison_v2.png
2025-11-11 11:38:02 - utils - INFO - Generating evaluation report...
2025-11-11 11:38:02 - utils - ERROR - Could not determine best model: Unknown format code 'f' for object of type 'str'
2025-11-11 11:38:02 - utils - INFO - Evaluation report saved to /Users/bipinrimal/Downloads/Thesis_work/results/evaluation_report_v2.txt
2025-11-11 11:38:02 - utils - INFO - Comprehensive V2 evaluation completed!
2025-11-11 11:38:13 - utils - INFO - Utility functions loaded successfully
2025-11-11 11:38:13 - utils - ERROR - Preprocessed data not found. Run data_preprocessing.py first. Error: [Errno 2] No such file or directory: '/Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv'
2025-11-11 11:39:55 - utils - INFO - Utility functions loaded successfully
2025-11-11 11:39:55 - utils - INFO - 
================================================================================
                            LABELING INSIDER THREATS                            
================================================================================

2025-11-11 11:39:55 - utils - INFO - Loading CMU-CERT answers file...
2025-11-11 11:39:55 - utils - INFO - Loaded 191 insider incidents
2025-11-11 11:39:55 - utils - INFO - Identified 191 unique insider users:
2025-11-11 11:39:55 - utils - INFO -   - AAF0535
2025-11-11 11:39:55 - utils - INFO -   - AAM0658
2025-11-11 11:39:55 - utils - INFO -   - ABB0427
2025-11-11 11:39:55 - utils - INFO -   - ABC0174
2025-11-11 11:39:55 - utils - INFO -   - ACA1126
2025-11-11 11:39:55 - utils - INFO -   - ACM1770
2025-11-11 11:39:55 - utils - INFO -   - ACM2278
2025-11-11 11:39:55 - utils - INFO -   - ADC1257
2025-11-11 11:39:55 - utils - INFO -   - AJR0932
2025-11-11 11:39:55 - utils - INFO -   - AKR0057
2025-11-11 11:39:55 - utils - INFO -   - ALT1465
2025-11-11 11:39:55 - utils - INFO -   - ALW0764
2025-11-11 11:39:55 - utils - INFO -   - AMC1883
2025-11-11 11:39:55 - utils - INFO -   - ASH0298
2025-11-11 11:39:55 - utils - INFO -   - ASH0458
2025-11-11 11:39:55 - utils - INFO -   - AYG1697
2025-11-11 11:39:55 - utils - INFO -   - BBS0039
2025-11-11 11:39:55 - utils - INFO -   - BDP0096
2025-11-11 11:39:55 - utils - INFO -   - BDV0168
2025-11-11 11:39:55 - utils - INFO -   - BGC0686
2025-11-11 11:39:55 - utils - INFO -   - BIH0745
2025-11-11 11:39:55 - utils - INFO -   - BLS0678
2025-11-11 11:39:55 - utils - INFO -   - BSS0369
2025-11-11 11:39:55 - utils - INFO -   - BTL0226
2025-11-11 11:39:55 - utils - INFO -   - BYO1846
2025-11-11 11:39:55 - utils - INFO -   - CAH0936
2025-11-11 11:39:55 - utils - INFO -   - CBW1826
2025-11-11 11:39:55 - utils - INFO -   - CCA0046
2025-11-11 11:39:55 - utils - INFO -   - CCH0959
2025-11-11 11:39:55 - utils - INFO -   - CCL0068
2025-11-11 11:39:55 - utils - INFO -   - CDE1846
2025-11-11 11:39:55 - utils - INFO -   - CEJ0109
2025-11-11 11:39:55 - utils - INFO -   - CGF1056
2025-11-11 11:39:55 - utils - INFO -   - CHP1711
2025-11-11 11:39:55 - utils - INFO -   - CIF1430
2025-11-11 11:39:55 - utils - INFO -   - CKP0630
2025-11-11 11:39:55 - utils - INFO -   - CMP2946
2025-11-11 11:39:55 - utils - INFO -   - CPD1525
2025-11-11 11:39:55 - utils - INFO -   - CQW0652
2025-11-11 11:39:55 - utils - INFO -   - CRD0272
2025-11-11 11:39:55 - utils - INFO -   - CSC0217
2025-11-11 11:39:55 - utils - INFO -   - CSF0929
2025-11-11 11:39:55 - utils - INFO -   - CSF2712
2025-11-11 11:39:55 - utils - INFO -   - CWW1120
2025-11-11 11:39:55 - utils - INFO -   - DAS1320
2025-11-11 11:39:55 - utils - INFO -   - DCC1119
2025-11-11 11:39:55 - utils - INFO -   - DCH0843
2025-11-11 11:39:55 - utils - INFO -   - DIB0285
2025-11-11 11:39:55 - utils - INFO -   - DIM0330
2025-11-11 11:39:55 - utils - INFO -   - DKG0161
2025-11-11 11:39:55 - utils - INFO -   - DNJ0740
2025-11-11 11:39:55 - utils - INFO -   - DQM0809
2025-11-11 11:39:55 - utils - INFO -   - DRR0162
2025-11-11 11:39:55 - utils - INFO -   - EDB0714
2025-11-11 11:39:55 - utils - INFO -   - EGD0132
2025-11-11 11:39:55 - utils - INFO -   - EHB0824
2025-11-11 11:39:55 - utils - INFO -   - EHD0584
2025-11-11 11:39:55 - utils - INFO -   - ELM1123
2025-11-11 11:39:55 - utils - INFO -   - ELT1370
2025-11-11 11:39:55 - utils - INFO -   - EPG1196
2025-11-11 11:39:55 - utils - INFO -   - ETW0002
2025-11-11 11:39:55 - utils - INFO -   - FMG0527
2025-11-11 11:39:55 - utils - INFO -   - FSC0601
2025-11-11 11:39:55 - utils - INFO -   - FTM0406
2025-11-11 11:39:55 - utils - INFO -   - FZG0389
2025-11-11 11:39:55 - utils - INFO -   - GCD0194
2025-11-11 11:39:55 - utils - INFO -   - GFM1815
2025-11-11 11:39:55 - utils - INFO -   - GHL0460
2025-11-11 11:39:55 - utils - INFO -   - GKW0043
2025-11-11 11:39:55 - utils - INFO -   - GMB0400
2025-11-11 11:39:55 - utils - INFO -   - GTD0219
2025-11-11 11:39:55 - utils - INFO -   - GWG0497
2025-11-11 11:39:55 - utils - INFO -   - HBO0413
2025-11-11 11:39:55 - utils - INFO -   - HBP1076
2025-11-11 11:39:55 - utils - INFO -   - HFC0492
2025-11-11 11:39:55 - utils - INFO -   - HIS1394
2025-11-11 11:39:55 - utils - INFO -   - HJB0462
2025-11-11 11:39:55 - utils - INFO -   - HJB0742
2025-11-11 11:39:55 - utils - INFO -   - HMS1658
2025-11-11 11:39:55 - utils - INFO -   - HSN0675
2025-11-11 11:39:55 - utils - INFO -   - HXL0968
2025-11-11 11:39:55 - utils - INFO -   - HXP0976
2025-11-11 11:39:55 - utils - INFO -   - ICB1354
2025-11-11 11:39:55 - utils - INFO -   - IHC0561
2025-11-11 11:39:55 - utils - INFO -   - IJM0776
2025-11-11 11:39:55 - utils - INFO -   - IKR0401
2025-11-11 11:39:55 - utils - INFO -   - IRH1224
2025-11-11 11:39:55 - utils - INFO -   - ISW0738
2025-11-11 11:39:55 - utils - INFO -   - ITA0159
2025-11-11 11:39:55 - utils - INFO -   - IUB0565
2025-11-11 11:39:55 - utils - INFO -   - JAK0783
2025-11-11 11:39:55 - utils - INFO -   - JAL0811
2025-11-11 11:39:55 - utils - INFO -   - JCC0016
2025-11-11 11:39:55 - utils - INFO -   - JCE0258
2025-11-11 11:39:55 - utils - INFO -   - JGT0221
2025-11-11 11:39:55 - utils - INFO -   - JIG1593
2025-11-11 11:39:55 - utils - INFO -   - JJM0203
2025-11-11 11:39:55 - utils - INFO -   - JKB0287
2025-11-11 11:39:55 - utils - INFO -   - JLM0364
2025-11-11 11:39:55 - utils - INFO -   - JMB0308
2025-11-11 11:39:55 - utils - INFO -   - JMM0613
2025-11-11 11:39:55 - utils - INFO -   - JNR1592
2025-11-11 11:39:55 - utils - INFO -   - JPH1910
2025-11-11 11:39:55 - utils - INFO -   - JRG0207
2025-11-11 11:39:55 - utils - INFO -   - JTC1885
2025-11-11 11:39:55 - utils - INFO -   - JTM0223
2025-11-11 11:39:55 - utils - INFO -   - JUP1472
2025-11-11 11:39:55 - utils - INFO -   - KBC1390
2025-11-11 11:39:55 - utils - INFO -   - KCM0466
2025-11-11 11:39:55 - utils - INFO -   - KDC0996
2025-11-11 11:39:55 - utils - INFO -   - KEW0198
2025-11-11 11:39:55 - utils - INFO -   - KLH0596
2025-11-11 11:39:55 - utils - INFO -   - KPC0073
2025-11-11 11:39:55 - utils - INFO -   - KRL0501
2025-11-11 11:39:55 - utils - INFO -   - KSS1005
2025-11-11 11:39:55 - utils - INFO -   - KTW0365
2025-11-11 11:39:55 - utils - INFO -   - LAH0463
2025-11-11 11:39:55 - utils - INFO -   - LBE0376
2025-11-11 11:39:55 - utils - INFO -   - LCC0819
2025-11-11 11:39:55 - utils - INFO -   - LJO1360
2025-11-11 11:39:55 - utils - INFO -   - LJR0523
2025-11-11 11:39:55 - utils - INFO -   - LQC0479
2025-11-11 11:39:55 - utils - INFO -   - LVF1626
2025-11-11 11:39:55 - utils - INFO -   - MAR0955
2025-11-11 11:39:55 - utils - INFO -   - MAS0025
2025-11-11 11:39:55 - utils - INFO -   - MBG3183
2025-11-11 11:39:55 - utils - INFO -   - MCF0600
2025-11-11 11:39:55 - utils - INFO -   - MCP0611
2025-11-11 11:39:55 - utils - INFO -   - MDH0580
2025-11-11 11:39:55 - utils - INFO -   - MDS0680
2025-11-11 11:39:55 - utils - INFO -   - MGB1235
2025-11-11 11:39:55 - utils - INFO -   - MIB0203
2025-11-11 11:39:55 - utils - INFO -   - MJR0711
2025-11-11 11:39:55 - utils - INFO -   - MOS0047
2025-11-11 11:39:55 - utils - INFO -   - MPF0690
2025-11-11 11:39:55 - utils - INFO -   - MPM0220
2025-11-11 11:39:55 - utils - INFO -   - MSO0222
2025-11-11 11:39:55 - utils - INFO -   - MTP1582
2025-11-11 11:39:55 - utils - INFO -   - MYD0978
2025-11-11 11:39:55 - utils - INFO -   - NAH1366
2025-11-11 11:39:55 - utils - INFO -   - NIV1608
2025-11-11 11:39:55 - utils - INFO -   - NKM1738
2025-11-11 11:39:55 - utils - INFO -   - NKN1405
2025-11-11 11:39:55 - utils - INFO -   - NWT0098
2025-11-11 11:39:55 - utils - INFO -   - NZL1395
2025-11-11 11:39:55 - utils - INFO -   - OFS0030
2025-11-11 11:39:55 - utils - INFO -   - OHS0036
2025-11-11 11:39:55 - utils - INFO -   - OKM1092
2025-11-11 11:39:55 - utils - INFO -   - ONS0995
2025-11-11 11:39:55 - utils - INFO -   - OSS1463
2025-11-11 11:39:55 - utils - INFO -   - PBC0077
2025-11-11 11:39:55 - utils - INFO -   - PLJ1771
2025-11-11 11:39:55 - utils - INFO -   - PNL0301
2025-11-11 11:39:55 - utils - INFO -   - PPF0435
2025-11-11 11:39:55 - utils - INFO -   - PSF0133
2025-11-11 11:39:55 - utils - INFO -   - PTH0005
2025-11-11 11:39:55 - utils - INFO -   - RAB0589
2025-11-11 11:39:55 - utils - INFO -   - RAR0725
2025-11-11 11:39:55 - utils - INFO -   - RCG0584
2025-11-11 11:39:55 - utils - INFO -   - RCW0822
2025-11-11 11:39:55 - utils - INFO -   - REF1924
2025-11-11 11:39:55 - utils - INFO -   - RGG0064
2025-11-11 11:39:55 - utils - INFO -   - RHL0992
2025-11-11 11:39:55 - utils - INFO -   - RKD0604
2025-11-11 11:39:55 - utils - INFO -   - RMW0542
2025-11-11 11:39:55 - utils - INFO -   - RRS0056
2025-11-11 11:39:55 - utils - INFO -   - SAF1942
2025-11-11 11:39:55 - utils - INFO -   - SIS0042
2025-11-11 11:39:55 - utils - INFO -   - SLL0193
2025-11-11 11:39:55 - utils - INFO -   - SNK1280
2025-11-11 11:39:55 - utils - INFO -   - TAP0551
2025-11-11 11:39:55 - utils - INFO -   - TMC0934
2025-11-11 11:39:55 - utils - INFO -   - TMT0851
2025-11-11 11:39:55 - utils - INFO -   - TNB1616
2025-11-11 11:39:55 - utils - INFO -   - TNM0961
2025-11-11 11:39:55 - utils - INFO -   - TRC1838
2025-11-11 11:39:55 - utils - INFO -   - VAH1292
2025-11-11 11:39:55 - utils - INFO -   - VCF1602
2025-11-11 11:39:55 - utils - INFO -   - VRP0267
2025-11-11 11:39:55 - utils - INFO -   - VSS0154
2025-11-11 11:39:55 - utils - INFO -   - WCW1013
2025-11-11 11:39:55 - utils - INFO -   - WDD0366
2025-11-11 11:39:55 - utils - INFO -   - WDT1634
2025-11-11 11:39:55 - utils - INFO -   - WHB1247
2025-11-11 11:39:55 - utils - INFO -   - WOS1834
2025-11-11 11:39:55 - utils - INFO -   - WSK1857
2025-11-11 11:39:55 - utils - INFO -   - WWW0701
2025-11-11 11:39:55 - utils - INFO -   - XHW0498
2025-11-11 11:39:55 - utils - INFO -   - ZEH0685
2025-11-11 11:39:55 - utils - INFO -   - ZIE0741
2025-11-11 11:39:55 - utils - INFO -   - ZKP0542
2025-11-11 11:39:55 - utils - WARNING - Could not parse dates for CDE1846: month must be in 1..12: /21/2011 11:43:39, at position 0
2025-11-11 11:39:55 - utils - INFO - Parsed 190 insider activity periods
2025-11-11 11:39:55 - utils - ERROR - Error: Processed data not found: /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv
Run data_preprocessing.py first
2025-11-11 11:40:02 - utils - INFO - Utility functions loaded successfully
2025-11-11 11:40:02 - utils - INFO - 
================================================================================
                            LABELING INSIDER THREATS                            
================================================================================

2025-11-11 11:40:02 - utils - INFO - Loading CMU-CERT answers file...
2025-11-11 11:40:02 - utils - INFO - Loaded 191 insider incidents
2025-11-11 11:40:02 - utils - WARNING - Could not parse dates for CDE1846: month must be in 1..12: /21/2011 11:43:39, at position 0
2025-11-11 11:40:02 - utils - INFO - Parsed 190 insider activity periods
2025-11-11 11:40:02 - utils - ERROR - Error: Processed data not found: /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv
2025-11-11 11:40:18 - utils - INFO - Utility functions loaded successfully
2025-11-11 11:40:18 - utils - INFO - 
================================================================================
                  LABELING INSIDER THREATS (V2: MULTI-DATASET)                  
================================================================================

2025-11-11 11:40:18 - utils - INFO - Loading CMU-CERT master answers file (insiders.csv)...
2025-11-11 11:40:18 - utils - INFO - Loaded 191 total insider incidents
2025-11-11 11:40:18 - utils - WARNING - Could not parse dates for CDE1846 in 6.2: month must be in 1..12: /21/2011 11:43:39, at position 0
2025-11-11 11:40:18 - utils - INFO - Parsed 190 insider activity rules
2025-11-11 11:40:19 - utils - INFO - Processing chunk 1 (1000000 rows)...
2025-11-11 11:40:32 - utils - INFO - Processing chunk 2 (1000000 rows)...
2025-11-11 11:40:45 - utils - INFO - Processing chunk 3 (1000000 rows)...
2025-11-11 11:40:58 - utils - INFO - Processing chunk 4 (1000000 rows)...
2025-11-11 11:41:11 - utils - INFO - Processing chunk 5 (1000000 rows)...
2025-11-11 11:41:20 - utils - WARNING - Temp file was not removed: /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs_ALL.labeled.tmp
2025-11-11 11:41:32 - utils - INFO - Utility functions loaded successfully
2025-11-11 11:41:45 - utils - INFO - Utility functions loaded successfully
2025-11-11 11:41:45 - utils - INFO - Found 2 dataset folders in /Users/bipinrimal/Downloads/Thesis_work/data/all_data
2025-11-11 11:41:45 - utils - INFO - 
================================================================================
                 DATA PREPROCESSING PIPELINE (V2: MEMORY-SAFE)                  
================================================================================

2025-11-11 11:41:45 - utils - INFO - Cleaning up old temporary files...
2025-11-11 11:41:45 - utils - INFO - Removed 0 old temp files.
2025-11-11 11:41:45 - utils - INFO - --- Processing single dataset: r1 ---
2025-11-11 11:41:46 - utils - INFO - Loaded logon.csv (849579 rows)
2025-11-11 11:41:47 - utils - INFO - Parsed datetime column: date
2025-11-11 11:41:47 - utils - INFO - Loaded device.csv (65668 rows)
2025-11-11 11:41:47 - utils - INFO - Parsed datetime column: date
2025-11-11 11:41:47 - utils - WARNING - file.csv not found in r1, skipping.
2025-11-11 11:41:47 - utils - WARNING - email.csv not found in r1, skipping.
2025-11-11 11:41:49 - utils - INFO - Loaded http.csv (3451664 rows)
2025-11-11 11:41:49 - utils - WARNING - 'date' column not found in /Users/bipinrimal/Downloads/Thesis_work/data/all_data/r1/http.csv. Skipping file.
2025-11-11 11:41:49 - utils - INFO - Cleaning dataframe with 915247 rows
2025-11-11 11:41:49 - utils - INFO - Removed 0 duplicate rows
2025-11-11 11:41:52 - utils - INFO - Saved temporary file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r1.csv (915247 rows)
2025-11-11 11:41:52 - utils - INFO - --- Processing single dataset: r2 ---
2025-11-11 11:41:53 - utils - INFO - Loaded logon.csv (840141 rows)
2025-11-11 11:41:53 - utils - INFO - Parsed datetime column: date
2025-11-11 11:41:54 - utils - INFO - Loaded device.csv (712308 rows)
2025-11-11 11:41:55 - utils - INFO - Parsed datetime column: date
2025-11-11 11:41:55 - utils - WARNING - file.csv not found in r2, skipping.
2025-11-11 11:41:56 - utils - INFO - Loaded email.csv (1189372 rows)
2025-11-11 11:41:57 - utils - INFO - Parsed datetime column: date
2025-11-11 11:42:02 - utils - INFO - Loaded http.csv (7321105 rows)
2025-11-11 11:42:09 - utils - INFO - Parsed datetime column: date
2025-11-11 11:42:15 - utils - INFO - Cleaning dataframe with 10062926 rows
2025-11-11 11:42:23 - utils - INFO - Removed 0 duplicate rows
2025-11-11 11:42:24 - utils - INFO - Missing values:
pc_id       1189372
activity    8510477
to          8873554
url         2741821
domain      2741821
dtype: int64
2025-11-11 11:42:57 - utils - INFO - Saved temporary file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r2.csv (10062926 rows)
2025-11-11 11:42:57 - utils - INFO - Merging 2 processed temp files...
2025-11-11 11:43:25 - utils - INFO - Master dataframe created: 10978173 total rows
2025-11-11 11:43:25 - utils - INFO - Cleaning up temporary files...
2025-11-11 11:43:25 - utils - INFO - Loading and merging static data (LDAP, Psychometric)...
2025-11-11 11:43:25 - utils - ERROR - Failed to load/merge LDAP data: No LDAP CSVs found in /Users/bipinrimal/Downloads/Thesis_work/data/all_data/LDAP
2025-11-11 11:43:26 - utils - INFO - Merged psychometric data for 1000 users
2025-11-11 11:43:47 - utils - INFO - Handled missing values using strategy: fill_mode
2025-11-11 11:43:47 - utils - INFO - Saving new master file to /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs_ALL.csv...
2025-11-11 11:44:34 - utils - INFO - ================================================================================
2025-11-11 11:44:34 - utils - INFO - V2 Preprocessing Complete!
2025-11-11 11:44:34 - utils - INFO - Master file saved: 10978173 rows
2025-11-11 11:44:34 - utils - INFO - Next step: python label_insiders_v2.py
2025-11-11 11:44:34 - utils - INFO - ================================================================================
2025-11-11 11:45:05 - utils - INFO - Utility functions loaded successfully
2025-11-11 11:47:11 - utils - INFO - Utility functions loaded successfully
2025-11-11 11:47:25 - utils - INFO - Utility functions loaded successfully
2025-11-11 11:47:25 - utils - INFO - Feature Engineer V2 initialized.
2025-11-11 11:47:25 - utils - INFO - 
================================================================================
                  FEATURE ENGINEERING PIPELINE V2 (MULTI-PASS)                  
================================================================================

2025-11-11 11:47:25 - utils - INFO - Found /Users/bipinrimal/Downloads/Thesis_work/data/processed/daily_features_unscaled_v2.csv, skipping Pass 1.
2025-11-11 11:47:25 - utils - INFO - 
================================================================================
                     PASS 2: FEATURE ENRICHMENT (Z-SCORES)                      
================================================================================

2025-11-11 11:47:25 - utils - ERROR - Failed to load LDAP data for role enrichment: No LDAP CSVs found in /Users/bipinrimal/Downloads/Thesis_work/data/all_data/LDAP
2025-11-11 11:47:25 - utils - WARNING - Could not load LDAP data. Peer-relative features will be skipped.
2025-11-11 11:47:25 - utils - INFO - Calculating self-relative Z-Scores (rolling 30-day)...
2025-11-11 11:47:27 - utils - INFO - Calculating peer-relative Z-Scores (by role)...
2025-11-11 11:47:27 - utils - INFO - PASS 2 complete. Enriched features created.
2025-11-11 11:47:27 - utils - INFO - Scaling and saving final daily features (for LSTM)...
2025-11-11 11:47:27 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/daily_feature_scaler_v2.pkl
2025-11-11 11:47:38 - utils - INFO - Saved /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_daily_features_v2.csv
2025-11-11 11:47:38 - utils - INFO - 
================================================================================
                        PASS 3: STATIC FEATURE CREATION                         
================================================================================

2025-11-11 11:47:38 - utils - INFO - Created static features for 3000 users
2025-11-11 11:47:38 - utils - INFO - Scaling and saving static features...
2025-11-11 11:47:38 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/static_feature_scaler_v2.pkl
2025-11-11 11:47:38 - utils - INFO - PASS 3 complete. Saved /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_static_features_v2.csv
2025-11-11 11:47:38 - utils - INFO - 
================================================================================
                           PASS 4: SEQUENCE CREATION                            
================================================================================

2025-11-11 11:47:38 - utils - INFO - Creating sequences (length=15, stride=10)...
2025-11-11 11:48:30 - utils - INFO - Created 97962 sequences from 3000 users
2025-11-11 11:48:30 - utils - INFO - PASS 4 complete. Saved sequence files to /Users/bipinrimal/Downloads/Thesis_work/data/processed
2025-11-11 11:48:30 - utils - INFO - ================================================================================
2025-11-11 11:48:30 - utils - INFO - V2 Feature Engineering Complete!
2025-11-11 11:48:30 - utils - INFO -   Static features created: /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_static_features_v2.csv
2025-11-11 11:48:30 - utils - INFO -   Sequence files created: /Users/bipinrimal/Downloads/Thesis_work/data/processed
2025-11-11 11:48:30 - utils - INFO - Next step: Train V2 models.
2025-11-11 11:48:30 - utils - INFO - ================================================================================
2025-11-11 11:48:47 - utils - INFO - Utility functions loaded successfully
2025-11-11 11:48:47 - utils - INFO - 
================================================================================
                 ISOLATION FOREST TRAINING (V2: MULTI-DATASET)                  
================================================================================

2025-11-11 11:48:47 - utils - INFO - Model loaded from /Users/bipinrimal/Downloads/Thesis_work/models/static_feature_scaler_v2.pkl
2025-11-11 11:48:47 - utils - INFO - Data split: 3000 total samples, 0 insiders
2025-11-11 11:48:47 - utils - INFO - Training on: 2400 normal samples
2025-11-11 11:48:47 - utils - INFO - Calibrating on: 600 normal samples
2025-11-11 11:48:47 - utils - INFO - Testing on: 3000 total samples (including 0 insiders)
2025-11-11 11:48:47 - utils - INFO - Initialized Isolation Forest (V2) with params: {'n_estimators': 50, 'max_samples': 256, 'contamination': 'auto', 'max_features': 1.0, 'bootstrap': False, 'n_jobs': -1, 'random_state': 42, 'verbose': 0}
2025-11-11 11:48:47 - utils - INFO - Training Isolation Forest on 2400 normal samples...
2025-11-11 11:48:47 - utils - INFO - Isolation Forest training completed
2025-11-11 11:48:47 - utils - INFO - Calibrating threshold for target FPR=0.05...
2025-11-11 11:48:47 - utils - INFO - Calibrated threshold: 0.5793
2025-11-11 11:48:47 - utils - INFO - Evaluating Isolation Forest (V2)...
2025-11-11 11:48:47 - utils - WARNING - No positive samples in test set. Metrics (Precision, Recall, F1, AUC-ROC) will be 0 or NaN.
2025-11-11 11:48:47 - utils - INFO - 
============================================================
2025-11-11 11:48:47 - utils - INFO - Isolation Forest (V2) Performance Metrics
2025-11-11 11:48:47 - utils - INFO - ============================================================
2025-11-11 11:48:47 - utils - INFO - Accuracy:  0.9547
2025-11-11 11:48:47 - utils - INFO - Precision: 0.0000
2025-11-11 11:48:47 - utils - INFO - Recall:    0.0000
2025-11-11 11:48:47 - utils - INFO - F1-Score:  0.0000
2025-11-11 11:48:47 - utils - INFO - AUC-ROC:   nan
2025-11-11 11:48:47 - utils - INFO - ============================================================

2025-11-11 11:48:47 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest_v2.pkl
2025-11-11 11:48:47 - utils - INFO - Saving Isolation Forest model to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest_v2.pkl
2025-11-11 11:48:47 - utils - INFO - Isolation Forest (V2) training and evaluation completed!
2025-11-11 11:49:02 - utils - INFO - Utility functions loaded successfully
2025-11-11 11:49:05 - utils - INFO - 
================================================================================
            LIGHTWEIGHT DEEP CLUSTERING TRAINING (V2: MULTI-DATASET)            
================================================================================

2025-11-11 11:49:05 - utils - INFO - Model loaded from /Users/bipinrimal/Downloads/Thesis_work/models/static_feature_scaler_v2.pkl
2025-11-11 11:49:05 - utils - INFO - Dataset: 3000 samples, 0 insiders
2025-11-11 11:49:05 - utils - INFO - Training on: 2400 normal samples
2025-11-11 11:49:05 - utils - INFO - Calibrating on: 600 normal samples
2025-11-11 11:49:05 - utils - INFO - Testing on: 3000 total samples (including 0 insiders)
2025-11-11 11:49:05 - utils - INFO - Initialized Lightweight Deep Clustering (V2) (n_clusters=5, encoding_dim=32)
2025-11-11 11:49:05 - utils - INFO - Training lightweight deep clustering model (V2)...
2025-11-11 11:49:05 - utils - INFO - Pre-training autoencoder...
2025-11-11 11:49:06 - utils - INFO - Autoencoder pre-training completed
2025-11-11 11:49:06 - utils - INFO - Fitting MiniBatch K-Means clustering...
2025-11-11 11:49:07 - utils - INFO - Deep clustering training completed
2025-11-11 11:49:07 - utils - INFO - Training completed in 1.44 seconds
2025-11-11 11:49:07 - utils - INFO - Calibrating threshold for target FPR=0.05...
2025-11-11 11:49:07 - utils - INFO - Calibrated threshold: 1.6087
2025-11-11 11:49:07 - utils - INFO - Evaluating lightweight deep clustering model (V2)...
2025-11-11 11:49:07 - utils - WARNING - No positive samples in test set. Metrics will be 0 or NaN.
2025-11-11 11:49:07 - utils - INFO - 
============================================================
2025-11-11 11:49:07 - utils - INFO - Deep Clustering (V2) Performance Metrics
2025-11-11 11:49:07 - utils - INFO - ============================================================
2025-11-11 11:49:07 - utils - INFO - Accuracy:  0.9517
2025-11-11 11:49:07 - utils - INFO - Precision: 0.0000
2025-11-11 11:49:07 - utils - INFO - Recall:    0.0000
2025-11-11 11:49:07 - utils - INFO - F1-Score:  0.0000
2025-11-11 11:49:07 - utils - INFO - AUC-ROC:   nan
2025-11-11 11:49:07 - utils - INFO - ============================================================

2025-11-11 11:49:07 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/deep_clustering_v2.pkl
2025-11-11 11:49:07 - utils - INFO - Encoder model saved to /Users/bipinrimal/Downloads/Thesis_work/models/deep_clustering_v2_encoder.keras
2025-11-11 11:49:07 - utils - INFO - Deep Clustering (V2) training and evaluation completed!
2025-11-11 11:49:21 - utils - INFO - Utility functions loaded successfully
2025-11-11 11:49:22 - utils - INFO - 
================================================================================
           LIGHTWEIGHT LSTM AUTOENCODER TRAINING (V2: MULTI-DATASET)            
================================================================================

2025-11-11 11:49:22 - utils - INFO - Loaded sequences: (97962, 15, 33), with 0 insider sequences
2025-11-11 11:49:23 - utils - INFO - Training on: 78369 normal sequences
2025-11-11 11:49:23 - utils - INFO - Calibrating on: 19593 normal sequences
2025-11-11 11:49:23 - utils - INFO - Testing on: 97962 total sequences (including 0 insider sequences)
2025-11-11 11:49:23 - utils - INFO - Initialized LSTM Autoencoder (V2) (15, 33)
2025-11-11 11:49:23 - utils - INFO - Training lightweight LSTM Autoencoder (V2)...
2025-11-11 11:49:23 - utils - INFO - Building lightweight LSTM Autoencoder...
2025-11-11 11:49:23 - utils - INFO - Model built with 21,329 parameters
2025-11-11 11:49:23 - utils - INFO - Training on 78369 sequences...
2025-11-11 11:50:56 - utils - INFO - Training completed
2025-11-11 11:50:56 - utils - INFO - Training completed in 93.08 seconds
2025-11-11 11:50:56 - utils - INFO - Calibrating threshold for target FPR=0.05
2025-11-11 11:50:56 - utils - INFO - Calibrated threshold: 0.2437
2025-11-11 11:50:56 - utils - INFO - Evaluating lightweight LSTM Autoencoder (V2)...
2025-11-11 11:50:58 - utils - WARNING - No positive samples in test set. Metrics (Precision, Recall, F1, AUC-ROC) will be 0 or NaN.
2025-11-11 11:50:59 - utils - INFO - 
============================================================
2025-11-11 11:50:59 - utils - INFO - LSTM Autoencoder (V2) Performance Metrics
2025-11-11 11:50:59 - utils - INFO - ============================================================
2025-11-11 11:50:59 - utils - INFO - Accuracy:  0.9532
2025-11-11 11:50:59 - utils - INFO - Precision: 0.0000
2025-11-11 11:50:59 - utils - INFO - Recall:    0.0000
2025-11-11 11:50:59 - utils - INFO - F1-Score:  0.0000
2025-11-11 11:50:59 - utils - INFO - AUC-ROC:   nan
2025-11-11 11:50:59 - utils - INFO - ============================================================

2025-11-11 11:50:59 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/lstm_autoencoder_v2.keras
2025-11-11 11:51:01 - utils - INFO - Lightweight LSTM Autoencoder (V2) completed!
2025-11-11 11:51:11 - utils - INFO - Utility functions loaded successfully
2025-11-11 11:51:11 - utils - INFO - 
================================================================================
                      COMPREHENSIVE MODEL EVALUATION (V2)                       
================================================================================

2025-11-11 11:51:11 - utils - INFO - Loading V2 results for all models...
2025-11-11 11:51:11 - utils - INFO - Loaded results for isolation_forest
2025-11-11 11:51:11 - utils - INFO - Loaded results for deep_clustering
2025-11-11 11:51:11 - utils - INFO - Loaded results for lstm_autoencoder
2025-11-11 11:51:11 - utils - INFO - Loaded results for 3 models
2025-11-11 11:51:11 - utils - INFO - Creating metrics comparison table...
2025-11-11 11:51:11 - utils - INFO - Metrics comparison table created
2025-11-11 11:51:11 - utils - INFO - Creating confusion matrix plots...
2025-11-11 11:51:11 - utils - INFO - Confusion matrices saved to /Users/bipinrimal/Downloads/Thesis_work/results/confusion_matrices/all_models_v2.png
2025-11-11 11:51:11 - utils - INFO - Creating ROC curves...
2025-11-11 11:51:11 - utils - WARNING - Skipping ROC for isolation_forest: No positive true labels.
2025-11-11 11:51:11 - utils - WARNING - Skipping ROC for deep_clustering: No positive true labels.
2025-11-11 11:51:11 - utils - WARNING - Skipping ROC for lstm_autoencoder: No positive true labels.
2025-11-11 11:51:11 - utils - INFO - ROC curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/roc_curves/roc_comparison_v2.png
2025-11-11 11:51:11 - utils - INFO - Creating Precision-Recall curves...
2025-11-11 11:51:11 - utils - WARNING - Skipping PR Curve for isolation_forest: No positive true labels.
2025-11-11 11:51:11 - utils - WARNING - Skipping PR Curve for deep_clustering: No positive true labels.
2025-11-11 11:51:11 - utils - WARNING - Skipping PR Curve for lstm_autoencoder: No positive true labels.
2025-11-11 11:51:11 - utils - INFO - Precision-Recall curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/precision_recall_comparison_v2.png
2025-11-11 11:51:11 - utils - INFO - Generating evaluation report...
2025-11-11 11:51:11 - utils - ERROR - Could not determine best model: Unknown format code 'f' for object of type 'str'
2025-11-11 11:51:11 - utils - INFO - Evaluation report saved to /Users/bipinrimal/Downloads/Thesis_work/results/evaluation_report_v2.txt
2025-11-11 11:51:11 - utils - INFO - Comprehensive V2 evaluation completed!
2025-11-11 11:51:20 - utils - INFO - Utility functions loaded successfully
2025-11-11 11:53:44 - utils - INFO - Utility functions loaded successfully
2025-11-11 11:56:14 - utils - INFO - Utility functions loaded successfully
2025-11-11 11:56:14 - utils - INFO - 
================================================================================
                  LABELING INSIDER THREATS (V2: MULTI-DATASET)                  
================================================================================

2025-11-11 11:56:14 - utils - INFO - Loading CMU-CERT master answers file (insiders.csv)...
2025-11-11 11:56:14 - utils - INFO - Loaded 191 total insider incidents
2025-11-11 11:56:14 - utils - WARNING - Could not parse dates for CDE1846 in 6.2: month must be in 1..12: /21/2011 11:43:39, at position 0
2025-11-11 11:56:14 - utils - INFO - Parsed 190 insider activity rules
2025-11-11 11:56:15 - utils - INFO - Processing chunk 1 (1000000 rows)...
2025-11-11 11:56:28 - utils - INFO - Processing chunk 2 (1000000 rows)...
2025-11-11 11:56:41 - utils - INFO - Processing chunk 3 (1000000 rows)...
2025-11-11 11:56:54 - utils - INFO - Processing chunk 4 (1000000 rows)...
2025-11-11 11:57:07 - utils - INFO - Processing chunk 5 (1000000 rows)...
2025-11-11 11:57:20 - utils - INFO - Processing chunk 6 (1000000 rows)...
2025-11-11 11:57:33 - utils - INFO - Processing chunk 7 (1000000 rows)...
2025-11-11 11:57:46 - utils - INFO - Processing chunk 8 (1000000 rows)...
2025-11-11 11:57:59 - utils - INFO - Processing chunk 9 (1000000 rows)...
2025-11-11 11:58:12 - utils - INFO - Processing chunk 10 (1000000 rows)...
2025-11-11 11:58:25 - utils - INFO - Processing chunk 11 (978173 rows)...
2025-11-11 11:58:36 - utils - INFO - All chunks processed. Total rows: 10978173
2025-11-11 11:58:36 - utils - INFO - Total insider records labeled: 0
2025-11-11 11:58:36 - utils - INFO - Replacing original file with labeled version...
2025-11-11 11:58:36 - utils - INFO - Successfully created: /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs_ALL.csv
2025-11-11 11:58:36 - utils - INFO - ================================================================================
2025-11-11 11:58:36 - utils - INFO - V2 Labeling Complete!
2025-11-11 11:58:36 - utils - INFO - The file 'processed_unified_logs_ALL.csv' is now labeled.
2025-11-11 11:58:36 - utils - INFO - Next step: Run 'feature_engineering_v2.py'
2025-11-11 11:58:36 - utils - INFO - ================================================================================
2025-11-11 11:59:03 - utils - INFO - Utility functions loaded successfully
2025-11-11 11:59:03 - utils - INFO - Feature Engineer V2 initialized.
2025-11-11 11:59:03 - utils - INFO - 
================================================================================
                  FEATURE ENGINEERING PIPELINE V2 (MULTI-PASS)                  
================================================================================

2025-11-11 11:59:03 - utils - INFO - Found /Users/bipinrimal/Downloads/Thesis_work/data/processed/daily_features_unscaled_v2.csv, skipping Pass 1.
2025-11-11 11:59:04 - utils - INFO - 
================================================================================
                     PASS 2: FEATURE ENRICHMENT (Z-SCORES)                      
================================================================================

2025-11-11 11:59:04 - utils - ERROR - Failed to load LDAP data for role enrichment: No LDAP CSVs found in /Users/bipinrimal/Downloads/Thesis_work/data/all_data/LDAP
2025-11-11 11:59:04 - utils - WARNING - Could not load LDAP data. Peer-relative features will be skipped.
2025-11-11 11:59:04 - utils - INFO - Calculating self-relative Z-Scores (rolling 30-day)...
2025-11-11 11:59:06 - utils - INFO - Calculating peer-relative Z-Scores (by role)...
2025-11-11 11:59:06 - utils - INFO - PASS 2 complete. Enriched features created.
2025-11-11 11:59:06 - utils - INFO - Scaling and saving final daily features (for LSTM)...
2025-11-11 11:59:06 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/daily_feature_scaler_v2.pkl
2025-11-11 11:59:17 - utils - INFO - Saved /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_daily_features_v2.csv
2025-11-11 11:59:17 - utils - INFO - 
================================================================================
                        PASS 3: STATIC FEATURE CREATION                         
================================================================================

2025-11-11 11:59:17 - utils - INFO - Created static features for 3000 users
2025-11-11 11:59:17 - utils - INFO - Scaling and saving static features...
2025-11-11 11:59:17 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/static_feature_scaler_v2.pkl
2025-11-11 11:59:17 - utils - INFO - PASS 3 complete. Saved /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_static_features_v2.csv
2025-11-11 11:59:17 - utils - INFO - 
================================================================================
                           PASS 4: SEQUENCE CREATION                            
================================================================================

2025-11-11 11:59:17 - utils - INFO - Creating sequences (length=15, stride=10)...
2025-11-11 12:00:09 - utils - INFO - Created 97962 sequences from 3000 users
2025-11-11 12:00:09 - utils - INFO - PASS 4 complete. Saved sequence files to /Users/bipinrimal/Downloads/Thesis_work/data/processed
2025-11-11 12:00:09 - utils - INFO - ================================================================================
2025-11-11 12:00:09 - utils - INFO - V2 Feature Engineering Complete!
2025-11-11 12:00:09 - utils - INFO -   Static features created: /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_static_features_v2.csv
2025-11-11 12:00:09 - utils - INFO -   Sequence files created: /Users/bipinrimal/Downloads/Thesis_work/data/processed
2025-11-11 12:00:09 - utils - INFO - Next step: Train V2 models.
2025-11-11 12:00:09 - utils - INFO - ================================================================================
2025-11-11 12:00:42 - utils - INFO - Utility functions loaded successfully
2025-11-11 12:00:42 - utils - INFO - 
================================================================================
                 ISOLATION FOREST TRAINING (V2: MULTI-DATASET)                  
================================================================================

2025-11-11 12:00:42 - utils - INFO - Model loaded from /Users/bipinrimal/Downloads/Thesis_work/models/static_feature_scaler_v2.pkl
2025-11-11 12:00:42 - utils - INFO - Data split: 3000 total samples, 0 insiders
2025-11-11 12:00:42 - utils - INFO - Training on: 2400 normal samples
2025-11-11 12:00:42 - utils - INFO - Calibrating on: 600 normal samples
2025-11-11 12:00:42 - utils - INFO - Testing on: 3000 total samples (including 0 insiders)
2025-11-11 12:00:42 - utils - INFO - Initialized Isolation Forest (V2) with params: {'n_estimators': 50, 'max_samples': 256, 'contamination': 'auto', 'max_features': 1.0, 'bootstrap': False, 'n_jobs': -1, 'random_state': 42, 'verbose': 0}
2025-11-11 12:00:42 - utils - INFO - Training Isolation Forest on 2400 normal samples...
2025-11-11 12:00:42 - utils - INFO - Isolation Forest training completed
2025-11-11 12:00:42 - utils - INFO - Calibrating threshold for target FPR=0.05...
2025-11-11 12:00:42 - utils - INFO - Calibrated threshold: 0.5793
2025-11-11 12:00:42 - utils - INFO - Evaluating Isolation Forest (V2)...
2025-11-11 12:00:42 - utils - WARNING - No positive samples in test set. Metrics (Precision, Recall, F1, AUC-ROC) will be 0 or NaN.
2025-11-11 12:00:42 - utils - INFO - 
============================================================
2025-11-11 12:00:42 - utils - INFO - Isolation Forest (V2) Performance Metrics
2025-11-11 12:00:42 - utils - INFO - ============================================================
2025-11-11 12:00:42 - utils - INFO - Accuracy:  0.9547
2025-11-11 12:00:42 - utils - INFO - Precision: 0.0000
2025-11-11 12:00:42 - utils - INFO - Recall:    0.0000
2025-11-11 12:00:42 - utils - INFO - F1-Score:  0.0000
2025-11-11 12:00:42 - utils - INFO - AUC-ROC:   nan
2025-11-11 12:00:42 - utils - INFO - ============================================================

2025-11-11 12:00:42 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest_v2.pkl
2025-11-11 12:00:42 - utils - INFO - Saving Isolation Forest model to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest_v2.pkl
2025-11-11 12:00:42 - utils - INFO - Isolation Forest (V2) training and evaluation completed!
2025-11-11 12:01:02 - utils - INFO - Utility functions loaded successfully
2025-11-11 12:01:04 - utils - INFO - 
================================================================================
            LIGHTWEIGHT DEEP CLUSTERING TRAINING (V2: MULTI-DATASET)            
================================================================================

2025-11-11 12:01:04 - utils - INFO - Model loaded from /Users/bipinrimal/Downloads/Thesis_work/models/static_feature_scaler_v2.pkl
2025-11-11 12:01:04 - utils - INFO - Dataset: 3000 samples, 0 insiders
2025-11-11 12:01:04 - utils - INFO - Training on: 2400 normal samples
2025-11-11 12:01:04 - utils - INFO - Calibrating on: 600 normal samples
2025-11-11 12:01:04 - utils - INFO - Testing on: 3000 total samples (including 0 insiders)
2025-11-11 12:01:04 - utils - INFO - Initialized Lightweight Deep Clustering (V2) (n_clusters=5, encoding_dim=32)
2025-11-11 12:01:04 - utils - INFO - Training lightweight deep clustering model (V2)...
2025-11-11 12:01:04 - utils - INFO - Pre-training autoencoder...
2025-11-11 12:01:05 - utils - INFO - Autoencoder pre-training completed
2025-11-11 12:01:05 - utils - INFO - Fitting MiniBatch K-Means clustering...
2025-11-11 12:01:06 - utils - INFO - Deep clustering training completed
2025-11-11 12:01:06 - utils - INFO - Training completed in 1.40 seconds
2025-11-11 12:01:06 - utils - INFO - Calibrating threshold for target FPR=0.05...
2025-11-11 12:01:06 - utils - INFO - Calibrated threshold: 1.6640
2025-11-11 12:01:06 - utils - INFO - Evaluating lightweight deep clustering model (V2)...
2025-11-11 12:01:06 - utils - WARNING - No positive samples in test set. Metrics will be 0 or NaN.
2025-11-11 12:01:06 - utils - INFO - 
============================================================
2025-11-11 12:01:06 - utils - INFO - Deep Clustering (V2) Performance Metrics
2025-11-11 12:01:06 - utils - INFO - ============================================================
2025-11-11 12:01:06 - utils - INFO - Accuracy:  0.9540
2025-11-11 12:01:06 - utils - INFO - Precision: 0.0000
2025-11-11 12:01:06 - utils - INFO - Recall:    0.0000
2025-11-11 12:01:06 - utils - INFO - F1-Score:  0.0000
2025-11-11 12:01:06 - utils - INFO - AUC-ROC:   nan
2025-11-11 12:01:06 - utils - INFO - ============================================================

2025-11-11 12:01:06 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/deep_clustering_v2.pkl
2025-11-11 12:01:06 - utils - INFO - Encoder model saved to /Users/bipinrimal/Downloads/Thesis_work/models/deep_clustering_v2_encoder.keras
2025-11-11 12:01:06 - utils - INFO - Deep Clustering (V2) training and evaluation completed!
2025-11-11 12:01:17 - utils - INFO - Utility functions loaded successfully
2025-11-11 12:01:19 - utils - INFO - 
================================================================================
           LIGHTWEIGHT LSTM AUTOENCODER TRAINING (V2: MULTI-DATASET)            
================================================================================

2025-11-11 12:01:19 - utils - INFO - Loaded sequences: (97962, 15, 33), with 0 insider sequences
2025-11-11 12:01:19 - utils - INFO - Training on: 78369 normal sequences
2025-11-11 12:01:19 - utils - INFO - Calibrating on: 19593 normal sequences
2025-11-11 12:01:19 - utils - INFO - Testing on: 97962 total sequences (including 0 insider sequences)
2025-11-11 12:01:19 - utils - INFO - Initialized LSTM Autoencoder (V2) (15, 33)
2025-11-11 12:01:19 - utils - INFO - Training lightweight LSTM Autoencoder (V2)...
2025-11-11 12:01:19 - utils - INFO - Building lightweight LSTM Autoencoder...
2025-11-11 12:01:19 - utils - INFO - Model built with 21,329 parameters
2025-11-11 12:01:19 - utils - INFO - Training on 78369 sequences...
2025-11-11 12:02:52 - utils - INFO - Training completed
2025-11-11 12:02:52 - utils - INFO - Training completed in 92.72 seconds
2025-11-11 12:02:52 - utils - INFO - Calibrating threshold for target FPR=0.05
2025-11-11 12:02:53 - utils - INFO - Calibrated threshold: 0.2587
2025-11-11 12:02:53 - utils - INFO - Evaluating lightweight LSTM Autoencoder (V2)...
2025-11-11 12:02:54 - utils - WARNING - No positive samples in test set. Metrics (Precision, Recall, F1, AUC-ROC) will be 0 or NaN.
2025-11-11 12:02:55 - utils - INFO - 
============================================================
2025-11-11 12:02:55 - utils - INFO - LSTM Autoencoder (V2) Performance Metrics
2025-11-11 12:02:55 - utils - INFO - ============================================================
2025-11-11 12:02:55 - utils - INFO - Accuracy:  0.9526
2025-11-11 12:02:55 - utils - INFO - Precision: 0.0000
2025-11-11 12:02:55 - utils - INFO - Recall:    0.0000
2025-11-11 12:02:55 - utils - INFO - F1-Score:  0.0000
2025-11-11 12:02:55 - utils - INFO - AUC-ROC:   nan
2025-11-11 12:02:55 - utils - INFO - ============================================================

2025-11-11 12:02:55 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/lstm_autoencoder_v2.keras
2025-11-11 12:02:57 - utils - INFO - Lightweight LSTM Autoencoder (V2) completed!
2025-11-11 12:03:31 - utils - INFO - Utility functions loaded successfully
2025-11-11 12:03:31 - utils - INFO - 
================================================================================
                      COMPREHENSIVE MODEL EVALUATION (V2)                       
================================================================================

2025-11-11 12:03:31 - utils - INFO - Loading V2 results for all models...
2025-11-11 12:03:31 - utils - INFO - Loaded results for isolation_forest
2025-11-11 12:03:31 - utils - INFO - Loaded results for deep_clustering
2025-11-11 12:03:31 - utils - INFO - Loaded results for lstm_autoencoder
2025-11-11 12:03:31 - utils - INFO - Loaded results for 3 models
2025-11-11 12:03:31 - utils - INFO - Creating metrics comparison table...
2025-11-11 12:03:31 - utils - INFO - Metrics comparison table created
2025-11-11 12:03:31 - utils - INFO - Creating confusion matrix plots...
2025-11-11 12:03:31 - utils - INFO - Confusion matrices saved to /Users/bipinrimal/Downloads/Thesis_work/results/confusion_matrices/all_models_v2.png
2025-11-11 12:03:31 - utils - INFO - Creating ROC curves...
2025-11-11 12:03:31 - utils - WARNING - Skipping ROC for isolation_forest: No positive true labels.
2025-11-11 12:03:31 - utils - WARNING - Skipping ROC for deep_clustering: No positive true labels.
2025-11-11 12:03:31 - utils - WARNING - Skipping ROC for lstm_autoencoder: No positive true labels.
2025-11-11 12:03:31 - utils - INFO - ROC curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/roc_curves/roc_comparison_v2.png
2025-11-11 12:03:31 - utils - INFO - Creating Precision-Recall curves...
2025-11-11 12:03:31 - utils - WARNING - Skipping PR Curve for isolation_forest: No positive true labels.
2025-11-11 12:03:31 - utils - WARNING - Skipping PR Curve for deep_clustering: No positive true labels.
2025-11-11 12:03:31 - utils - WARNING - Skipping PR Curve for lstm_autoencoder: No positive true labels.
2025-11-11 12:03:31 - utils - INFO - Precision-Recall curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/precision_recall_comparison_v2.png
2025-11-11 12:03:31 - utils - INFO - Generating evaluation report...
2025-11-11 12:03:31 - utils - ERROR - Could not determine best model: Unknown format code 'f' for object of type 'str'
2025-11-11 12:03:31 - utils - INFO - Evaluation report saved to /Users/bipinrimal/Downloads/Thesis_work/results/evaluation_report_v2.txt
2025-11-11 12:03:31 - utils - INFO - Comprehensive V2 evaluation completed!
2025-11-11 12:04:12 - utils - INFO - Utility functions loaded successfully
2025-11-11 12:05:28 - utils - INFO - Utility functions loaded successfully
2025-11-11 12:05:31 - utils - INFO - Utility functions loaded successfully
2025-11-11 12:05:31 - utils - INFO - 
================================================================================
                      COMPREHENSIVE MODEL EVALUATION (V2)                       
================================================================================

2025-11-11 12:05:31 - utils - INFO - Loading V2 results for all models...
2025-11-11 12:05:31 - utils - INFO - Loaded results for isolation_forest
2025-11-11 12:05:31 - utils - INFO - Loaded results for deep_clustering
2025-11-11 12:05:31 - utils - INFO - Loaded results for lstm_autoencoder
2025-11-11 12:05:31 - utils - INFO - Loaded results for 3 models
2025-11-11 12:05:31 - utils - INFO - Creating metrics comparison table...
2025-11-11 12:05:31 - utils - INFO - Metrics comparison table created
2025-11-11 12:05:31 - utils - INFO - Creating confusion matrix plots...
2025-11-11 12:05:31 - utils - ERROR - Evaluation failed: `data` and `annot` must have same shape.
2025-11-11 12:05:43 - utils - INFO - Utility functions loaded successfully
2025-11-11 12:05:43 - utils - INFO - 
================================================================================
                      COMPREHENSIVE MODEL EVALUATION (V2)                       
================================================================================

2025-11-11 12:05:43 - utils - INFO - Loading V2 results for all models...
2025-11-11 12:05:43 - utils - INFO - Loaded results for isolation_forest
2025-11-11 12:05:43 - utils - INFO - Loaded results for deep_clustering
2025-11-11 12:05:43 - utils - INFO - Loaded results for lstm_autoencoder
2025-11-11 12:05:43 - utils - INFO - Loaded results for 3 models
2025-11-11 12:05:43 - utils - INFO - Creating metrics comparison table...
2025-11-11 12:05:43 - utils - INFO - Metrics comparison table created
2025-11-11 12:05:43 - utils - INFO - Creating confusion matrix plots...
2025-11-11 12:05:43 - utils - ERROR - Evaluation failed: `data` and `annot` must have same shape.
2025-11-11 12:06:45 - utils - INFO - Utility functions loaded successfully
2025-11-11 12:06:45 - utils - INFO - Found 2 dataset folders in /Users/bipinrimal/Downloads/Thesis_work/data/all_data
2025-11-11 12:06:45 - utils - INFO - 
================================================================================
                 DATA PREPROCESSING PIPELINE (V2: MEMORY-SAFE)                  
================================================================================

2025-11-11 12:06:45 - utils - INFO - Cleaning up old temporary files...
2025-11-11 12:06:45 - utils - INFO - Removed 0 old temp files.
2025-11-11 12:06:45 - utils - INFO - --- Processing single dataset: r1 ---
2025-11-11 12:06:46 - utils - INFO - Loaded logon.csv (849579 rows)
2025-11-11 12:06:47 - utils - INFO - Parsed datetime column: date
2025-11-11 12:06:47 - utils - INFO - Loaded device.csv (65668 rows)
2025-11-11 12:06:47 - utils - INFO - Parsed datetime column: date
2025-11-11 12:06:47 - utils - WARNING - file.csv not found in r1, skipping.
2025-11-11 12:06:47 - utils - WARNING - email.csv not found in r1, skipping.
2025-11-11 12:06:49 - utils - INFO - Loaded http.csv (3451664 rows)
2025-11-11 12:06:49 - utils - WARNING - 'date' column not found in /Users/bipinrimal/Downloads/Thesis_work/data/all_data/r1/http.csv. Skipping file.
2025-11-11 12:06:49 - utils - INFO - Cleaning dataframe with 915247 rows
2025-11-11 12:06:50 - utils - INFO - Removed 0 duplicate rows
2025-11-11 12:06:53 - utils - INFO - Saved temporary file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r1.csv (915247 rows)
2025-11-11 12:06:53 - utils - INFO - --- Processing single dataset: r2 ---
2025-11-11 12:06:53 - utils - INFO - Loaded logon.csv (840141 rows)
2025-11-11 12:06:54 - utils - INFO - Parsed datetime column: date
2025-11-11 12:06:55 - utils - INFO - Loaded device.csv (712308 rows)
2025-11-11 12:06:55 - utils - INFO - Parsed datetime column: date
2025-11-11 12:06:55 - utils - WARNING - file.csv not found in r2, skipping.
2025-11-11 12:06:56 - utils - INFO - Loaded email.csv (1189372 rows)
2025-11-11 12:06:57 - utils - INFO - Parsed datetime column: date
2025-11-11 12:07:03 - utils - INFO - Loaded http.csv (7321105 rows)
2025-11-11 12:07:10 - utils - INFO - Parsed datetime column: date
2025-11-11 12:07:16 - utils - INFO - Cleaning dataframe with 10062926 rows
2025-11-11 12:07:23 - utils - INFO - Removed 0 duplicate rows
2025-11-11 12:07:24 - utils - INFO - Missing values:
pc_id       1189372
activity    8510477
to          8873554
url         2741821
domain      2741821
dtype: int64
2025-11-11 12:07:57 - utils - INFO - Saved temporary file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r2.csv (10062926 rows)
2025-11-11 12:07:57 - utils - INFO - Merging 2 processed temp files...
2025-11-11 12:08:24 - utils - INFO - Master dataframe created: 10978173 total rows
2025-11-11 12:08:24 - utils - INFO - Cleaning up temporary files...
2025-11-11 12:08:25 - utils - INFO - Loading and merging static data (LDAP, Psychometric)...
2025-11-11 12:08:25 - utils - ERROR - Failed to load/merge LDAP data: No LDAP CSVs found in /Users/bipinrimal/Downloads/Thesis_work/data/all_data/LDAP
2025-11-11 12:08:26 - utils - INFO - Merged psychometric data for 1000 users
2025-11-11 12:08:47 - utils - INFO - Handled missing values using strategy: fill_mode
2025-11-11 12:08:47 - utils - INFO - Saving new master file to /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs_ALL.csv...
2025-11-11 12:09:33 - utils - INFO - ================================================================================
2025-11-11 12:09:33 - utils - INFO - V2 Preprocessing Complete!
2025-11-11 12:09:33 - utils - INFO - Master file saved: 10978173 rows
2025-11-11 12:09:33 - utils - INFO - Next step: python label_insiders_v2.py
2025-11-11 12:09:33 - utils - INFO - ================================================================================
2025-11-11 12:11:49 - utils - INFO - Utility functions loaded successfully
2025-11-11 12:11:49 - utils - INFO - 
================================================================================
                  LABELING INSIDER THREATS (V2: MULTI-DATASET)                  
================================================================================

2025-11-11 12:11:49 - utils - INFO - Loading CMU-CERT master answers file (insiders.csv)...
2025-11-11 12:11:49 - utils - INFO - Loaded 191 total insider incidents
2025-11-11 12:11:49 - utils - WARNING - Could not parse dates for CDE1846 in 6.2: month must be in 1..12: /21/2011 11:43:39, at position 0
2025-11-11 12:11:49 - utils - INFO - Parsed 190 insider activity rules
2025-11-11 12:11:51 - utils - INFO - Processing chunk 1 (1000000 rows)...
2025-11-11 12:12:03 - utils - INFO - Processing chunk 2 (1000000 rows)...
2025-11-11 12:12:16 - utils - INFO - Processing chunk 3 (1000000 rows)...
2025-11-11 12:12:29 - utils - INFO - Processing chunk 4 (1000000 rows)...
2025-11-11 12:12:42 - utils - INFO - Processing chunk 5 (1000000 rows)...
2025-11-11 12:12:56 - utils - INFO - Processing chunk 6 (1000000 rows)...
2025-11-11 12:13:09 - utils - INFO - Processing chunk 7 (1000000 rows)...
2025-11-11 12:13:22 - utils - INFO - Processing chunk 8 (1000000 rows)...
2025-11-11 12:13:35 - utils - INFO - Processing chunk 9 (1000000 rows)...
2025-11-11 12:13:48 - utils - INFO - Processing chunk 10 (1000000 rows)...
2025-11-11 12:14:01 - utils - INFO - Processing chunk 11 (978173 rows)...
2025-11-11 12:14:12 - utils - INFO - All chunks processed. Total rows: 10978173
2025-11-11 12:14:12 - utils - INFO - Total insider records labeled: 0
2025-11-11 12:14:12 - utils - INFO - Replacing original file with labeled version...
2025-11-11 12:14:12 - utils - INFO - Successfully created: /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs_ALL.csv
2025-11-11 12:14:12 - utils - INFO - ================================================================================
2025-11-11 12:14:12 - utils - INFO - V2 Labeling Complete!
2025-11-11 12:14:12 - utils - INFO - The file 'processed_unified_logs_ALL.csv' is now labeled.
2025-11-11 12:14:12 - utils - INFO - Next step: Run 'feature_engineering_v2.py'
2025-11-11 12:14:12 - utils - INFO - ================================================================================
2025-11-11 12:17:04 - utils - INFO - Utility functions loaded successfully
2025-11-11 12:17:04 - utils - INFO - Found 8 dataset folders in /Users/bipinrimal/Downloads/Thesis_work/data/all_data
2025-11-11 12:17:04 - utils - INFO - 
================================================================================
                 DATA PREPROCESSING PIPELINE (V2: MEMORY-SAFE)                  
================================================================================

2025-11-11 12:17:04 - utils - INFO - Cleaning up old temporary files...
2025-11-11 12:17:04 - utils - INFO - Removed 0 old temp files.
2025-11-11 12:17:04 - utils - INFO - --- Processing single dataset: r1 ---
2025-11-11 12:17:04 - utils - INFO - Loaded logon.csv (849579 rows)
2025-11-11 12:17:05 - utils - INFO - Parsed datetime column: date
2025-11-11 12:17:05 - utils - INFO - Loaded device.csv (65668 rows)
2025-11-11 12:17:05 - utils - INFO - Parsed datetime column: date
2025-11-11 12:17:05 - utils - WARNING - file.csv not found in r1, skipping.
2025-11-11 12:17:05 - utils - WARNING - email.csv not found in r1, skipping.
2025-11-11 12:17:07 - utils - INFO - Loaded http.csv (3451664 rows)
2025-11-11 12:17:07 - utils - WARNING - 'date' column not found in /Users/bipinrimal/Downloads/Thesis_work/data/all_data/r1/http.csv. Skipping file.
2025-11-11 12:17:07 - utils - INFO - Cleaning dataframe with 915247 rows
2025-11-11 12:17:08 - utils - INFO - Removed 0 duplicate rows
2025-11-11 12:17:10 - utils - INFO - Saved temporary file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r1.csv (915247 rows)
2025-11-11 12:17:10 - utils - INFO - --- Processing single dataset: r2 ---
2025-11-11 12:17:11 - utils - INFO - Loaded logon.csv (840141 rows)
2025-11-11 12:17:12 - utils - INFO - Parsed datetime column: date
2025-11-11 12:17:12 - utils - INFO - Loaded device.csv (712308 rows)
2025-11-11 12:17:13 - utils - INFO - Parsed datetime column: date
2025-11-11 12:17:13 - utils - WARNING - file.csv not found in r2, skipping.
2025-11-11 12:17:14 - utils - INFO - Loaded email.csv (1189372 rows)
2025-11-11 12:17:15 - utils - INFO - Parsed datetime column: date
2025-11-11 12:17:20 - utils - INFO - Loaded http.csv (7321105 rows)
2025-11-11 12:17:27 - utils - INFO - Parsed datetime column: date
2025-11-11 12:17:33 - utils - INFO - Cleaning dataframe with 10062926 rows
2025-11-11 12:17:39 - utils - INFO - Removed 0 duplicate rows
2025-11-11 12:17:40 - utils - INFO - Missing values:
pc_id       1189372
activity    8510477
to          8873554
url         2741821
domain      2741821
dtype: int64
2025-11-11 12:18:13 - utils - INFO - Saved temporary file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r2.csv (10062926 rows)
2025-11-11 12:18:13 - utils - INFO - --- Processing single dataset: r3.1 ---
2025-11-11 12:18:14 - utils - INFO - Loaded logon.csv (842109 rows)
2025-11-11 12:18:14 - utils - INFO - Parsed datetime column: date
2025-11-11 12:18:15 - utils - INFO - Loaded device.csv (417588 rows)
2025-11-11 12:18:15 - utils - INFO - Parsed datetime column: date
2025-11-11 12:18:17 - utils - INFO - Loaded file.csv (457520 rows)
2025-11-11 12:18:17 - utils - INFO - Parsed datetime column: date
2025-11-11 12:18:24 - utils - INFO - Loaded email.csv (1994071 rows)
2025-11-11 12:18:26 - utils - INFO - Parsed datetime column: date
2025-11-11 12:26:48 - utils - INFO - Utility functions loaded successfully
2025-11-11 12:26:48 - utils - INFO - Found 8 dataset folders in /Users/bipinrimal/Downloads/Thesis_work/data/all_data
2025-11-11 12:26:48 - utils - INFO - 
================================================================================
                 DATA PREPROCESSING PIPELINE (V2: MEMORY-SAFE)                  
================================================================================

2025-11-11 12:26:48 - utils - INFO - Cleaning up old temporary files...
2025-11-11 12:26:48 - utils - INFO - Removed 2 old temp files.
2025-11-11 12:26:48 - utils - INFO - --- Processing single dataset: r1 ---
2025-11-11 12:26:49 - utils - INFO - Loaded logon.csv (849579 rows)
2025-11-11 12:26:50 - utils - INFO - Parsed datetime column: date
2025-11-11 12:26:50 - utils - INFO - Loaded device.csv (65668 rows)
2025-11-11 12:26:50 - utils - INFO - Parsed datetime column: date
2025-11-11 12:26:50 - utils - WARNING - file.csv not found in r1, skipping.
2025-11-11 12:26:50 - utils - WARNING - email.csv not found in r1, skipping.
2025-11-11 12:26:52 - utils - INFO - Loaded http.csv (3451664 rows)
2025-11-11 12:26:52 - utils - WARNING - 'date' column not found in /Users/bipinrimal/Downloads/Thesis_work/data/all_data/r1/http.csv. Skipping file.
2025-11-11 12:26:52 - utils - INFO - Cleaning dataframe with 915247 rows
2025-11-11 12:26:52 - utils - INFO - Removed 0 duplicate rows
2025-11-11 12:26:55 - utils - INFO - Saved temporary file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r1.csv (915247 rows)
2025-11-11 12:26:55 - utils - INFO - --- Processing single dataset: r2 ---
2025-11-11 12:26:56 - utils - INFO - Loaded logon.csv (840141 rows)
2025-11-11 12:26:56 - utils - INFO - Parsed datetime column: date
2025-11-11 12:26:57 - utils - INFO - Loaded device.csv (712308 rows)
2025-11-11 12:26:58 - utils - INFO - Parsed datetime column: date
2025-11-11 12:26:58 - utils - WARNING - file.csv not found in r2, skipping.
2025-11-11 12:26:59 - utils - INFO - Loaded email.csv (1189372 rows)
2025-11-11 12:27:00 - utils - INFO - Parsed datetime column: date
2025-11-11 12:27:05 - utils - INFO - Loaded http.csv (7321105 rows)
2025-11-11 12:27:12 - utils - INFO - Parsed datetime column: date
2025-11-11 12:27:18 - utils - INFO - Cleaning dataframe with 10062926 rows
2025-11-11 12:27:23 - utils - INFO - Removed 0 duplicate rows
2025-11-11 12:27:24 - utils - INFO - Missing values:
pc_id       1189372
activity    8510477
to          8873554
url         2741821
domain      2741821
dtype: int64
2025-11-11 12:27:58 - utils - INFO - Saved temporary file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r2.csv (10062926 rows)
2025-11-11 12:27:58 - utils - INFO - --- Processing single dataset: r3.1 ---
2025-11-11 12:27:58 - utils - INFO - Loaded logon.csv (842109 rows)
2025-11-11 12:27:59 - utils - INFO - Parsed datetime column: date
2025-11-11 12:27:59 - utils - INFO - Loaded device.csv (417588 rows)
2025-11-11 12:28:00 - utils - INFO - Parsed datetime column: date
2025-11-11 12:28:01 - utils - INFO - Loaded file.csv (457520 rows)
2025-11-11 12:28:01 - utils - INFO - Parsed datetime column: date
2025-11-11 12:28:08 - utils - INFO - Loaded email.csv (1994071 rows)
2025-11-11 12:28:10 - utils - INFO - Parsed datetime column: date
2025-11-11 12:34:07 - utils - INFO - Loaded http.csv (23555143 rows)
2025-11-11 12:34:32 - utils - INFO - Parsed datetime column: date
2025-11-11 12:35:49 - utils - INFO - Cleaning dataframe with 27266431 rows
2025-11-11 12:44:20 - utils - INFO - Removed 0 duplicate rows
2025-11-11 12:44:52 - utils - INFO - Missing values:
pc_id           1994071
activity       26006734
filename       26808911
content         1259697
to             25272360
size           25272360
attachments    25272360
url             3711288
domain          3711288
dtype: int64
2025-11-11 12:49:57 - utils - INFO - Saved temporary file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r3.1.csv (27266431 rows)
2025-11-11 12:51:42 - utils - INFO - Utility functions loaded successfully
2025-11-11 12:51:42 - utils - INFO - Processing SUBSET defined in config: ['r2', 'r3.1', 'r4.1']
2025-11-11 12:51:42 - utils - INFO - Found 3 dataset folders to process.
2025-11-11 12:51:42 - utils - INFO - 
================================================================================
                 DATA PREPROCESSING PIPELINE (V2: MEMORY-SAFE)                  
================================================================================

2025-11-11 12:51:42 - utils - INFO - Cleaning up old temporary files...
2025-11-11 12:51:42 - utils - INFO - Removed 3 old temp files.
2025-11-11 12:51:42 - utils - INFO - --- Processing single dataset: r2 ---
2025-11-11 12:51:43 - utils - INFO - Loaded logon.csv (840141 rows)
2025-11-11 12:51:43 - utils - INFO - Parsed datetime column: date
2025-11-11 12:51:44 - utils - INFO - Loaded device.csv (712308 rows)
2025-11-11 12:51:45 - utils - INFO - Parsed datetime column: date
2025-11-11 12:51:45 - utils - WARNING - file.csv not found in r2, skipping.
2025-11-11 12:51:46 - utils - INFO - Loaded email.csv (1189372 rows)
2025-11-11 12:51:47 - utils - INFO - Parsed datetime column: date
2025-11-11 12:51:52 - utils - INFO - Loaded http.csv (7321105 rows)
2025-11-11 12:51:59 - utils - INFO - Parsed datetime column: date
2025-11-11 12:52:05 - utils - INFO - Cleaning dataframe with 10062926 rows
2025-11-11 12:52:11 - utils - INFO - Removed 0 duplicate rows
2025-11-11 12:52:12 - utils - INFO - Missing values:
pc_id       1189372
activity    8510477
to          8873554
url         2741821
domain      2741821
dtype: int64
2025-11-11 12:52:46 - utils - INFO - Saved temporary file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r2.csv (10062926 rows)
2025-11-11 12:52:46 - utils - INFO - --- Processing single dataset: r3.1 ---
2025-11-11 12:52:47 - utils - INFO - Loaded logon.csv (842109 rows)
2025-11-11 12:52:48 - utils - INFO - Parsed datetime column: date
2025-11-11 12:52:48 - utils - INFO - Loaded device.csv (417588 rows)
2025-11-11 12:52:49 - utils - INFO - Parsed datetime column: date
2025-11-11 12:52:50 - utils - INFO - Loaded file.csv (457520 rows)
2025-11-11 12:52:51 - utils - INFO - Parsed datetime column: date
2025-11-11 12:52:58 - utils - INFO - Loaded email.csv (1994071 rows)
2025-11-11 12:53:00 - utils - INFO - Parsed datetime column: date
2025-11-11 12:57:21 - utils - INFO - Loaded http.csv (23555143 rows)
2025-11-11 12:57:49 - utils - INFO - Parsed datetime column: date
2025-11-11 12:58:49 - utils - INFO - Cleaning dataframe with 27266431 rows
2025-11-11 13:07:09 - utils - INFO - Removed 0 duplicate rows
2025-11-11 13:07:31 - utils - INFO - Missing values:
pc_id           1994071
activity       26006734
filename       26808911
content         1259697
to             25272360
size           25272360
attachments    25272360
url             3711288
domain          3711288
dtype: int64
2025-11-11 13:11:59 - utils - INFO - Saved temporary file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r3.1.csv (27266431 rows)
2025-11-11 13:12:23 - utils - INFO - --- Processing single dataset: r4.1 ---
2025-11-11 13:12:25 - utils - INFO - Loaded logon.csv (899118 rows)
2025-11-11 13:12:26 - utils - INFO - Parsed datetime column: date
2025-11-11 13:12:27 - utils - INFO - Loaded device.csv (437168 rows)
2025-11-11 13:12:27 - utils - INFO - Parsed datetime column: date
2025-11-11 13:12:30 - utils - INFO - Loaded file.csv (414556 rows)
2025-11-11 13:12:30 - utils - INFO - Parsed datetime column: date
2025-11-11 13:12:46 - utils - INFO - Loaded email.csv (2733360 rows)
2025-11-11 13:12:49 - utils - INFO - Parsed datetime column: date
2025-11-11 13:41:16 - utils - INFO - Loaded http.csv (29553383 rows)
2025-11-11 13:41:59 - utils - INFO - Parsed datetime column: date
2025-11-11 13:45:49 - utils - INFO - Cleaning dataframe with 34037585 rows
2025-11-11 13:57:41 - utils - INFO - Removed 0 duplicate rows
2025-11-11 13:58:57 - utils - INFO - Missing values:
activity       32701299
filename       33623029
content         1336286
to             31304225
cc             32987711
bcc            33607961
from           31304225
size           31304225
attachments    31304225
url             4484202
domain          4484202
dtype: int64
2025-11-11 14:06:54 - utils - INFO - Saved temporary file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r4.1.csv (34037585 rows)
2025-11-11 14:08:36 - utils - INFO - Merging 3 processed temp files into master file...
2025-11-11 14:08:36 - utils - INFO - Merging /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r2.csv...
2025-11-11 14:09:24 - utils - INFO - Merging /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r3.1.csv...
2025-11-11 14:14:30 - utils - INFO - Merging /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r4.1.csv...
2025-11-11 14:20:38 - utils - INFO - Master dataframe created: 71366942 total rows
2025-11-11 14:20:38 - utils - INFO - Loading and merging static data (LDAP, Psychometric) via streaming...
2025-11-11 14:20:38 - utils - ERROR - Failed to load LDAP data: No objects to concatenate
2025-11-11 14:20:38 - utils - INFO - Loaded psychometric data for 2999 users
2025-11-11 14:20:40 - utils - INFO - Enriching chunk 1...
2025-11-11 14:20:44 - utils - INFO - Enriching chunk 2...
2025-11-11 14:20:49 - utils - INFO - Enriching chunk 3...
2025-11-11 14:20:54 - utils - INFO - Enriching chunk 4...
2025-11-11 14:20:59 - utils - INFO - Enriching chunk 5...
2025-11-11 14:21:04 - utils - INFO - Enriching chunk 6...
2025-11-11 14:21:08 - utils - INFO - Enriching chunk 7...
2025-11-11 14:21:13 - utils - INFO - Enriching chunk 8...
2025-11-11 14:21:17 - utils - INFO - Enriching chunk 9...
2025-11-11 14:21:22 - utils - INFO - Enriching chunk 10...
2025-11-11 14:21:26 - utils - ERROR - Failed to stream-merge static data: Error tokenizing data. C error: Expected 26 fields in line 10062928, saw 30

2025-11-11 14:21:26 - utils - ERROR - Static data enrichment failed. Aborting.
2025-11-11 14:28:24 - utils - INFO - Utility functions loaded successfully
2025-11-11 14:28:24 - utils - INFO - Processing SUBSET defined in config: ['r2', 'r3.1', 'r4.1']
2025-11-11 14:28:24 - utils - INFO - Found 3 dataset folders to process.
2025-11-11 14:28:24 - utils - INFO - 
================================================================================
                 DATA PREPROCESSING PIPELINE (V2: MEMORY-SAFE)                  
================================================================================

2025-11-11 14:28:24 - utils - INFO - Cleaning up old temporary files...
2025-11-11 14:28:24 - utils - INFO - Removed 0 old temp files.
2025-11-11 14:28:24 - utils - INFO - --- Processing single dataset: r2 ---
2025-11-11 14:28:24 - utils - INFO - Loaded logon.csv (840141 rows)
2025-11-11 14:28:25 - utils - INFO - Parsed datetime column: date
2025-11-11 14:28:26 - utils - INFO - Loaded device.csv (712308 rows)
2025-11-11 14:28:26 - utils - INFO - Parsed datetime column: date
2025-11-11 14:28:26 - utils - WARNING - file.csv not found in r2, skipping.
2025-11-11 14:28:27 - utils - INFO - Loaded email.csv (1189372 rows)
2025-11-11 14:28:28 - utils - INFO - Parsed datetime column: date
2025-11-11 14:28:34 - utils - INFO - Loaded http.csv (7321105 rows)
2025-11-11 14:28:41 - utils - INFO - Parsed datetime column: date
2025-11-11 14:28:47 - utils - INFO - Cleaning dataframe with 10062926 rows
2025-11-11 14:28:53 - utils - INFO - Removed 0 duplicate rows
2025-11-11 14:28:54 - utils - INFO - Missing values:
pc_id              1189372
activity           8510477
to                 8873554
url                2741821
domain             2741821
from              10062926
size              10062926
attachments       10062926
cc                10062926
bcc               10062926
filename          10062926
content           10062926
file_extension    10062926
dtype: int64
2025-11-11 14:29:42 - utils - INFO - Saved temporary file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r2.csv (10062926 rows)
2025-11-11 14:29:42 - utils - INFO - --- Processing single dataset: r3.1 ---
2025-11-11 14:29:42 - utils - INFO - Loaded logon.csv (842109 rows)
2025-11-11 14:29:43 - utils - INFO - Parsed datetime column: date
2025-11-11 14:29:43 - utils - INFO - Loaded device.csv (417588 rows)
2025-11-11 14:29:44 - utils - INFO - Parsed datetime column: date
2025-11-11 14:29:45 - utils - INFO - Loaded file.csv (457520 rows)
2025-11-11 14:29:46 - utils - INFO - Parsed datetime column: date
2025-11-11 14:29:53 - utils - INFO - Loaded email.csv (1994071 rows)
2025-11-11 14:29:55 - utils - INFO - Parsed datetime column: date
2025-11-11 14:31:53 - utils - INFO - Utility functions loaded successfully
2025-11-11 14:31:53 - utils - INFO - Processing SUBSET defined in config: ['r2', 'r3.1', 'r4.1']
2025-11-11 14:31:53 - utils - INFO - Found 3 dataset folders to process.
2025-11-11 14:31:53 - utils - INFO - 
================================================================================
                 DATA PREPROCESSING PIPELINE (V2: MEMORY-SAFE)                  
================================================================================

2025-11-11 14:31:53 - utils - INFO - --- Processing single dataset: r2 ---
2025-11-11 14:31:53 - utils - WARNING - Temp file temp_processed_r2.csv already exists. Skipping processing.
2025-11-11 14:31:53 - utils - INFO - --- Processing single dataset: r3.1 ---
2025-11-11 14:31:54 - utils - INFO - Loaded logon.csv (842109 rows)
2025-11-11 14:31:55 - utils - INFO - Parsed datetime column: date
2025-11-11 14:31:55 - utils - INFO - Loaded device.csv (417588 rows)
2025-11-11 14:31:56 - utils - INFO - Parsed datetime column: date
2025-11-11 14:31:57 - utils - INFO - Loaded file.csv (457520 rows)
2025-11-11 14:31:57 - utils - INFO - Parsed datetime column: date
2025-11-11 14:32:04 - utils - INFO - Loaded email.csv (1994071 rows)
2025-11-11 14:32:06 - utils - INFO - Parsed datetime column: date
2025-11-11 14:37:26 - utils - INFO - Loaded http.csv (23555143 rows)
2025-11-11 14:37:58 - utils - INFO - Parsed datetime column: date
2025-11-11 14:38:53 - utils - INFO - Cleaning dataframe with 27266431 rows
2025-11-11 14:44:14 - utils - INFO - Removed 0 duplicate rows
2025-11-11 14:44:44 - utils - INFO - Missing values:
pc_id              1994071
activity          26006734
filename          26808911
content            1259697
file_extension    26808911
to                25272360
size              25272360
attachments       25272360
url                3711288
domain             3711288
from              27266431
cc                27266431
bcc               27266431
dtype: int64
2025-11-11 14:50:43 - utils - INFO - Saved temporary file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r3.1.csv (27266431 rows)
2025-11-11 14:51:11 - utils - INFO - --- Processing single dataset: r4.1 ---
2025-11-11 14:51:12 - utils - INFO - Loaded logon.csv (899118 rows)
2025-11-11 14:51:13 - utils - INFO - Parsed datetime column: date
2025-11-11 14:51:13 - utils - INFO - Loaded device.csv (437168 rows)
2025-11-11 14:51:13 - utils - INFO - Parsed datetime column: date
2025-11-11 14:51:15 - utils - INFO - Loaded file.csv (414556 rows)
2025-11-11 14:51:15 - utils - INFO - Parsed datetime column: date
2025-11-11 14:51:27 - utils - INFO - Loaded email.csv (2733360 rows)
2025-11-11 14:51:29 - utils - INFO - Parsed datetime column: date
2025-11-11 15:08:44 - utils - INFO - Loaded http.csv (29553383 rows)
2025-11-11 15:09:21 - utils - INFO - Parsed datetime column: date
2025-11-11 15:12:44 - utils - INFO - Cleaning dataframe with 34037585 rows
2025-11-11 15:23:47 - utils - INFO - Removed 0 duplicate rows
2025-11-11 15:24:37 - utils - INFO - Missing values:
activity          32701299
filename          33623029
content            1336286
file_extension    33623029
to                31304225
cc                32987711
bcc               33607961
from              31304225
size              31304225
attachments       31304225
url                4484202
domain             4484202
dtype: int64
2025-11-11 15:33:54 - utils - INFO - Saved temporary file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r4.1.csv (34037585 rows)
2025-11-11 15:34:46 - utils - INFO - Merging 4 processed temp files into master file...
2025-11-11 15:34:47 - utils - INFO - Merging /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r2.csv...
2025-11-11 15:35:50 - utils - INFO - Merging /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r2.csv...
2025-11-11 15:36:48 - utils - INFO - Merging /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r3.1.csv...
2025-11-11 15:41:56 - utils - INFO - Merging /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r4.1.csv...
2025-11-11 15:48:28 - utils - INFO - Master dataframe created: 81429868 total rows
2025-11-11 15:48:28 - utils - INFO - Loading and merging static data (LDAP, Psychometric) via streaming...
2025-11-11 15:48:28 - utils - INFO - Scanning for LDAP data in dataset folders...
2025-11-11 15:48:28 - utils - ERROR - Failed to load/merge LDAP data: Usecols do not match columns, columns expected but not found: ['domain']
2025-11-11 15:48:28 - utils - INFO - Loaded and de-duplicated psychometric data for 2999 users
2025-11-11 15:48:30 - utils - INFO - Enriching chunk 1...
2025-11-11 15:48:36 - utils - INFO - Enriching chunk 2...
2025-11-11 15:48:43 - utils - INFO - Enriching chunk 3...
2025-11-11 15:48:49 - utils - INFO - Enriching chunk 4...
2025-11-11 15:48:56 - utils - INFO - Enriching chunk 5...
2025-11-11 15:49:02 - utils - INFO - Enriching chunk 6...
2025-11-11 15:49:08 - utils - INFO - Enriching chunk 7...
2025-11-11 15:49:14 - utils - INFO - Enriching chunk 8...
2025-11-11 15:49:20 - utils - INFO - Enriching chunk 9...
2025-11-11 15:49:27 - utils - INFO - Enriching chunk 10...
2025-11-11 15:49:33 - utils - INFO - Enriching chunk 11...
2025-11-11 15:49:39 - utils - INFO - Enriching chunk 12...
2025-11-11 15:49:46 - utils - INFO - Enriching chunk 13...
2025-11-11 15:49:52 - utils - INFO - Enriching chunk 14...
2025-11-11 15:49:58 - utils - INFO - Enriching chunk 15...
2025-11-11 15:50:05 - utils - INFO - Enriching chunk 16...
2025-11-11 15:50:11 - utils - INFO - Enriching chunk 17...
2025-11-11 15:50:17 - utils - INFO - Enriching chunk 18...
2025-11-11 15:50:23 - utils - INFO - Enriching chunk 19...
2025-11-11 15:50:30 - utils - INFO - Enriching chunk 20...
2025-11-11 15:50:36 - utils - INFO - Enriching chunk 21...
2025-11-11 15:50:44 - utils - INFO - Enriching chunk 22...
2025-11-11 15:50:55 - utils - INFO - Enriching chunk 23...
2025-11-11 15:51:09 - utils - INFO - Enriching chunk 24...
2025-11-11 15:51:21 - utils - INFO - Enriching chunk 25...
2025-11-11 15:51:33 - utils - INFO - Enriching chunk 26...
2025-11-11 15:51:45 - utils - INFO - Enriching chunk 27...
2025-11-11 15:51:57 - utils - INFO - Enriching chunk 28...
2025-11-11 15:52:09 - utils - INFO - Enriching chunk 29...
2025-11-11 15:52:22 - utils - INFO - Enriching chunk 30...
2025-11-11 15:52:34 - utils - INFO - Enriching chunk 31...
2025-11-11 15:52:46 - utils - INFO - Enriching chunk 32...
2025-11-11 15:52:58 - utils - INFO - Enriching chunk 33...
2025-11-11 15:53:10 - utils - INFO - Enriching chunk 34...
2025-11-11 15:53:22 - utils - INFO - Enriching chunk 35...
2025-11-11 15:53:34 - utils - INFO - Enriching chunk 36...
2025-11-11 15:53:46 - utils - INFO - Enriching chunk 37...
2025-11-11 15:53:58 - utils - INFO - Enriching chunk 38...
2025-11-11 15:54:10 - utils - INFO - Enriching chunk 39...
2025-11-11 15:54:22 - utils - INFO - Enriching chunk 40...
2025-11-11 15:54:34 - utils - INFO - Enriching chunk 41...
2025-11-11 15:54:46 - utils - INFO - Enriching chunk 42...
2025-11-11 15:54:59 - utils - INFO - Enriching chunk 43...
2025-11-11 15:55:12 - utils - INFO - Enriching chunk 44...
2025-11-11 15:55:24 - utils - INFO - Enriching chunk 45...
2025-11-11 15:55:36 - utils - INFO - Enriching chunk 46...
2025-11-11 15:55:49 - utils - INFO - Enriching chunk 47...
2025-11-11 15:56:00 - utils - INFO - Enriching chunk 48...
2025-11-11 15:56:09 - utils - INFO - Enriching chunk 49...
2025-11-11 15:56:18 - utils - INFO - Enriching chunk 50...
2025-11-11 15:56:31 - utils - INFO - Enriching chunk 51...
2025-11-11 15:56:44 - utils - INFO - Enriching chunk 52...
2025-11-11 15:56:56 - utils - INFO - Enriching chunk 53...
2025-11-11 15:57:08 - utils - INFO - Enriching chunk 54...
2025-11-11 15:57:20 - utils - INFO - Enriching chunk 55...
2025-11-11 15:57:32 - utils - INFO - Enriching chunk 56...
2025-11-11 15:57:44 - utils - INFO - Enriching chunk 57...
2025-11-11 15:57:56 - utils - INFO - Enriching chunk 58...
2025-11-11 15:58:08 - utils - INFO - Enriching chunk 59...
2025-11-11 15:58:20 - utils - INFO - Enriching chunk 60...
2025-11-11 15:58:31 - utils - INFO - Enriching chunk 61...
2025-11-11 15:58:44 - utils - INFO - Enriching chunk 62...
2025-11-11 15:58:55 - utils - INFO - Enriching chunk 63...
2025-11-11 15:59:08 - utils - INFO - Enriching chunk 64...
2025-11-11 15:59:20 - utils - INFO - Enriching chunk 65...
2025-11-11 15:59:33 - utils - INFO - Enriching chunk 66...
2025-11-11 15:59:45 - utils - INFO - Enriching chunk 67...
2025-11-11 15:59:58 - utils - INFO - Enriching chunk 68...
2025-11-11 16:00:10 - utils - INFO - Enriching chunk 69...
2025-11-11 16:00:23 - utils - INFO - Enriching chunk 70...
2025-11-11 16:00:36 - utils - INFO - Enriching chunk 71...
2025-11-11 16:00:48 - utils - INFO - Enriching chunk 72...
2025-11-11 16:01:01 - utils - INFO - Enriching chunk 73...
2025-11-11 16:01:13 - utils - INFO - Enriching chunk 74...
2025-11-11 16:01:26 - utils - INFO - Enriching chunk 75...
2025-11-11 16:01:38 - utils - INFO - Enriching chunk 76...
2025-11-11 16:01:51 - utils - INFO - Enriching chunk 77...
2025-11-11 16:02:03 - utils - INFO - Enriching chunk 78...
2025-11-11 16:02:16 - utils - INFO - Enriching chunk 79...
2025-11-11 16:02:29 - utils - INFO - Enriching chunk 80...
2025-11-11 16:02:41 - utils - INFO - Enriching chunk 81...
2025-11-11 16:02:50 - utils - INFO - Enriching chunk 82...
2025-11-11 16:02:54 - utils - INFO - Enrichment complete. Replacing master file...
2025-11-11 16:02:54 - utils - INFO - Successfully created final enriched file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs_r2_r3.1_r4.1_ENRICHED.csv
2025-11-11 16:02:54 - utils - INFO - Loading final file for last-pass cleaning...
2025-11-11 16:34:50 - utils - INFO - Utility functions loaded successfully
2025-11-11 16:34:50 - utils - INFO - Processing SUBSET defined in config: ['r2', 'r3.1', 'r4.1']
2025-11-11 16:34:50 - utils - INFO - Found 3 dataset folders to process.
2025-11-11 16:34:50 - utils - INFO - 
================================================================================
                 DATA PREPROCESSING PIPELINE (V2: MEMORY-SAFE)                  
================================================================================

2025-11-11 16:34:50 - utils - WARNING - ================================================================================
2025-11-11 16:34:50 - utils - WARNING - Final file 'processed_unified_logs_r2_r3.1_r4.1_ENRICHED.csv' already exists.
2025-11-11 16:34:50 - utils - WARNING - Skipping entire preprocessing pipeline.
2025-11-11 16:34:50 - utils - WARNING - To re-run, set FORCE_RERUN_PREPROCESSING = True in config_v2.py
2025-11-11 16:34:50 - utils - WARNING - ================================================================================
2025-11-11 16:36:16 - utils - INFO - Utility functions loaded successfully
2025-11-11 16:36:16 - utils - INFO - 
================================================================================
                  LABELING INSIDER THREATS (V2: MULTI-DATASET)                  
================================================================================

2025-11-11 16:36:16 - utils - INFO - Loading CMU-CERT master answers file (insiders.csv)...
2025-11-11 16:36:16 - utils - INFO - Loaded 191 total insider incidents
2025-11-11 16:36:16 - utils - WARNING - Could not parse dates for CDE1846 in 6.2: month must be in 1..12: /21/2011 11:43:39, at position 0
2025-11-11 16:36:16 - utils - INFO - Parsed 190 insider activity rules
2025-11-11 16:36:17 - utils - INFO - Processing chunk 1 (1000000 rows)...
2025-11-11 16:36:31 - utils - INFO - Processing chunk 2 (1000000 rows)...
2025-11-11 16:36:45 - utils - INFO - Processing chunk 3 (1000000 rows)...
2025-11-11 16:36:58 - utils - INFO - Processing chunk 4 (1000000 rows)...
2025-11-11 16:37:12 - utils - INFO - Processing chunk 5 (1000000 rows)...
2025-11-11 16:37:25 - utils - INFO - Processing chunk 6 (1000000 rows)...
2025-11-11 16:37:39 - utils - INFO - Processing chunk 7 (1000000 rows)...
2025-11-11 16:37:53 - utils - INFO - Processing chunk 8 (1000000 rows)...
2025-11-11 16:38:08 - utils - INFO - Processing chunk 9 (1000000 rows)...
2025-11-11 16:38:22 - utils - INFO - Processing chunk 10 (1000000 rows)...
2025-11-11 16:38:36 - utils - INFO - Processing chunk 11 (1000000 rows)...
2025-11-11 16:38:50 - utils - INFO - Processing chunk 12 (1000000 rows)...
2025-11-11 16:39:04 - utils - INFO - Processing chunk 13 (1000000 rows)...
2025-11-11 16:39:18 - utils - INFO - Processing chunk 14 (1000000 rows)...
2025-11-11 16:39:33 - utils - INFO - Processing chunk 15 (1000000 rows)...
2025-11-11 16:39:47 - utils - INFO - Processing chunk 16 (1000000 rows)...
2025-11-11 16:40:01 - utils - INFO - Processing chunk 17 (1000000 rows)...
2025-11-11 16:40:15 - utils - INFO - Processing chunk 18 (1000000 rows)...
2025-11-11 16:40:30 - utils - INFO - Processing chunk 19 (1000000 rows)...
2025-11-11 16:40:44 - utils - INFO - Processing chunk 20 (1000000 rows)...
2025-11-11 16:40:58 - utils - INFO - Processing chunk 21 (1000000 rows)...
2025-11-11 16:41:14 - utils - INFO - Processing chunk 22 (1000000 rows)...
2025-11-11 16:41:33 - utils - INFO - Processing chunk 23 (1000000 rows)...
2025-11-11 16:41:54 - utils - INFO - Processing chunk 24 (1000000 rows)...
2025-11-11 16:42:15 - utils - INFO - Processing chunk 25 (1000000 rows)...
2025-11-11 16:42:35 - utils - INFO - Processing chunk 26 (1000000 rows)...
2025-11-11 16:42:55 - utils - INFO - Processing chunk 27 (1000000 rows)...
2025-11-11 16:43:15 - utils - INFO - Processing chunk 28 (1000000 rows)...
2025-11-11 16:43:35 - utils - INFO - Processing chunk 29 (1000000 rows)...
2025-11-11 16:43:55 - utils - INFO - Processing chunk 30 (1000000 rows)...
2025-11-11 16:44:15 - utils - INFO - Processing chunk 31 (1000000 rows)...
2025-11-11 16:44:35 - utils - INFO - Processing chunk 32 (1000000 rows)...
2025-11-11 16:44:55 - utils - INFO - Processing chunk 33 (1000000 rows)...
2025-11-11 16:45:15 - utils - INFO - Processing chunk 34 (1000000 rows)...
2025-11-11 16:45:35 - utils - INFO - Processing chunk 35 (1000000 rows)...
2025-11-11 16:45:55 - utils - INFO - Processing chunk 36 (1000000 rows)...
2025-11-11 16:46:15 - utils - INFO - Processing chunk 37 (1000000 rows)...
2025-11-11 16:46:34 - utils - INFO - Processing chunk 38 (1000000 rows)...
2025-11-11 16:46:54 - utils - INFO - Processing chunk 39 (1000000 rows)...
2025-11-11 16:47:14 - utils - INFO - Processing chunk 40 (1000000 rows)...
2025-11-11 16:47:34 - utils - INFO - Processing chunk 41 (1000000 rows)...
2025-11-11 16:47:53 - utils - INFO - Processing chunk 42 (1000000 rows)...
2025-11-11 16:48:14 - utils - INFO - Processing chunk 43 (1000000 rows)...
2025-11-11 16:48:34 - utils - INFO - Processing chunk 44 (1000000 rows)...
2025-11-11 16:48:54 - utils - INFO - Processing chunk 45 (1000000 rows)...
2025-11-11 16:49:15 - utils - INFO - Processing chunk 46 (1000000 rows)...
2025-11-11 16:49:35 - utils - INFO - Processing chunk 47 (1000000 rows)...
2025-11-11 16:49:53 - utils - INFO - Processing chunk 48 (1000000 rows)...
2025-11-11 16:50:09 - utils - INFO - Processing chunk 49 (1000000 rows)...
2025-11-11 16:50:27 - utils - INFO - Processing chunk 50 (1000000 rows)...
2025-11-11 16:50:47 - utils - INFO - Processing chunk 51 (1000000 rows)...
2025-11-11 16:51:08 - utils - INFO - Processing chunk 52 (1000000 rows)...
2025-11-11 16:51:27 - utils - INFO - Processing chunk 53 (1000000 rows)...
2025-11-11 16:51:47 - utils - INFO - Processing chunk 54 (1000000 rows)...
2025-11-11 16:52:07 - utils - INFO - Processing chunk 55 (1000000 rows)...
2025-11-11 16:52:27 - utils - INFO - Processing chunk 56 (1000000 rows)...
2025-11-11 16:52:47 - utils - INFO - Processing chunk 57 (1000000 rows)...
2025-11-11 16:53:07 - utils - INFO - Processing chunk 58 (1000000 rows)...
2025-11-11 16:53:27 - utils - INFO - Processing chunk 59 (1000000 rows)...
2025-11-11 16:53:47 - utils - INFO - Processing chunk 60 (1000000 rows)...
2025-11-11 16:54:06 - utils - INFO - Processing chunk 61 (1000000 rows)...
2025-11-11 16:54:26 - utils - INFO - Processing chunk 62 (1000000 rows)...
2025-11-11 16:54:45 - utils - INFO - Processing chunk 63 (1000000 rows)...
2025-11-11 16:55:05 - utils - INFO - Processing chunk 64 (1000000 rows)...
2025-11-11 16:55:24 - utils - INFO - Processing chunk 65 (1000000 rows)...
2025-11-11 16:55:43 - utils - INFO - Processing chunk 66 (1000000 rows)...
2025-11-11 16:56:03 - utils - INFO - Processing chunk 67 (1000000 rows)...
2025-11-11 16:56:22 - utils - INFO - Processing chunk 68 (1000000 rows)...
2025-11-11 16:56:41 - utils - INFO - Processing chunk 69 (1000000 rows)...
2025-11-11 16:57:01 - utils - INFO - Processing chunk 70 (1000000 rows)...
2025-11-11 16:57:20 - utils - INFO - Processing chunk 71 (1000000 rows)...
2025-11-11 16:57:39 - utils - INFO - Processing chunk 72 (1000000 rows)...
2025-11-11 16:57:59 - utils - INFO - Processing chunk 73 (1000000 rows)...
2025-11-11 16:58:18 - utils - INFO - Processing chunk 74 (1000000 rows)...
2025-11-11 16:58:37 - utils - INFO - Processing chunk 75 (1000000 rows)...
2025-11-11 16:58:56 - utils - INFO - Processing chunk 76 (1000000 rows)...
2025-11-11 16:59:17 - utils - INFO - Processing chunk 77 (1000000 rows)...
2025-11-11 16:59:38 - utils - INFO - Processing chunk 78 (1000000 rows)...
2025-11-11 16:59:59 - utils - INFO - Processing chunk 79 (1000000 rows)...
2025-11-11 17:00:19 - utils - INFO - Processing chunk 80 (1000000 rows)...
2025-11-11 17:00:39 - utils - INFO - Processing chunk 81 (1000000 rows)...
2025-11-11 17:00:56 - utils - INFO - Processing chunk 82 (429868 rows)...
2025-11-11 17:01:03 - utils - INFO - All chunks processed. Total rows: 81429868
2025-11-11 17:01:03 - utils - INFO - Total insider records labeled: 0
2025-11-11 17:01:03 - utils - INFO - Successfully created: /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs_r2_r3.1_r4.1_LABELED.csv
2025-11-11 17:01:03 - utils - INFO - ================================================================================
2025-11-11 17:01:03 - utils - INFO - V2 Labeling Complete!
2025-11-11 17:01:03 - utils - INFO - The file 'processed_unified_logs_r2_r3.1_r4.1_LABELED.csv' is now labeled.
2025-11-11 17:01:03 - utils - INFO - Next step: Run 'feature_engineering_v2.py'
2025-11-11 17:01:03 - utils - INFO - ================================================================================
2025-11-11 17:22:15 - utils - INFO - Utility functions loaded successfully
2025-11-11 17:22:15 - utils - INFO - Feature Engineer V2 initialized.
2025-11-11 17:22:15 - utils - INFO - 
================================================================================
                  FEATURE ENGINEERING PIPELINE V2 (MULTI-PASS)                  
================================================================================

2025-11-11 17:22:16 - utils - INFO - Found /Users/bipinrimal/Downloads/Thesis_work/data/processed/daily_features_unscaled_v2.csv, skipping Pass 1.
2025-11-11 17:22:16 - utils - INFO - 
================================================================================
                     PASS 2: FEATURE ENRICHMENT (Z-SCORES)                      
================================================================================

2025-11-11 17:22:16 - utils - ERROR - Failed to load LDAP data for role enrichment: No LDAP CSVs found in /Users/bipinrimal/Downloads/Thesis_work/data/all_data/LDAP
2025-11-11 17:22:16 - utils - WARNING - Could not load LDAP data. Peer-relative features will be skipped.
2025-11-11 17:22:16 - utils - INFO - Calculating self-relative Z-Scores (rolling 30-day)...
2025-11-11 17:22:18 - utils - INFO - Calculating peer-relative Z-Scores (by role)...
2025-11-11 17:22:18 - utils - INFO - PASS 2 complete. Enriched features created.
2025-11-11 17:22:18 - utils - INFO - Scaling and saving final daily features (for LSTM)...
2025-11-11 17:22:18 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/daily_feature_scaler_v2.pkl
2025-11-11 17:22:29 - utils - INFO - Saved /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_daily_features_v2.csv
2025-11-11 17:22:29 - utils - INFO - 
================================================================================
                        PASS 3: STATIC FEATURE CREATION                         
================================================================================

2025-11-11 17:22:29 - utils - INFO - Created static features for 3000 users
2025-11-11 17:22:29 - utils - INFO - Scaling and saving static features...
2025-11-11 17:22:29 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/static_feature_scaler_v2.pkl
2025-11-11 17:22:29 - utils - INFO - PASS 3 complete. Saved /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_static_features_v2.csv
2025-11-11 17:22:29 - utils - INFO - 
================================================================================
                           PASS 4: SEQUENCE CREATION                            
================================================================================

2025-11-11 17:22:29 - utils - INFO - Creating sequences (length=15, stride=10)...
2025-11-11 17:23:19 - utils - INFO - Created 97962 sequences from 3000 users
2025-11-11 17:23:19 - utils - INFO - PASS 4 complete. Saved sequence files to /Users/bipinrimal/Downloads/Thesis_work/data/processed
2025-11-11 17:23:19 - utils - INFO - ================================================================================
2025-11-11 17:23:19 - utils - INFO - V2 Feature Engineering Complete!
2025-11-11 17:23:19 - utils - INFO -   Static features created: /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_static_features_v2.csv
2025-11-11 17:23:19 - utils - INFO -   Sequence files created: /Users/bipinrimal/Downloads/Thesis_work/data/processed
2025-11-11 17:23:19 - utils - INFO - Next step: Train V2 models.
2025-11-11 17:23:19 - utils - INFO - ================================================================================
2025-11-11 17:24:02 - utils - INFO - Utility functions loaded successfully
2025-11-11 17:24:02 - utils - INFO - 
================================================================================
                 ISOLATION FOREST TRAINING (V2: MULTI-DATASET)                  
================================================================================

2025-11-11 17:24:02 - utils - INFO - Model loaded from /Users/bipinrimal/Downloads/Thesis_work/models/static_feature_scaler_v2.pkl
2025-11-11 17:24:02 - utils - INFO - Data split: 3000 total samples, 0 insiders
2025-11-11 17:24:02 - utils - INFO - Training on: 2400 normal samples
2025-11-11 17:24:02 - utils - INFO - Calibrating on: 600 normal samples
2025-11-11 17:24:02 - utils - INFO - Testing on: 3000 total samples (including 0 insiders)
2025-11-11 17:24:02 - utils - INFO - Initialized Isolation Forest (V2) with params: {'n_estimators': 50, 'max_samples': 256, 'contamination': 'auto', 'max_features': 1.0, 'bootstrap': False, 'n_jobs': -1, 'random_state': 42, 'verbose': 0}
2025-11-11 17:24:02 - utils - INFO - Training Isolation Forest on 2400 normal samples...
2025-11-11 17:24:02 - utils - INFO - Isolation Forest training completed
2025-11-11 17:24:02 - utils - INFO - Calibrating threshold for target FPR=0.05...
2025-11-11 17:24:02 - utils - INFO - Calibrated threshold: 0.5793
2025-11-11 17:24:02 - utils - INFO - Evaluating Isolation Forest (V2)...
2025-11-11 17:24:02 - utils - WARNING - No positive samples in test set. Metrics (Precision, Recall, F1, AUC-ROC) will be 0 or NaN.
2025-11-11 17:24:02 - utils - INFO - 
============================================================
2025-11-11 17:24:02 - utils - INFO - Isolation Forest (V2) Performance Metrics
2025-11-11 17:24:02 - utils - INFO - ============================================================
2025-11-11 17:24:02 - utils - INFO - Accuracy:  0.9547
2025-11-11 17:24:02 - utils - INFO - Precision: 0.0000
2025-11-11 17:24:02 - utils - INFO - Recall:    0.0000
2025-11-11 17:24:02 - utils - INFO - F1-Score:  0.0000
2025-11-11 17:24:02 - utils - INFO - AUC-ROC:   nan
2025-11-11 17:24:02 - utils - INFO - ============================================================

2025-11-11 17:24:02 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest_v2.pkl
2025-11-11 17:24:02 - utils - INFO - Saving Isolation Forest model to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest_v2.pkl
2025-11-11 17:24:02 - utils - INFO - Isolation Forest (V2) training and evaluation completed!
2025-11-11 17:25:25 - utils - INFO - Utility functions loaded successfully
2025-11-11 17:25:28 - utils - INFO - 
================================================================================
            LIGHTWEIGHT DEEP CLUSTERING TRAINING (V2: MULTI-DATASET)            
================================================================================

2025-11-11 17:25:28 - utils - INFO - Model loaded from /Users/bipinrimal/Downloads/Thesis_work/models/static_feature_scaler_v2.pkl
2025-11-11 17:25:28 - utils - INFO - Dataset: 3000 samples, 0 insiders
2025-11-11 17:25:28 - utils - INFO - Training on: 2400 normal samples
2025-11-11 17:25:28 - utils - INFO - Calibrating on: 600 normal samples
2025-11-11 17:25:28 - utils - INFO - Testing on: 3000 total samples (including 0 insiders)
2025-11-11 17:25:28 - utils - INFO - Initialized Lightweight Deep Clustering (V2) (n_clusters=5, encoding_dim=32)
2025-11-11 17:25:28 - utils - INFO - Training lightweight deep clustering model (V2)...
2025-11-11 17:25:28 - utils - INFO - Pre-training autoencoder...
2025-11-11 17:25:30 - utils - INFO - Autoencoder pre-training completed
2025-11-11 17:25:30 - utils - INFO - Fitting MiniBatch K-Means clustering...
2025-11-11 17:25:30 - utils - INFO - Deep clustering training completed
2025-11-11 17:25:30 - utils - INFO - Training completed in 1.42 seconds
2025-11-11 17:25:30 - utils - INFO - Calibrating threshold for target FPR=0.05...
2025-11-11 17:25:30 - utils - INFO - Calibrated threshold: 1.7741
2025-11-11 17:25:30 - utils - INFO - Evaluating lightweight deep clustering model (V2)...
2025-11-11 17:25:30 - utils - WARNING - No positive samples in test set. Metrics will be 0 or NaN.
2025-11-11 17:25:30 - utils - INFO - 
============================================================
2025-11-11 17:25:30 - utils - INFO - Deep Clustering (V2) Performance Metrics
2025-11-11 17:25:30 - utils - INFO - ============================================================
2025-11-11 17:25:30 - utils - INFO - Accuracy:  0.9603
2025-11-11 17:25:30 - utils - INFO - Precision: 0.0000
2025-11-11 17:25:30 - utils - INFO - Recall:    0.0000
2025-11-11 17:25:30 - utils - INFO - F1-Score:  0.0000
2025-11-11 17:25:30 - utils - INFO - AUC-ROC:   nan
2025-11-11 17:25:30 - utils - INFO - ============================================================

2025-11-11 17:25:30 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/deep_clustering_v2.pkl
2025-11-11 17:25:30 - utils - INFO - Encoder model saved to /Users/bipinrimal/Downloads/Thesis_work/models/deep_clustering_v2_encoder.keras
2025-11-11 17:25:30 - utils - INFO - Deep Clustering (V2) training and evaluation completed!
2025-11-11 17:25:45 - utils - INFO - Utility functions loaded successfully
2025-11-11 17:25:47 - utils - INFO - 
================================================================================
           LIGHTWEIGHT LSTM AUTOENCODER TRAINING (V2: MULTI-DATASET)            
================================================================================

2025-11-11 17:25:47 - utils - INFO - Loaded sequences: (97962, 15, 33), with 0 insider sequences
2025-11-11 17:25:47 - utils - INFO - Training on: 78369 normal sequences
2025-11-11 17:25:47 - utils - INFO - Calibrating on: 19593 normal sequences
2025-11-11 17:25:47 - utils - INFO - Testing on: 97962 total sequences (including 0 insider sequences)
2025-11-11 17:25:47 - utils - INFO - Initialized LSTM Autoencoder (V2) (15, 33)
2025-11-11 17:25:47 - utils - INFO - Training lightweight LSTM Autoencoder (V2)...
2025-11-11 17:25:47 - utils - INFO - Building lightweight LSTM Autoencoder...
2025-11-11 17:25:47 - utils - INFO - Model built with 21,329 parameters
2025-11-11 17:25:47 - utils - INFO - Training on 78369 sequences...
2025-11-11 17:27:20 - utils - INFO - Training completed
2025-11-11 17:27:20 - utils - INFO - Training completed in 92.50 seconds
2025-11-11 17:27:20 - utils - INFO - Calibrating threshold for target FPR=0.05
2025-11-11 17:27:21 - utils - INFO - Calibrated threshold: 0.2592
2025-11-11 17:27:21 - utils - INFO - Evaluating lightweight LSTM Autoencoder (V2)...
2025-11-11 17:27:22 - utils - WARNING - No positive samples in test set. Metrics (Precision, Recall, F1, AUC-ROC) will be 0 or NaN.
2025-11-11 17:27:23 - utils - INFO - 
============================================================
2025-11-11 17:27:23 - utils - INFO - LSTM Autoencoder (V2) Performance Metrics
2025-11-11 17:27:23 - utils - INFO - ============================================================
2025-11-11 17:27:23 - utils - INFO - Accuracy:  0.9528
2025-11-11 17:27:23 - utils - INFO - Precision: 0.0000
2025-11-11 17:27:23 - utils - INFO - Recall:    0.0000
2025-11-11 17:27:23 - utils - INFO - F1-Score:  0.0000
2025-11-11 17:27:23 - utils - INFO - AUC-ROC:   nan
2025-11-11 17:27:23 - utils - INFO - ============================================================

2025-11-11 17:27:23 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/lstm_autoencoder_v2.keras
2025-11-11 17:27:25 - utils - INFO - Lightweight LSTM Autoencoder (V2) completed!
2025-11-11 17:32:26 - utils - INFO - Utility functions loaded successfully
2025-11-11 17:32:26 - utils - INFO - Processing SUBSET defined in config: ['r2', 'r3.1', 'r4.1']
2025-11-11 17:32:26 - utils - INFO - Found 3 dataset folders to process.
2025-11-11 17:32:26 - utils - INFO - 
================================================================================
                 DATA PREPROCESSING PIPELINE (V2: MEMORY-SAFE)                  
================================================================================

2025-11-11 17:32:26 - utils - INFO - Did not find all temp files. Will re-process missing ones.
2025-11-11 17:32:26 - utils - INFO - Cleaning up old temporary files...
2025-11-11 17:32:26 - utils - INFO - Removed 0 old temp files.
2025-11-11 17:32:26 - utils - INFO - --- Processing single dataset: r2 ---
2025-11-11 17:32:26 - utils - INFO - Loaded logon.csv (840141 rows)
2025-11-11 17:32:27 - utils - INFO - Parsed datetime column: date
2025-11-11 17:32:27 - utils - INFO - Loaded device.csv (712308 rows)
2025-11-11 17:32:28 - utils - INFO - Parsed datetime column: date
2025-11-11 17:32:28 - utils - WARNING - file.csv not found in r2, skipping.
2025-11-11 17:32:29 - utils - INFO - Loaded email.csv (1189372 rows)
2025-11-11 17:32:30 - utils - INFO - Parsed datetime column: date
2025-11-11 17:32:35 - utils - INFO - Loaded http.csv (7321105 rows)
2025-11-11 17:32:42 - utils - INFO - Parsed datetime column: date
2025-11-11 17:32:48 - utils - INFO - Cleaning dataframe with 10062926 rows
2025-11-11 17:32:54 - utils - INFO - Removed 0 duplicate rows
2025-11-11 17:32:56 - utils - INFO - Missing values:
pc_id              1189372
activity           8510477
to                 8873554
url                2741821
domain             2741821
from              10062926
size              10062926
attachments       10062926
cc                10062926
bcc               10062926
filename          10062926
content           10062926
file_extension    10062926
dtype: int64
2025-11-11 17:33:40 - utils - INFO - Saved temporary file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r2.csv (10062926 rows)
2025-11-11 17:33:40 - utils - INFO - --- Processing single dataset: r3.1 ---
2025-11-11 17:33:41 - utils - INFO - Loaded logon.csv (842109 rows)
2025-11-11 17:33:41 - utils - INFO - Parsed datetime column: date
2025-11-11 17:33:42 - utils - INFO - Loaded device.csv (417588 rows)
2025-11-11 17:33:42 - utils - INFO - Parsed datetime column: date
2025-11-11 17:33:44 - utils - INFO - Loaded file.csv (457520 rows)
2025-11-11 17:33:44 - utils - INFO - Parsed datetime column: date
2025-11-11 17:33:51 - utils - INFO - Loaded email.csv (1994071 rows)
2025-11-11 17:33:53 - utils - INFO - Parsed datetime column: date
2025-11-11 17:38:39 - utils - INFO - Loaded http.csv (23555143 rows)
2025-11-11 17:39:08 - utils - INFO - Parsed datetime column: date
2025-11-11 17:40:11 - utils - INFO - Cleaning dataframe with 27266431 rows
2025-11-11 17:48:56 - utils - INFO - Removed 0 duplicate rows
2025-11-11 17:49:25 - utils - INFO - Missing values:
pc_id              1994071
activity          26006734
filename          26808911
content            1259697
file_extension    26808911
to                25272360
size              25272360
attachments       25272360
url                3711288
domain             3711288
from              27266431
cc                27266431
bcc               27266431
dtype: int64
2025-11-11 17:57:14 - utils - INFO - Saved temporary file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r3.1.csv (27266431 rows)
2025-11-11 17:57:43 - utils - INFO - --- Processing single dataset: r4.1 ---
2025-11-11 17:57:44 - utils - INFO - Loaded logon.csv (899118 rows)
2025-11-11 17:57:45 - utils - INFO - Parsed datetime column: date
2025-11-11 17:57:46 - utils - INFO - Loaded device.csv (437168 rows)
2025-11-11 17:57:46 - utils - INFO - Parsed datetime column: date
2025-11-11 17:57:48 - utils - INFO - Loaded file.csv (414556 rows)
2025-11-11 17:57:49 - utils - INFO - Parsed datetime column: date
2025-11-11 17:58:01 - utils - INFO - Loaded email.csv (2733360 rows)
2025-11-11 17:58:03 - utils - INFO - Parsed datetime column: date
2025-11-11 18:10:57 - utils - INFO - Loaded http.csv (29553383 rows)
2025-11-11 18:11:37 - utils - INFO - Parsed datetime column: date
2025-11-11 18:20:02 - utils - INFO - Cleaning dataframe with 34037585 rows
2025-11-11 18:33:41 - utils - INFO - Removed 0 duplicate rows
2025-11-11 18:34:43 - utils - INFO - Missing values:
activity          32701299
filename          33623029
content            1336286
file_extension    33623029
to                31304225
cc                32987711
bcc               33607961
from              31304225
size              31304225
attachments       31304225
url                4484202
domain             4484202
dtype: int64
2025-11-11 18:46:59 - utils - INFO - Saved temporary file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r4.1.csv (34037585 rows)
2025-11-11 18:48:35 - utils - INFO - Merging 3 processed temp files into master file...
2025-11-11 18:48:35 - utils - INFO - Merging temp_processed_r2.csv...
2025-11-11 18:49:43 - utils - INFO - Merging temp_processed_r3.1.csv...
2025-11-11 20:07:59 - utils - INFO - Utility functions loaded successfully
2025-11-11 20:07:59 - utils - ERROR - Preprocessed data not found. Run data_preprocessing.py first. Error: [Errno 2] No such file or directory: '/Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv'
2025-11-11 20:08:14 - utils - INFO - Utility functions loaded successfully
2025-11-11 20:08:14 - utils - INFO - Found 8 dataset folders in /Users/bipinrimal/Downloads/Thesis_work/data/all_data
2025-11-11 20:08:14 - utils - INFO - 
================================================================================
                 DATA PREPROCESSING PIPELINE (V2: MEMORY-SAFE)                  
================================================================================

2025-11-11 20:08:14 - utils - INFO - Cleaning up old temporary files...
2025-11-11 20:08:16 - utils - INFO - Removed 3 old temp files.
2025-11-11 20:08:16 - utils - INFO - --- Processing single dataset: r1 ---
2025-11-11 20:08:16 - utils - INFO - Loaded logon.csv (849579 rows)
2025-11-11 20:08:17 - utils - INFO - Parsed datetime column: date
2025-11-11 20:08:17 - utils - INFO - Loaded device.csv (65668 rows)
2025-11-11 20:08:17 - utils - INFO - Parsed datetime column: date
2025-11-11 20:08:17 - utils - WARNING - file.csv not found in r1, skipping.
2025-11-11 20:08:17 - utils - WARNING - email.csv not found in r1, skipping.
2025-11-11 20:08:19 - utils - INFO - Loaded http.csv (3451664 rows)
2025-11-11 20:08:19 - utils - WARNING - 'date' column not found in /Users/bipinrimal/Downloads/Thesis_work/data/all_data/r1/http.csv. Skipping file.
2025-11-11 20:08:19 - utils - INFO - Cleaning dataframe with 915247 rows
2025-11-11 20:08:20 - utils - INFO - Removed 0 duplicate rows
2025-11-11 20:08:22 - utils - INFO - Saved temporary file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r1.csv (915247 rows)
2025-11-11 20:08:22 - utils - INFO - --- Processing single dataset: r2 ---
2025-11-11 20:08:23 - utils - INFO - Loaded logon.csv (840141 rows)
2025-11-11 20:08:24 - utils - INFO - Parsed datetime column: date
2025-11-11 20:08:24 - utils - INFO - Loaded device.csv (712308 rows)
2025-11-11 20:08:25 - utils - INFO - Parsed datetime column: date
2025-11-11 20:08:25 - utils - WARNING - file.csv not found in r2, skipping.
2025-11-11 20:08:26 - utils - INFO - Loaded email.csv (1189372 rows)
2025-11-11 20:08:27 - utils - INFO - Parsed datetime column: date
2025-11-11 20:08:32 - utils - INFO - Loaded http.csv (7321105 rows)
2025-11-11 20:08:39 - utils - INFO - Parsed datetime column: date
2025-11-11 20:08:44 - utils - INFO - Cleaning dataframe with 10062926 rows
2025-11-11 20:08:50 - utils - INFO - Removed 0 duplicate rows
2025-11-11 20:08:52 - utils - INFO - Missing values:
pc_id       1189372
activity    8510477
to          8873554
url         2741821
domain      2741821
dtype: int64
2025-11-11 20:09:26 - utils - INFO - Saved temporary file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r2.csv (10062926 rows)
2025-11-11 20:09:26 - utils - INFO - --- Processing single dataset: r3.1 ---
2025-11-11 20:09:26 - utils - INFO - Loaded logon.csv (842109 rows)
2025-11-11 20:09:27 - utils - INFO - Parsed datetime column: date
2025-11-11 20:09:28 - utils - INFO - Loaded device.csv (417588 rows)
2025-11-11 20:09:28 - utils - INFO - Parsed datetime column: date
2025-11-11 20:09:29 - utils - INFO - Loaded file.csv (457520 rows)
2025-11-11 20:09:30 - utils - INFO - Parsed datetime column: date
2025-11-11 20:09:37 - utils - INFO - Loaded email.csv (1994071 rows)
2025-11-11 20:09:38 - utils - INFO - Parsed datetime column: date
2025-11-11 20:15:07 - utils - INFO - Loaded http.csv (23555143 rows)
2025-11-11 20:15:38 - utils - INFO - Parsed datetime column: date
2025-11-11 20:16:47 - utils - INFO - Cleaning dataframe with 27266431 rows
2025-11-11 20:21:08 - utils - INFO - Removed 0 duplicate rows
2025-11-11 20:21:29 - utils - INFO - Missing values:
pc_id           1994071
activity       26006734
filename       26808911
content         1259697
to             25272360
size           25272360
attachments    25272360
url             3711288
domain          3711288
dtype: int64
2025-11-11 20:25:33 - utils - INFO - Saved temporary file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r3.1.csv (27266431 rows)
2025-11-11 20:25:55 - utils - INFO - --- Processing single dataset: r3.2 ---
2025-11-11 20:25:56 - utils - INFO - Loaded logon.csv (845351 rows)
2025-11-11 20:25:57 - utils - INFO - Parsed datetime column: date
2025-11-11 20:25:58 - utils - INFO - Loaded device.csv (407908 rows)
2025-11-11 20:25:58 - utils - INFO - Parsed datetime column: date
2025-11-11 20:26:01 - utils - INFO - Loaded file.csv (434769 rows)
2025-11-11 20:26:01 - utils - INFO - Parsed datetime column: date
2025-11-11 20:26:15 - utils - INFO - Loaded email.csv (1975101 rows)
2025-11-11 20:26:17 - utils - INFO - Parsed datetime column: date
2025-11-11 20:30:46 - utils - INFO - Loaded http.csv (23845079 rows)
2025-11-11 20:31:13 - utils - INFO - Parsed datetime column: date
2025-11-11 20:32:21 - utils - INFO - Cleaning dataframe with 27508208 rows
2025-11-11 20:38:24 - utils - INFO - Removed 0 duplicate rows
2025-11-11 20:38:46 - utils - INFO - Missing values:
pc_id           1975101
activity       26254949
filename       27073439
content         1253259
to             25533107
size           25533107
attachments    25533107
url             3663129
domain          3663129
dtype: int64
2025-11-11 20:50:13 - utils - INFO - Saved temporary file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r3.2.csv (27508208 rows)
2025-11-11 20:50:42 - utils - INFO - --- Processing single dataset: r4.1 ---
2025-11-11 20:50:43 - utils - INFO - Loaded logon.csv (899118 rows)
2025-11-11 20:50:44 - utils - INFO - Parsed datetime column: date
2025-11-11 20:50:45 - utils - INFO - Loaded device.csv (437168 rows)
2025-11-11 20:50:45 - utils - INFO - Parsed datetime column: date
2025-11-11 20:50:48 - utils - INFO - Loaded file.csv (414556 rows)
2025-11-11 20:50:48 - utils - INFO - Parsed datetime column: date
2025-11-11 20:51:02 - utils - INFO - Loaded email.csv (2733360 rows)
2025-11-11 20:51:05 - utils - INFO - Parsed datetime column: date
2025-11-11 21:01:24 - utils - INFO - Loaded http.csv (29553383 rows)
2025-11-11 21:02:06 - utils - INFO - Parsed datetime column: date
2025-11-11 21:05:25 - utils - INFO - Cleaning dataframe with 34037585 rows
2025-11-11 21:16:16 - utils - INFO - Removed 0 duplicate rows
2025-11-11 21:17:06 - utils - INFO - Missing values:
activity       32701299
filename       33623029
content         1336286
to             31304225
cc             32987711
bcc            33607961
from           31304225
size           31304225
attachments    31304225
url             4484202
domain          4484202
dtype: int64
2025-11-11 21:23:49 - utils - INFO - Saved temporary file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r4.1.csv (34037585 rows)
2025-11-11 21:25:09 - utils - INFO - --- Processing single dataset: r4.2 ---
2025-11-11 21:25:10 - utils - INFO - Loaded logon.csv (854859 rows)
2025-11-11 21:25:11 - utils - INFO - Parsed datetime column: date
2025-11-11 21:25:11 - utils - INFO - Loaded device.csv (405380 rows)
2025-11-11 21:25:12 - utils - INFO - Parsed datetime column: date
2025-11-11 21:25:14 - utils - INFO - Loaded file.csv (445581 rows)
2025-11-11 21:25:15 - utils - INFO - Parsed datetime column: date
2025-11-11 21:25:29 - utils - INFO - Loaded email.csv (2629979 rows)
2025-11-11 21:25:32 - utils - INFO - Parsed datetime column: date
2025-11-11 21:47:45 - utils - INFO - Utility functions loaded successfully
2025-11-11 21:47:45 - utils - INFO - Found 8 dataset folders in /Users/bipinrimal/Downloads/Thesis_work/data/all_data
2025-11-11 21:47:45 - utils - INFO - 
================================================================================
                 DATA PREPROCESSING PIPELINE (V2: MEMORY-SAFE)                  
================================================================================

2025-11-11 21:47:45 - utils - INFO - Cleaning up old temporary files...
2025-11-11 21:47:46 - utils - INFO - Removed 5 old temp files.
2025-11-11 21:47:46 - utils - INFO - --- Processing single dataset: r1 ---
2025-11-11 21:47:47 - utils - INFO - Loaded logon.csv (849579 rows)
2025-11-11 21:47:47 - utils - INFO - Parsed datetime column: date
2025-11-11 21:47:48 - utils - INFO - Loaded device.csv (65668 rows)
2025-11-11 21:47:48 - utils - INFO - Parsed datetime column: date
2025-11-11 21:47:48 - utils - WARNING - file.csv not found in r1, skipping.
2025-11-11 21:47:48 - utils - WARNING - email.csv not found in r1, skipping.
2025-11-11 21:47:50 - utils - INFO - Loaded http.csv (3451664 rows)
2025-11-11 21:47:50 - utils - WARNING - 'date' column not found in /Users/bipinrimal/Downloads/Thesis_work/data/all_data/r1/http.csv. Skipping file.
2025-11-11 21:47:50 - utils - INFO - Cleaning dataframe with 915247 rows
2025-11-11 21:47:50 - utils - INFO - Removed 0 duplicate rows
2025-11-11 21:47:53 - utils - INFO - Saved temporary file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r1.csv (915247 rows)
2025-11-11 21:47:53 - utils - INFO - --- Processing single dataset: r2 ---
2025-11-11 21:47:53 - utils - INFO - Loaded logon.csv (840141 rows)
2025-11-11 21:47:54 - utils - INFO - Parsed datetime column: date
2025-11-11 21:47:54 - utils - INFO - Loaded device.csv (712308 rows)
2025-11-11 21:47:55 - utils - INFO - Parsed datetime column: date
2025-11-11 21:47:55 - utils - WARNING - file.csv not found in r2, skipping.
2025-11-11 21:47:56 - utils - INFO - Loaded email.csv (1189372 rows)
2025-11-11 21:47:57 - utils - INFO - Parsed datetime column: date
2025-11-11 21:48:02 - utils - INFO - Loaded http.csv (7321105 rows)
2025-11-11 21:48:09 - utils - INFO - Parsed datetime column: date
2025-11-11 21:48:15 - utils - INFO - Cleaning dataframe with 10062926 rows
2025-11-11 21:48:21 - utils - INFO - Removed 0 duplicate rows
2025-11-11 21:48:22 - utils - INFO - Missing values:
pc_id       1189372
activity    8510477
to          8873554
url         2741821
domain      2741821
dtype: int64
2025-11-11 21:48:57 - utils - INFO - Saved temporary file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r2.csv (10062926 rows)
2025-11-11 21:48:57 - utils - INFO - --- Processing single dataset: r3.1 ---
2025-11-11 21:48:57 - utils - INFO - Loaded logon.csv (842109 rows)
2025-11-11 21:48:58 - utils - INFO - Parsed datetime column: date
2025-11-11 21:48:59 - utils - INFO - Loaded device.csv (417588 rows)
2025-11-11 21:48:59 - utils - INFO - Parsed datetime column: date
2025-11-11 21:49:00 - utils - INFO - Loaded file.csv (457520 rows)
2025-11-11 21:49:01 - utils - INFO - Parsed datetime column: date
2025-11-11 21:49:08 - utils - INFO - Loaded email.csv (1994071 rows)
2025-11-11 21:49:10 - utils - INFO - Parsed datetime column: date
2025-11-11 21:54:09 - utils - INFO - Loaded http.csv (23555143 rows)
2025-11-11 21:54:38 - utils - INFO - Parsed datetime column: date
2025-11-11 21:55:51 - utils - INFO - Cleaning dataframe with 27266431 rows
2025-11-12 14:44:48 - utils - INFO - Utility functions loaded successfully
2025-11-12 14:44:48 - utils - INFO - Processing SUBSET defined in config: ['r1', 'r2', 'r3.1', 'r3.2']
2025-11-12 14:44:48 - utils - INFO - Found 4 dataset folders to process.
2025-11-12 14:44:48 - utils - INFO - 
================================================================================
                 DATA PREPROCESSING PIPELINE (V2: MEMORY-SAFE)                  
================================================================================

2025-11-12 14:44:48 - utils - INFO - Cleaning up old temporary files...
2025-11-12 14:44:48 - utils - INFO - Removed 2 old temp files.
2025-11-12 14:44:48 - utils - INFO - --- Processing single dataset: r1 ---
2025-11-12 14:44:48 - utils - INFO - Loaded logon.csv (849579 rows)
2025-11-12 14:44:49 - utils - INFO - Parsed datetime column: date
2025-11-12 14:44:49 - utils - INFO - Loaded device.csv (65668 rows)
2025-11-12 14:44:50 - utils - INFO - Parsed datetime column: date
2025-11-12 14:44:50 - utils - WARNING - file.csv not found in r1, skipping.
2025-11-12 14:44:50 - utils - WARNING - email.csv not found in r1, skipping.
2025-11-12 14:44:52 - utils - INFO - Loaded http.csv (3451664 rows)
2025-11-12 14:44:52 - utils - WARNING - 'date' column not found in /Users/bipinrimal/Downloads/Thesis_work/data/all_data/r1/http.csv. Skipping file.
2025-11-12 14:44:52 - utils - INFO - Cleaning dataframe with 915247 rows
2025-11-12 14:44:52 - utils - INFO - Removed 0 duplicate rows
2025-11-12 14:44:55 - utils - INFO - Saved temporary file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r1.csv (915247 rows)
2025-11-12 14:44:55 - utils - INFO - --- Processing single dataset: r2 ---
2025-11-12 14:44:55 - utils - INFO - Loaded logon.csv (840141 rows)
2025-11-12 14:44:56 - utils - INFO - Parsed datetime column: date
2025-11-12 14:44:57 - utils - INFO - Loaded device.csv (712308 rows)
2025-11-12 14:44:57 - utils - INFO - Parsed datetime column: date
2025-11-12 14:44:57 - utils - WARNING - file.csv not found in r2, skipping.
2025-11-12 14:44:58 - utils - INFO - Loaded email.csv (1189372 rows)
2025-11-12 14:44:59 - utils - INFO - Parsed datetime column: date
2025-11-12 14:45:05 - utils - INFO - Loaded http.csv (7321105 rows)
2025-11-12 14:45:11 - utils - INFO - Parsed datetime column: date
2025-11-12 14:45:18 - utils - INFO - Cleaning dataframe with 10062926 rows
2025-11-12 14:45:25 - utils - INFO - Removed 0 duplicate rows
2025-11-12 14:45:27 - utils - INFO - Missing values:
pc_id       1189372
activity    8510477
to          8873554
url         2741821
domain      2741821
dtype: int64
2025-11-12 14:45:59 - utils - INFO - Saved temporary file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r2.csv (10062926 rows)
2025-11-12 14:45:59 - utils - INFO - --- Processing single dataset: r3.1 ---
2025-11-12 14:45:59 - utils - INFO - Loaded logon.csv (842109 rows)
2025-11-12 14:46:00 - utils - INFO - Parsed datetime column: date
2025-11-12 14:46:01 - utils - INFO - Loaded device.csv (417588 rows)
2025-11-12 14:46:01 - utils - INFO - Parsed datetime column: date
2025-11-12 14:46:02 - utils - INFO - Loaded file.csv (457520 rows)
2025-11-12 14:46:03 - utils - INFO - Parsed datetime column: date
2025-11-12 14:46:10 - utils - INFO - Loaded email.csv (1994071 rows)
2025-11-12 14:46:12 - utils - INFO - Parsed datetime column: date
2025-11-12 14:53:30 - utils - INFO - Loaded http.csv (23555143 rows)
2025-11-12 14:54:01 - utils - INFO - Parsed datetime column: date
2025-11-12 14:55:04 - utils - INFO - Cleaning dataframe with 27266431 rows
2025-11-12 15:01:14 - utils - INFO - Removed 0 duplicate rows
2025-11-12 15:01:37 - utils - INFO - Missing values:
pc_id           1994071
activity       26006734
filename       26808911
content         1259697
to             25272360
size           25272360
attachments    25272360
url             3711288
domain          3711288
dtype: int64
2025-11-12 15:06:18 - utils - INFO - Saved temporary file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r3.1.csv (27266431 rows)
2025-11-12 15:06:45 - utils - INFO - --- Processing single dataset: r3.2 ---
2025-11-12 15:06:46 - utils - INFO - Loaded logon.csv (845351 rows)
2025-11-12 15:06:47 - utils - INFO - Parsed datetime column: date
2025-11-12 15:06:47 - utils - INFO - Loaded device.csv (407908 rows)
2025-11-12 15:06:48 - utils - INFO - Parsed datetime column: date
2025-11-12 15:06:51 - utils - INFO - Loaded file.csv (434769 rows)
2025-11-12 15:06:51 - utils - INFO - Parsed datetime column: date
2025-11-12 15:07:07 - utils - INFO - Loaded email.csv (1975101 rows)
2025-11-12 15:07:09 - utils - INFO - Parsed datetime column: date
2025-11-12 15:12:00 - utils - INFO - Loaded http.csv (23845079 rows)
2025-11-12 15:12:33 - utils - INFO - Parsed datetime column: date
2025-11-12 15:13:43 - utils - INFO - Cleaning dataframe with 27508208 rows
2025-11-12 15:23:51 - utils - INFO - Removed 0 duplicate rows
2025-11-12 15:24:20 - utils - INFO - Missing values:
pc_id           1975101
activity       26254949
filename       27073439
content         1253259
to             25533107
size           25533107
attachments    25533107
url             3663129
domain          3663129
dtype: int64
2025-11-12 15:31:55 - utils - INFO - Saved temporary file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r3.2.csv (27508208 rows)
2025-11-12 15:32:29 - utils - INFO - Merging 4 processed temp files into master file...
2025-11-12 15:32:29 - utils - INFO - Merging /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r1.csv...
2025-11-12 15:32:35 - utils - INFO - Merging /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r2.csv...
2025-11-12 15:34:55 - utils - INFO - Merging /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r3.1.csv...
2025-11-12 15:40:01 - utils - INFO - Merging /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r3.2.csv...
2025-11-12 15:45:07 - utils - INFO - Master dataframe created: 65752812 total rows
2025-11-12 15:45:07 - utils - INFO - Loading and merging static data (LDAP, Psychometric) via streaming...
2025-11-12 15:45:07 - utils - ERROR - Failed to load LDAP data: No objects to concatenate
2025-11-12 15:45:07 - utils - INFO - Loaded psychometric data for 2999 users
2025-11-12 15:45:08 - utils - ERROR - Failed to stream-merge static data: Error tokenizing data. C error: Expected 23 fields in line 915249, saw 26

2025-11-12 15:45:08 - utils - ERROR - Static data enrichment failed. Aborting.
2025-11-12 15:47:11 - utils - INFO - Utility functions loaded successfully
2025-11-12 15:47:11 - utils - INFO - 
================================================================================
                  LABELING INSIDER THREATS (V2: MULTI-DATASET)                  
================================================================================

2025-11-12 15:47:29 - utils - INFO - Utility functions loaded successfully
2025-11-12 15:47:29 - utils - INFO - 
================================================================================
                  LABELING INSIDER THREATS (V2: MULTI-DATASET)                  
================================================================================

2025-11-12 15:48:48 - utils - INFO - Utility functions loaded successfully
2025-11-12 15:48:48 - utils - INFO - Processing SUBSET defined in config: ['r1', 'r2', 'r3.1', 'r3.2']
2025-11-12 15:48:48 - utils - INFO - Found 4 dataset folders to process.
2025-11-12 15:48:48 - utils - INFO - 
================================================================================
                 DATA PREPROCESSING PIPELINE (V2: MEMORY-SAFE)                  
================================================================================

2025-11-12 15:48:48 - utils - INFO - Did not find all temp files. Will re-process missing ones.
2025-11-12 15:48:48 - utils - INFO - Cleaning up old temporary files...
2025-11-12 15:48:48 - utils - INFO - Removed 0 old temp files.
2025-11-12 15:48:48 - utils - INFO - --- Processing single dataset: r1 ---
2025-11-12 15:48:49 - utils - INFO - Loaded logon.csv (849579 rows)
2025-11-12 15:48:50 - utils - INFO - Parsed datetime column: date
2025-11-12 15:48:50 - utils - INFO - Loaded device.csv (65668 rows)
2025-11-12 15:48:50 - utils - INFO - Parsed datetime column: date
2025-11-12 15:48:50 - utils - WARNING - file.csv not found in r1, skipping.
2025-11-12 15:48:50 - utils - WARNING - email.csv not found in r1, skipping.
2025-11-12 15:48:52 - utils - INFO - Loaded http.csv (3451664 rows)
2025-11-12 15:48:52 - utils - WARNING - 'date' column not found in /Users/bipinrimal/Downloads/Thesis_work/data/all_data/r1/http.csv. Skipping file.
2025-11-12 15:48:52 - utils - INFO - Cleaning dataframe with 915247 rows
2025-11-12 15:48:53 - utils - INFO - Removed 0 duplicate rows
2025-11-12 15:48:53 - utils - INFO - Missing values:
to                915247
from              915247
size              915247
attachments       915247
cc                915247
bcc               915247
url               915247
domain            915247
filename          915247
content           915247
file_extension    915247
dtype: int64
2025-11-12 15:48:57 - utils - INFO - Saved temporary file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r1.csv (915247 rows)
2025-11-12 15:48:57 - utils - INFO - --- Processing single dataset: r2 ---
2025-11-12 15:48:57 - utils - INFO - Loaded logon.csv (840141 rows)
2025-11-12 15:48:58 - utils - INFO - Parsed datetime column: date
2025-11-12 15:48:59 - utils - INFO - Loaded device.csv (712308 rows)
2025-11-12 15:48:59 - utils - INFO - Parsed datetime column: date
2025-11-12 15:48:59 - utils - WARNING - file.csv not found in r2, skipping.
2025-11-12 15:49:00 - utils - INFO - Loaded email.csv (1189372 rows)
2025-11-12 15:49:02 - utils - INFO - Parsed datetime column: date
2025-11-12 15:49:07 - utils - INFO - Loaded http.csv (7321105 rows)
2025-11-12 15:49:14 - utils - INFO - Parsed datetime column: date
2025-11-12 15:49:21 - utils - INFO - Cleaning dataframe with 10062926 rows
2025-11-12 15:49:28 - utils - INFO - Removed 0 duplicate rows
2025-11-12 15:49:30 - utils - INFO - Missing values:
pc_id              1189372
activity           8510477
to                 8873554
from              10062926
size              10062926
attachments       10062926
cc                10062926
bcc               10062926
url                2741821
domain             2741821
filename          10062926
content           10062926
file_extension    10062926
dtype: int64
2025-11-12 15:50:18 - utils - INFO - Saved temporary file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r2.csv (10062926 rows)
2025-11-12 15:50:18 - utils - INFO - --- Processing single dataset: r3.1 ---
2025-11-12 15:50:18 - utils - INFO - Loaded logon.csv (842109 rows)
2025-11-12 15:50:19 - utils - INFO - Parsed datetime column: date
2025-11-12 15:50:19 - utils - INFO - Loaded device.csv (417588 rows)
2025-11-12 15:50:20 - utils - INFO - Parsed datetime column: date
2025-11-12 15:50:21 - utils - INFO - Loaded file.csv (457520 rows)
2025-11-12 15:50:22 - utils - INFO - Parsed datetime column: date
2025-11-12 15:50:28 - utils - INFO - Loaded email.csv (1994071 rows)
2025-11-12 15:50:30 - utils - INFO - Parsed datetime column: date
2025-11-12 15:55:46 - utils - INFO - Loaded http.csv (23555143 rows)
2025-11-12 15:56:13 - utils - INFO - Parsed datetime column: date
2025-11-12 15:58:01 - utils - INFO - Cleaning dataframe with 27266431 rows
2025-11-12 16:04:33 - utils - INFO - Removed 0 duplicate rows
2025-11-12 16:05:02 - utils - INFO - Missing values:
pc_id              1994071
activity          26006734
to                25272360
from              27266431
size              25272360
attachments       25272360
cc                27266431
bcc               27266431
url                3711288
domain             3711288
filename          26808911
content            1259697
file_extension    26808911
dtype: int64
2025-11-12 16:09:32 - utils - INFO - Saved temporary file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r3.1.csv (27266431 rows)
2025-11-12 16:09:57 - utils - INFO - --- Processing single dataset: r3.2 ---
2025-11-12 16:09:58 - utils - INFO - Loaded logon.csv (845351 rows)
2025-11-12 16:09:59 - utils - INFO - Parsed datetime column: date
2025-11-12 16:10:00 - utils - INFO - Loaded device.csv (407908 rows)
2025-11-12 16:10:00 - utils - INFO - Parsed datetime column: date
2025-11-12 16:10:03 - utils - INFO - Loaded file.csv (434769 rows)
2025-11-12 16:10:03 - utils - INFO - Parsed datetime column: date
2025-11-12 16:10:12 - utils - INFO - Loaded email.csv (1975101 rows)
2025-11-12 16:10:14 - utils - INFO - Parsed datetime column: date
2025-11-12 16:25:05 - utils - INFO - Utility functions loaded successfully
2025-11-12 16:25:05 - utils - INFO - Processing SUBSET defined in config: ['r1', 'r2', 'r3.1', 'r3.2']
2025-11-12 16:25:05 - utils - INFO - Found 4 dataset folders to process.
2025-11-12 16:25:05 - utils - INFO - 
================================================================================
                 DATA PREPROCESSING PIPELINE (V2: MEMORY-SAFE)                  
================================================================================

2025-11-12 16:25:05 - utils - INFO - Did not find all temp files. Will re-process missing ones.
2025-11-12 16:25:05 - utils - INFO - Cleaning up old temporary files...
2025-11-12 16:25:06 - utils - INFO - Removed 3 old temp files.
2025-11-12 16:25:06 - utils - INFO - --- Processing single dataset: r1 ---
2025-11-12 16:25:07 - utils - INFO - Loaded logon.csv (849579 rows)
2025-11-12 16:25:07 - utils - INFO - Parsed datetime column: date
2025-11-12 16:25:07 - utils - INFO - Loaded device.csv (65668 rows)
2025-11-12 16:25:08 - utils - INFO - Parsed datetime column: date
2025-11-12 16:25:08 - utils - WARNING - file.csv not found in r1, skipping.
2025-11-12 16:25:08 - utils - WARNING - email.csv not found in r1, skipping.
2025-11-12 16:25:10 - utils - INFO - Loaded http.csv (3451664 rows)
2025-11-12 16:25:10 - utils - WARNING - 'date' column not found in /Users/bipinrimal/Downloads/Thesis_work/data/all_data/r1/http.csv. Skipping file.
2025-11-12 16:25:10 - utils - INFO - Cleaning dataframe with 915247 rows
2025-11-12 16:25:11 - utils - INFO - Removed 0 duplicate rows
2025-11-12 16:25:11 - utils - INFO - Missing values:
to                915247
from              915247
size              915247
attachments       915247
cc                915247
bcc               915247
url               915247
domain            915247
filename          915247
content           915247
file_extension    915247
dtype: int64
2025-11-12 16:25:15 - utils - INFO - Saved temporary file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r1.csv (915247 rows)
2025-11-12 16:25:15 - utils - INFO - --- Processing single dataset: r2 ---
2025-11-12 16:25:16 - utils - INFO - Loaded logon.csv (840141 rows)
2025-11-12 16:25:16 - utils - INFO - Parsed datetime column: date
2025-11-12 16:25:17 - utils - INFO - Loaded device.csv (712308 rows)
2025-11-12 16:25:17 - utils - INFO - Parsed datetime column: date
2025-11-12 16:25:18 - utils - WARNING - file.csv not found in r2, skipping.
2025-11-12 16:25:19 - utils - INFO - Loaded email.csv (1189372 rows)
2025-11-12 16:25:20 - utils - INFO - Parsed datetime column: date
2025-11-12 16:25:25 - utils - INFO - Loaded http.csv (7321105 rows)
2025-11-12 16:25:32 - utils - INFO - Parsed datetime column: date
2025-11-12 16:25:39 - utils - INFO - Cleaning dataframe with 10062926 rows
2025-11-12 16:25:47 - utils - INFO - Removed 0 duplicate rows
2025-11-12 16:25:48 - utils - INFO - Missing values:
pc_id              1189372
activity           8510477
to                 8873554
from              10062926
size              10062926
attachments       10062926
cc                10062926
bcc               10062926
url                2741821
domain             2741821
filename          10062926
content           10062926
file_extension    10062926
dtype: int64
2025-11-12 16:28:42 - utils - INFO - Saved temporary file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r2.csv (10062926 rows)
2025-11-12 16:28:43 - utils - INFO - --- Processing single dataset: r3.1 ---
2025-11-12 16:28:43 - utils - INFO - Loaded logon.csv (842109 rows)
2025-11-12 16:28:44 - utils - INFO - Parsed datetime column: date
2025-11-12 16:28:44 - utils - INFO - Loaded device.csv (417588 rows)
2025-11-12 16:28:45 - utils - INFO - Parsed datetime column: date
2025-11-12 16:28:46 - utils - INFO - Loaded file.csv (457520 rows)
2025-11-12 16:28:47 - utils - INFO - Parsed datetime column: date
2025-11-12 16:28:54 - utils - INFO - Loaded email.csv (1994071 rows)
2025-11-12 16:28:56 - utils - INFO - Parsed datetime column: date
2025-11-12 16:33:25 - utils - INFO - Loaded http.csv (23555143 rows)
2025-11-12 16:33:51 - utils - INFO - Parsed datetime column: date
2025-11-12 16:35:38 - utils - INFO - Cleaning dataframe with 27266431 rows
2025-11-12 16:41:19 - utils - INFO - Removed 0 duplicate rows
2025-11-12 16:41:49 - utils - INFO - Missing values:
pc_id              1994071
activity          26006734
to                25272360
from              27266431
size              25272360
attachments       25272360
cc                27266431
bcc               27266431
url                3711288
domain             3711288
filename          26808911
content            1259697
file_extension    26808911
dtype: int64
2025-11-12 16:46:16 - utils - INFO - Saved temporary file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r3.1.csv (27266431 rows)
2025-11-12 16:46:39 - utils - INFO - --- Processing single dataset: r3.2 ---
2025-11-12 16:46:40 - utils - INFO - Loaded logon.csv (845351 rows)
2025-11-12 16:46:41 - utils - INFO - Parsed datetime column: date
2025-11-12 16:46:41 - utils - INFO - Loaded device.csv (407908 rows)
2025-11-12 16:46:42 - utils - INFO - Parsed datetime column: date
2025-11-12 16:46:44 - utils - INFO - Loaded file.csv (434769 rows)
2025-11-12 16:46:44 - utils - INFO - Parsed datetime column: date
2025-11-12 16:46:53 - utils - INFO - Loaded email.csv (1975101 rows)
2025-11-12 16:46:55 - utils - INFO - Parsed datetime column: date
2025-11-12 20:04:52 - utils - INFO - Utility functions loaded successfully
2025-11-12 20:04:52 - utils - INFO - Processing SUBSET defined in config: ['r1', 'r2', 'r3.1']
2025-11-12 20:04:52 - utils - INFO - Found 3 dataset folders to process.
2025-11-12 20:04:52 - utils - INFO - 
================================================================================
                 DATA PREPROCESSING PIPELINE (V2: MEMORY-SAFE)                  
================================================================================

2025-11-12 20:04:52 - utils - INFO - Found 3 existing temp files. Will skip processing and go straight to merging.
2025-11-12 20:04:52 - utils - INFO - Merging 3 processed temp files into master file...
2025-11-12 20:04:52 - utils - INFO - Merging /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r1.csv...
2025-11-12 20:04:56 - utils - INFO - Merging /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r2.csv...
2025-11-12 20:05:49 - utils - INFO - Merging /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r3.1.csv...
2025-11-12 20:10:45 - utils - INFO - Master dataframe created: 38244604 total rows
2025-11-12 20:10:45 - utils - INFO - Loading and merging static data (LDAP, Psychometric) via streaming...
2025-11-12 20:10:45 - utils - INFO - Scanning for LDAP data in shared folder: /Users/bipinrimal/Downloads/Thesis_work/data/all_data/LDAP
2025-11-12 20:10:45 - utils - ERROR - Failed to load/merge LDAP data: LDAP folder not found at /Users/bipinrimal/Downloads/Thesis_work/data/all_data/LDAP
2025-11-12 20:10:45 - utils - INFO - Loaded and de-duplicated psychometric data for 1999 users
2025-11-12 20:10:46 - utils - INFO - Enriching chunk 1...
2025-11-12 20:10:53 - utils - INFO - Enriching chunk 2...
2025-11-12 20:10:59 - utils - INFO - Enriching chunk 3...
2025-11-12 20:11:06 - utils - INFO - Enriching chunk 4...
2025-11-12 20:11:13 - utils - INFO - Enriching chunk 5...
2025-11-12 20:11:20 - utils - INFO - Enriching chunk 6...
2025-11-12 20:11:27 - utils - INFO - Enriching chunk 7...
2025-11-12 20:11:34 - utils - INFO - Enriching chunk 8...
2025-11-12 20:11:40 - utils - INFO - Enriching chunk 9...
2025-11-12 20:11:47 - utils - INFO - Enriching chunk 10...
2025-11-12 20:11:54 - utils - INFO - Enriching chunk 11...
2025-11-12 20:12:01 - utils - INFO - Enriching chunk 12...
2025-11-12 20:12:09 - utils - INFO - Enriching chunk 13...
2025-11-12 20:12:22 - utils - INFO - Enriching chunk 14...
2025-11-12 20:12:37 - utils - INFO - Enriching chunk 15...
2025-11-12 20:12:51 - utils - INFO - Enriching chunk 16...
2025-11-12 20:13:05 - utils - INFO - Enriching chunk 17...
2025-11-12 20:13:19 - utils - INFO - Enriching chunk 18...
2025-11-12 20:13:32 - utils - INFO - Enriching chunk 19...
2025-11-12 20:13:45 - utils - INFO - Enriching chunk 20...
2025-11-12 20:13:58 - utils - INFO - Enriching chunk 21...
2025-11-12 20:14:10 - utils - INFO - Enriching chunk 22...
2025-11-12 20:14:23 - utils - INFO - Enriching chunk 23...
2025-11-12 20:14:36 - utils - INFO - Enriching chunk 24...
2025-11-12 20:14:50 - utils - INFO - Enriching chunk 25...
2025-11-12 20:15:02 - utils - INFO - Enriching chunk 26...
2025-11-12 20:15:14 - utils - INFO - Enriching chunk 27...
2025-11-12 20:15:26 - utils - INFO - Enriching chunk 28...
2025-11-12 20:15:38 - utils - INFO - Enriching chunk 29...
2025-11-12 20:15:50 - utils - INFO - Enriching chunk 30...
2025-11-12 20:16:02 - utils - INFO - Enriching chunk 31...
2025-11-12 20:16:14 - utils - INFO - Enriching chunk 32...
2025-11-12 20:16:26 - utils - INFO - Enriching chunk 33...
2025-11-12 20:16:38 - utils - INFO - Enriching chunk 34...
2025-11-12 20:16:50 - utils - INFO - Enriching chunk 35...
2025-11-12 20:17:02 - utils - INFO - Enriching chunk 36...
2025-11-12 20:17:14 - utils - INFO - Enriching chunk 37...
2025-11-12 20:17:26 - utils - INFO - Enriching chunk 38...
2025-11-12 20:17:35 - utils - INFO - Enriching chunk 39...
2025-11-12 20:17:37 - utils - INFO - Enrichment complete. Replacing master file...
2025-11-12 20:17:38 - utils - INFO - Successfully created final enriched file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs_r1_r2_r3.1_ENRICHED.csv
2025-11-12 20:17:38 - utils - INFO - Performing final pass (cleanup and label init)...
2025-11-12 20:17:40 - utils - INFO - Finalizing chunk 1...
2025-11-12 20:17:48 - utils - INFO - Finalizing chunk 2...
2025-11-12 20:17:55 - utils - INFO - Finalizing chunk 3...
2025-11-12 20:18:03 - utils - INFO - Finalizing chunk 4...
2025-11-12 20:18:12 - utils - INFO - Finalizing chunk 5...
2025-11-12 20:18:19 - utils - INFO - Finalizing chunk 6...
2025-11-12 20:18:27 - utils - INFO - Finalizing chunk 7...
2025-11-12 20:18:34 - utils - INFO - Finalizing chunk 8...
2025-11-12 20:18:41 - utils - INFO - Finalizing chunk 9...
2025-11-12 20:18:49 - utils - INFO - Finalizing chunk 10...
2025-11-12 20:18:56 - utils - INFO - Finalizing chunk 11...
2025-11-12 20:19:04 - utils - INFO - Finalizing chunk 12...
2025-11-12 20:19:13 - utils - INFO - Finalizing chunk 13...
2025-11-12 20:19:27 - utils - INFO - Finalizing chunk 14...
2025-11-12 20:19:42 - utils - INFO - Finalizing chunk 15...
2025-11-12 20:19:56 - utils - INFO - Finalizing chunk 16...
2025-11-12 20:20:10 - utils - INFO - Finalizing chunk 17...
2025-11-12 20:20:23 - utils - INFO - Finalizing chunk 18...
2025-11-12 20:20:36 - utils - INFO - Finalizing chunk 19...
2025-11-12 20:20:50 - utils - INFO - Finalizing chunk 20...
2025-11-12 20:21:03 - utils - INFO - Finalizing chunk 21...
2025-11-12 20:21:17 - utils - INFO - Finalizing chunk 22...
2025-11-12 20:21:30 - utils - INFO - Finalizing chunk 23...
2025-11-12 20:21:44 - utils - INFO - Finalizing chunk 24...
2025-11-12 20:21:57 - utils - INFO - Finalizing chunk 25...
2025-11-12 20:22:10 - utils - INFO - Finalizing chunk 26...
2025-11-12 20:22:24 - utils - INFO - Finalizing chunk 27...
2025-11-12 20:22:37 - utils - INFO - Finalizing chunk 28...
2025-11-12 20:22:50 - utils - INFO - Finalizing chunk 29...
2025-11-12 20:23:03 - utils - INFO - Finalizing chunk 30...
2025-11-12 20:23:16 - utils - INFO - Finalizing chunk 31...
2025-11-12 20:23:30 - utils - INFO - Finalizing chunk 32...
2025-11-12 20:23:43 - utils - INFO - Finalizing chunk 33...
2025-11-12 20:23:56 - utils - INFO - Finalizing chunk 34...
2025-11-12 20:24:09 - utils - INFO - Finalizing chunk 35...
2025-11-12 20:24:23 - utils - INFO - Finalizing chunk 36...
2025-11-12 20:24:36 - utils - INFO - Finalizing chunk 37...
2025-11-12 20:24:49 - utils - INFO - Finalizing chunk 38...
2025-11-12 20:24:59 - utils - INFO - Finalizing chunk 39...
2025-11-12 20:25:05 - utils - INFO - ================================================================================
2025-11-12 20:25:05 - utils - INFO - V2 Preprocessing Complete!
2025-11-12 20:25:05 - utils - INFO - Master file saved: processed_unified_logs_r1_r2_r3.1_ENRICHED.csv (38244604 rows)
2025-11-12 20:25:05 - utils - INFO - Next step: python label_insiders_v2.py
2025-11-12 20:25:05 - utils - INFO - ================================================================================
2025-11-12 20:28:08 - utils - INFO - Utility functions loaded successfully
2025-11-12 20:28:08 - utils - INFO - 
================================================================================
                  LABELING INSIDER THREATS (V2: MULTI-DATASET)                  
================================================================================

2025-11-12 20:28:08 - utils - INFO - Loading CMU-CERT master answers file (insiders.csv)...
2025-11-12 20:28:08 - utils - INFO - Loaded 191 total insider incidents
2025-11-12 20:28:08 - utils - WARNING - Could not parse dates for CDE1846 in 6.2: month must be in 1..12: /21/2011 11:43:39, at position 0
2025-11-12 20:28:08 - utils - INFO - Parsed 190 insider activity rules
2025-11-12 20:28:10 - utils - INFO - Processing chunk 1 (1000000 rows)...
2025-11-12 20:28:25 - utils - INFO - Processing chunk 2 (1000000 rows)...
2025-11-12 20:28:39 - utils - INFO - Processing chunk 3 (1000000 rows)...
2025-11-12 20:28:54 - utils - INFO - Processing chunk 4 (1000000 rows)...
2025-11-12 20:29:09 - utils - INFO - Processing chunk 5 (1000000 rows)...
2025-11-12 20:29:25 - utils - INFO - Processing chunk 6 (1000000 rows)...
2025-11-12 20:29:40 - utils - INFO - Processing chunk 7 (1000000 rows)...
2025-11-12 20:29:55 - utils - INFO - Processing chunk 8 (1000000 rows)...
2025-11-12 20:30:10 - utils - INFO - Processing chunk 9 (1000000 rows)...
2025-11-12 20:30:26 - utils - INFO - Processing chunk 10 (1000000 rows)...
2025-11-12 20:30:41 - utils - INFO - Processing chunk 11 (1000000 rows)...
2025-11-12 20:30:56 - utils - INFO - Processing chunk 12 (1000000 rows)...
2025-11-12 20:31:14 - utils - INFO - Processing chunk 13 (1000000 rows)...
2025-11-12 20:31:36 - utils - INFO - Processing chunk 14 (1000000 rows)...
2025-11-12 20:31:59 - utils - INFO - Processing chunk 15 (1000000 rows)...
2025-11-12 20:32:20 - utils - INFO - Processing chunk 16 (1000000 rows)...
2025-11-12 20:32:41 - utils - INFO - Processing chunk 17 (1000000 rows)...
2025-11-12 20:33:02 - utils - INFO - Processing chunk 18 (1000000 rows)...
2025-11-12 20:33:23 - utils - INFO - Processing chunk 19 (1000000 rows)...
2025-11-12 20:33:44 - utils - INFO - Processing chunk 20 (1000000 rows)...
2025-11-12 20:34:04 - utils - INFO - Processing chunk 21 (1000000 rows)...
2025-11-12 20:34:26 - utils - INFO - Processing chunk 22 (1000000 rows)...
2025-11-12 20:34:47 - utils - INFO - Processing chunk 23 (1000000 rows)...
2025-11-12 20:35:08 - utils - INFO - Processing chunk 24 (1000000 rows)...
2025-11-12 20:35:29 - utils - INFO - Processing chunk 25 (1000000 rows)...
2025-11-12 20:35:50 - utils - INFO - Processing chunk 26 (1000000 rows)...
2025-11-12 20:36:11 - utils - INFO - Processing chunk 27 (1000000 rows)...
2025-11-12 20:36:32 - utils - INFO - Processing chunk 28 (1000000 rows)...
2025-11-12 20:36:52 - utils - INFO - Processing chunk 29 (1000000 rows)...
2025-11-12 20:37:13 - utils - INFO - Processing chunk 30 (1000000 rows)...
2025-11-12 20:37:34 - utils - INFO - Processing chunk 31 (1000000 rows)...
2025-11-12 20:37:55 - utils - INFO - Processing chunk 32 (1000000 rows)...
2025-11-12 20:38:16 - utils - INFO - Processing chunk 33 (1000000 rows)...
2025-11-12 20:38:37 - utils - INFO - Processing chunk 34 (1000000 rows)...
2025-11-12 20:38:58 - utils - INFO - Processing chunk 35 (1000000 rows)...
2025-11-12 20:39:18 - utils - INFO - Processing chunk 36 (1000000 rows)...
2025-11-12 20:39:39 - utils - INFO - Processing chunk 37 (1000000 rows)...
2025-11-12 20:40:00 - utils - INFO - Processing chunk 38 (1000000 rows)...
2025-11-12 20:40:16 - utils - INFO - Processing chunk 39 (244604 rows)...
2025-11-12 20:40:20 - utils - INFO - All chunks processed. Total rows: 38244604
2025-11-12 20:40:20 - utils - INFO - Total insider records labeled: 0
2025-11-12 20:40:20 - utils - INFO - Successfully created: /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs_r1_r2_r3.1_LABELED.csv
2025-11-12 20:40:20 - utils - INFO - ================================================================================
2025-11-12 20:40:20 - utils - INFO - V2 Labeling Complete!
2025-11-12 20:40:20 - utils - INFO - The file 'processed_unified_logs_r1_r2_r3.1_LABELED.csv' is now labeled.
2025-11-12 20:40:20 - utils - INFO - Next step: Run 'feature_engineering_v2.py'
2025-11-12 20:40:20 - utils - INFO - ================================================================================
2025-11-12 20:44:32 - utils - INFO - Utility functions loaded successfully
2025-11-12 20:44:32 - utils - INFO - Feature Engineer V2 initialized.
2025-11-12 20:44:32 - utils - INFO - 
================================================================================
                  FEATURE ENGINEERING PIPELINE V2 (MULTI-PASS)                  
================================================================================

2025-11-12 20:44:32 - utils - INFO - 
================================================================================
                           PASS 1: DAILY AGGREGATION                            
================================================================================

2025-11-12 20:46:02 - utils - INFO - Utility functions loaded successfully
2025-11-12 20:46:02 - utils - INFO - 
================================================================================
                             LDAP DATA PATCH SCRIPT                             
================================================================================

2025-11-12 20:46:02 - utils - INFO - Loading LDAP data for subset: ['r1', 'r2', 'r3.1']
2025-11-12 20:46:02 - utils - INFO - Scanning for LDAP data in dataset folders...
2025-11-12 20:46:02 - utils - INFO - Loaded and de-duplicated LDAP data for 2999 users
2025-11-12 20:46:07 - utils - INFO - Patching chunk 1...
2025-11-12 20:46:23 - utils - INFO - Patching chunk 2...
2025-11-12 20:46:40 - utils - INFO - Patching chunk 3...
2025-11-12 20:46:55 - utils - INFO - Patching chunk 4...
2025-11-12 20:47:11 - utils - INFO - Patching chunk 5...
2025-11-12 20:47:27 - utils - INFO - Patching chunk 6...
2025-11-12 20:47:49 - utils - INFO - Patching chunk 7...
2025-11-12 20:48:18 - utils - INFO - Patching chunk 8...
2025-11-12 20:48:47 - utils - INFO - Patching chunk 9...
2025-11-12 20:49:15 - utils - INFO - Patching chunk 10...
2025-11-12 20:49:43 - utils - INFO - Patching chunk 11...
2025-11-12 20:50:11 - utils - INFO - Patching chunk 12...
2025-11-12 20:50:39 - utils - INFO - Patching chunk 13...
2025-11-12 20:51:06 - utils - INFO - Patching chunk 14...
2025-11-12 20:51:35 - utils - INFO - Patching chunk 15...
2025-11-12 20:52:03 - utils - INFO - Patching chunk 16...
2025-11-12 20:52:31 - utils - INFO - Patching chunk 17...
2025-11-12 20:52:59 - utils - INFO - Patching chunk 18...
2025-11-12 20:53:26 - utils - INFO - Patching chunk 19...
2025-11-12 20:53:45 - utils - INFO - Patching chunk 20...
2025-11-12 20:53:47 - utils - INFO - Patching complete. Replacing original file...
2025-11-12 20:53:47 - utils - INFO - Successfully patched processed_unified_logs_r1_r2_r3.1_ENRICHED.csv
2025-11-12 20:53:47 - utils - INFO - ================================================================================
2025-11-12 20:53:47 - utils - INFO - PATCH COMPLETE.
2025-11-12 20:53:47 - utils - INFO - Next step: python label_insiders_v2.py
2025-11-12 20:53:47 - utils - INFO - ================================================================================
2025-11-12 20:55:50 - utils - INFO - Utility functions loaded successfully
2025-11-12 20:55:50 - utils - INFO - 
================================================================================
                  LABELING INSIDER THREATS (V2: MULTI-DATASET)                  
================================================================================

2025-11-12 20:55:50 - utils - INFO - Loading CMU-CERT master answers file (insiders.csv)...
2025-11-12 20:55:50 - utils - INFO - Loaded 191 total insider incidents
2025-11-12 20:55:50 - utils - WARNING - Could not parse dates for CDE1846 in 6.2: month must be in 1..12: /21/2011 11:43:39, at position 0
2025-11-12 20:55:50 - utils - INFO - Parsed 190 insider activity rules
2025-11-12 20:55:52 - utils - INFO - Processing chunk 1 (1000000 rows)...
2025-11-12 20:56:07 - utils - INFO - Processing chunk 2 (1000000 rows)...
2025-11-12 20:56:22 - utils - INFO - Processing chunk 3 (1000000 rows)...
2025-11-12 20:56:39 - utils - INFO - Processing chunk 4 (1000000 rows)...
2025-11-12 20:56:55 - utils - INFO - Processing chunk 5 (1000000 rows)...
2025-11-12 20:57:10 - utils - INFO - Processing chunk 6 (1000000 rows)...
2025-11-12 20:57:26 - utils - INFO - Processing chunk 7 (1000000 rows)...
2025-11-12 20:57:42 - utils - INFO - Processing chunk 8 (1000000 rows)...
2025-11-12 20:57:57 - utils - INFO - Processing chunk 9 (1000000 rows)...
2025-11-12 20:58:13 - utils - INFO - Processing chunk 10 (1000000 rows)...
2025-11-12 20:58:29 - utils - INFO - Processing chunk 11 (1000000 rows)...
2025-11-12 20:58:45 - utils - INFO - Processing chunk 12 (1000000 rows)...
2025-11-12 20:59:03 - utils - INFO - Processing chunk 13 (1000000 rows)...
2025-11-12 20:59:24 - utils - INFO - Processing chunk 14 (1000000 rows)...
2025-11-12 20:59:48 - utils - INFO - Processing chunk 15 (1000000 rows)...
2025-11-12 21:00:10 - utils - INFO - Processing chunk 16 (1000000 rows)...
2025-11-12 21:00:32 - utils - INFO - Processing chunk 17 (1000000 rows)...
2025-11-12 21:00:54 - utils - INFO - Processing chunk 18 (1000000 rows)...
2025-11-12 21:01:16 - utils - INFO - Processing chunk 19 (1000000 rows)...
2025-11-12 21:01:38 - utils - INFO - Processing chunk 20 (1000000 rows)...
2025-11-12 21:01:59 - utils - INFO - Processing chunk 21 (1000000 rows)...
2025-11-12 21:02:21 - utils - INFO - Processing chunk 22 (1000000 rows)...
2025-11-12 21:02:42 - utils - INFO - Processing chunk 23 (1000000 rows)...
2025-11-12 21:03:04 - utils - INFO - Processing chunk 24 (1000000 rows)...
2025-11-12 21:03:26 - utils - INFO - Processing chunk 25 (1000000 rows)...
2025-11-12 21:03:48 - utils - INFO - Processing chunk 26 (1000000 rows)...
2025-11-12 21:04:09 - utils - INFO - Processing chunk 27 (1000000 rows)...
2025-11-12 21:04:31 - utils - INFO - Processing chunk 28 (1000000 rows)...
2025-11-12 21:04:52 - utils - INFO - Processing chunk 29 (1000000 rows)...
2025-11-12 21:05:14 - utils - INFO - Processing chunk 30 (1000000 rows)...
2025-11-12 21:05:35 - utils - INFO - Processing chunk 31 (1000000 rows)...
2025-11-12 21:05:57 - utils - INFO - Processing chunk 32 (1000000 rows)...
2025-11-12 21:06:17 - utils - INFO - Processing chunk 33 (1000000 rows)...
2025-11-12 21:06:38 - utils - INFO - Processing chunk 34 (1000000 rows)...
2025-11-12 21:06:59 - utils - INFO - Processing chunk 35 (1000000 rows)...
2025-11-12 21:07:20 - utils - INFO - Processing chunk 36 (1000000 rows)...
2025-11-12 21:07:41 - utils - INFO - Processing chunk 37 (1000000 rows)...
2025-11-12 21:08:02 - utils - INFO - Processing chunk 38 (1000000 rows)...
2025-11-12 21:08:20 - utils - INFO - Processing chunk 39 (244604 rows)...
2025-11-12 21:08:24 - utils - INFO - All chunks processed. Total rows: 38244604
2025-11-12 21:08:24 - utils - INFO - Total insider records labeled: 0
2025-11-12 21:08:24 - utils - INFO - Successfully created: /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs_r1_r2_r3.1_LABELED.csv
2025-11-12 21:08:24 - utils - INFO - ================================================================================
2025-11-12 21:08:24 - utils - INFO - V2 Labeling Complete!
2025-11-12 21:08:24 - utils - INFO - The file 'processed_unified_logs_r1_r2_r3.1_LABELED.csv' is now labeled.
2025-11-12 21:08:24 - utils - INFO - Next step: Run 'feature_engineering_v2.py'
2025-11-12 21:08:24 - utils - INFO - ================================================================================
2025-11-12 21:22:40 - utils - INFO - Utility functions loaded successfully
2025-11-12 21:22:40 - utils - INFO - 
================================================================================
                  LABELING INSIDER THREATS (V2: MULTI-DATASET)                  
================================================================================

2025-11-12 21:22:40 - utils - INFO - Loading CMU-CERT master answers file (insiders.csv)...
2025-11-12 21:22:40 - utils - INFO - Loaded 191 total insider incidents
2025-11-12 21:22:40 - utils - WARNING - Could not parse dates for CDE1846 in 6.2: month must be in 1..12: /21/2011 11:43:39, at position 0
2025-11-12 21:22:40 - utils - INFO - Parsed and normalized 190 insider activity rules
2025-11-12 21:22:40 - utils - INFO - Sample of normalized rules:
2025-11-12 21:22:40 - utils - INFO -   - User: ONS0995, Dataset: 2.0, Start: 2010-03-06
2025-11-12 21:22:40 - utils - INFO -   - User: CSF0929, Dataset: 3.1, Start: 2010-07-01
2025-11-12 21:22:40 - utils - INFO -   - User: CCH0959, Dataset: 3.1, Start: 2010-08-02
2025-11-12 21:22:40 - utils - INFO -   ...and 187 more.
2025-11-12 21:22:42 - utils - INFO - Processing chunk 1 (1000000 rows)...
2025-11-12 21:22:51 - utils - INFO - Processing chunk 2 (1000000 rows)...
2025-11-12 21:23:00 - utils - INFO - Processing chunk 3 (1000000 rows)...
2025-11-12 21:23:09 - utils - INFO - Processing chunk 4 (1000000 rows)...
2025-11-12 21:23:18 - utils - INFO - Processing chunk 5 (1000000 rows)...
2025-11-12 21:23:27 - utils - INFO - Processing chunk 6 (1000000 rows)...
2025-11-12 21:23:35 - utils - INFO - Processing chunk 7 (1000000 rows)...
2025-11-12 21:23:44 - utils - INFO - Processing chunk 8 (1000000 rows)...
2025-11-12 21:23:52 - utils - INFO - Processing chunk 9 (1000000 rows)...
2025-11-12 21:24:01 - utils - INFO - Processing chunk 10 (1000000 rows)...
2025-11-12 21:24:09 - utils - INFO - Processing chunk 11 (1000000 rows)...
2025-11-12 21:24:17 - utils - INFO - Processing chunk 12 (1000000 rows)...
2025-11-12 21:24:28 - utils - INFO - Processing chunk 13 (1000000 rows)...
2025-11-12 21:24:42 - utils - INFO - Processing chunk 14 (1000000 rows)...
2025-11-12 21:24:57 - utils - INFO - Processing chunk 15 (1000000 rows)...
2025-11-12 21:25:12 - utils - INFO - Processing chunk 16 (1000000 rows)...
2025-11-12 21:25:27 - utils - INFO - Processing chunk 17 (1000000 rows)...
2025-11-12 21:25:42 - utils - INFO - Processing chunk 18 (1000000 rows)...
2025-11-12 21:25:56 - utils - INFO - Processing chunk 19 (1000000 rows)...
2025-11-12 21:26:11 - utils - INFO - Processing chunk 20 (1000000 rows)...
2025-11-12 21:26:26 - utils - INFO - Processing chunk 21 (1000000 rows)...
2025-11-12 21:26:41 - utils - INFO - Processing chunk 22 (1000000 rows)...
2025-11-12 21:26:55 - utils - INFO - Processing chunk 23 (1000000 rows)...
2025-11-12 21:27:10 - utils - INFO - Processing chunk 24 (1000000 rows)...
2025-11-12 21:27:24 - utils - INFO - Processing chunk 25 (1000000 rows)...
2025-11-12 21:27:39 - utils - INFO - Processing chunk 26 (1000000 rows)...
2025-11-12 21:27:53 - utils - INFO - Processing chunk 27 (1000000 rows)...
2025-11-12 21:28:07 - utils - INFO - Processing chunk 28 (1000000 rows)...
2025-11-12 21:28:21 - utils - INFO - Processing chunk 29 (1000000 rows)...
2025-11-12 21:28:35 - utils - INFO - Processing chunk 30 (1000000 rows)...
2025-11-12 21:28:50 - utils - INFO - Processing chunk 31 (1000000 rows)...
2025-11-12 21:29:04 - utils - INFO - Processing chunk 32 (1000000 rows)...
2025-11-12 21:29:18 - utils - INFO - Processing chunk 33 (1000000 rows)...
2025-11-12 21:29:33 - utils - INFO - Processing chunk 34 (1000000 rows)...
2025-11-12 21:29:48 - utils - INFO - Processing chunk 35 (1000000 rows)...
2025-11-12 21:30:02 - utils - INFO - Processing chunk 36 (1000000 rows)...
2025-11-12 21:30:17 - utils - INFO - Processing chunk 37 (1000000 rows)...
2025-11-12 21:30:31 - utils - INFO - Processing chunk 38 (1000000 rows)...
2025-11-12 21:30:41 - utils - INFO - Processing chunk 39 (244604 rows)...
2025-11-12 21:30:44 - utils - INFO - All chunks processed. Total rows: 38244604
2025-11-12 21:30:44 - utils - WARNING - ================================================================================
2025-11-12 21:30:44 - utils - WARNING - WARNING: Total insider records labeled is 0.
2025-11-12 21:30:44 - utils - WARNING - This means no matches were found between insiders.csv and your data.
2025-11-12 21:30:44 - utils - WARNING - Please check your 'answers/insiders.csv' file and dataset subset.
2025-11-12 21:30:44 - utils - WARNING - ================================================================================
2025-11-12 21:30:44 - utils - INFO - Successfully created: /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs_r1_r2_r3.1_LABELED.csv
2025-11-12 21:30:44 - utils - INFO - ================================================================================
2025-11-12 21:30:44 - utils - INFO - V2 Labeling Complete!
2025-11-12 21:30:44 - utils - INFO - The file 'processed_unified_logs_r1_r2_r3.1_LABELED.csv' is now labeled.
2025-11-12 21:30:44 - utils - INFO - Next step: Run 'feature_engineering_v2.py'
2025-11-12 21:30:44 - utils - INFO - ================================================================================
2025-11-12 21:34:33 - utils - INFO - Utility functions loaded successfully
2025-11-12 21:34:33 - utils - INFO - 
================================================================================
                  LABELING INSIDER THREATS (V2: MULTI-DATASET)                  
================================================================================

2025-11-12 21:34:33 - utils - INFO - Loading CMU-CERT master answers file (insiders.csv)...
2025-11-12 21:34:33 - utils - INFO - Loaded 191 total insider incidents
2025-11-12 21:34:33 - utils - WARNING - Could not parse dates for CDE1846 in 6.2: month must be in 1..12: /21/2011 11:43:39, at position 0
2025-11-12 21:34:33 - utils - INFO - Parsed and normalized 190 insider activity rules
2025-11-12 21:34:33 - utils - INFO - Sample of normalized rules:
2025-11-12 21:34:33 - utils - INFO -   - User: ONS0995, Dataset: r2, Start: 2010-03-06
2025-11-12 21:34:33 - utils - INFO -   - User: CSF0929, Dataset: r3.1, Start: 2010-07-01
2025-11-12 21:34:33 - utils - INFO -   - User: CCH0959, Dataset: r3.1, Start: 2010-08-02
2025-11-12 21:34:33 - utils - INFO -   ...and 187 more.
2025-11-12 21:34:33 - utils - INFO - Loaded 190 unique (user, dataset) rule combinations.
2025-11-12 21:34:33 - utils - INFO - Example rule keys: [('ONS0995', 'r2'), ('CSF0929', 'r3.1'), ('CCH0959', 'r3.1'), ('RCW0822', 'r3.2'), ('JCE0258', 'r3.2')]
2025-11-12 21:34:35 - utils - INFO - Processing chunk 1 (1000000 rows)...
2025-11-12 21:34:44 - utils - INFO - Processing chunk 2 (1000000 rows)...
2025-11-12 21:34:44 - utils - INFO -   > Labeled 53 records in this chunk.
2025-11-12 21:34:52 - utils - INFO - Processing chunk 3 (1000000 rows)...
2025-11-12 21:35:02 - utils - INFO - Processing chunk 4 (1000000 rows)...
2025-11-12 21:35:11 - utils - INFO - Processing chunk 5 (1000000 rows)...
2025-11-12 21:35:11 - utils - INFO -   > Labeled 17 records in this chunk.
2025-11-12 21:35:20 - utils - INFO - Processing chunk 6 (1000000 rows)...
2025-11-12 21:35:28 - utils - INFO - Processing chunk 7 (1000000 rows)...
2025-11-12 21:35:37 - utils - INFO - Processing chunk 8 (1000000 rows)...
2025-11-12 21:35:46 - utils - INFO - Processing chunk 9 (1000000 rows)...
2025-11-12 21:35:54 - utils - INFO - Processing chunk 10 (1000000 rows)...
2025-11-12 21:36:03 - utils - INFO - Processing chunk 11 (1000000 rows)...
2025-11-12 21:36:11 - utils - INFO - Processing chunk 12 (1000000 rows)...
2025-11-12 21:36:12 - utils - INFO -   > Labeled 136 records in this chunk.
2025-11-12 21:36:23 - utils - INFO - Processing chunk 13 (1000000 rows)...
2025-11-12 21:36:23 - utils - INFO -   > Labeled 426 records in this chunk.
2025-11-12 21:36:37 - utils - INFO - Processing chunk 14 (1000000 rows)...
2025-11-12 21:36:54 - utils - INFO - Processing chunk 15 (1000000 rows)...
2025-11-12 21:37:08 - utils - INFO - Processing chunk 16 (1000000 rows)...
2025-11-12 21:37:23 - utils - INFO - Processing chunk 17 (1000000 rows)...
2025-11-12 21:37:38 - utils - INFO - Processing chunk 18 (1000000 rows)...
2025-11-12 21:37:53 - utils - INFO - Processing chunk 19 (1000000 rows)...
2025-11-12 21:38:07 - utils - INFO - Processing chunk 20 (1000000 rows)...
2025-11-12 21:38:22 - utils - INFO - Processing chunk 21 (1000000 rows)...
2025-11-12 21:38:37 - utils - INFO - Processing chunk 22 (1000000 rows)...
2025-11-12 21:38:54 - utils - INFO - Processing chunk 23 (1000000 rows)...
2025-11-12 21:39:09 - utils - INFO - Processing chunk 24 (1000000 rows)...
2025-11-12 21:39:09 - utils - INFO -   > Labeled 612 records in this chunk.
2025-11-12 21:39:24 - utils - INFO - Processing chunk 25 (1000000 rows)...
2025-11-12 21:39:24 - utils - INFO -   > Labeled 549 records in this chunk.
2025-11-12 21:39:39 - utils - INFO - Processing chunk 26 (1000000 rows)...
2025-11-12 21:39:39 - utils - INFO -   > Labeled 3211 records in this chunk.
2025-11-12 21:39:54 - utils - INFO - Processing chunk 27 (1000000 rows)...
2025-11-12 21:39:54 - utils - INFO -   > Labeled 3236 records in this chunk.
2025-11-12 21:40:09 - utils - INFO - Processing chunk 28 (1000000 rows)...
2025-11-12 21:40:09 - utils - INFO -   > Labeled 2729 records in this chunk.
2025-11-12 21:40:24 - utils - INFO - Processing chunk 29 (1000000 rows)...
2025-11-12 21:40:38 - utils - INFO - Processing chunk 30 (1000000 rows)...
2025-11-12 21:40:52 - utils - INFO - Processing chunk 31 (1000000 rows)...
2025-11-12 21:41:08 - utils - INFO - Processing chunk 32 (1000000 rows)...
2025-11-12 21:41:23 - utils - INFO - Processing chunk 33 (1000000 rows)...
2025-11-12 21:41:37 - utils - INFO - Processing chunk 34 (1000000 rows)...
2025-11-12 21:41:52 - utils - INFO - Processing chunk 35 (1000000 rows)...
2025-11-12 21:42:06 - utils - INFO - Processing chunk 36 (1000000 rows)...
2025-11-12 21:42:20 - utils - INFO - Processing chunk 37 (1000000 rows)...
2025-11-12 21:42:35 - utils - INFO - Processing chunk 38 (1000000 rows)...
2025-11-12 21:42:46 - utils - INFO - Processing chunk 39 (244604 rows)...
2025-11-12 21:42:48 - utils - INFO - All chunks processed. Total rows: 38244604
2025-11-12 21:42:48 - utils - INFO - Total insider records labeled: 10969
2025-11-12 21:42:48 - utils - INFO - Successfully created: /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs_r1_r2_r3.1_LABELED.csv
2025-11-12 21:42:48 - utils - INFO - ================================================================================
2025-11-12 21:42:48 - utils - INFO - V2 Labeling Complete!
2025-11-12 21:42:48 - utils - INFO - The file 'processed_unified_logs_r1_r2_r3.1_LABELED.csv' is now labeled.
2025-11-12 21:42:48 - utils - INFO - Next step: Run 'feature_engineering_v2.py'
2025-11-12 21:42:48 - utils - INFO - ================================================================================
2025-11-12 21:43:24 - utils - INFO - Utility functions loaded successfully
2025-11-12 21:43:24 - utils - INFO - Feature Engineer V2 initialized.
2025-11-12 21:43:24 - utils - INFO - 
================================================================================
                  FEATURE ENGINEERING PIPELINE V2 (MULTI-PASS)                  
================================================================================

2025-11-12 21:43:24 - utils - INFO - 
================================================================================
                           PASS 1: DAILY AGGREGATION                            
================================================================================

2025-11-12 21:45:27 - utils - INFO - Utility functions loaded successfully
2025-11-12 21:45:27 - utils - INFO - Feature Engineer V2 initialized. Reading from: processed_unified_logs_r1_r2_r3.1_LABELED.csv
2025-11-12 21:45:27 - utils - INFO - 
================================================================================
                  FEATURE ENGINEERING PIPELINE V2 (MULTI-PASS)                  
================================================================================

2025-11-12 21:45:27 - utils - INFO - 
================================================================================
                           PASS 1: DAILY AGGREGATION                            
================================================================================

2025-11-12 21:45:27 - utils - INFO - Reading /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs_r1_r2_r3.1_LABELED.csv in 2000000-row chunks...
2025-11-12 21:45:29 - utils - INFO - Processing chunk 1...
2025-11-12 21:45:34 - utils - INFO - Processing chunk 2...
2025-11-12 21:45:39 - utils - INFO - Processing chunk 3...
2025-11-12 21:45:41 - utils - INFO - Processing chunk 4...
2025-11-12 21:45:44 - utils - INFO - Processing chunk 5...
2025-11-12 21:45:47 - utils - INFO - Processing chunk 6...
2025-11-12 21:45:53 - utils - INFO - Processing chunk 7...
2025-11-12 21:45:59 - utils - INFO - Processing chunk 8...
2025-11-12 21:46:04 - utils - INFO - Processing chunk 9...
2025-11-12 21:46:08 - utils - INFO - Processing chunk 10...
2025-11-12 21:46:13 - utils - INFO - Processing chunk 11...
2025-11-12 21:46:18 - utils - INFO - Processing chunk 12...
2025-11-12 21:46:23 - utils - INFO - Processing chunk 13...
2025-11-12 21:46:28 - utils - INFO - Processing chunk 14...
2025-11-12 21:46:33 - utils - INFO - Processing chunk 15...
2025-11-12 21:46:38 - utils - INFO - Processing chunk 16...
2025-11-12 21:46:42 - utils - INFO - Processing chunk 17...
2025-11-12 21:46:48 - utils - INFO - Processing chunk 18...
2025-11-12 21:46:52 - utils - INFO - Processing chunk 19...
2025-11-12 21:46:53 - utils - INFO - Processing chunk 20...
2025-11-12 21:46:53 - utils - INFO - All 20 chunks processed. Merging daily summaries...
2025-11-12 21:46:55 - utils - INFO - Cleaning up temporary chunk files...
2025-11-12 21:46:59 - utils - INFO - PASS 1 complete. Saved /Users/bipinrimal/Downloads/Thesis_work/data/processed/daily_features_unscaled_r1_r2_r3.1_v2.csv (1655902 rows)
2025-11-12 21:46:59 - utils - INFO - 
================================================================================
                     PASS 2: FEATURE ENRICHMENT (Z-SCORES)                      
================================================================================

2025-11-12 21:46:59 - utils - INFO - Scanning for LDAP data in shared folder: /Users/bipinrimal/Downloads/Thesis_work/data/all_data/LDAP
2025-11-12 21:46:59 - utils - ERROR - Failed to load LDAP data for role enrichment: LDAP folder not found at /Users/bipinrimal/Downloads/Thesis_work/data/all_data/LDAP
2025-11-12 21:46:59 - utils - WARNING - Could not load LDAP data. Peer-relative features will be skipped.
2025-11-12 21:46:59 - utils - INFO - Calculating self-relative Z-Scores (rolling 30-day)...
2025-11-12 21:47:03 - utils - INFO - Calculating peer-relative Z-Scores (by role)...
2025-11-12 21:47:03 - utils - INFO - PASS 2 complete. Enriched features created.
2025-11-12 21:47:03 - utils - INFO - Scaling and saving final daily features (for LSTM)...
2025-11-12 21:47:03 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/daily_feature_scaler_v2.pkl
2025-11-12 21:47:30 - utils - INFO - Saved /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_daily_features_r1_r2_r3.1_v2.csv
2025-11-12 21:47:30 - utils - INFO - 
================================================================================
                        PASS 3: STATIC FEATURE CREATION                         
================================================================================

2025-11-12 21:47:30 - utils - INFO - Created static features for 4999 users
2025-11-12 21:47:30 - utils - INFO - Scaling and saving static features...
2025-11-12 21:47:30 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/static_feature_scaler_v2.pkl
2025-11-12 21:47:30 - utils - INFO - PASS 3 complete. Saved /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_static_features_r1_r2_r3.1_v2.csv
2025-11-12 21:47:30 - utils - INFO - 
================================================================================
                           PASS 4: SEQUENCE CREATION                            
================================================================================

2025-11-12 21:47:30 - utils - INFO - Creating sequences (length=15, stride=10)...
2025-11-12 21:49:57 - utils - INFO - Created 162520 sequences from 4999 users
2025-11-12 21:49:57 - utils - INFO - PASS 4 complete. Saved sequence files to /Users/bipinrimal/Downloads/Thesis_work/data/processed
2025-11-12 21:49:57 - utils - INFO - ================================================================================
2025-11-12 21:49:57 - utils - INFO - V2 Feature Engineering Complete!
2025-11-12 21:49:57 - utils - INFO -   Static features created: /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_static_features_r1_r2_r3.1_v2.csv
2025-11-12 21:49:57 - utils - INFO -   Sequence files created: /Users/bipinrimal/Downloads/Thesis_work/data/processed
2025-11-12 21:49:57 - utils - INFO - Next step: Train V2 models.
2025-11-12 21:49:57 - utils - INFO - ================================================================================
2025-11-12 21:53:19 - utils - INFO - Utility functions loaded successfully
2025-11-12 21:53:19 - utils - INFO - 
================================================================================
                 ISOLATION FOREST TRAINING (V2: MULTI-DATASET)                  
================================================================================

2025-11-12 21:53:19 - utils - ERROR - Failed to load 'engineered_static_features_v2.csv'. Run feature_engineering_v2.py first. Error: [Errno 2] No such file or directory: '/Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_static_features_v2.csv'
2025-11-12 21:54:14 - utils - INFO - Utility functions loaded successfully
2025-11-12 21:54:14 - utils - INFO - Feature Engineer V2 initialized. Reading from: processed_unified_logs_r1_r2_r3.1_LABELED.csv
2025-11-12 21:54:14 - utils - INFO - 
================================================================================
                  FEATURE ENGINEERING PIPELINE V2 (MULTI-PASS)                  
================================================================================

2025-11-12 21:54:14 - utils - INFO - Found /Users/bipinrimal/Downloads/Thesis_work/data/processed/daily_features_unscaled_r1_r2_r3.1_v2.csv, skipping Pass 1.
2025-11-12 21:54:15 - utils - INFO - 
================================================================================
                     PASS 2: FEATURE ENRICHMENT (Z-SCORES)                      
================================================================================

2025-11-12 21:54:52 - utils - INFO - Utility functions loaded successfully
2025-11-12 21:54:52 - utils - INFO - Feature Engineer V2 initialized. Reading from: processed_unified_logs_r1_r2_r3.1_LABELED.csv
2025-11-12 21:54:52 - utils - INFO - 
================================================================================
                  FEATURE ENGINEERING PIPELINE V2 (MULTI-PASS)                  
================================================================================

2025-11-12 21:54:52 - utils - INFO - Found /Users/bipinrimal/Downloads/Thesis_work/data/processed/daily_features_unscaled_r1_r2_r3.1_v2.csv, skipping Pass 1.
2025-11-12 21:54:52 - utils - INFO - 
================================================================================
                     PASS 2: FEATURE ENRICHMENT (Z-SCORES)                      
================================================================================

2025-11-12 21:59:12 - utils - INFO - Utility functions loaded successfully
2025-11-12 21:59:12 - utils - INFO - Processing SUBSET defined in config: ['r1', 'r2', 'r3.1']
2025-11-12 21:59:12 - utils - INFO - Found 3 dataset folders to process.
2025-11-12 21:59:12 - utils - INFO - 
================================================================================
                 DATA PREPROCESSING PIPELINE (V2: MEMORY-SAFE)                  
================================================================================

2025-11-12 21:59:12 - utils - WARNING - ================================================================================
2025-11-12 21:59:12 - utils - WARNING - Final file 'processed_unified_logs_r1_r2_r3.1_ENRICHED.csv' already exists.
2025-11-12 21:59:12 - utils - WARNING - Skipping entire preprocessing pipeline.
2025-11-12 21:59:12 - utils - WARNING - To re-run, set FORCE_RERUN_PREPROCESSING = True in config_v2.py
2025-11-12 21:59:12 - utils - WARNING - ================================================================================
2025-11-12 21:59:32 - utils - INFO - Utility functions loaded successfully
2025-11-12 21:59:32 - utils - INFO - Processing SUBSET defined in config: ['r1', 'r2', 'r3.1']
2025-11-12 21:59:32 - utils - INFO - Found 3 dataset folders to process.
2025-11-12 21:59:32 - utils - INFO - 
================================================================================
                 DATA PREPROCESSING PIPELINE (V2: MEMORY-SAFE)                  
================================================================================

2025-11-12 21:59:32 - utils - WARNING - ================================================================================
2025-11-12 21:59:32 - utils - WARNING - Final file 'processed_unified_logs_r1_r2_r3.1_ENRICHED.csv' already exists.
2025-11-12 21:59:32 - utils - WARNING - Skipping entire preprocessing pipeline.
2025-11-12 21:59:32 - utils - WARNING - To re-run, set FORCE_RERUN_PREPROCESSING = True in config_v2.py
2025-11-12 21:59:32 - utils - WARNING - ================================================================================
2025-11-12 22:00:47 - utils - INFO - Utility functions loaded successfully
2025-11-12 22:00:47 - utils - INFO - Processing SUBSET defined in config: ['r1', 'r2', 'r3.1']
2025-11-12 22:00:47 - utils - INFO - Found 3 dataset folders to process.
2025-11-12 22:00:47 - utils - INFO - 
================================================================================
                 DATA PREPROCESSING PIPELINE (V2: MEMORY-SAFE)                  
================================================================================

2025-11-12 22:00:47 - utils - INFO - Did not find all temp files. Will re-process missing ones.
2025-11-12 22:00:47 - utils - INFO - Cleaning up old temporary files...
2025-11-12 22:00:47 - utils - INFO - Removed 0 old temp files.
2025-11-12 22:00:47 - utils - INFO - --- Processing single dataset: r1 ---
2025-11-12 22:00:47 - utils - INFO - Loaded logon.csv (849579 rows)
2025-11-12 22:00:48 - utils - INFO - Parsed datetime column: date
2025-11-12 22:00:48 - utils - INFO - Loaded device.csv (65668 rows)
2025-11-12 22:00:48 - utils - INFO - Parsed datetime column: date
2025-11-12 22:00:48 - utils - WARNING - file.csv not found in r1, skipping.
2025-11-12 22:00:48 - utils - WARNING - email.csv not found in r1, skipping.
2025-11-12 22:00:50 - utils - INFO - Loaded http.csv (3451664 rows)
2025-11-12 22:00:50 - utils - WARNING - 'date' column not found in /Users/bipinrimal/Downloads/Thesis_work/data/all_data/r1/http.csv. Skipping file.
2025-11-12 22:00:50 - utils - INFO - Cleaning dataframe with 915247 rows
2025-11-12 22:00:51 - utils - INFO - Removed 0 duplicate rows
2025-11-12 22:00:51 - utils - INFO - Missing values:
to                915247
from              915247
size              915247
attachments       915247
cc                915247
bcc               915247
url               915247
domain            915247
filename          915247
content           915247
file_extension    915247
dtype: int64
2025-11-12 22:00:55 - utils - INFO - Saved temporary file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r1.csv (915247 rows)
2025-11-12 22:00:55 - utils - INFO - --- Processing single dataset: r2 ---
2025-11-12 22:00:56 - utils - INFO - Loaded logon.csv (840141 rows)
2025-11-12 22:00:56 - utils - INFO - Parsed datetime column: date
2025-11-12 22:00:57 - utils - INFO - Loaded device.csv (712308 rows)
2025-11-12 22:00:57 - utils - INFO - Parsed datetime column: date
2025-11-12 22:00:58 - utils - WARNING - file.csv not found in r2, skipping.
2025-11-12 22:00:59 - utils - INFO - Loaded email.csv (1189372 rows)
2025-11-12 22:01:00 - utils - INFO - Parsed datetime column: date
2025-11-12 22:01:05 - utils - INFO - Loaded http.csv (7321105 rows)
2025-11-12 22:01:12 - utils - INFO - Parsed datetime column: date
2025-11-12 22:01:20 - utils - INFO - Cleaning dataframe with 10062926 rows
2025-11-12 22:01:27 - utils - INFO - Removed 0 duplicate rows
2025-11-12 22:01:29 - utils - INFO - Missing values:
pc_id              1189372
activity           8510477
to                 8873554
from              10062926
size              10062926
attachments       10062926
cc                10062926
bcc               10062926
url                2741821
domain             2741821
filename          10062926
content           10062926
file_extension    10062926
dtype: int64
2025-11-12 22:02:17 - utils - INFO - Saved temporary file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r2.csv (10062926 rows)
2025-11-12 22:02:18 - utils - INFO - --- Processing single dataset: r3.1 ---
2025-11-12 22:02:18 - utils - INFO - Loaded logon.csv (842109 rows)
2025-11-12 22:02:19 - utils - INFO - Parsed datetime column: date
2025-11-12 22:02:19 - utils - INFO - Loaded device.csv (417588 rows)
2025-11-12 22:02:20 - utils - INFO - Parsed datetime column: date
2025-11-12 22:02:21 - utils - INFO - Loaded file.csv (457520 rows)
2025-11-12 22:02:22 - utils - INFO - Parsed datetime column: date
2025-11-12 22:02:28 - utils - INFO - Loaded email.csv (1994071 rows)
2025-11-12 22:02:30 - utils - INFO - Parsed datetime column: date
2025-11-12 22:07:25 - utils - INFO - Loaded http.csv (23555143 rows)
2025-11-12 22:07:51 - utils - INFO - Parsed datetime column: date
2025-11-12 22:09:56 - utils - INFO - Cleaning dataframe with 27266431 rows
2025-11-12 22:18:57 - utils - INFO - Removed 0 duplicate rows
2025-11-12 22:19:53 - utils - INFO - Missing values:
pc_id              1994071
activity          26006734
to                25272360
from              27266431
size              25272360
attachments       25272360
cc                27266431
bcc               27266431
url                3711288
domain             3711288
filename          26808911
content            1259697
file_extension    26808911
dtype: int64
2025-11-12 22:25:32 - utils - INFO - Saved temporary file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r3.1.csv (27266431 rows)
2025-11-12 22:26:11 - utils - INFO - Merging 3 processed temp files into master file...
2025-11-12 22:26:11 - utils - INFO - Merging temp_processed_r1.csv...
2025-11-12 22:26:19 - utils - INFO - Merging temp_processed_r2.csv...
2025-11-12 22:27:29 - utils - INFO - Merging temp_processed_r3.1.csv...
2025-11-12 23:30:17 - utils - INFO - Utility functions loaded successfully
2025-11-12 23:30:17 - utils - INFO - Processing SUBSET defined in config: ['r1', 'r2', 'r3.1']
2025-11-12 23:30:17 - utils - INFO - Found 3 dataset folders to process.
2025-11-12 23:30:17 - utils - INFO - 
================================================================================
                 DATA PREPROCESSING PIPELINE (V2: MEMORY-SAFE)                  
================================================================================

2025-11-12 23:30:17 - utils - INFO - Found 3 existing temp files. Will skip processing and go straight to merging.
2025-11-12 23:30:17 - utils - INFO - Merging 3 processed temp files into master file...
2025-11-12 23:30:17 - utils - WARNING - Master file processed_unified_logs_r1_r2_r3.1.csv already exists. Deleting.
2025-11-12 23:30:17 - utils - INFO - Merging temp_processed_r1.csv...
2025-11-12 23:30:23 - utils - INFO - Merging temp_processed_r2.csv...
2025-11-12 23:31:26 - utils - INFO - Merging temp_processed_r3.1.csv...
2025-11-13 10:04:34 - utils - INFO - Utility functions loaded successfully
2025-11-13 10:04:34 - utils - INFO - Processing SUBSET defined in config: ['r1', 'r2', 'r3.1']
2025-11-13 10:04:34 - utils - INFO - Found 3 dataset folders to process.
2025-11-13 10:04:34 - utils - INFO - 
================================================================================
                 DATA PREPROCESSING PIPELINE (V2: MEMORY-SAFE)                  
================================================================================

2025-11-13 10:04:34 - utils - INFO - Did not find all temp files. Will re-process missing ones.
2025-11-13 10:04:34 - utils - INFO - Cleaning up old temporary files...
2025-11-13 10:04:34 - utils - INFO - Removed 0 old temp files.
2025-11-13 10:04:34 - utils - INFO - --- Processing single dataset: r1 ---
2025-11-13 10:04:34 - utils - INFO - Loaded logon.csv (849579 rows)
2025-11-13 10:04:35 - utils - INFO - Parsed datetime column: date
2025-11-13 10:04:35 - utils - INFO - Loaded device.csv (65668 rows)
2025-11-13 10:04:35 - utils - INFO - Parsed datetime column: date
2025-11-13 10:04:35 - utils - WARNING - file.csv not found in r1, skipping.
2025-11-13 10:04:35 - utils - WARNING - email.csv not found in r1, skipping.
2025-11-13 10:04:38 - utils - INFO - Loaded http.csv (3451664 rows)
2025-11-13 10:04:38 - utils - WARNING - 'date' column not found in /Users/bipinrimal/Downloads/Thesis_work/data/all_data/r1/http.csv. Skipping file.
2025-11-13 10:04:38 - utils - INFO - Cleaning dataframe with 915247 rows
2025-11-13 10:04:38 - utils - INFO - Removed 0 duplicate rows
2025-11-13 10:04:38 - utils - INFO - Missing values:
to                915247
from              915247
size              915247
attachments       915247
cc                915247
bcc               915247
url               915247
domain            915247
filename          915247
content           915247
file_extension    915247
dtype: int64
2025-11-13 10:04:42 - utils - INFO - Saved temporary file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r1.csv (915247 rows)
2025-11-13 10:04:42 - utils - INFO - --- Processing single dataset: r2 ---
2025-11-13 10:04:43 - utils - INFO - Loaded logon.csv (840141 rows)
2025-11-13 10:04:43 - utils - INFO - Parsed datetime column: date
2025-11-13 10:04:44 - utils - INFO - Loaded device.csv (712308 rows)
2025-11-13 10:04:44 - utils - INFO - Parsed datetime column: date
2025-11-13 10:04:45 - utils - WARNING - file.csv not found in r2, skipping.
2025-11-13 10:04:46 - utils - INFO - Loaded email.csv (1189372 rows)
2025-11-13 10:04:47 - utils - INFO - Parsed datetime column: date
2025-11-13 10:04:52 - utils - INFO - Loaded http.csv (7321105 rows)
2025-11-13 10:04:59 - utils - INFO - Parsed datetime column: date
2025-11-13 10:05:06 - utils - INFO - Cleaning dataframe with 10062926 rows
2025-11-13 10:05:14 - utils - INFO - Removed 0 duplicate rows
2025-11-13 10:05:16 - utils - INFO - Missing values:
pc_id              1189372
activity           8510477
to                 8873554
from              10062926
size              10062926
attachments       10062926
cc                10062926
bcc               10062926
url                2741821
domain             2741821
filename          10062926
content           10062926
file_extension    10062926
dtype: int64
2025-11-13 10:06:01 - utils - INFO - Saved temporary file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r2.csv (10062926 rows)
2025-11-13 10:06:01 - utils - INFO - --- Processing single dataset: r3.1 ---
2025-11-13 10:06:02 - utils - INFO - Loaded logon.csv (842109 rows)
2025-11-13 10:06:03 - utils - INFO - Parsed datetime column: date
2025-11-13 10:06:03 - utils - INFO - Loaded device.csv (417588 rows)
2025-11-13 10:06:03 - utils - INFO - Parsed datetime column: date
2025-11-13 10:06:05 - utils - INFO - Loaded file.csv (457520 rows)
2025-11-13 10:06:05 - utils - INFO - Parsed datetime column: date
2025-11-13 10:06:12 - utils - INFO - Loaded email.csv (1994071 rows)
2025-11-13 10:06:14 - utils - INFO - Parsed datetime column: date
2025-11-13 10:10:44 - utils - INFO - Loaded http.csv (23555143 rows)
2025-11-13 10:11:12 - utils - INFO - Parsed datetime column: date
2025-11-13 10:12:49 - utils - INFO - Cleaning dataframe with 27266431 rows
2025-11-13 10:16:37 - utils - INFO - Removed 0 duplicate rows
2025-11-13 10:16:57 - utils - INFO - Missing values:
pc_id              1994071
activity          26006734
to                25272360
from              27266431
size              25272360
attachments       25272360
cc                27266431
bcc               27266431
url                3711288
domain             3711288
filename          26808911
content            1259697
file_extension    26808911
dtype: int64
2025-11-13 10:21:09 - utils - INFO - Saved temporary file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r3.1.csv (27266431 rows)
2025-11-13 10:21:28 - utils - INFO - Merging 3 processed temp files into master file...
2025-11-13 10:21:28 - utils - INFO - Merging temp_processed_r1.csv...
2025-11-13 10:21:34 - utils - INFO - Merging temp_processed_r2.csv...
2025-11-13 10:22:41 - utils - INFO - Merging temp_processed_r3.1.csv...
2025-11-13 11:44:48 - utils - INFO - Utility functions loaded successfully
2025-11-13 11:44:48 - utils - INFO - Processing SUBSET defined in config: ['r1', 'r2', 'r3.1']
2025-11-13 11:44:48 - utils - INFO - Found 3 dataset folders to process.
2025-11-13 11:44:48 - utils - INFO - 
================================================================================
                 DATA PREPROCESSING PIPELINE (V2: MEMORY-SAFE)                  
================================================================================

2025-11-13 11:44:48 - utils - INFO - Did not find all temp files. Will re-process missing ones.
2025-11-13 11:44:48 - utils - INFO - Cleaning up old temporary files...
2025-11-13 11:44:48 - utils - INFO - Removed 0 old temp files.
2025-11-13 11:44:48 - utils - INFO - --- Processing single dataset: r1 ---
2025-11-13 11:44:49 - utils - INFO - Loaded logon.csv (849579 rows)
2025-11-13 11:44:50 - utils - INFO - Parsed datetime column: date
2025-11-13 11:44:50 - utils - INFO - Loaded device.csv (65668 rows)
2025-11-13 11:44:50 - utils - INFO - Parsed datetime column: date
2025-11-13 11:44:50 - utils - WARNING - file.csv not found in r1, skipping.
2025-11-13 11:44:50 - utils - WARNING - email.csv not found in r1, skipping.
2025-11-13 11:44:52 - utils - INFO - Loaded http.csv (3451664 rows)
2025-11-13 11:44:52 - utils - WARNING - 'date' column not found in /Users/bipinrimal/Downloads/Thesis_work/data/all_data/r1/http.csv. Skipping file.
2025-11-13 11:44:52 - utils - INFO - Cleaning dataframe with 915247 rows
2025-11-13 11:44:53 - utils - INFO - Removed 0 duplicate rows
2025-11-13 11:44:53 - utils - INFO - Missing values:
to                915247
from              915247
size              915247
attachments       915247
cc                915247
bcc               915247
url               915247
domain            915247
filename          915247
content           915247
file_extension    915247
dtype: int64
2025-11-13 11:44:57 - utils - INFO - Saved temporary file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r1.csv (915247 rows)
2025-11-13 11:44:57 - utils - INFO - --- Processing single dataset: r2 ---
2025-11-13 11:44:58 - utils - INFO - Loaded logon.csv (840141 rows)
2025-11-13 11:44:59 - utils - INFO - Parsed datetime column: date
2025-11-13 11:44:59 - utils - INFO - Loaded device.csv (712308 rows)
2025-11-13 11:45:00 - utils - INFO - Parsed datetime column: date
2025-11-13 11:45:00 - utils - WARNING - file.csv not found in r2, skipping.
2025-11-13 11:45:01 - utils - INFO - Loaded email.csv (1189372 rows)
2025-11-13 11:45:02 - utils - INFO - Parsed datetime column: date
2025-11-13 11:45:07 - utils - INFO - Loaded http.csv (7321105 rows)
2025-11-13 11:45:15 - utils - INFO - Parsed datetime column: date
2025-11-13 11:45:19 - utils - INFO - Cleaning dataframe with 10062926 rows
2025-11-13 11:45:26 - utils - INFO - Removed 0 duplicate rows
2025-11-13 11:45:27 - utils - INFO - Missing values:
pc_id              1189372
activity           8510477
to                 8873554
from              10062926
size              10062926
attachments       10062926
cc                10062926
bcc               10062926
url                2741821
domain            10062926
filename          10062926
content           10062926
file_extension    10062926
dtype: int64
2025-11-13 11:46:13 - utils - INFO - Saved temporary file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r2.csv (10062926 rows)
2025-11-13 11:46:13 - utils - INFO - --- Processing single dataset: r3.1 ---
2025-11-13 11:46:14 - utils - INFO - Loaded logon.csv (842109 rows)
2025-11-13 11:46:14 - utils - INFO - Parsed datetime column: date
2025-11-13 11:46:15 - utils - INFO - Loaded device.csv (417588 rows)
2025-11-13 11:46:15 - utils - INFO - Parsed datetime column: date
2025-11-13 11:46:17 - utils - INFO - Loaded file.csv (457520 rows)
2025-11-13 11:46:17 - utils - INFO - Parsed datetime column: date
2025-11-13 11:46:24 - utils - INFO - Loaded email.csv (1994071 rows)
2025-11-13 11:46:26 - utils - INFO - Parsed datetime column: date
2025-11-13 11:51:04 - utils - INFO - Loaded http.csv (23555143 rows)
2025-11-13 11:51:35 - utils - INFO - Parsed datetime column: date
2025-11-13 11:52:28 - utils - INFO - Cleaning dataframe with 27266431 rows
2025-11-13 11:54:40 - utils - INFO - Removed 0 duplicate rows
2025-11-13 11:55:00 - utils - INFO - Missing values:
pc_id              1994071
activity          26006734
to                25272360
from              27266431
size              25272360
attachments       25272360
cc                27266431
bcc               27266431
url                3711288
domain            27266431
filename          26808911
content            1259697
file_extension    26808911
dtype: int64
2025-11-13 11:59:02 - utils - INFO - Saved temporary file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r3.1.csv (27266431 rows)
2025-11-13 11:59:05 - utils - INFO - Merging 3 processed temp files into master file...
2025-11-13 11:59:05 - utils - INFO - Merging temp_processed_r1.csv...
2025-11-13 11:59:11 - utils - INFO - Merging temp_processed_r2.csv...
2025-11-13 12:12:01 - utils - INFO - Merging temp_processed_r3.1.csv...
2025-11-13 13:27:55 - utils - INFO - Utility functions loaded successfully
2025-11-13 13:27:55 - utils - INFO - Processing SUBSET defined in config: ['r1', 'r2', 'r3.1']
2025-11-13 13:27:55 - utils - INFO - Found 3 dataset folders to process.
2025-11-13 13:27:55 - utils - INFO - 
================================================================================
                 DATA PREPROCESSING PIPELINE (V2: MEMORY-SAFE)                  
================================================================================

2025-11-13 13:27:55 - utils - INFO - Did not find all temp files. Will re-process missing ones.
2025-11-13 13:27:55 - utils - INFO - Cleaning up old temporary files...
2025-11-13 13:27:55 - utils - INFO - Removed 0 old temp files.
2025-11-13 13:27:55 - utils - INFO - --- Processing single dataset: r1 ---
2025-11-13 13:27:56 - utils - INFO - Loaded logon.csv (849579 rows)
2025-11-13 13:27:56 - utils - INFO - Parsed datetime column: date
2025-11-13 13:27:57 - utils - INFO - Loaded device.csv (65668 rows)
2025-11-13 13:27:57 - utils - INFO - Parsed datetime column: date
2025-11-13 13:27:57 - utils - WARNING - file.csv not found in r1, skipping.
2025-11-13 13:27:57 - utils - WARNING - email.csv not found in r1, skipping.
2025-11-13 13:27:59 - utils - INFO - Loaded http.csv (3451664 rows)
2025-11-13 13:27:59 - utils - WARNING - 'date' column not found in /Users/bipinrimal/Downloads/Thesis_work/data/all_data/r1/http.csv. Skipping file.
2025-11-13 13:27:59 - utils - INFO - Cleaning dataframe with 915247 rows
2025-11-13 13:27:59 - utils - INFO - Removed 0 duplicate rows
2025-11-13 13:27:59 - utils - INFO - Missing values:
to                915247
from              915247
size              915247
attachments       915247
cc                915247
bcc               915247
url               915247
domain            915247
filename          915247
content           915247
file_extension    915247
dtype: int64
2025-11-13 13:28:04 - utils - INFO - Saved temporary file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r1.csv (915247 rows)
2025-11-13 13:28:04 - utils - INFO - --- Processing single dataset: r2 ---
2025-11-13 13:28:04 - utils - INFO - Loaded logon.csv (840141 rows)
2025-11-13 13:28:05 - utils - INFO - Parsed datetime column: date
2025-11-13 13:28:06 - utils - INFO - Loaded device.csv (712308 rows)
2025-11-13 13:28:06 - utils - INFO - Parsed datetime column: date
2025-11-13 13:28:06 - utils - WARNING - file.csv not found in r2, skipping.
2025-11-13 13:28:07 - utils - INFO - Loaded email.csv (1189372 rows)
2025-11-13 13:28:08 - utils - INFO - Parsed datetime column: date
2025-11-13 13:28:14 - utils - INFO - Loaded http.csv (7321105 rows)
2025-11-13 13:28:21 - utils - INFO - Parsed datetime column: date
2025-11-13 13:28:24 - utils - INFO - Cleaning dataframe with 10062926 rows
2025-11-13 13:28:31 - utils - INFO - Removed 0 duplicate rows
2025-11-13 13:28:32 - utils - INFO - Missing values:
pc_id              1189372
activity           8510477
to                 8873554
from              10062926
size              10062926
attachments       10062926
cc                10062926
bcc               10062926
url                2741821
domain            10062926
filename          10062926
content           10062926
file_extension    10062926
dtype: int64
2025-11-13 13:29:17 - utils - INFO - Saved temporary file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r2.csv (10062926 rows)
2025-11-13 13:29:18 - utils - INFO - --- Processing single dataset: r3.1 ---
2025-11-13 13:29:18 - utils - INFO - Loaded logon.csv (842109 rows)
2025-11-13 13:29:19 - utils - INFO - Parsed datetime column: date
2025-11-13 13:29:19 - utils - INFO - Loaded device.csv (417588 rows)
2025-11-13 13:29:20 - utils - INFO - Parsed datetime column: date
2025-11-13 13:29:21 - utils - INFO - Loaded file.csv (457520 rows)
2025-11-13 13:29:21 - utils - INFO - Parsed datetime column: date
2025-11-13 13:29:28 - utils - INFO - Loaded email.csv (1994071 rows)
2025-11-13 13:29:30 - utils - INFO - Parsed datetime column: date
2025-11-13 13:34:06 - utils - INFO - Loaded http.csv (23555143 rows)
2025-11-13 13:34:35 - utils - INFO - Parsed datetime column: date
2025-11-13 13:35:40 - utils - INFO - Cleaning dataframe with 27266431 rows
2025-11-13 13:38:55 - utils - INFO - Removed 0 duplicate rows
2025-11-13 13:39:14 - utils - INFO - Missing values:
pc_id              1994071
activity          26006734
to                25272360
from              27266431
size              25272360
attachments       25272360
cc                27266431
bcc               27266431
url                3711288
domain            27266431
filename          26808911
content            1259697
file_extension    26808911
dtype: int64
2025-11-13 13:42:52 - utils - INFO - Saved temporary file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/temp_processed_r3.1.csv (27266431 rows)
2025-11-13 13:42:55 - utils - INFO - Merging 3 processed temp files into master file...
2025-11-13 13:42:55 - utils - INFO - Merging temp_processed_r1.csv...
2025-11-13 13:43:01 - utils - INFO - Merging temp_processed_r2.csv...
2025-11-13 13:44:07 - utils - INFO - Merging temp_processed_r3.1.csv...
2025-11-13 15:05:29 - utils - INFO - Utility functions loaded successfully
2025-11-13 15:05:29 - utils - INFO - Processing SUBSET defined in config: ['r1', 'r2', 'r3.1']
2025-11-13 15:05:29 - utils - INFO - Found 3 dataset folders to process.
2025-11-13 15:05:29 - utils - INFO - 
================================================================================
                 DATA PREPROCESSING PIPELINE (V2: MEMORY-SAFE)                  
================================================================================

2025-11-13 15:05:29 - utils - INFO - Found 3 existing temp files. Will skip processing and go straight to merging.
2025-11-13 15:05:29 - utils - INFO - Merging 3 processed temp files into master file (streaming)...
2025-11-13 15:05:29 - utils - WARNING - Master file processed_unified_logs_r1_r2_r3.1.csv already exists. Deleting.
2025-11-13 15:05:29 - utils - INFO - Merging temp_processed_r1.csv *in chunks*...
2025-11-13 15:05:34 - utils - INFO - Merging temp_processed_r2.csv *in chunks*...
2025-11-13 15:05:56 - utils - INFO - Utility functions loaded successfully
2025-11-13 15:05:56 - utils - INFO - Processing SUBSET defined in config: ['r1', 'r2', 'r3.1']
2025-11-13 15:05:56 - utils - INFO - Found 3 dataset folders to process.
2025-11-13 15:05:56 - utils - INFO - 
================================================================================
                 DATA PREPROCESSING PIPELINE (V2: MEMORY-SAFE)                  
================================================================================

2025-11-13 15:05:56 - utils - INFO - Found 3 existing temp files. Will skip processing and go straight to merging.
2025-11-13 15:05:56 - utils - INFO - Merging 3 processed temp files into master file (streaming)...
2025-11-13 15:05:56 - utils - INFO - Merging temp_processed_r1.csv *in chunks*...
2025-11-13 15:06:01 - utils - INFO - Merging temp_processed_r2.csv *in chunks*...
2025-11-13 15:06:58 - utils - INFO - Merging temp_processed_r3.1.csv *in chunks*...
2025-11-13 15:11:59 - utils - INFO - Master dataframe created: 38244604 total rows
2025-11-13 15:11:59 - utils - INFO - Successfully merged all temp files.
2025-11-13 15:11:59 - utils - INFO - Loading and merging static data (LDAP, Psychometric) via streaming...
2025-11-13 15:11:59 - utils - INFO - Scanning for LDAP data in shared folder: /Users/bipinrimal/Downloads/Thesis_work/data/all_data/LDAP
2025-11-13 15:11:59 - utils - ERROR - Failed to load/merge LDAP data: LDAP folder not found at /Users/bipinrimal/Downloads/Thesis_work/data/all_data/LDAP
2025-11-13 15:11:59 - utils - INFO - Loaded and de-duplicated psychometric data for 1999 users
2025-11-13 15:12:01 - utils - INFO - Enriching chunk 1...
2025-11-13 15:12:07 - utils - INFO - Enriching chunk 2...
2025-11-13 15:12:13 - utils - INFO - Enriching chunk 3...
2025-11-13 15:12:19 - utils - INFO - Enriching chunk 4...
2025-11-13 15:12:26 - utils - INFO - Enriching chunk 5...
2025-11-13 15:12:32 - utils - INFO - Enriching chunk 6...
2025-11-13 15:12:38 - utils - INFO - Enriching chunk 7...
2025-11-13 15:12:43 - utils - INFO - Enriching chunk 8...
2025-11-13 15:12:49 - utils - INFO - Enriching chunk 9...
2025-11-13 15:12:55 - utils - INFO - Enriching chunk 10...
2025-11-13 15:13:01 - utils - INFO - Enriching chunk 11...
2025-11-13 15:13:07 - utils - INFO - Enriching chunk 12...
2025-11-13 15:13:14 - utils - INFO - Enriching chunk 13...
2025-11-13 15:13:26 - utils - INFO - Enriching chunk 14...
2025-11-13 15:13:38 - utils - INFO - Enriching chunk 15...
2025-11-13 15:13:50 - utils - INFO - Enriching chunk 16...
2025-11-13 15:14:02 - utils - INFO - Enriching chunk 17...
2025-11-13 15:14:13 - utils - INFO - Enriching chunk 18...
2025-11-13 15:14:25 - utils - INFO - Enriching chunk 19...
2025-11-13 15:14:37 - utils - INFO - Enriching chunk 20...
2025-11-13 15:14:48 - utils - INFO - Enriching chunk 21...
2025-11-13 15:15:00 - utils - INFO - Enriching chunk 22...
2025-11-13 15:15:11 - utils - INFO - Enriching chunk 23...
2025-11-13 15:15:23 - utils - INFO - Enriching chunk 24...
2025-11-13 15:15:35 - utils - INFO - Enriching chunk 25...
2025-11-13 15:15:46 - utils - INFO - Enriching chunk 26...
2025-11-13 15:15:58 - utils - INFO - Enriching chunk 27...
2025-11-13 15:16:10 - utils - INFO - Enriching chunk 28...
2025-11-13 15:16:21 - utils - INFO - Enriching chunk 29...
2025-11-13 15:16:32 - utils - INFO - Enriching chunk 30...
2025-11-13 15:16:44 - utils - INFO - Enriching chunk 31...
2025-11-13 15:16:56 - utils - INFO - Enriching chunk 32...
2025-11-13 15:17:08 - utils - INFO - Enriching chunk 33...
2025-11-13 15:17:21 - utils - INFO - Enriching chunk 34...
2025-11-13 15:17:33 - utils - INFO - Enriching chunk 35...
2025-11-13 15:17:45 - utils - INFO - Enriching chunk 36...
2025-11-13 15:17:56 - utils - INFO - Enriching chunk 37...
2025-11-13 15:18:08 - utils - INFO - Enriching chunk 38...
2025-11-13 15:18:17 - utils - INFO - Enriching chunk 39...
2025-11-13 15:18:18 - utils - INFO - Enrichment complete. Replacing master file...
2025-11-13 15:18:19 - utils - INFO - Successfully created final enriched file: /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs_r1_r2_r3.1_ENRICHED.csv
2025-11-13 15:18:19 - utils - INFO - Performing final pass (cleanup and label init)...
2025-11-13 15:18:21 - utils - INFO - Finalizing chunk 1...
2025-11-13 15:18:28 - utils - INFO - Finalizing chunk 2...
2025-11-13 15:18:35 - utils - INFO - Finalizing chunk 3...
2025-11-13 15:18:43 - utils - INFO - Finalizing chunk 4...
2025-11-13 15:18:51 - utils - INFO - Finalizing chunk 5...
2025-11-13 15:18:58 - utils - INFO - Finalizing chunk 6...
2025-11-13 15:19:05 - utils - INFO - Finalizing chunk 7...
2025-11-13 15:19:12 - utils - INFO - Finalizing chunk 8...
2025-11-13 15:19:19 - utils - INFO - Finalizing chunk 9...
2025-11-13 15:19:26 - utils - INFO - Finalizing chunk 10...
2025-11-13 15:19:33 - utils - INFO - Finalizing chunk 11...
2025-11-13 15:19:40 - utils - INFO - Finalizing chunk 12...
2025-11-13 15:19:49 - utils - INFO - Finalizing chunk 13...
2025-11-13 15:20:02 - utils - INFO - Finalizing chunk 14...
2025-11-13 15:20:16 - utils - INFO - Finalizing chunk 15...
2025-11-13 15:20:30 - utils - INFO - Finalizing chunk 16...
2025-11-13 15:20:43 - utils - INFO - Finalizing chunk 17...
2025-11-13 15:20:56 - utils - INFO - Finalizing chunk 18...
2025-11-13 15:21:09 - utils - INFO - Finalizing chunk 19...
2025-11-13 15:21:22 - utils - INFO - Finalizing chunk 20...
2025-11-13 15:21:36 - utils - INFO - Finalizing chunk 21...
2025-11-13 15:21:49 - utils - INFO - Finalizing chunk 22...
2025-11-13 15:22:03 - utils - INFO - Finalizing chunk 23...
2025-11-13 15:22:16 - utils - INFO - Finalizing chunk 24...
2025-11-13 15:22:29 - utils - INFO - Finalizing chunk 25...
2025-11-13 15:22:42 - utils - INFO - Finalizing chunk 26...
2025-11-13 15:22:56 - utils - INFO - Finalizing chunk 27...
2025-11-13 15:23:09 - utils - INFO - Finalizing chunk 28...
2025-11-13 15:23:22 - utils - INFO - Finalizing chunk 29...
2025-11-13 15:23:35 - utils - INFO - Finalizing chunk 30...
2025-11-13 15:23:48 - utils - INFO - Finalizing chunk 31...
2025-11-13 15:24:02 - utils - INFO - Finalizing chunk 32...
2025-11-13 15:24:15 - utils - INFO - Finalizing chunk 33...
2025-11-13 15:24:28 - utils - INFO - Finalizing chunk 34...
2025-11-13 15:24:41 - utils - INFO - Finalizing chunk 35...
2025-11-13 15:24:54 - utils - INFO - Finalizing chunk 36...
2025-11-13 15:25:07 - utils - INFO - Finalizing chunk 37...
2025-11-13 15:25:21 - utils - INFO - Finalizing chunk 38...
2025-11-13 15:25:30 - utils - INFO - Finalizing chunk 39...
2025-11-13 15:25:33 - utils - INFO - ================================================================================
2025-11-13 15:25:33 - utils - INFO - V2 Preprocessing Complete!
2025-11-13 15:25:33 - utils - INFO - Master file saved: processed_unified_logs_r1_r2_r3.1_ENRICHED.csv (38244604 rows)
2025-11-13 15:25:33 - utils - INFO - Next step: python label_insiders_v2.py
2025-11-13 15:25:33 - utils - INFO - ================================================================================
2025-11-13 15:34:11 - utils - INFO - Utility functions loaded successfully
2025-11-13 15:34:11 - utils - INFO - 
================================================================================
                         STATIC DATA PATCH SCRIPT (V2)                          
================================================================================

2025-11-13 15:34:11 - utils - INFO - Loading static data for subset: ['r1', 'r2', 'r3.1']
2025-11-13 15:34:11 - utils - INFO - Scanning for LDAP data in dataset folders...
2025-11-13 15:34:11 - utils - INFO - Loaded and de-duplicated LDAP data for 2999 users
2025-11-13 15:34:11 - utils - INFO - Loaded and de-duplicated psychometric data for 1999 users
2025-11-13 15:34:15 - utils - INFO - Patching chunk 1...
2025-11-13 15:34:32 - utils - INFO - Patching chunk 2...
2025-11-13 15:34:48 - utils - INFO - Patching chunk 3...
2025-11-13 15:35:03 - utils - INFO - Patching chunk 4...
2025-11-13 15:35:18 - utils - INFO - Patching chunk 5...
2025-11-13 15:35:33 - utils - INFO - Patching chunk 6...
2025-11-13 15:35:55 - utils - INFO - Patching chunk 7...
2025-11-13 15:36:23 - utils - INFO - Patching chunk 8...
2025-11-13 15:36:51 - utils - INFO - Patching chunk 9...
2025-11-13 15:37:18 - utils - INFO - Patching chunk 10...
2025-11-13 15:37:46 - utils - INFO - Patching chunk 11...
2025-11-13 15:38:13 - utils - INFO - Patching chunk 12...
2025-11-13 15:38:41 - utils - INFO - Patching chunk 13...
2025-11-13 15:39:08 - utils - INFO - Patching chunk 14...
2025-11-13 15:39:36 - utils - INFO - Patching chunk 15...
2025-11-13 15:40:03 - utils - INFO - Patching chunk 16...
2025-11-13 15:40:30 - utils - INFO - Patching chunk 17...
2025-11-13 15:40:58 - utils - INFO - Patching chunk 18...
2025-11-13 15:41:26 - utils - INFO - Patching chunk 19...
2025-11-13 15:41:44 - utils - INFO - Patching chunk 20...
2025-11-13 15:41:46 - utils - INFO - Patching complete. Replacing original file...
2025-11-13 15:41:47 - utils - INFO - Successfully patched processed_unified_logs_r1_r2_r3.1_ENRICHED.csv
2025-11-13 15:41:47 - utils - INFO - ================================================================================
2025-11-13 15:41:47 - utils - INFO - PATCH COMPLETE.
2025-11-13 15:41:47 - utils - INFO - Your data is now 100% correct.
2025-11-13 15:41:47 - utils - INFO - Next step: python label_insiders_v2.py
2025-11-13 15:41:47 - utils - INFO - ================================================================================
2025-11-13 15:42:03 - utils - INFO - Utility functions loaded successfully
2025-11-13 15:42:03 - utils - INFO - 
================================================================================
                  LABELING INSIDER THREATS (V2: MULTI-DATASET)                  
================================================================================

2025-11-13 15:42:03 - utils - INFO - Loading CMU-CERT master answers file (insiders.csv)...
2025-11-13 15:42:03 - utils - INFO - Loaded 191 total insider incidents
2025-11-13 15:42:03 - utils - WARNING - Could not parse dates for CDE1846 in 6.2: month must be in 1..12: /21/2011 11:43:39, at position 0
2025-11-13 15:42:03 - utils - INFO - Parsed and normalized 190 insider activity rules
2025-11-13 15:42:03 - utils - INFO - Sample of normalized rules:
2025-11-13 15:42:03 - utils - INFO -   - User: ONS0995, Dataset: r2, Start: 2010-03-06
2025-11-13 15:42:03 - utils - INFO -   - User: CSF0929, Dataset: r3.1, Start: 2010-07-01
2025-11-13 15:42:03 - utils - INFO -   - User: CCH0959, Dataset: r3.1, Start: 2010-08-02
2025-11-13 15:42:03 - utils - INFO -   ...and 187 more.
2025-11-13 15:42:03 - utils - INFO - Loaded 190 unique (user, dataset) rule combinations.
2025-11-13 15:42:03 - utils - INFO - Example rule keys: [('ONS0995', 'r2'), ('CSF0929', 'r3.1'), ('CCH0959', 'r3.1'), ('RCW0822', 'r3.2'), ('JCE0258', 'r3.2')]
2025-11-13 15:42:05 - utils - INFO - Processing chunk 1 (1000000 rows)...
2025-11-13 15:42:13 - utils - INFO - Processing chunk 2 (1000000 rows)...
2025-11-13 15:42:14 - utils - INFO -   > Labeled 53 records in this chunk.
2025-11-13 15:42:22 - utils - INFO - Processing chunk 3 (1000000 rows)...
2025-11-13 15:42:31 - utils - INFO - Processing chunk 4 (1000000 rows)...
2025-11-13 15:42:39 - utils - INFO - Processing chunk 5 (1000000 rows)...
2025-11-13 15:42:40 - utils - INFO -   > Labeled 17 records in this chunk.
2025-11-13 15:42:47 - utils - INFO - Processing chunk 6 (1000000 rows)...
2025-11-13 15:42:55 - utils - INFO - Processing chunk 7 (1000000 rows)...
2025-11-13 15:43:03 - utils - INFO - Processing chunk 8 (1000000 rows)...
2025-11-13 15:43:10 - utils - INFO - Processing chunk 9 (1000000 rows)...
2025-11-13 15:43:18 - utils - INFO - Processing chunk 10 (1000000 rows)...
2025-11-13 15:43:26 - utils - INFO - Processing chunk 11 (1000000 rows)...
2025-11-13 15:43:33 - utils - INFO - Processing chunk 12 (1000000 rows)...
2025-11-13 15:43:34 - utils - INFO -   > Labeled 136 records in this chunk.
2025-11-13 15:43:43 - utils - INFO - Processing chunk 13 (1000000 rows)...
2025-11-13 15:43:44 - utils - INFO -   > Labeled 426 records in this chunk.
2025-11-13 15:43:57 - utils - INFO - Processing chunk 14 (1000000 rows)...
2025-11-13 15:44:11 - utils - INFO - Processing chunk 15 (1000000 rows)...
2025-11-13 15:44:26 - utils - INFO - Processing chunk 16 (1000000 rows)...
2025-11-13 15:44:40 - utils - INFO - Processing chunk 17 (1000000 rows)...
2025-11-13 15:44:53 - utils - INFO - Processing chunk 18 (1000000 rows)...
2025-11-13 15:45:07 - utils - INFO - Processing chunk 19 (1000000 rows)...
2025-11-13 15:45:20 - utils - INFO - Processing chunk 20 (1000000 rows)...
2025-11-13 15:45:34 - utils - INFO - Processing chunk 21 (1000000 rows)...
2025-11-13 15:45:48 - utils - INFO - Processing chunk 22 (1000000 rows)...
2025-11-13 15:46:01 - utils - INFO - Processing chunk 23 (1000000 rows)...
2025-11-13 15:46:15 - utils - INFO - Processing chunk 24 (1000000 rows)...
2025-11-13 15:46:15 - utils - INFO -   > Labeled 612 records in this chunk.
2025-11-13 15:46:28 - utils - INFO - Processing chunk 25 (1000000 rows)...
2025-11-13 15:46:28 - utils - INFO -   > Labeled 549 records in this chunk.
2025-11-13 15:46:42 - utils - INFO - Processing chunk 26 (1000000 rows)...
2025-11-13 15:46:42 - utils - INFO -   > Labeled 3211 records in this chunk.
2025-11-13 15:46:55 - utils - INFO - Processing chunk 27 (1000000 rows)...
2025-11-13 15:46:55 - utils - INFO -   > Labeled 3236 records in this chunk.
2025-11-13 15:47:09 - utils - INFO - Processing chunk 28 (1000000 rows)...
2025-11-13 15:47:09 - utils - INFO -   > Labeled 2729 records in this chunk.
2025-11-13 15:47:22 - utils - INFO - Processing chunk 29 (1000000 rows)...
2025-11-13 15:47:35 - utils - INFO - Processing chunk 30 (1000000 rows)...
2025-11-13 15:47:49 - utils - INFO - Processing chunk 31 (1000000 rows)...
2025-11-13 15:48:02 - utils - INFO - Processing chunk 32 (1000000 rows)...
2025-11-13 15:48:16 - utils - INFO - Processing chunk 33 (1000000 rows)...
2025-11-13 15:48:29 - utils - INFO - Processing chunk 34 (1000000 rows)...
2025-11-13 15:48:43 - utils - INFO - Processing chunk 35 (1000000 rows)...
2025-11-13 15:48:56 - utils - INFO - Processing chunk 36 (1000000 rows)...
2025-11-13 15:49:10 - utils - INFO - Processing chunk 37 (1000000 rows)...
2025-11-13 15:49:23 - utils - INFO - Processing chunk 38 (1000000 rows)...
2025-11-13 15:49:33 - utils - INFO - Processing chunk 39 (244604 rows)...
2025-11-13 15:49:35 - utils - INFO - All chunks processed. Total rows: 38244604
2025-11-13 15:49:35 - utils - INFO - Total insider records labeled: 10969
2025-11-13 15:49:35 - utils - INFO - Successfully created: /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs_r1_r2_r3.1_LABELED.csv
2025-11-13 15:49:35 - utils - INFO - ================================================================================
2025-11-13 15:49:35 - utils - INFO - V2 Labeling Complete!
2025-11-13 15:49:35 - utils - INFO - The file 'processed_unified_logs_r1_r2_r3.1_LABELED.csv' is now labeled.
2025-11-13 15:49:35 - utils - INFO - Next step: Run 'feature_engineering_v2.py'
2025-11-13 15:49:35 - utils - INFO - ================================================================================
2025-11-13 15:53:46 - utils - INFO - Utility functions loaded successfully
2025-11-13 15:53:46 - utils - INFO - Feature Engineer V2 initialized. Reading from: processed_unified_logs_r1_r2_r3.1_LABELED.csv
2025-11-13 15:53:46 - utils - INFO - 
================================================================================
                  FEATURE ENGINEERING PIPELINE V2 (MULTI-PASS)                  
================================================================================

2025-11-13 15:53:46 - utils - INFO - 
================================================================================
                           PASS 1: DAILY AGGREGATION                            
================================================================================

2025-11-13 15:53:46 - utils - INFO - Reading /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs_r1_r2_r3.1_LABELED.csv in 2000000-row chunks...
2025-11-13 15:53:49 - utils - INFO - Processing chunk 1...
2025-11-13 15:53:54 - utils - INFO - Processing chunk 2...
2025-11-13 15:53:58 - utils - INFO - Processing chunk 3...
2025-11-13 15:54:01 - utils - INFO - Processing chunk 4...
2025-11-13 15:54:04 - utils - INFO - Processing chunk 5...
2025-11-13 15:54:07 - utils - INFO - Processing chunk 6...
2025-11-13 15:54:13 - utils - INFO - Processing chunk 7...
2025-11-13 15:54:18 - utils - INFO - Processing chunk 8...
2025-11-13 15:54:23 - utils - INFO - Processing chunk 9...
2025-11-13 15:54:28 - utils - INFO - Processing chunk 10...
2025-11-13 15:54:32 - utils - INFO - Processing chunk 11...
2025-11-13 15:54:37 - utils - INFO - Processing chunk 12...
2025-11-13 15:54:41 - utils - INFO - Processing chunk 13...
2025-11-13 15:54:46 - utils - INFO - Processing chunk 14...
2025-11-13 15:54:50 - utils - INFO - Processing chunk 15...
2025-11-13 15:54:55 - utils - INFO - Processing chunk 16...
2025-11-13 15:54:59 - utils - INFO - Processing chunk 17...
2025-11-13 15:55:04 - utils - INFO - Processing chunk 18...
2025-11-13 15:55:08 - utils - INFO - Processing chunk 19...
2025-11-13 15:55:09 - utils - INFO - Processing chunk 20...
2025-11-13 15:55:09 - utils - INFO - All 20 chunks processed. Merging daily summaries...
2025-11-13 15:55:10 - utils - INFO - Cleaning up temporary chunk files...
2025-11-13 15:55:14 - utils - INFO - PASS 1 complete. Saved /Users/bipinrimal/Downloads/Thesis_work/data/processed/daily_features_unscaled_r1_r2_r3.1_v2.csv (1655902 rows)
2025-11-13 15:55:14 - utils - INFO - 
================================================================================
                     PASS 2: FEATURE ENRICHMENT (Z-SCORES)                      
================================================================================

2025-11-13 15:55:14 - utils - INFO - Verified 'role' column for Pass 2.
2025-11-13 15:55:14 - utils - INFO - Calculating self-relative Z-Scores (rolling 30-day)...
2025-11-13 15:55:18 - utils - INFO - Calculating peer-relative Z-Scores (by role)...
2025-11-13 15:55:19 - utils - INFO - PASS 2 complete. Enriched features created.
2025-11-13 15:55:19 - utils - INFO - Scaling and saving final daily features (for LSTM)...
2025-11-13 15:55:19 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/daily_feature_scaler_v2.pkl
2025-11-13 15:55:42 - utils - INFO - Saved /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_daily_features_r1_r2_r3.1_v2.csv
2025-11-13 15:55:42 - utils - INFO - 
================================================================================
                        PASS 3: STATIC FEATURE CREATION                         
================================================================================

2025-11-13 15:55:42 - utils - INFO - Created static features for 4999 users
2025-11-13 15:55:42 - utils - INFO - Scaling and saving static features...
2025-11-13 15:55:42 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/static_feature_scaler_v2.pkl
2025-11-13 15:55:42 - utils - INFO - PASS 3 complete. Saved /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_static_features_r1_r2_r3.1_v2.csv
2025-11-13 15:55:42 - utils - INFO - 
================================================================================
                           PASS 4: SEQUENCE CREATION                            
================================================================================

2025-11-13 15:55:42 - utils - INFO - Creating sequences (length=15, stride=10)...
2025-11-13 15:58:06 - utils - INFO - Created 162520 sequences from 4999 users
2025-11-13 15:58:07 - utils - INFO - PASS 4 complete. Saved sequence files to /Users/bipinrimal/Downloads/Thesis_work/data/processed
2025-11-13 15:58:07 - utils - INFO - ================================================================================
2025-11-13 15:58:07 - utils - INFO - V2 Feature Engineering Complete!
2025-11-13 15:58:07 - utils - INFO -   Static features created: /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_static_features_r1_r2_r3.1_v2.csv
2025-11-13 15:58:07 - utils - INFO -   Sequence files created: /Users/bipinrimal/Downloads/Thesis_work/data/processed
2025-11-13 15:58:07 - utils - INFO - Next step: Train V2 models.
2025-11-13 15:58:07 - utils - INFO - ================================================================================
2025-11-13 15:58:21 - utils - INFO - Utility functions loaded successfully
2025-11-13 15:58:21 - utils - INFO - 
================================================================================
                 ISOLATION FOREST TRAINING (V2: MULTI-DATASET)                  
================================================================================

2025-11-13 15:58:21 - utils - ERROR - Failed to load 'engineered_static_features_v2.csv'. Run feature_engineering_v2.py first. Error: [Errno 2] No such file or directory: '/Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_static_features_v2.csv'
2025-11-13 16:00:47 - utils - INFO - Utility functions loaded successfully
2025-11-13 16:00:47 - utils - INFO - Feature Engineer V2 initialized. Reading from: processed_unified_logs_r1_r2_r3.1_LABELED.csv
2025-11-13 16:00:47 - utils - INFO - 
================================================================================
                  FEATURE ENGINEERING PIPELINE V2 (MULTI-PASS)                  
================================================================================

2025-11-13 16:00:47 - utils - INFO - Found /Users/bipinrimal/Downloads/Thesis_work/data/processed/daily_features_unscaled_r1_r2_r3.1_v2.csv, skipping Pass 1.
2025-11-13 16:00:48 - utils - INFO - 
================================================================================
                     PASS 2: FEATURE ENRICHMENT (Z-SCORES)                      
================================================================================

2025-11-13 16:00:48 - utils - INFO - Verified 'role' column for Pass 2.
2025-11-13 16:00:48 - utils - INFO - Calculating self-relative Z-Scores (rolling 30-day)...
2025-11-13 16:00:52 - utils - INFO - Calculating peer-relative Z-Scores (by role)...
2025-11-13 16:00:53 - utils - INFO - PASS 2 complete. Enriched features created.
2025-11-13 16:00:53 - utils - INFO - Scaling and saving final daily features (for LSTM)...
2025-11-13 16:00:53 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/daily_feature_scaler_v2.pkl
2025-11-13 16:01:16 - utils - INFO - Saved /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_daily_features_r1_r2_r3.1_v2.csv
2025-11-13 16:01:16 - utils - INFO - 
================================================================================
                        PASS 3: STATIC FEATURE CREATION                         
================================================================================

2025-11-13 16:01:16 - utils - INFO - Created static features for 4999 users
2025-11-13 16:01:16 - utils - INFO - Scaling and saving static features...
2025-11-13 16:01:16 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/static_feature_scaler_v2.pkl
2025-11-13 16:01:16 - utils - INFO - PASS 3 complete. Saved /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_static_features_r1_r2_r3.1_v2.csv
2025-11-13 16:01:16 - utils - INFO - 
================================================================================
                           PASS 4: SEQUENCE CREATION                            
================================================================================

2025-11-13 16:01:16 - utils - INFO - Creating sequences (length=15, stride=10)...
2025-11-13 16:03:38 - utils - INFO - Created 162520 sequences from 4999 users
2025-11-13 16:03:38 - utils - INFO - PASS 4 complete. Saved sequence files to /Users/bipinrimal/Downloads/Thesis_work/data/processed
2025-11-13 16:03:38 - utils - INFO - ================================================================================
2025-11-13 16:03:38 - utils - INFO - V2 Feature Engineering Complete!
2025-11-13 16:03:38 - utils - INFO -   Static features created: /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_static_features_r1_r2_r3.1_v2.csv
2025-11-13 16:03:38 - utils - INFO -   Sequence files created: /Users/bipinrimal/Downloads/Thesis_work/data/processed
2025-11-13 16:03:38 - utils - INFO - Next step: Train V2 models.
2025-11-13 16:03:38 - utils - INFO - ================================================================================
2025-11-13 16:04:10 - utils - INFO - Utility functions loaded successfully
2025-11-13 16:04:10 - utils - INFO - 
================================================================================
                 ISOLATION FOREST TRAINING (V2: MULTI-DATASET)                  
================================================================================

2025-11-13 16:04:10 - utils - ERROR - Failed to load 'engineered_static_features_v2.csv'. Run feature_engineering_v2.py first. Error: [Errno 2] No such file or directory: '/Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_static_features_v2.csv'
2025-11-13 16:06:01 - utils - INFO - Utility functions loaded successfully
2025-11-13 16:06:01 - utils - INFO - 
================================================================================
                 ISOLATION FOREST TRAINING (V2: MULTI-DATASET)                  
================================================================================

2025-11-13 16:06:01 - utils - ERROR - Failed to load 'engineered_static_features_v2.csv'. Run feature_engineering_v2.py first. Error: [Errno 2] No such file or directory: '/Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_static_features_v2.csv'
2025-11-13 16:06:32 - utils - INFO - Utility functions loaded successfully
2025-11-13 16:06:32 - utils - INFO - 
================================================================================
                 ISOLATION FOREST TRAINING (V2: MULTI-DATASET)                  
================================================================================

2025-11-13 16:06:32 - utils - ERROR - Failed to load 'engineered_static_features_v2.csv'. Run feature_engineering_v2.py first. Error: [Errno 2] No such file or directory: '/Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_static_features_v2.csv'
2025-11-13 16:10:06 - utils - INFO - Utility functions loaded successfully
2025-11-13 16:10:06 - utils - INFO - 
================================================================================
                 ISOLATION FOREST TRAINING (V2: MULTI-DATASET)                  
================================================================================

2025-11-13 16:10:06 - utils - ERROR - Failed to load 'engineered_static_features_v2.csv'. Run feature_engineering_v2.py first. Error: [Errno 2] No such file or directory: '/Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_static_features_v2.csv'
2025-11-13 16:12:50 - utils - INFO - Utility functions loaded successfully
2025-11-13 16:12:50 - utils - INFO - 
================================================================================
                 ISOLATION FOREST TRAINING (V2: MULTI-DATASET)                  
================================================================================

2025-11-13 16:12:50 - utils - ERROR - Failed to load 'engineered_static_features_v2.csv'. Run feature_engineering_v2.py first. Error: [Errno 2] No such file or directory: '/Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_static_features_v2.csv'
2025-11-13 16:13:02 - utils - INFO - Utility functions loaded successfully
2025-11-13 16:13:02 - utils - INFO - 
================================================================================
                 ISOLATION FOREST TRAINING (V2: MULTI-DATASET)                  
================================================================================

2025-11-13 16:13:02 - utils - ERROR - Failed to load 'engineered_static_features_v2.csv'. Run feature_engineering_v2.py first. Error: [Errno 2] No such file or directory: '/Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_static_features_v2.csv'
2025-11-13 16:13:49 - utils - INFO - Utility functions loaded successfully
2025-11-13 16:13:49 - utils - INFO - 
================================================================================
                 ISOLATION FOREST TRAINING (V2: MULTI-DATASET)                  
================================================================================

2025-11-13 16:13:49 - utils - ERROR - Failed to load 'engineered_static_features_v2.csv'. Run feature_engineering_v2.py first. Error: [Errno 2] No such file or directory: '/Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_static_features_v2.csv'
2025-11-13 16:14:16 - utils - INFO - Utility functions loaded successfully
2025-11-13 16:14:16 - utils - INFO - 
================================================================================
                 ISOLATION FOREST TRAINING (V2: MULTI-DATASET)                  
================================================================================

2025-11-13 16:14:16 - utils - ERROR - Failed to load 'engineered_static_features_v2.csv'. Run feature_engineering_v2.py first. Error: [Errno 2] No such file or directory: '/Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_static_features_v2.csv'
2025-11-13 16:14:48 - utils - INFO - Utility functions loaded successfully
2025-11-13 16:14:48 - utils - INFO - 
================================================================================
                 ISOLATION FOREST TRAINING (V2: MULTI-DATASET)                  
================================================================================

2025-11-13 16:14:48 - utils - ERROR - Failed to load 'engineered_static_features_v2.csv'. Run feature_engineering_v2.py first. Error: [Errno 2] No such file or directory: '/Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_static_features_v2.csv'
2025-11-13 16:15:26 - utils - INFO - Utility functions loaded successfully
2025-11-13 16:15:26 - utils - INFO - 
================================================================================
                 ISOLATION FOREST TRAINING (V2: MULTI-DATASET)                  
================================================================================

2025-11-13 16:15:26 - utils - ERROR - Failed to load 'engineered_static_features_v2.csv'. Run feature_engineering_v2.py first. Error: [Errno 2] No such file or directory: '/Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_static_features_v2.csv'
2025-11-13 16:16:19 - utils - INFO - Utility functions loaded successfully
2025-11-13 16:16:19 - utils - INFO - Feature Engineer V2 initialized. Reading from: processed_unified_logs_r1_r2_r3.1_LABELED.csv
2025-11-13 16:16:19 - utils - INFO - 
================================================================================
                  FEATURE ENGINEERING PIPELINE V2 (MULTI-PASS)                  
================================================================================

2025-11-13 16:16:19 - utils - INFO - Found /Users/bipinrimal/Downloads/Thesis_work/data/processed/daily_features_unscaled_r1_r2_r3.1_v2.csv, skipping Pass 1.
2025-11-13 16:16:20 - utils - INFO - 
================================================================================
                     PASS 2: FEATURE ENRICHMENT (Z-SCORES)                      
================================================================================

2025-11-13 16:16:20 - utils - INFO - Verified 'role' column for Pass 2.
2025-11-13 16:16:20 - utils - INFO - Calculating self-relative Z-Scores (rolling 30-day)...
2025-11-13 16:16:23 - utils - INFO - Calculating peer-relative Z-Scores (by role)...
2025-11-13 16:16:24 - utils - INFO - PASS 2 complete. Enriched features created.
2025-11-13 16:16:24 - utils - INFO - Scaling and saving final daily features (for LSTM)...
2025-11-13 16:16:24 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/daily_feature_scaler_v2.pkl
2025-11-13 16:16:47 - utils - INFO - Saved /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_daily_features_r1_r2_r3.1_v2.csv
2025-11-13 16:16:47 - utils - INFO - 
================================================================================
                        PASS 3: STATIC FEATURE CREATION                         
================================================================================

2025-11-13 16:16:47 - utils - INFO - Created static features for 4999 users
2025-11-13 16:16:47 - utils - INFO - Scaling and saving static features...
2025-11-13 16:16:47 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/static_feature_scaler_v2.pkl
2025-11-13 16:16:47 - utils - INFO - PASS 3 complete. Saved /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_static_features_r1_r2_r3.1_v2.csv
2025-11-13 16:16:47 - utils - INFO - 
================================================================================
                           PASS 4: SEQUENCE CREATION                            
================================================================================

2025-11-13 16:16:47 - utils - INFO - Creating sequences (length=15, stride=10)...
2025-11-13 16:19:13 - utils - INFO - Created 162520 sequences from 4999 users
2025-11-13 16:19:13 - utils - INFO - PASS 4 complete. Saved sequence files to /Users/bipinrimal/Downloads/Thesis_work/data/processed
2025-11-13 16:19:13 - utils - INFO - ================================================================================
2025-11-13 16:19:13 - utils - INFO - V2 Feature Engineering Complete!
2025-11-13 16:19:13 - utils - INFO -   Static features created: /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_static_features_r1_r2_r3.1_v2.csv
2025-11-13 16:19:13 - utils - INFO -   Sequence files created: /Users/bipinrimal/Downloads/Thesis_work/data/processed
2025-11-13 16:19:13 - utils - INFO - Next step: Train V2 models.
2025-11-13 16:19:13 - utils - INFO - ================================================================================
2025-11-13 16:21:53 - utils - INFO - Utility functions loaded successfully
2025-11-13 16:21:53 - utils - INFO - 
================================================================================
                 ISOLATION FOREST TRAINING (V2: MULTI-DATASET)                  
================================================================================

2025-11-13 16:21:53 - utils - ERROR - Failed to load 'engineered_static_features_v2.csv'. Run feature_engineering_v2.py first. Error: [Errno 2] No such file or directory: '/Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_static_features_v2.csv'
2025-11-13 16:24:34 - utils - INFO - Utility functions loaded successfully
2025-11-13 16:24:34 - utils - INFO - 
================================================================================
                 ISOLATION FOREST TRAINING (V2: MULTI-DATASET)                  
================================================================================

2025-11-13 16:24:34 - utils - ERROR - Failed to load 'engineered_static_features_v2.csv'. Run feature_engineering_v2.py first. Error: [Errno 2] No such file or directory: '/Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_static_features_v2.csv'
2025-11-13 16:24:42 - utils - INFO - Utility functions loaded successfully
2025-11-13 16:24:42 - utils - INFO - 
================================================================================
                 ISOLATION FOREST TRAINING (V2: MULTI-DATASET)                  
================================================================================

2025-11-13 16:24:42 - utils - ERROR - Failed to load 'engineered_static_features_v2.csv'. Run feature_engineering_v2.py first. Error: [Errno 2] No such file or directory: '/Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_static_features_v2.csv'
2025-11-13 16:25:43 - utils - INFO - Utility functions loaded successfully
2025-11-13 16:25:43 - utils - INFO - 
================================================================================
                 ISOLATION FOREST TRAINING (V2: MULTI-DATASET)                  
================================================================================

2025-11-13 16:25:43 - utils - INFO - Model loaded from /Users/bipinrimal/Downloads/Thesis_work/models/static_feature_scaler_v2.pkl
2025-11-13 16:25:43 - utils - INFO - Data split: 4999 total samples, 9 insiders
2025-11-13 16:25:43 - utils - INFO - Training on: 3996 normal samples
2025-11-13 16:25:43 - utils - INFO - Calibrating on: 1000 normal samples
2025-11-13 16:25:43 - utils - INFO - Testing on: 4999 total samples (including 9 insiders)
2025-11-13 16:25:43 - utils - INFO - Initialized Isolation Forest (V2) with params: {'n_estimators': 50, 'max_samples': 256, 'contamination': 'auto', 'max_features': 1.0, 'bootstrap': False, 'n_jobs': -1, 'random_state': 42, 'verbose': 0}
2025-11-13 16:25:43 - utils - INFO - Training Isolation Forest on 3996 normal samples...
2025-11-13 16:25:43 - utils - INFO - Isolation Forest training completed
2025-11-13 16:25:43 - utils - INFO - Calibrating threshold for target FPR=0.05...
2025-11-13 16:25:43 - utils - INFO - Calibrated threshold: 0.5348
2025-11-13 16:25:43 - utils - INFO - Evaluating Isolation Forest (V2)...
2025-11-13 16:25:43 - utils - INFO - Test set contains 9 positive samples.
2025-11-13 16:29:41 - utils - INFO - Utility functions loaded successfully
2025-11-13 16:29:41 - utils - INFO - 
================================================================================
                 ISOLATION FOREST TRAINING (V2: MULTI-DATASET)                  
================================================================================

2025-11-13 16:29:41 - utils - ERROR - Failed to load 'engineered_static_features_v2.csv'. Run feature_engineering_v2.py first. Error: [Errno 2] No such file or directory: '/Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_static_features_v2.csv'
2025-11-13 16:30:06 - utils - INFO - Utility functions loaded successfully
2025-11-13 16:30:06 - utils - INFO - 
================================================================================
                 ISOLATION FOREST TRAINING (V2: MULTI-DATASET)                  
================================================================================

2025-11-13 16:30:06 - utils - INFO - Model loaded from /Users/bipinrimal/Downloads/Thesis_work/models/static_feature_scaler_v2.pkl
2025-11-13 16:30:06 - utils - INFO - Data split: 4999 total samples, 9 insiders
2025-11-13 16:30:06 - utils - INFO - Training on: 3996 normal samples
2025-11-13 16:30:06 - utils - INFO - Calibrating on: 1000 normal samples
2025-11-13 16:30:06 - utils - INFO - Testing on: 4999 total samples (including 9 insiders)
2025-11-13 16:30:06 - utils - INFO - Initialized Isolation Forest (V2) with params: {'n_estimators': 50, 'max_samples': 256, 'contamination': 'auto', 'max_features': 1.0, 'bootstrap': False, 'n_jobs': -1, 'random_state': 42, 'verbose': 0}
2025-11-13 16:30:06 - utils - INFO - Training Isolation Forest on 3996 normal samples...
2025-11-13 16:30:06 - utils - INFO - Isolation Forest training completed
2025-11-13 16:30:06 - utils - INFO - Calibrating threshold for target FPR=0.05...
2025-11-13 16:30:06 - utils - INFO - Calibrated threshold: 0.5348
2025-11-13 16:30:06 - utils - INFO - Evaluating Isolation Forest (V2)...
2025-11-13 16:30:06 - utils - INFO - Test set contains 9 positive samples.
2025-11-13 16:32:38 - utils - INFO - Utility functions loaded successfully
2025-11-13 16:32:38 - utils - INFO - 
================================================================================
                 ISOLATION FOREST TRAINING (V2: MULTI-DATASET)                  
================================================================================

2025-11-13 16:32:38 - utils - ERROR - Failed to load 'engineered_static_features_v2.csv'. Run feature_engineering_v2.py first. Error: [Errno 2] No such file or directory: '/Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_static_features_v2.csv'
2025-11-13 16:32:55 - utils - INFO - Utility functions loaded successfully
2025-11-13 16:32:55 - utils - INFO - 
================================================================================
                 ISOLATION FOREST TRAINING (V2: MULTI-DATASET)                  
================================================================================

2025-11-13 16:32:55 - utils - INFO - Model loaded from /Users/bipinrimal/Downloads/Thesis_work/models/static_feature_scaler_v2.pkl
2025-11-13 16:32:55 - utils - INFO - Data split: 4999 total samples, 9 insiders
2025-11-13 16:32:55 - utils - INFO - Training on: 3996 normal samples
2025-11-13 16:32:55 - utils - INFO - Calibrating on: 1000 normal samples
2025-11-13 16:32:55 - utils - INFO - Testing on: 4999 total samples (including 9 insiders)
2025-11-13 16:32:55 - utils - INFO - Initialized Isolation Forest (V2) with params: {'n_estimators': 50, 'max_samples': 256, 'contamination': 'auto', 'max_features': 1.0, 'bootstrap': False, 'n_jobs': -1, 'random_state': 42, 'verbose': 0}
2025-11-13 16:32:55 - utils - INFO - Training Isolation Forest on 3996 normal samples...
2025-11-13 16:32:55 - utils - INFO - Isolation Forest training completed
2025-11-13 16:32:55 - utils - INFO - Calibrating threshold for target FPR=0.05...
2025-11-13 16:32:55 - utils - INFO - Calibrated threshold: 0.5348
2025-11-13 16:32:55 - utils - INFO - Evaluating Isolation Forest (V2)...
2025-11-13 16:32:55 - utils - INFO - Test set contains 9 positive samples.
2025-11-13 16:38:35 - utils - INFO - Utility functions loaded successfully
2025-11-13 16:38:35 - utils - INFO - 
================================================================================
                 ISOLATION FOREST TRAINING (V2: MULTI-DATASET)                  
================================================================================

2025-11-13 16:38:35 - utils - ERROR - Failed to load 'engineered_static_features_v2.csv'. Run feature_engineering_v2.py first. Error: [Errno 2] No such file or directory: '/Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_static_features_v2.csv'
2025-11-13 16:38:49 - utils - INFO - Utility functions loaded successfully
2025-11-13 16:38:49 - utils - INFO - 
================================================================================
                 ISOLATION FOREST TRAINING (V2: MULTI-DATASET)                  
================================================================================

2025-11-13 16:38:49 - utils - INFO - Model loaded from /Users/bipinrimal/Downloads/Thesis_work/models/static_feature_scaler_v2.pkl
2025-11-13 16:38:49 - utils - INFO - Data split: 4999 total samples, 9 insiders
2025-11-13 16:38:49 - utils - INFO - Training on: 3996 normal samples
2025-11-13 16:38:49 - utils - INFO - Calibrating on: 1000 normal samples
2025-11-13 16:38:49 - utils - INFO - Testing on: 4999 total samples (including 9 insiders)
2025-11-13 16:38:49 - utils - INFO - Initialized Isolation Forest (V2) with params: {'n_estimators': 50, 'max_samples': 256, 'contamination': 'auto', 'max_features': 1.0, 'bootstrap': False, 'n_jobs': -1, 'random_state': 42, 'verbose': 0}
2025-11-13 16:38:49 - utils - INFO - Training Isolation Forest on 3996 normal samples...
2025-11-13 16:38:49 - utils - INFO - Isolation Forest training completed
2025-11-13 16:38:49 - utils - INFO - Calibrating threshold for target FPR=0.05...
2025-11-13 16:38:49 - utils - INFO - Calibrated threshold: 0.5348
2025-11-13 16:38:49 - utils - INFO - Evaluating Isolation Forest (V2)...
2025-11-13 16:38:49 - utils - INFO - Test set contains 9 positive samples.
2025-11-13 16:38:49 - utils - INFO - 
============================================================
2025-11-13 16:38:49 - utils - INFO - Isolation Forest (V2) Performance Metrics
2025-11-13 16:38:49 - utils - INFO - ============================================================
2025-11-13 16:38:49 - utils - INFO - Accuracy:  0.9440
2025-11-13 16:38:49 - utils - INFO - Precision: 0.0071
2025-11-13 16:38:49 - utils - INFO - Recall:    0.6667
2025-11-13 16:38:49 - utils - INFO - F1-Score:  0.0141
2025-11-13 16:38:49 - utils - INFO - AUC-ROC:   0.9185
2025-11-13 16:38:49 - utils - INFO - ============================================================

2025-11-13 16:38:49 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest_v2.pkl
2025-11-13 16:38:49 - utils - INFO - Saving Isolation Forest model to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest_v2.pkl
2025-11-13 16:38:49 - utils - INFO - Isolation Forest (V2) training and evaluation completed!
2025-11-13 16:40:47 - utils - INFO - Utility functions loaded successfully
2025-11-13 16:40:47 - utils - INFO - 
================================================================================
                 ISOLATION FOREST TRAINING (V2: MULTI-DATASET)                  
================================================================================

2025-11-13 16:40:47 - utils - INFO - Model loaded from /Users/bipinrimal/Downloads/Thesis_work/models/static_feature_scaler_v2.pkl
2025-11-13 16:40:47 - utils - INFO - Data split: 4999 total samples, 9 insiders
2025-11-13 16:40:47 - utils - INFO - Training on: 3996 normal samples
2025-11-13 16:40:47 - utils - INFO - Calibrating on: 1000 normal samples
2025-11-13 16:40:47 - utils - INFO - Testing on: 4999 total samples (including 9 insiders)
2025-11-13 16:40:47 - utils - INFO - Initialized Isolation Forest (V2) with params: {'n_estimators': 50, 'max_samples': 256, 'contamination': 'auto', 'max_features': 1.0, 'bootstrap': False, 'n_jobs': -1, 'random_state': 42, 'verbose': 0}
2025-11-13 16:40:47 - utils - INFO - Training Isolation Forest on 3996 normal samples...
2025-11-13 16:40:47 - utils - INFO - Isolation Forest training completed
2025-11-13 16:40:47 - utils - INFO - Calibrating threshold for target FPR=0.05...
2025-11-13 16:40:47 - utils - INFO - Calibrated threshold: 0.5348
2025-11-13 16:40:47 - utils - INFO - Evaluating Isolation Forest (V2)...
2025-11-13 16:40:47 - utils - INFO - Test set contains 9 positive samples.
2025-11-13 16:40:47 - utils - INFO - 
============================================================
2025-11-13 16:40:47 - utils - INFO - Isolation Forest (V2) Performance Metrics
2025-11-13 16:40:47 - utils - INFO - ============================================================
2025-11-13 16:40:47 - utils - INFO - Accuracy:  0.9440
2025-11-13 16:40:47 - utils - INFO - Precision: 0.0071
2025-11-13 16:40:47 - utils - INFO - Recall:    0.6667
2025-11-13 16:40:47 - utils - INFO - F1-Score:  0.0141
2025-11-13 16:40:47 - utils - INFO - AUC-ROC:   0.9185
2025-11-13 16:40:47 - utils - INFO - ============================================================

2025-11-13 16:40:47 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest_v2.pkl
2025-11-13 16:40:47 - utils - INFO - Saving Isolation Forest model to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest_v2.pkl
2025-11-13 16:40:47 - utils - INFO - Isolation Forest (V2) training and evaluation completed!
2025-11-13 16:41:09 - utils - INFO - Utility functions loaded successfully
2025-11-13 16:41:19 - utils - INFO - 
================================================================================
            LIGHTWEIGHT DEEP CLUSTERING TRAINING (V2: MULTI-DATASET)            
================================================================================

2025-11-13 16:41:19 - utils - INFO - Model loaded from /Users/bipinrimal/Downloads/Thesis_work/models/static_feature_scaler_v2.pkl
2025-11-13 16:41:19 - utils - INFO - Dataset: 4999 samples, 9 insiders
2025-11-13 16:41:19 - utils - INFO - Training on: 3996 normal samples
2025-11-13 16:41:19 - utils - INFO - Calibrating on: 1000 normal samples
2025-11-13 16:41:19 - utils - INFO - Testing on: 4999 total samples (including 9 insiders)
2025-11-13 16:41:19 - utils - INFO - Initialized Lightweight Deep Clustering (V2) (n_clusters=5, encoding_dim=32)
2025-11-13 16:41:19 - utils - INFO - Training lightweight deep clustering model (V2)...
2025-11-13 16:41:19 - utils - INFO - Pre-training autoencoder...
2025-11-13 16:41:21 - utils - INFO - Autoencoder pre-training completed
2025-11-13 16:41:21 - utils - INFO - Fitting MiniBatch K-Means clustering...
2025-11-13 16:41:21 - utils - INFO - Deep clustering training completed
2025-11-13 16:41:21 - utils - INFO - Training completed in 1.64 seconds
2025-11-13 16:41:21 - utils - INFO - Calibrating threshold for target FPR=0.05...
2025-11-13 16:41:21 - utils - INFO - Calibrated threshold: 2.3712
2025-11-13 16:41:21 - utils - INFO - Evaluating lightweight deep clustering model (V2)...
2025-11-13 16:41:21 - utils - INFO - Test set contains 9 positive samples.
2025-11-13 16:41:21 - utils - INFO - 
============================================================
2025-11-13 16:41:21 - utils - INFO - Deep Clustering (V2) Performance Metrics
2025-11-13 16:41:21 - utils - INFO - ============================================================
2025-11-13 16:41:21 - utils - INFO - Accuracy:  0.9496
2025-11-13 16:41:21 - utils - INFO - Precision: 0.0079
2025-11-13 16:41:21 - utils - INFO - Recall:    0.6667
2025-11-13 16:41:21 - utils - INFO - F1-Score:  0.0156
2025-11-13 16:41:21 - utils - INFO - AUC-ROC:   0.8247
2025-11-13 16:41:21 - utils - INFO - ============================================================

2025-11-13 16:41:21 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/deep_clustering_v2.pkl
2025-11-13 16:41:21 - utils - INFO - Encoder model saved to /Users/bipinrimal/Downloads/Thesis_work/models/deep_clustering_v2_encoder.keras
2025-11-13 16:41:21 - utils - INFO - Deep Clustering (V2) training and evaluation completed!
2025-11-13 16:41:34 - utils - INFO - Utility functions loaded successfully
2025-11-13 16:41:36 - utils - INFO - 
================================================================================
           LIGHTWEIGHT LSTM AUTOENCODER TRAINING (V2: MULTI-DATASET)            
================================================================================

2025-11-13 16:41:36 - utils - ERROR - V2 Sequence data not found. Run feature_engineering_v2.py first. Error: [Errno 2] No such file or directory: '/Users/bipinrimal/Downloads/Thesis_work/data/processed/sequences_v2.npy'
2025-11-13 16:42:01 - utils - INFO - Utility functions loaded successfully
2025-11-13 16:42:03 - utils - INFO - 
================================================================================
            LIGHTWEIGHT DEEP CLUSTERING TRAINING (V2: MULTI-DATASET)            
================================================================================

2025-11-13 16:42:03 - utils - INFO - Model loaded from /Users/bipinrimal/Downloads/Thesis_work/models/static_feature_scaler_v2.pkl
2025-11-13 16:42:03 - utils - INFO - Dataset: 4999 samples, 9 insiders
2025-11-13 16:42:03 - utils - INFO - Training on: 3996 normal samples
2025-11-13 16:42:03 - utils - INFO - Calibrating on: 1000 normal samples
2025-11-13 16:42:03 - utils - INFO - Testing on: 4999 total samples (including 9 insiders)
2025-11-13 16:42:03 - utils - INFO - Initialized Lightweight Deep Clustering (V2) (n_clusters=5, encoding_dim=32)
2025-11-13 16:42:03 - utils - INFO - Training lightweight deep clustering model (V2)...
2025-11-13 16:42:03 - utils - INFO - Pre-training autoencoder...
2025-11-13 16:42:05 - utils - INFO - Autoencoder pre-training completed
2025-11-13 16:42:05 - utils - INFO - Fitting MiniBatch K-Means clustering...
2025-11-13 16:42:05 - utils - INFO - Deep clustering training completed
2025-11-13 16:42:05 - utils - INFO - Training completed in 1.56 seconds
2025-11-13 16:42:05 - utils - INFO - Calibrating threshold for target FPR=0.05...
2025-11-13 16:42:05 - utils - INFO - Calibrated threshold: 2.2083
2025-11-13 16:42:05 - utils - INFO - Evaluating lightweight deep clustering model (V2)...
2025-11-13 16:42:05 - utils - INFO - Test set contains 9 positive samples.
2025-11-13 16:42:05 - utils - INFO - 
============================================================
2025-11-13 16:42:05 - utils - INFO - Deep Clustering (V2) Performance Metrics
2025-11-13 16:42:05 - utils - INFO - ============================================================
2025-11-13 16:42:05 - utils - INFO - Accuracy:  0.9510
2025-11-13 16:42:05 - utils - INFO - Precision: 0.0041
2025-11-13 16:42:05 - utils - INFO - Recall:    0.3333
2025-11-13 16:42:05 - utils - INFO - F1-Score:  0.0081
2025-11-13 16:42:05 - utils - INFO - AUC-ROC:   0.6730
2025-11-13 16:42:05 - utils - INFO - ============================================================

2025-11-13 16:42:05 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/deep_clustering_v2.pkl
2025-11-13 16:42:05 - utils - INFO - Encoder model saved to /Users/bipinrimal/Downloads/Thesis_work/models/deep_clustering_v2_encoder.keras
2025-11-13 16:42:05 - utils - INFO - Deep Clustering (V2) training and evaluation completed!
2025-11-13 16:43:48 - utils - INFO - Utility functions loaded successfully
2025-11-13 16:43:50 - utils - INFO - 
================================================================================
           LIGHTWEIGHT LSTM AUTOENCODER TRAINING (V2: MULTI-DATASET)            
================================================================================

2025-11-13 16:43:50 - utils - INFO - Loading sequences from: sequences_r1_r2_r3.1_v2.npy
2025-11-13 16:43:50 - utils - INFO - Loaded sequences: (162520, 15, 33), with 1 insider sequences
2025-11-13 16:43:50 - utils - INFO - Training on: 130015 normal sequences
2025-11-13 16:43:50 - utils - INFO - Calibrating on: 32504 normal sequences
2025-11-13 16:43:50 - utils - INFO - Testing on: 162520 total sequences (including 1 insider sequences)
2025-11-13 16:43:50 - utils - INFO - Model loaded from /Users/bipinrimal/Downloads/Thesis_work/models/daily_feature_scaler_v2.pkl
2025-11-13 16:43:50 - utils - INFO - Initialized Lightweight LSTM Autoencoder (V2) (15, 33)
2025-11-13 16:43:50 - utils - INFO - Training lightweight LSTM Autoencoder on 130015 sequences...
2025-11-13 16:43:50 - utils - INFO - Building lightweight LSTM Autoencoder (V2)...
2025-11-13 16:43:50 - utils - INFO - Model built with 21,329 parameters
2025-11-13 16:46:25 - utils - INFO - Training completed
2025-11-13 16:46:25 - utils - INFO - Training completed in 155.05 seconds
2025-11-13 16:52:06 - utils - INFO - Utility functions loaded successfully
2025-11-13 16:52:08 - utils - INFO - 
================================================================================
           LIGHTWEIGHT LSTM AUTOENCODER TRAINING (V2: MULTI-DATASET)            
================================================================================

2025-11-13 16:52:08 - utils - INFO - Loading sequences from: sequences_r1_r2_r3.1_v2.npy
2025-11-13 16:52:08 - utils - INFO - Loaded sequences: (162520, 15, 33), with 1 insider sequences
2025-11-13 16:52:08 - utils - INFO - Training on: 130015 normal sequences
2025-11-13 16:52:08 - utils - INFO - Calibrating on: 32504 normal sequences
2025-11-13 16:52:08 - utils - INFO - Testing on: 162520 total sequences (including 1 insider sequences)
2025-11-13 16:52:08 - utils - INFO - Model loaded from /Users/bipinrimal/Downloads/Thesis_work/models/daily_feature_scaler_v2.pkl
2025-11-13 16:52:08 - utils - INFO - Initialized Lightweight LSTM Autoencoder (V2) (15, 33)
2025-11-13 16:52:08 - utils - INFO - Training lightweight LSTM Autoencoder on 130015 sequences...
2025-11-13 16:52:08 - utils - INFO - Building lightweight LSTM Autoencoder (V2)...
2025-11-13 16:52:08 - utils - INFO - Model built with 21,329 parameters
2025-11-13 16:54:42 - utils - INFO - Training completed
2025-11-13 16:54:42 - utils - INFO - Training completed in 153.87 seconds
2025-11-13 16:54:42 - utils - INFO - Evaluating lightweight LSTM Autoencoder (V2)...
2025-11-13 16:54:45 - utils - WARNING - Threshold not set, using 95th percentile as default.
2025-11-13 16:54:45 - utils - INFO - Test set contains 1 positive samples.
2025-11-13 16:54:48 - utils - INFO - 
============================================================
2025-11-13 16:54:48 - utils - INFO - LSTM Autoencoder (V2) Performance Metrics
2025-11-13 16:54:48 - utils - INFO - ============================================================
2025-11-13 16:54:48 - utils - INFO - Accuracy:  0.9500
2025-11-13 16:54:48 - utils - INFO - Precision: 0.0000
2025-11-13 16:54:48 - utils - INFO - Recall:    0.0000
2025-11-13 16:54:48 - utils - INFO - F1-Score:  0.0000
2025-11-13 16:54:48 - utils - INFO - AUC-ROC:   0.8818
2025-11-13 16:54:48 - utils - INFO - ============================================================

2025-11-13 16:54:48 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/lstm_autoencoder_v2.keras
2025-11-13 16:54:50 - utils - WARNING - Threshold not set, using 95th percentile as default.
2025-11-13 16:54:50 - utils - INFO - Lightweight LSTM Autoencoder (V2) completed!
2025-11-13 16:55:07 - utils - INFO - Utility functions loaded successfully
2025-11-13 16:55:10 - utils - INFO - 
================================================================================
           LIGHTWEIGHT LSTM AUTOENCODER TRAINING (V2: MULTI-DATASET)            
================================================================================

2025-11-13 16:55:10 - utils - INFO - Loading sequences from: sequences_r1_r2_r3.1_v2.npy
2025-11-13 16:55:10 - utils - INFO - Loaded sequences: (162520, 15, 33), with 1 insider sequences
2025-11-13 16:55:10 - utils - INFO - Training on: 130015 normal sequences
2025-11-13 16:55:10 - utils - INFO - Calibrating on: 32504 normal sequences
2025-11-13 16:55:10 - utils - INFO - Testing on: 162520 total sequences (including 1 insider sequences)
2025-11-13 16:55:10 - utils - INFO - Model loaded from /Users/bipinrimal/Downloads/Thesis_work/models/daily_feature_scaler_v2.pkl
2025-11-13 16:55:10 - utils - INFO - Initialized Lightweight LSTM Autoencoder (V2) (15, 33)
2025-11-13 16:55:10 - utils - INFO - Training lightweight LSTM Autoencoder on 130015 sequences...
2025-11-13 16:55:10 - utils - INFO - Building lightweight LSTM Autoencoder (V2)...
2025-11-13 16:55:10 - utils - INFO - Model built with 21,329 parameters
2025-11-13 16:57:44 - utils - INFO - Training completed
2025-11-13 16:57:44 - utils - INFO - Training completed in 154.51 seconds
2025-11-13 16:57:44 - utils - INFO - Calibrating threshold for target FPR=0.05
2025-11-13 16:57:45 - utils - INFO - Calibrated threshold: 0.2872
2025-11-13 16:57:45 - utils - INFO - Evaluating lightweight LSTM Autoencoder (V2)...
2025-11-13 16:57:48 - utils - INFO - Test set contains 1 positive samples.
2025-11-13 16:57:50 - utils - INFO - 
============================================================
2025-11-13 16:57:50 - utils - INFO - LSTM Autoencoder (V2) Performance Metrics
2025-11-13 16:57:50 - utils - INFO - ============================================================
2025-11-13 16:57:50 - utils - INFO - Accuracy:  0.9697
2025-11-13 16:57:50 - utils - INFO - Precision: 0.0000
2025-11-13 16:57:50 - utils - INFO - Recall:    0.0000
2025-11-13 16:57:50 - utils - INFO - F1-Score:  0.0000
2025-11-13 16:57:50 - utils - INFO - AUC-ROC:   0.8823
2025-11-13 16:57:50 - utils - INFO - ============================================================

2025-11-13 16:57:50 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/lstm_autoencoder_v2.keras
2025-11-13 16:57:52 - utils - INFO - Lightweight LSTM Autoencoder (V2) completed!
2025-11-13 17:00:16 - utils - INFO - Utility functions loaded successfully
2025-11-13 17:00:16 - utils - INFO - 
================================================================================
                 ISOLATION FOREST TRAINING (V2: MULTI-DATASET)                  
================================================================================

2025-11-13 17:00:16 - utils - INFO - Model loaded from /Users/bipinrimal/Downloads/Thesis_work/models/static_feature_scaler_v2.pkl
2025-11-13 17:00:16 - utils - INFO - Data split: 4999 total samples, 9 insiders
2025-11-13 17:00:16 - utils - INFO - Training on: 3996 normal samples
2025-11-13 17:00:16 - utils - INFO - Calibrating on: 1000 normal samples
2025-11-13 17:00:16 - utils - INFO - Testing on: 4999 total samples (including 9 insiders)
2025-11-13 17:00:16 - utils - INFO - Initialized Isolation Forest (V2) with params: {'n_estimators': 50, 'max_samples': 256, 'contamination': 'auto', 'max_features': 1.0, 'bootstrap': False, 'n_jobs': -1, 'random_state': 42, 'verbose': 0}
2025-11-13 17:00:16 - utils - INFO - Training Isolation Forest on 3996 normal samples...
2025-11-13 17:00:16 - utils - INFO - Isolation Forest training completed
2025-11-13 17:00:16 - utils - INFO - Calibrating threshold for target FPR=0.05...
2025-11-13 17:00:16 - utils - INFO - Calibrated threshold: 0.5348
2025-11-13 17:00:16 - utils - INFO - Evaluating Isolation Forest (V2)...
2025-11-13 17:00:16 - utils - INFO - Test set contains 9 positive samples.
2025-11-13 17:00:16 - utils - INFO - 
============================================================
2025-11-13 17:00:16 - utils - INFO - Isolation Forest (V2) Performance Metrics
2025-11-13 17:00:16 - utils - INFO - ============================================================
2025-11-13 17:00:16 - utils - INFO - Accuracy:  0.9440
2025-11-13 17:00:16 - utils - INFO - Precision: 0.0071
2025-11-13 17:00:16 - utils - INFO - Recall:    0.6667
2025-11-13 17:00:16 - utils - INFO - F1-Score:  0.0141
2025-11-13 17:00:16 - utils - INFO - AUC-ROC:   0.9185
2025-11-13 17:00:16 - utils - INFO - ============================================================

2025-11-13 17:00:16 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest_v2.pkl
2025-11-13 17:00:16 - utils - INFO - Saving Isolation Forest model to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest_v2.pkl
2025-11-13 17:00:16 - utils - INFO - Isolation Forest (V2) training and evaluation completed!
2025-11-13 17:00:23 - utils - INFO - Utility functions loaded successfully
2025-11-13 17:00:25 - utils - INFO - 
================================================================================
            LIGHTWEIGHT DEEP CLUSTERING TRAINING (V2: MULTI-DATASET)            
================================================================================

2025-11-13 17:00:25 - utils - INFO - Model loaded from /Users/bipinrimal/Downloads/Thesis_work/models/static_feature_scaler_v2.pkl
2025-11-13 17:00:25 - utils - INFO - Dataset: 4999 samples, 9 insiders
2025-11-13 17:00:25 - utils - INFO - Training on: 3996 normal samples
2025-11-13 17:00:25 - utils - INFO - Calibrating on: 1000 normal samples
2025-11-13 17:00:25 - utils - INFO - Testing on: 4999 total samples (including 9 insiders)
2025-11-13 17:00:25 - utils - INFO - Initialized Lightweight Deep Clustering (V2) (n_clusters=5, encoding_dim=32)
2025-11-13 17:00:25 - utils - INFO - Training lightweight deep clustering model (V2)...
2025-11-13 17:00:25 - utils - INFO - Pre-training autoencoder...
2025-11-13 17:00:27 - utils - INFO - Autoencoder pre-training completed
2025-11-13 17:00:27 - utils - INFO - Fitting MiniBatch K-Means clustering...
2025-11-13 17:00:27 - utils - INFO - Deep clustering training completed
2025-11-13 17:00:27 - utils - INFO - Training completed in 1.54 seconds
2025-11-13 17:00:27 - utils - INFO - Calibrating threshold for target FPR=0.05...
2025-11-13 17:00:27 - utils - INFO - Calibrated threshold: 2.5044
2025-11-13 17:00:27 - utils - INFO - Evaluating lightweight deep clustering model (V2)...
2025-11-13 17:00:27 - utils - INFO - Test set contains 9 positive samples.
2025-11-13 17:00:27 - utils - INFO - 
============================================================
2025-11-13 17:00:27 - utils - INFO - Deep Clustering (V2) Performance Metrics
2025-11-13 17:00:27 - utils - INFO - ============================================================
2025-11-13 17:00:27 - utils - INFO - Accuracy:  0.9514
2025-11-13 17:00:27 - utils - INFO - Precision: 0.0000
2025-11-13 17:00:27 - utils - INFO - Recall:    0.0000
2025-11-13 17:00:27 - utils - INFO - F1-Score:  0.0000
2025-11-13 17:00:27 - utils - INFO - AUC-ROC:   0.7578
2025-11-13 17:00:27 - utils - INFO - ============================================================

2025-11-13 17:00:27 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/deep_clustering_v2.pkl
2025-11-13 17:00:27 - utils - INFO - Encoder model saved to /Users/bipinrimal/Downloads/Thesis_work/models/deep_clustering_v2_encoder.keras
2025-11-13 17:00:27 - utils - INFO - Deep Clustering (V2) training and evaluation completed!
2025-11-13 17:00:31 - utils - INFO - Utility functions loaded successfully
2025-11-13 17:00:33 - utils - INFO - 
================================================================================
           LIGHTWEIGHT LSTM AUTOENCODER TRAINING (V2: MULTI-DATASET)            
================================================================================

2025-11-13 17:00:33 - utils - INFO - Loading sequences from: sequences_r1_r2_r3.1_v2.npy
2025-11-13 17:00:33 - utils - INFO - Loaded sequences: (162520, 15, 33), with 1 insider sequences
2025-11-13 17:00:33 - utils - INFO - Training on: 130015 normal sequences
2025-11-13 17:00:33 - utils - INFO - Calibrating on: 32504 normal sequences
2025-11-13 17:00:33 - utils - INFO - Testing on: 162520 total sequences (including 1 insider sequences)
2025-11-13 17:00:33 - utils - INFO - Model loaded from /Users/bipinrimal/Downloads/Thesis_work/models/daily_feature_scaler_v2.pkl
2025-11-13 17:00:33 - utils - INFO - Initialized Lightweight LSTM Autoencoder (V2) (15, 33)
2025-11-13 17:00:33 - utils - INFO - Training lightweight LSTM Autoencoder on 130015 sequences...
2025-11-13 17:00:33 - utils - INFO - Building lightweight LSTM Autoencoder (V2)...
2025-11-13 17:00:33 - utils - INFO - Model built with 21,329 parameters
2025-11-13 17:03:08 - utils - INFO - Training completed
2025-11-13 17:03:08 - utils - INFO - Training completed in 154.21 seconds
2025-11-13 17:03:08 - utils - INFO - Calibrating threshold for target FPR=0.05
2025-11-13 17:03:09 - utils - INFO - Calibrated threshold: 0.2876
2025-11-13 17:03:09 - utils - INFO - Evaluating lightweight LSTM Autoencoder (V2)...
2025-11-13 17:03:11 - utils - INFO - Test set contains 1 positive samples.
2025-11-13 17:03:13 - utils - INFO - 
============================================================
2025-11-13 17:03:13 - utils - INFO - LSTM Autoencoder (V2) Performance Metrics
2025-11-13 17:03:13 - utils - INFO - ============================================================
2025-11-13 17:03:13 - utils - INFO - Accuracy:  0.9694
2025-11-13 17:03:13 - utils - INFO - Precision: 0.0000
2025-11-13 17:03:13 - utils - INFO - Recall:    0.0000
2025-11-13 17:03:13 - utils - INFO - F1-Score:  0.0000
2025-11-13 17:03:13 - utils - INFO - AUC-ROC:   0.8818
2025-11-13 17:03:13 - utils - INFO - ============================================================

2025-11-13 17:03:13 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/lstm_autoencoder_v2.keras
2025-11-13 17:03:16 - utils - INFO - Lightweight LSTM Autoencoder (V2) completed!
2025-11-13 17:05:30 - utils - INFO - Utility functions loaded successfully
2025-11-13 17:05:30 - utils - INFO - 
================================================================================
                 ISOLATION FOREST TRAINING (V2: MULTI-DATASET)                  
================================================================================

2025-11-13 17:05:30 - utils - INFO - Model loaded from /Users/bipinrimal/Downloads/Thesis_work/models/static_feature_scaler_v2.pkl
2025-11-13 17:05:30 - utils - INFO - Data split: 4999 total samples, 9 insiders
2025-11-13 17:05:30 - utils - INFO - Training on: 3996 normal samples
2025-11-13 17:05:30 - utils - INFO - Calibrating on: 1000 normal samples
2025-11-13 17:05:30 - utils - INFO - Testing on: 4999 total samples (including 9 insiders)
2025-11-13 17:05:30 - utils - INFO - Initialized Isolation Forest (V2) with params: {'n_estimators': 50, 'max_samples': 256, 'contamination': 'auto', 'max_features': 1.0, 'bootstrap': False, 'n_jobs': -1, 'random_state': 42, 'verbose': 0}
2025-11-13 17:05:30 - utils - INFO - Training Isolation Forest on 3996 normal samples...
2025-11-13 17:05:30 - utils - INFO - Isolation Forest training completed
2025-11-13 17:05:30 - utils - INFO - Calibrating threshold for target FPR=0.05...
2025-11-13 17:05:30 - utils - INFO - Calibrated threshold: 0.5348
2025-11-13 17:05:30 - utils - INFO - Evaluating Isolation Forest (V2)...
2025-11-13 17:05:30 - utils - INFO - Test set contains 9 positive samples.
2025-11-13 17:05:30 - utils - INFO - 
============================================================
2025-11-13 17:05:30 - utils - INFO - Isolation Forest (V2) Performance Metrics
2025-11-13 17:05:30 - utils - INFO - ============================================================
2025-11-13 17:05:30 - utils - INFO - Accuracy:  0.9440
2025-11-13 17:05:30 - utils - INFO - Precision: 0.0071
2025-11-13 17:05:30 - utils - INFO - Recall:    0.6667
2025-11-13 17:05:30 - utils - INFO - F1-Score:  0.0141
2025-11-13 17:05:30 - utils - INFO - AUC-ROC:   0.9185
2025-11-13 17:05:30 - utils - INFO - ============================================================

2025-11-13 17:05:30 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest_v2.pkl
2025-11-13 17:05:30 - utils - INFO - Saving Isolation Forest model to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest_v2.pkl
2025-11-13 17:05:30 - utils - INFO - Isolation Forest (V2) training and evaluation completed!
2025-11-13 17:06:56 - utils - INFO - Utility functions loaded successfully
2025-11-13 17:06:58 - utils - INFO - 
================================================================================
            LIGHTWEIGHT DEEP CLUSTERING TRAINING (V2: MULTI-DATASET)            
================================================================================

2025-11-13 17:06:58 - utils - INFO - Loading static features from: engineered_static_features_r1_r2_r3.1_v2.csv
2025-11-13 17:06:58 - utils - ERROR - Failed to load 'engineered_static_features_r1_r2_r3.1_v2.csv'. Run feature_engineering_v2.py first. Error: [Errno 2] No such file or directory: '/Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_static_features_r1_r2_r3.1_v2.csv'
2025-11-13 17:07:22 - utils - INFO - Utility functions loaded successfully
2025-11-13 17:07:22 - utils - INFO - 
================================================================================
                 ISOLATION FOREST TRAINING (V2: MULTI-DATASET)                  
================================================================================

2025-11-13 17:07:22 - utils - ERROR - Failed to load 'engineered_static_features_v2.csv'. Run feature_engineering_v2.py first. Error: [Errno 2] No such file or directory: '/Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_static_features_v2.csv'
2025-11-13 17:07:26 - utils - INFO - Utility functions loaded successfully
2025-11-13 17:07:28 - utils - INFO - 
================================================================================
            LIGHTWEIGHT DEEP CLUSTERING TRAINING (V2: MULTI-DATASET)            
================================================================================

2025-11-13 17:07:28 - utils - INFO - Loading static features from: engineered_static_features_r1_r2_r3.1_v2.csv
2025-11-13 17:07:28 - utils - ERROR - Failed to load 'engineered_static_features_r1_r2_r3.1_v2.csv'. Run feature_engineering_v2.py first. Error: [Errno 2] No such file or directory: '/Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_static_features_r1_r2_r3.1_v2.csv'
2025-11-13 17:08:16 - utils - INFO - Utility functions loaded successfully
2025-11-13 17:08:18 - utils - INFO - 
================================================================================
            LIGHTWEIGHT DEEP CLUSTERING TRAINING (V2: MULTI-DATASET)            
================================================================================

2025-11-13 17:08:18 - utils - INFO - Loading static features from: engineered_static_features_r1_r2_r3.1_v2.csv
2025-11-13 17:08:18 - utils - INFO - Model loaded from /Users/bipinrimal/Downloads/Thesis_work/models/static_feature_scaler_v2.pkl
2025-11-13 17:08:18 - utils - INFO - Dataset: 4999 samples, 9 insiders
2025-11-13 17:08:18 - utils - INFO - Training on: 3996 normal samples
2025-11-13 17:08:18 - utils - INFO - Calibrating on: 1000 normal samples
2025-11-13 17:08:18 - utils - INFO - Testing on: 4999 total samples (including 9 insiders)
2025-11-13 17:08:18 - utils - INFO - Initialized Lightweight Deep Clustering (V2) (n_clusters=5, encoding_dim=32)
2025-11-13 17:08:18 - utils - INFO - Training lightweight deep clustering model (V2)...
2025-11-13 17:08:18 - utils - INFO - Pre-training autoencoder...
2025-11-13 17:08:19 - utils - INFO - Autoencoder pre-training completed
2025-11-13 17:08:19 - utils - INFO - Fitting MiniBatch K-Means clustering...
2025-11-13 17:08:19 - utils - INFO - Deep clustering training completed
2025-11-13 17:08:19 - utils - INFO - Training completed in 1.62 seconds
2025-11-13 17:08:19 - utils - INFO - Calibrating threshold for target FPR=0.05...
2025-11-13 17:08:19 - utils - INFO - Calibrated threshold: 2.5526
2025-11-13 17:08:19 - utils - INFO - Evaluating lightweight deep clustering model (V2)...
2025-11-13 17:08:19 - utils - INFO - Test set contains 9 positive samples.
2025-11-13 17:08:19 - utils - INFO - 
============================================================
2025-11-13 17:08:19 - utils - INFO - Deep Clustering (V2) Performance Metrics
2025-11-13 17:08:19 - utils - INFO - ============================================================
2025-11-13 17:08:19 - utils - INFO - Accuracy:  0.9520
2025-11-13 17:08:19 - utils - INFO - Precision: 0.0083
2025-11-13 17:08:19 - utils - INFO - Recall:    0.6667
2025-11-13 17:08:19 - utils - INFO - F1-Score:  0.0164
2025-11-13 17:08:19 - utils - INFO - AUC-ROC:   0.6760
2025-11-13 17:08:19 - utils - INFO - ============================================================

2025-11-13 17:08:19 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/deep_clustering_v2.pkl
2025-11-13 17:08:19 - utils - INFO - Encoder model saved to /Users/bipinrimal/Downloads/Thesis_work/models/deep_clustering_v2_encoder.keras
2025-11-13 17:08:19 - utils - INFO - Deep Clustering (V2) training and evaluation completed!
2025-11-13 17:12:48 - utils - INFO - Utility functions loaded successfully
2025-11-13 17:12:50 - utils - INFO - 
================================================================================
           LIGHTWEIGHT LSTM AUTOENCODER TRAINING (V2: MULTI-DATASET)            
================================================================================

2025-11-13 17:12:50 - utils - INFO - Loading sequences from: sequences_r1_r2_r3.1_v2.npy
2025-11-13 17:12:50 - utils - INFO - Loaded sequences: (162520, 15, 33), with 1 insider sequences
2025-11-13 17:12:50 - utils - INFO - Training on: 130015 normal sequences
2025-11-13 17:12:50 - utils - INFO - Calibrating on: 32504 normal sequences
2025-11-13 17:12:50 - utils - INFO - Testing on: 162520 total sequences (including 1 insider sequences)
2025-11-13 17:12:50 - utils - INFO - Model loaded from /Users/bipinrimal/Downloads/Thesis_work/models/daily_feature_scaler_v2.pkl
2025-11-13 17:12:50 - utils - INFO - Initialized Lightweight LSTM Autoencoder (V2) (15, 33)
2025-11-13 17:12:50 - utils - INFO - Training lightweight LSTM Autoencoder on 130015 sequences...
2025-11-13 17:12:50 - utils - INFO - Building lightweight LSTM Autoencoder (V2)...
2025-11-13 17:12:50 - utils - INFO - Model built with 21,329 parameters
2025-11-13 17:15:25 - utils - INFO - Training completed
2025-11-13 17:15:25 - utils - INFO - Training completed in 155.13 seconds
2025-11-13 17:15:25 - utils - INFO - Calibrating threshold for target FPR=0.05
2025-11-13 17:15:26 - utils - INFO - Calibrated threshold: 0.2941
2025-11-13 17:15:26 - utils - INFO - Evaluating lightweight LSTM Autoencoder (V2)...
2025-11-13 17:15:29 - utils - INFO - Test set contains 1 positive samples.
2025-11-13 17:15:31 - utils - INFO - 
============================================================
2025-11-13 17:15:31 - utils - INFO - LSTM Autoencoder (V2) Performance Metrics
2025-11-13 17:15:31 - utils - INFO - ============================================================
2025-11-13 17:15:31 - utils - INFO - Accuracy:  0.9707
2025-11-13 17:15:31 - utils - INFO - Precision: 0.0000
2025-11-13 17:15:31 - utils - INFO - Recall:    0.0000
2025-11-13 17:15:31 - utils - INFO - F1-Score:  0.0000
2025-11-13 17:15:31 - utils - INFO - AUC-ROC:   0.8820
2025-11-13 17:15:31 - utils - INFO - ============================================================

2025-11-13 17:15:31 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/lstm_autoencoder_v2.keras
2025-11-13 17:15:33 - utils - INFO - Lightweight LSTM Autoencoder (V2) completed!
2025-11-13 17:18:23 - utils - INFO - Utility functions loaded successfully
2025-11-13 17:18:23 - utils - INFO - 
================================================================================
                 ISOLATION FOREST TRAINING (V2: MULTI-DATASET)                  
================================================================================

2025-11-13 17:18:23 - utils - INFO - Model loaded from /Users/bipinrimal/Downloads/Thesis_work/models/static_feature_scaler_v2.pkl
2025-11-13 17:18:23 - utils - INFO - Data split: 4999 total samples, 9 insiders
2025-11-13 17:18:23 - utils - INFO - Training on: 3996 normal samples
2025-11-13 17:18:23 - utils - INFO - Calibrating on: 1000 normal samples
2025-11-13 17:18:23 - utils - INFO - Testing on: 4999 total samples (including 9 insiders)
2025-11-13 17:18:23 - utils - INFO - Initialized Isolation Forest (V2) with params: {'n_estimators': 50, 'max_samples': 256, 'contamination': 'auto', 'max_features': 1.0, 'bootstrap': False, 'n_jobs': -1, 'random_state': 42, 'verbose': 0}
2025-11-13 17:18:23 - utils - INFO - Training Isolation Forest on 3996 normal samples...
2025-11-13 17:18:23 - utils - INFO - Isolation Forest training completed
2025-11-13 17:18:23 - utils - INFO - Calibrating threshold for target FPR=0.05...
2025-11-13 17:18:23 - utils - INFO - Calibrated threshold: 0.5348
2025-11-13 17:18:23 - utils - INFO - Evaluating Isolation Forest (V2)...
2025-11-13 17:18:23 - utils - INFO - Test set contains 9 positive samples.
2025-11-13 17:18:23 - utils - INFO - 
============================================================
2025-11-13 17:18:23 - utils - INFO - Isolation Forest (V2) Performance Metrics
2025-11-13 17:18:23 - utils - INFO - ============================================================
2025-11-13 17:18:23 - utils - INFO - Accuracy:  0.9440
2025-11-13 17:18:23 - utils - INFO - Precision: 0.0071
2025-11-13 17:18:23 - utils - INFO - Recall:    0.6667
2025-11-13 17:18:23 - utils - INFO - F1-Score:  0.0141
2025-11-13 17:18:23 - utils - INFO - AUC-ROC:   0.9185
2025-11-13 17:18:23 - utils - INFO - ============================================================

2025-11-13 17:18:23 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest_v2.pkl
2025-11-13 17:18:23 - utils - INFO - Saving Isolation Forest model to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest_v2.pkl
2025-11-13 17:18:23 - utils - INFO - Isolation Forest (V2) training and evaluation completed!
2025-11-13 17:18:49 - utils - INFO - Utility functions loaded successfully
2025-11-13 17:18:51 - utils - INFO - 
================================================================================
            LIGHTWEIGHT DEEP CLUSTERING TRAINING (V2: MULTI-DATASET)            
================================================================================

2025-11-13 17:18:51 - utils - INFO - Loading static features from: engineered_static_features_r1_r2_r3.1_v2.csv
2025-11-13 17:18:51 - utils - INFO - Model loaded from /Users/bipinrimal/Downloads/Thesis_work/models/static_feature_scaler_v2.pkl
2025-11-13 17:18:51 - utils - INFO - Dataset: 4999 samples, 9 insiders
2025-11-13 17:18:51 - utils - INFO - Training on: 3996 normal samples
2025-11-13 17:18:51 - utils - INFO - Calibrating on: 1000 normal samples
2025-11-13 17:18:51 - utils - INFO - Testing on: 4999 total samples (including 9 insiders)
2025-11-13 17:18:51 - utils - INFO - Initialized Lightweight Deep Clustering (V2) (n_clusters=5, encoding_dim=32)
2025-11-13 17:18:51 - utils - INFO - Training lightweight deep clustering model (V2)...
2025-11-13 17:18:51 - utils - INFO - Pre-training autoencoder...
2025-11-13 17:18:52 - utils - INFO - Autoencoder pre-training completed
2025-11-13 17:18:52 - utils - INFO - Fitting MiniBatch K-Means clustering...
2025-11-13 17:18:52 - utils - INFO - Deep clustering training completed
2025-11-13 17:18:52 - utils - INFO - Training completed in 1.52 seconds
2025-11-13 17:18:52 - utils - INFO - Calibrating threshold for target FPR=0.05...
2025-11-13 17:18:52 - utils - INFO - Calibrated threshold: 2.3660
2025-11-13 17:18:52 - utils - INFO - Evaluating lightweight deep clustering model (V2)...
2025-11-13 17:18:53 - utils - INFO - Test set contains 9 positive samples.
2025-11-13 17:18:53 - utils - INFO - 
============================================================
2025-11-13 17:18:53 - utils - INFO - Deep Clustering (V2) Performance Metrics
2025-11-13 17:18:53 - utils - INFO - ============================================================
2025-11-13 17:18:53 - utils - INFO - Accuracy:  0.9506
2025-11-13 17:18:53 - utils - INFO - Precision: 0.0081
2025-11-13 17:18:53 - utils - INFO - Recall:    0.6667
2025-11-13 17:18:53 - utils - INFO - F1-Score:  0.0159
2025-11-13 17:18:53 - utils - INFO - AUC-ROC:   0.7114
2025-11-13 17:18:53 - utils - INFO - ============================================================

2025-11-13 17:18:53 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/deep_clustering_v2.pkl
2025-11-13 17:18:53 - utils - INFO - Encoder model saved to /Users/bipinrimal/Downloads/Thesis_work/models/deep_clustering_v2_encoder.keras
2025-11-13 17:18:53 - utils - INFO - Deep Clustering (V2) training and evaluation completed!
2025-11-13 17:22:01 - utils - INFO - Utility functions loaded successfully
2025-11-13 17:22:01 - utils - INFO - 
================================================================================
                      COMPREHENSIVE MODEL EVALUATION (V2)                       
================================================================================

2025-11-13 17:22:01 - utils - INFO - Loading V2 results for all models...
2025-11-13 17:22:01 - utils - ERROR - Failed to load V2 results for isolation_forest from /Users/bipinrimal/Downloads/Thesis_work/results/isolation_forest_metrics_r1_r2_r3.1_v2.csv: [Errno 2] No such file or directory: '/Users/bipinrimal/Downloads/Thesis_work/results/isolation_forest_metrics_r1_r2_r3.1_v2.csv'
2025-11-13 17:22:01 - utils - INFO - Loaded results for deep_clustering
2025-11-13 17:22:01 - utils - INFO - Loaded results for lstm_autoencoder
2025-11-13 17:22:01 - utils - INFO - Loaded results for 2 models
2025-11-13 17:22:01 - utils - INFO - Creating metrics comparison table...
2025-11-13 17:22:01 - utils - INFO - Metrics comparison table created
2025-11-13 17:22:01 - utils - INFO - Creating confusion matrix plots...
2025-11-13 17:22:01 - utils - INFO - Confusion matrices saved to /Users/bipinrimal/Downloads/Thesis_work/results/confusion_matrices/all_models_r1_r2_r3.1_v2.png
2025-11-13 17:22:01 - utils - INFO - Creating ROC curves...
2025-11-13 17:22:01 - utils - ERROR - Evaluation failed: multiclass format is not supported
2025-11-13 17:24:55 - utils - INFO - Utility functions loaded successfully
2025-11-13 17:24:55 - utils - INFO - 
================================================================================
                  LABELING INSIDER THREATS (V2: MULTI-DATASET)                  
================================================================================

2025-11-13 17:24:55 - utils - INFO - Loading CMU-CERT master answers file (insiders.csv)...
2025-11-13 17:24:55 - utils - INFO - Loaded 191 total insider incidents
2025-11-13 17:24:55 - utils - WARNING - Could not parse dates for CDE1846 in 6.2: month must be in 1..12: /21/2011 11:43:39, at position 0
2025-11-13 17:24:55 - utils - INFO - Parsed and normalized 190 insider activity rules
2025-11-13 17:24:55 - utils - INFO - Sample of normalized rules:
2025-11-13 17:24:55 - utils - INFO -   - User: ONS0995, Dataset: r2, Start: 2010-03-06
2025-11-13 17:24:55 - utils - INFO -   - User: CSF0929, Dataset: r3.1, Start: 2010-07-01
2025-11-13 17:24:55 - utils - INFO -   - User: CCH0959, Dataset: r3.1, Start: 2010-08-02
2025-11-13 17:24:55 - utils - INFO -   ...and 187 more.
2025-11-13 17:24:55 - utils - INFO - Loaded 190 unique (user, dataset) rule combinations.
2025-11-13 17:24:55 - utils - INFO - Example rule keys: [('ONS0995', 'r2'), ('CSF0929', 'r3.1'), ('CCH0959', 'r3.1'), ('RCW0822', 'r3.2'), ('JCE0258', 'r3.2')]
2025-11-13 17:24:57 - utils - INFO - Processing chunk 1 (1000000 rows)...
2025-11-13 17:25:05 - utils - INFO - Processing chunk 2 (1000000 rows)...
2025-11-13 17:25:05 - utils - INFO -   > Labeled 53 records in this chunk.
2025-11-13 17:25:14 - utils - INFO - Processing chunk 3 (1000000 rows)...
2025-11-13 17:25:23 - utils - INFO - Processing chunk 4 (1000000 rows)...
2025-11-13 17:25:31 - utils - INFO - Processing chunk 5 (1000000 rows)...
2025-11-13 17:25:32 - utils - INFO -   > Labeled 17 records in this chunk.
2025-11-13 17:25:39 - utils - INFO - Processing chunk 6 (1000000 rows)...
2025-11-13 17:25:48 - utils - INFO - Processing chunk 7 (1000000 rows)...
2025-11-13 17:25:56 - utils - INFO - Processing chunk 8 (1000000 rows)...
2025-11-13 17:26:03 - utils - INFO - Processing chunk 9 (1000000 rows)...
2025-11-13 17:26:11 - utils - INFO - Processing chunk 10 (1000000 rows)...
2025-11-13 17:26:19 - utils - INFO - Processing chunk 11 (1000000 rows)...
2025-11-13 17:26:27 - utils - INFO - Processing chunk 12 (1000000 rows)...
2025-11-13 17:26:27 - utils - INFO -   > Labeled 136 records in this chunk.
2025-11-13 17:26:38 - utils - INFO - Processing chunk 13 (1000000 rows)...
2025-11-13 17:26:38 - utils - INFO -   > Labeled 426 records in this chunk.
2025-11-13 17:26:52 - utils - INFO - Processing chunk 14 (1000000 rows)...
2025-11-13 17:27:07 - utils - INFO - Processing chunk 15 (1000000 rows)...
2025-11-13 17:27:22 - utils - INFO - Processing chunk 16 (1000000 rows)...
2025-11-13 17:27:36 - utils - INFO - Processing chunk 17 (1000000 rows)...
2025-11-13 17:27:50 - utils - INFO - Processing chunk 18 (1000000 rows)...
2025-11-13 17:28:04 - utils - INFO - Processing chunk 19 (1000000 rows)...
2025-11-13 17:28:18 - utils - INFO - Processing chunk 20 (1000000 rows)...
2025-11-13 17:28:32 - utils - INFO - Processing chunk 21 (1000000 rows)...
2025-11-13 17:28:46 - utils - INFO - Processing chunk 22 (1000000 rows)...
2025-11-13 17:29:01 - utils - INFO - Processing chunk 23 (1000000 rows)...
2025-11-13 17:29:15 - utils - INFO - Processing chunk 24 (1000000 rows)...
2025-11-13 17:29:15 - utils - INFO -   > Labeled 612 records in this chunk.
2025-11-13 17:29:29 - utils - INFO - Processing chunk 25 (1000000 rows)...
2025-11-13 17:29:29 - utils - INFO -   > Labeled 549 records in this chunk.
2025-11-13 17:29:44 - utils - INFO - Processing chunk 26 (1000000 rows)...
2025-11-13 17:29:44 - utils - INFO -   > Labeled 3211 records in this chunk.
2025-11-13 17:29:58 - utils - INFO - Processing chunk 27 (1000000 rows)...
2025-11-13 17:29:58 - utils - INFO -   > Labeled 3236 records in this chunk.
2025-11-13 17:30:12 - utils - INFO - Processing chunk 28 (1000000 rows)...
2025-11-13 17:30:12 - utils - INFO -   > Labeled 2729 records in this chunk.
2025-11-13 17:30:26 - utils - INFO - Processing chunk 29 (1000000 rows)...
2025-11-13 17:30:40 - utils - INFO - Processing chunk 30 (1000000 rows)...
2025-11-13 17:30:54 - utils - INFO - Processing chunk 31 (1000000 rows)...
2025-11-13 17:31:08 - utils - INFO - Processing chunk 32 (1000000 rows)...
2025-11-13 17:31:22 - utils - INFO - Processing chunk 33 (1000000 rows)...
2025-11-13 17:31:37 - utils - INFO - Processing chunk 34 (1000000 rows)...
2025-11-13 17:31:51 - utils - INFO - Processing chunk 35 (1000000 rows)...
2025-11-13 17:32:05 - utils - INFO - Processing chunk 36 (1000000 rows)...
2025-11-13 17:32:19 - utils - INFO - Processing chunk 37 (1000000 rows)...
2025-11-13 17:32:33 - utils - INFO - Processing chunk 38 (1000000 rows)...
2025-11-13 17:32:43 - utils - INFO - Processing chunk 39 (244604 rows)...
2025-11-13 17:32:46 - utils - INFO - All chunks processed. Total rows: 38244604
2025-11-13 17:32:46 - utils - INFO - Total insider records labeled: 10969
2025-11-13 17:32:46 - utils - INFO - Successfully created: /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs_r1_r2_r3.1_LABELED.csv
2025-11-13 17:32:46 - utils - INFO - ================================================================================
2025-11-13 17:32:46 - utils - INFO - V2 Labeling Complete!
2025-11-13 17:32:46 - utils - INFO - The file 'processed_unified_logs_r1_r2_r3.1_LABELED.csv' is now labeled.
2025-11-13 17:32:46 - utils - INFO - Next step: Run 'feature_engineering_v2.py'
2025-11-13 17:32:46 - utils - INFO - ================================================================================
2025-11-13 17:34:13 - utils - INFO - Utility functions loaded successfully
2025-11-13 17:34:13 - utils - INFO - 
================================================================================
                      COMPREHENSIVE MODEL EVALUATION (V2)                       
================================================================================

2025-11-13 17:34:13 - utils - INFO - Loading V2 results for all models...
2025-11-13 17:34:13 - utils - ERROR - Failed to load V2 results for isolation_forest from isolation_forest_metrics_r1_r2_r3.1_v2.csv: [Errno 2] No such file or directory: '/Users/bipinrimal/Downloads/Thesis_work/results/isolation_forest_metrics_r1_r2_r3.1_v2.csv'
2025-11-13 17:34:13 - utils - INFO - Loaded results for deep_clustering
2025-11-13 17:34:13 - utils - INFO - Loaded results for lstm_autoencoder
2025-11-13 17:34:13 - utils - INFO - Loaded results for 2 models
2025-11-13 17:34:13 - utils - INFO - Creating metrics comparison table...
2025-11-13 17:34:13 - utils - INFO - Metrics comparison table created
2025-11-13 17:34:13 - utils - INFO - Creating confusion matrix plots...
2025-11-13 17:34:14 - utils - INFO - Confusion matrices saved to /Users/bipinrimal/Downloads/Thesis_work/results/confusion_matrices/all_models_r1_r2_r3.1_v2.png
2025-11-13 17:34:14 - utils - INFO - Creating ROC curves...
2025-11-13 17:34:14 - utils - ERROR - Evaluation failed: multiclass format is not supported
2025-11-13 17:34:52 - utils - INFO - Utility functions loaded successfully
2025-11-13 17:34:52 - utils - INFO - Feature Engineer V2 initialized. Reading from: processed_unified_logs_r1_r2_r3.1_LABELED.csv
2025-11-13 17:34:52 - utils - INFO - 
================================================================================
                  FEATURE ENGINEERING PIPELINE V2 (MULTI-PASS)                  
================================================================================

2025-11-13 17:34:52 - utils - INFO - Found /Users/bipinrimal/Downloads/Thesis_work/data/processed/daily_features_unscaled_r1_r2_r3.1_v2.csv, skipping Pass 1.
2025-11-13 17:34:52 - utils - INFO - 
================================================================================
                     PASS 2: FEATURE ENRICHMENT (Z-SCORES)                      
================================================================================

2025-11-13 17:34:52 - utils - INFO - Verified 'role' column for Pass 2.
2025-11-13 17:34:52 - utils - INFO - Calculating self-relative Z-Scores (rolling 30-day)...
2025-11-13 17:34:56 - utils - INFO - Calculating peer-relative Z-Scores (by role)...
2025-11-13 17:34:57 - utils - INFO - PASS 2 complete. Enriched features created.
2025-11-13 17:34:57 - utils - INFO - Scaling and saving final daily features (for LSTM)...
2025-11-13 17:34:57 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/daily_feature_scaler_v2.pkl
2025-11-13 17:35:20 - utils - INFO - Saved /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_daily_features_r1_r2_r3.1_v2.csv
2025-11-13 17:35:20 - utils - INFO - 
================================================================================
                        PASS 3: STATIC FEATURE CREATION                         
================================================================================

2025-11-13 17:35:21 - utils - INFO - Created static features for 4999 users
2025-11-13 17:35:21 - utils - INFO - Scaling and saving static features...
2025-11-13 17:35:21 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/static_feature_scaler_v2.pkl
2025-11-13 17:35:21 - utils - INFO - PASS 3 complete. Saved /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_static_features_r1_r2_r3.1_v2.csv
2025-11-13 17:35:21 - utils - INFO - 
================================================================================
                           PASS 4: SEQUENCE CREATION                            
================================================================================

2025-11-13 17:35:21 - utils - INFO - Creating sequences (length=15, stride=10)...
2025-11-13 17:37:50 - utils - INFO - Created 162520 sequences from 4999 users
2025-11-13 17:37:50 - utils - INFO - PASS 4 complete. Saved sequence files to /Users/bipinrimal/Downloads/Thesis_work/data/processed
2025-11-13 17:37:50 - utils - INFO - ================================================================================
2025-11-13 17:37:50 - utils - INFO - V2 Feature Engineering Complete!
2025-11-13 17:37:50 - utils - INFO -   Static features created: /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_static_features_r1_r2_r3.1_v2.csv
2025-11-13 17:37:50 - utils - INFO -   Sequence files created: /Users/bipinrimal/Downloads/Thesis_work/data/processed
2025-11-13 17:37:50 - utils - INFO - Next step: Train V2 models.
2025-11-13 17:37:50 - utils - INFO - ================================================================================
2025-11-13 17:38:27 - utils - INFO - Utility functions loaded successfully
2025-11-13 17:38:27 - utils - INFO - 
================================================================================
                 ISOLATION FOREST TRAINING (V2: MULTI-DATASET)                  
================================================================================

2025-11-13 17:38:27 - utils - INFO - Model loaded from /Users/bipinrimal/Downloads/Thesis_work/models/static_feature_scaler_v2.pkl
2025-11-13 17:38:27 - utils - INFO - Data split: 4999 total samples, 9 insiders
2025-11-13 17:38:27 - utils - INFO - Training on: 3996 normal samples
2025-11-13 17:38:27 - utils - INFO - Calibrating on: 1000 normal samples
2025-11-13 17:38:27 - utils - INFO - Testing on: 4999 total samples (including 9 insiders)
2025-11-13 17:38:27 - utils - INFO - Initialized Isolation Forest (V2) with params: {'n_estimators': 50, 'max_samples': 256, 'contamination': 'auto', 'max_features': 1.0, 'bootstrap': False, 'n_jobs': -1, 'random_state': 42, 'verbose': 0}
2025-11-13 17:38:27 - utils - INFO - Training Isolation Forest on 3996 normal samples...
2025-11-13 17:38:27 - utils - INFO - Isolation Forest training completed
2025-11-13 17:38:27 - utils - INFO - Calibrating threshold for target FPR=0.05...
2025-11-13 17:38:27 - utils - INFO - Calibrated threshold: 0.5348
2025-11-13 17:38:27 - utils - INFO - Evaluating Isolation Forest (V2)...
2025-11-13 17:38:27 - utils - INFO - Test set contains 9 positive samples.
2025-11-13 17:38:27 - utils - INFO - 
============================================================
2025-11-13 17:38:27 - utils - INFO - Isolation Forest (V2) Performance Metrics
2025-11-13 17:38:27 - utils - INFO - ============================================================
2025-11-13 17:38:27 - utils - INFO - Accuracy:  0.9440
2025-11-13 17:38:27 - utils - INFO - Precision: 0.0071
2025-11-13 17:38:27 - utils - INFO - Recall:    0.6667
2025-11-13 17:38:27 - utils - INFO - F1-Score:  0.0141
2025-11-13 17:38:27 - utils - INFO - AUC-ROC:   0.9185
2025-11-13 17:38:27 - utils - INFO - ============================================================

2025-11-13 17:38:27 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest_v2.pkl
2025-11-13 17:38:27 - utils - INFO - Saving Isolation Forest model to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest_v2.pkl
2025-11-13 17:38:27 - utils - INFO - Isolation Forest (V2) training and evaluation completed!
2025-11-13 17:38:34 - utils - INFO - Utility functions loaded successfully
2025-11-13 17:38:37 - utils - INFO - 
================================================================================
            LIGHTWEIGHT DEEP CLUSTERING TRAINING (V2: MULTI-DATASET)            
================================================================================

2025-11-13 17:38:37 - utils - INFO - Loading static features from: engineered_static_features_r1_r2_r3.1_v2.csv
2025-11-13 17:38:37 - utils - INFO - Model loaded from /Users/bipinrimal/Downloads/Thesis_work/models/static_feature_scaler_v2.pkl
2025-11-13 17:38:37 - utils - INFO - Dataset: 4999 samples, 9 insiders
2025-11-13 17:38:37 - utils - INFO - Training on: 3996 normal samples
2025-11-13 17:38:37 - utils - INFO - Calibrating on: 1000 normal samples
2025-11-13 17:38:37 - utils - INFO - Testing on: 4999 total samples (including 9 insiders)
2025-11-13 17:38:37 - utils - INFO - Initialized Lightweight Deep Clustering (V2) (n_clusters=5, encoding_dim=32)
2025-11-13 17:38:37 - utils - INFO - Training lightweight deep clustering model (V2)...
2025-11-13 17:38:37 - utils - INFO - Pre-training autoencoder...
2025-11-13 17:38:38 - utils - INFO - Autoencoder pre-training completed
2025-11-13 17:38:38 - utils - INFO - Fitting MiniBatch K-Means clustering...
2025-11-13 17:38:38 - utils - INFO - Deep clustering training completed
2025-11-13 17:38:38 - utils - INFO - Training completed in 1.58 seconds
2025-11-13 17:38:38 - utils - INFO - Calibrating threshold for target FPR=0.05...
2025-11-13 17:38:38 - utils - INFO - Calibrated threshold: 2.0736
2025-11-13 17:38:38 - utils - INFO - Evaluating lightweight deep clustering model (V2)...
2025-11-13 17:38:39 - utils - INFO - Test set contains 9 positive samples.
2025-11-13 17:38:39 - utils - INFO - 
============================================================
2025-11-13 17:38:39 - utils - INFO - Deep Clustering (V2) Performance Metrics
2025-11-13 17:38:39 - utils - INFO - ============================================================
2025-11-13 17:38:39 - utils - INFO - Accuracy:  0.9486
2025-11-13 17:38:39 - utils - INFO - Precision: 0.0078
2025-11-13 17:38:39 - utils - INFO - Recall:    0.6667
2025-11-13 17:38:39 - utils - INFO - F1-Score:  0.0153
2025-11-13 17:38:39 - utils - INFO - AUC-ROC:   0.7720
2025-11-13 17:38:39 - utils - INFO - ============================================================

2025-11-13 17:38:39 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/deep_clustering_v2.pkl
2025-11-13 17:38:39 - utils - INFO - Encoder model saved to /Users/bipinrimal/Downloads/Thesis_work/models/deep_clustering_v2_encoder.keras
2025-11-13 17:38:39 - utils - INFO - Deep Clustering (V2) training and evaluation completed!
2025-11-13 17:38:52 - utils - INFO - Utility functions loaded successfully
2025-11-13 17:38:54 - utils - INFO - 
================================================================================
           LIGHTWEIGHT LSTM AUTOENCODER TRAINING (V2: MULTI-DATASET)            
================================================================================

2025-11-13 17:38:54 - utils - INFO - Loading sequences from: sequences_r1_r2_r3.1_v2.npy
2025-11-13 17:38:54 - utils - INFO - Loaded sequences: (162520, 15, 33), with 1 insider sequences
2025-11-13 17:38:54 - utils - INFO - Training on: 130015 normal sequences
2025-11-13 17:38:54 - utils - INFO - Calibrating on: 32504 normal sequences
2025-11-13 17:38:54 - utils - INFO - Testing on: 162520 total sequences (including 1 insider sequences)
2025-11-13 17:38:54 - utils - INFO - Model loaded from /Users/bipinrimal/Downloads/Thesis_work/models/daily_feature_scaler_v2.pkl
2025-11-13 17:38:54 - utils - INFO - Initialized Lightweight LSTM Autoencoder (V2) (15, 33)
2025-11-13 17:38:54 - utils - INFO - Training lightweight LSTM Autoencoder on 130015 sequences...
2025-11-13 17:38:54 - utils - INFO - Building lightweight LSTM Autoencoder (V2)...
2025-11-13 17:38:54 - utils - INFO - Model built with 21,329 parameters
2025-11-13 17:41:27 - utils - INFO - Training completed
2025-11-13 17:41:27 - utils - INFO - Training completed in 153.32 seconds
2025-11-13 17:41:27 - utils - INFO - Calibrating threshold for target FPR=0.05
2025-11-13 17:41:28 - utils - INFO - Calibrated threshold: 0.2534
2025-11-13 17:41:28 - utils - INFO - Evaluating lightweight LSTM Autoencoder (V2)...
2025-11-13 17:41:31 - utils - INFO - Test set contains 1 positive samples.
2025-11-13 17:41:33 - utils - INFO - 
============================================================
2025-11-13 17:41:33 - utils - INFO - LSTM Autoencoder (V2) Performance Metrics
2025-11-13 17:41:33 - utils - INFO - ============================================================
2025-11-13 17:41:33 - utils - INFO - Accuracy:  0.9593
2025-11-13 17:41:33 - utils - INFO - Precision: 0.0000
2025-11-13 17:41:33 - utils - INFO - Recall:    0.0000
2025-11-13 17:41:33 - utils - INFO - F1-Score:  0.0000
2025-11-13 17:41:33 - utils - INFO - AUC-ROC:   0.8800
2025-11-13 17:41:33 - utils - INFO - ============================================================

2025-11-13 17:41:33 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/lstm_autoencoder_v2.keras
2025-11-13 17:41:35 - utils - INFO - Lightweight LSTM Autoencoder (V2) completed!
2025-11-13 17:43:29 - utils - INFO - Utility functions loaded successfully
2025-11-13 17:43:29 - utils - INFO - 
================================================================================
                      COMPREHENSIVE MODEL EVALUATION (V2)                       
================================================================================

2025-11-13 17:43:29 - utils - INFO - Loading V2 results for all models...
2025-11-13 17:43:29 - utils - ERROR - Failed to load V2 results for isolation_forest from isolation_forest_metrics_r1_r2_r3.1_v2.csv: [Errno 2] No such file or directory: '/Users/bipinrimal/Downloads/Thesis_work/results/isolation_forest_metrics_r1_r2_r3.1_v2.csv'
2025-11-13 17:43:29 - utils - INFO - Loaded results for deep_clustering
2025-11-13 17:43:29 - utils - INFO - Loaded results for lstm_autoencoder
2025-11-13 17:43:29 - utils - INFO - Loaded results for 2 models
2025-11-13 17:43:29 - utils - INFO - Creating metrics comparison table...
2025-11-13 17:43:29 - utils - INFO - Metrics comparison table created
2025-11-13 17:43:29 - utils - INFO - Creating confusion matrix plots...
2025-11-13 17:43:29 - utils - INFO - Confusion matrices saved to /Users/bipinrimal/Downloads/Thesis_work/results/confusion_matrices/all_models_r1_r2_r3.1_v2.png
2025-11-13 17:43:29 - utils - INFO - Creating ROC curves...
2025-11-13 17:43:29 - utils - ERROR - Evaluation failed: multiclass format is not supported
2025-11-13 17:44:05 - utils - INFO - Utility functions loaded successfully
2025-11-13 17:44:05 - utils - INFO - 
================================================================================
              MODEL DIAGNOSIS & THRESHOLD TUNING (V2: r1_r2_r3.1)               
================================================================================

2025-11-13 17:44:05 - utils - INFO - 
================================================================================
2025-11-13 17:44:05 - utils - INFO - Diagnosing: Isolation Forest
2025-11-13 17:44:05 - utils - INFO - ================================================================================
2025-11-13 17:44:05 - utils - ERROR - Could not load predictions for isolation_forest from isolation_forest_predictions_r1_r2_r3.1_v2.csv: [Errno 2] No such file or directory: '/Users/bipinrimal/Downloads/Thesis_work/results/isolation_forest_predictions_r1_r2_r3.1_v2.csv'
2025-11-13 17:44:05 - utils - INFO - 
================================================================================
2025-11-13 17:44:05 - utils - INFO - Diagnosing: Deep Clustering
2025-11-13 17:44:05 - utils - INFO - ================================================================================
2025-11-13 17:44:05 - utils - INFO - Loaded 4999 predictions for deep_clustering
2025-11-13 17:44:41 - utils - INFO - Utility functions loaded successfully
2025-11-13 17:44:41 - utils - INFO - 
================================================================================
                      COMPREHENSIVE MODEL EVALUATION (V2)                       
================================================================================

2025-11-13 17:44:41 - utils - INFO - Loading V2 results for all models...
2025-11-13 17:44:41 - utils - ERROR - Failed to load V2 results for isolation_forest from isolation_forest_metrics_r1_r2_r3.1_v2.csv: [Errno 2] No such file or directory: '/Users/bipinrimal/Downloads/Thesis_work/results/isolation_forest_metrics_r1_r2_r3.1_v2.csv'
2025-11-13 17:44:41 - utils - INFO - Loaded results for deep_clustering
2025-11-13 17:44:41 - utils - INFO - Loaded results for lstm_autoencoder
2025-11-13 17:44:41 - utils - INFO - Loaded results for 2 models
2025-11-13 17:44:41 - utils - INFO - Creating metrics comparison table...
2025-11-13 17:44:41 - utils - INFO - Metrics comparison table created
2025-11-13 17:44:41 - utils - INFO - Creating confusion matrix plots...
2025-11-13 17:44:41 - utils - INFO - Confusion matrices saved to /Users/bipinrimal/Downloads/Thesis_work/results/confusion_matrices/all_models_r1_r2_r3.1_v2.png
2025-11-13 17:44:41 - utils - INFO - Creating ROC curves...
2025-11-13 17:44:41 - utils - ERROR - Evaluation failed: multiclass format is not supported
2025-11-13 17:47:32 - utils - INFO - Utility functions loaded successfully
2025-11-13 17:47:32 - utils - INFO - 
================================================================================
                 ISOLATION FOREST TRAINING (V2: MULTI-DATASET)                  
================================================================================

2025-11-13 17:47:32 - utils - INFO - Model loaded from /Users/bipinrimal/Downloads/Thesis_work/models/static_feature_scaler_v2.pkl
2025-11-13 17:47:32 - utils - INFO - Data split: 4999 total samples, 9 insiders
2025-11-13 17:47:32 - utils - INFO - Training on: 3996 normal samples
2025-11-13 17:47:32 - utils - INFO - Calibrating on: 1000 normal samples
2025-11-13 17:47:32 - utils - INFO - Testing on: 4999 total samples (including 9 insiders)
2025-11-13 17:47:32 - utils - INFO - Initialized Isolation Forest (V2) with params: {'n_estimators': 50, 'max_samples': 256, 'contamination': 'auto', 'max_features': 1.0, 'bootstrap': False, 'n_jobs': -1, 'random_state': 42, 'verbose': 0}
2025-11-13 17:47:32 - utils - INFO - Training Isolation Forest on 3996 normal samples...
2025-11-13 17:47:32 - utils - INFO - Isolation Forest training completed
2025-11-13 17:47:32 - utils - INFO - Calibrating threshold for target FPR=0.05...
2025-11-13 17:47:32 - utils - INFO - Calibrated threshold: 0.5348
2025-11-13 17:47:32 - utils - INFO - Evaluating Isolation Forest (V2)...
2025-11-13 17:47:32 - utils - INFO - Test set contains 9 positive samples.
2025-11-13 17:47:32 - utils - INFO - 
============================================================
2025-11-13 17:47:32 - utils - INFO - Isolation Forest (V2) Performance Metrics
2025-11-13 17:47:32 - utils - INFO - ============================================================
2025-11-13 17:47:32 - utils - INFO - Accuracy:  0.9440
2025-11-13 17:47:32 - utils - INFO - Precision: 0.0071
2025-11-13 17:47:32 - utils - INFO - Recall:    0.6667
2025-11-13 17:47:32 - utils - INFO - F1-Score:  0.0141
2025-11-13 17:47:32 - utils - INFO - AUC-ROC:   0.9185
2025-11-13 17:47:32 - utils - INFO - ============================================================

2025-11-13 17:47:32 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest_v2.pkl
2025-11-13 17:47:32 - utils - INFO - Saving Isolation Forest model to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest_v2.pkl
2025-11-13 17:47:32 - utils - INFO - Isolation Forest (V2) training and evaluation completed!
2025-11-13 17:54:16 - utils - INFO - Utility functions loaded successfully
2025-11-13 17:54:18 - utils - INFO - 
================================================================================
            LIGHTWEIGHT DEEP CLUSTERING TRAINING (V2: MULTI-DATASET)            
================================================================================

2025-11-13 17:54:18 - utils - INFO - Loading static features from: engineered_static_features_r1_r2_r3.1_v2.csv
2025-11-13 17:54:18 - utils - INFO - Model loaded from /Users/bipinrimal/Downloads/Thesis_work/models/static_feature_scaler_v2.pkl
2025-11-13 17:54:18 - utils - INFO - Dataset: 4999 samples, 9 insiders
2025-11-13 17:54:18 - utils - INFO - Training on: 3996 normal samples
2025-11-13 17:54:18 - utils - INFO - Calibrating on: 1000 normal samples
2025-11-13 17:54:18 - utils - INFO - Testing on: 4999 total samples (including 9 insiders)
2025-11-13 17:54:18 - utils - INFO - Initialized Lightweight Deep Clustering (V2) (n_clusters=5, encoding_dim=32)
2025-11-13 17:54:18 - utils - INFO - Training lightweight deep clustering model (V2)...
2025-11-13 17:54:18 - utils - INFO - Pre-training autoencoder...
2025-11-13 17:54:19 - utils - INFO - Autoencoder pre-training completed
2025-11-13 17:54:19 - utils - INFO - Fitting MiniBatch K-Means clustering...
2025-11-13 17:54:20 - utils - INFO - Deep clustering training completed
2025-11-13 17:54:20 - utils - INFO - Training completed in 1.52 seconds
2025-11-13 17:54:20 - utils - INFO - Calibrating threshold for target FPR=0.05...
2025-11-13 17:54:20 - utils - INFO - Calibrated threshold: 2.5595
2025-11-13 17:54:20 - utils - INFO - Evaluating lightweight deep clustering model (V2)...
2025-11-13 17:54:20 - utils - INFO - Test set contains 9 positive samples.
2025-11-13 17:54:20 - utils - INFO - 
============================================================
2025-11-13 17:54:20 - utils - INFO - Deep Clustering (V2) Performance Metrics
2025-11-13 17:54:20 - utils - INFO - ============================================================
2025-11-13 17:54:20 - utils - INFO - Accuracy:  0.9526
2025-11-13 17:54:20 - utils - INFO - Precision: 0.0042
2025-11-13 17:54:20 - utils - INFO - Recall:    0.3333
2025-11-13 17:54:20 - utils - INFO - F1-Score:  0.0084
2025-11-13 17:54:20 - utils - INFO - AUC-ROC:   0.6458
2025-11-13 17:54:20 - utils - INFO - ============================================================

2025-11-13 17:54:20 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/deep_clustering_v2.pkl
2025-11-13 17:54:20 - utils - INFO - Encoder model saved to /Users/bipinrimal/Downloads/Thesis_work/models/deep_clustering_v2_encoder.keras
2025-11-13 17:54:20 - utils - INFO - Deep Clustering (V2) training and evaluation completed!
2025-11-13 17:59:15 - utils - INFO - Utility functions loaded successfully
2025-11-13 17:59:17 - utils - INFO - 
================================================================================
           LIGHTWEIGHT LSTM AUTOENCODER TRAINING (V2: MULTI-DATASET)            
================================================================================

2025-11-13 17:59:17 - utils - INFO - Loading sequences from: sequences_r1_r2_r3.1_v2.npy
2025-11-13 17:59:17 - utils - INFO - Loaded sequences: (162520, 15, 33), with 1 insider sequences
2025-11-13 17:59:17 - utils - INFO - Training on: 130015 normal sequences
2025-11-13 17:59:17 - utils - INFO - Calibrating on: 32504 normal sequences
2025-11-13 17:59:17 - utils - INFO - Testing on: 162520 total sequences (including 1 insider sequences)
2025-11-13 17:59:17 - utils - INFO - Model loaded from /Users/bipinrimal/Downloads/Thesis_work/models/daily_feature_scaler_v2.pkl
2025-11-13 17:59:17 - utils - INFO - Initialized Lightweight LSTM Autoencoder (V2) (15, 33)
2025-11-13 17:59:17 - utils - INFO - Training lightweight LSTM Autoencoder on 130015 sequences...
2025-11-13 17:59:17 - utils - INFO - Building lightweight LSTM Autoencoder (V2)...
2025-11-13 17:59:17 - utils - INFO - Model built with 21,329 parameters
2025-11-13 18:02:50 - utils - INFO - Training completed
2025-11-13 18:02:50 - utils - INFO - Training completed in 212.30 seconds
2025-11-13 18:02:50 - utils - INFO - Calibrating threshold for target FPR=0.05
2025-11-13 18:02:51 - utils - INFO - Calibrated threshold: 0.2942
2025-11-13 18:02:51 - utils - INFO - Evaluating lightweight LSTM Autoencoder (V2)...
2025-11-13 18:02:53 - utils - INFO - Test set contains 1 positive samples.
2025-11-13 18:02:55 - utils - INFO - 
============================================================
2025-11-13 18:02:55 - utils - INFO - LSTM Autoencoder (V2) Performance Metrics
2025-11-13 18:02:55 - utils - INFO - ============================================================
2025-11-13 18:02:55 - utils - INFO - Accuracy:  0.9719
2025-11-13 18:02:55 - utils - INFO - Precision: 0.0000
2025-11-13 18:02:55 - utils - INFO - Recall:    0.0000
2025-11-13 18:02:55 - utils - INFO - F1-Score:  0.0000
2025-11-13 18:02:55 - utils - INFO - AUC-ROC:   0.8819
2025-11-13 18:02:55 - utils - INFO - ============================================================

2025-11-13 18:02:55 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/lstm_autoencoder_v2.keras
2025-11-13 18:02:58 - utils - INFO - Lightweight LSTM Autoencoder (V2) completed!
2025-11-13 18:03:13 - utils - INFO - Utility functions loaded successfully
2025-11-13 18:03:13 - utils - INFO - 
================================================================================
                      COMPREHENSIVE MODEL EVALUATION (V2)                       
================================================================================

2025-11-13 18:03:13 - utils - INFO - Loading V2 results for all models...
2025-11-13 18:03:13 - utils - ERROR - Failed to load V2 results for isolation_forest from isolation_forest_metrics_r1_r2_r3.1_v2.csv: [Errno 2] No such file or directory: '/Users/bipinrimal/Downloads/Thesis_work/results/isolation_forest_metrics_r1_r2_r3.1_v2.csv'
2025-11-13 18:03:13 - utils - INFO - Loaded results for deep_clustering
2025-11-13 18:03:13 - utils - INFO - Loaded results for lstm_autoencoder
2025-11-13 18:03:13 - utils - INFO - Loaded results for 2 models
2025-11-13 18:03:13 - utils - INFO - Creating metrics comparison table...
2025-11-13 18:03:13 - utils - INFO - Metrics comparison table created
2025-11-13 18:03:13 - utils - INFO - Creating confusion matrix plots...
2025-11-13 18:03:13 - utils - INFO - Confusion matrices saved to /Users/bipinrimal/Downloads/Thesis_work/results/confusion_matrices/all_models_r1_r2_r3.1_v2.png
2025-11-13 18:03:13 - utils - INFO - Creating ROC curves...
2025-11-13 18:03:13 - utils - ERROR - Evaluation failed: multiclass format is not supported
2025-11-13 18:05:07 - utils - INFO - Utility functions loaded successfully
2025-11-13 18:05:07 - utils - INFO - 
================================================================================
                      COMPREHENSIVE MODEL EVALUATION (V2)                       
================================================================================

2025-11-13 18:05:07 - utils - INFO - Loading V2 results for all models...
2025-11-13 18:05:07 - utils - ERROR - Failed to load V2 results for isolation_forest from isolation_forest_metrics_r1_r2_r3.1_v2.csv: [Errno 2] No such file or directory: '/Users/bipinrimal/Downloads/Thesis_work/results/isolation_forest_metrics_r1_r2_r3.1_v2.csv'
2025-11-13 18:05:07 - utils - INFO - Loaded results for deep_clustering
2025-11-13 18:05:07 - utils - INFO - Loaded results for lstm_autoencoder
2025-11-13 18:05:07 - utils - INFO - Loaded results for 2 models
2025-11-13 18:05:07 - utils - INFO - Creating metrics comparison table...
2025-11-13 18:05:07 - utils - INFO - Metrics comparison table created
2025-11-13 18:05:07 - utils - INFO - Creating confusion matrix plots...
2025-11-13 18:05:07 - utils - INFO - Confusion matrices saved to /Users/bipinrimal/Downloads/Thesis_work/results/confusion_matrices/all_models_r1_r2_r3.1_v2.png
2025-11-13 18:05:07 - utils - INFO - Creating ROC curves...
2025-11-13 18:05:07 - utils - ERROR - Evaluation failed: multiclass format is not supported
2025-11-13 18:05:55 - utils - INFO - Utility functions loaded successfully
2025-11-13 18:05:55 - utils - INFO - 
================================================================================
                      COMPREHENSIVE MODEL EVALUATION (V2)                       
================================================================================

2025-11-13 18:05:55 - utils - INFO - Loading V2 results for all models...
2025-11-13 18:05:55 - utils - INFO - Loaded results for isolation_forest
2025-11-13 18:05:55 - utils - INFO - Loaded results for deep_clustering
2025-11-13 18:05:55 - utils - INFO - Loaded results for lstm_autoencoder
2025-11-13 18:05:55 - utils - INFO - Loaded results for 3 models
2025-11-13 18:05:55 - utils - INFO - Creating metrics comparison table...
2025-11-13 18:05:55 - utils - INFO - Metrics comparison table created
2025-11-13 18:05:55 - utils - INFO - Creating confusion matrix plots...
2025-11-13 18:05:55 - utils - INFO - Confusion matrices saved to /Users/bipinrimal/Downloads/Thesis_work/results/confusion_matrices/all_models_r1_r2_r3.1_v2.png
2025-11-13 18:05:55 - utils - INFO - Creating ROC curves...
2025-11-13 18:05:55 - utils - ERROR - Evaluation failed: multiclass format is not supported
2025-11-13 18:06:45 - utils - INFO - Utility functions loaded successfully
2025-11-13 18:06:45 - utils - INFO - 
================================================================================
                      COMPREHENSIVE MODEL EVALUATION (V2)                       
================================================================================

2025-11-13 18:06:45 - utils - INFO - Loading V2 results for all models...
2025-11-13 18:06:45 - utils - INFO - Loaded results for isolation_forest
2025-11-13 18:06:45 - utils - INFO - Loaded results for deep_clustering
2025-11-13 18:06:45 - utils - INFO - Loaded results for lstm_autoencoder
2025-11-13 18:06:45 - utils - INFO - Loaded results for 3 models
2025-11-13 18:06:45 - utils - INFO - Creating metrics comparison table...
2025-11-13 18:06:45 - utils - INFO - Metrics comparison table created
2025-11-13 18:06:45 - utils - INFO - Creating confusion matrix plots...
2025-11-13 18:06:45 - utils - INFO - Confusion matrices saved to /Users/bipinrimal/Downloads/Thesis_work/results/confusion_matrices/all_models_r1_r2_r3.1_v2.png
2025-11-13 18:06:45 - utils - INFO - Creating ROC curves...
2025-11-13 18:06:45 - utils - ERROR - Evaluation failed: multiclass format is not supported
2025-11-13 18:11:04 - utils - INFO - Utility functions loaded successfully
2025-11-13 18:11:04 - utils - INFO - 
================================================================================
                      COMPREHENSIVE MODEL EVALUATION (V2)                       
================================================================================

2025-11-13 18:11:04 - utils - INFO - Loading V2 results for all models...
2025-11-13 18:11:04 - utils - INFO - Loaded results for isolation_forest
2025-11-13 18:11:04 - utils - INFO - Loaded results for deep_clustering
2025-11-13 18:11:04 - utils - INFO - Loaded results for lstm_autoencoder
2025-11-13 18:11:04 - utils - INFO - Loaded results for 3 models
2025-11-13 18:11:04 - utils - INFO - Creating metrics comparison table...
2025-11-13 18:11:04 - utils - INFO - Metrics comparison table created
2025-11-13 18:11:04 - utils - INFO - Creating confusion matrix plots...
2025-11-13 18:11:04 - utils - INFO - Confusion matrices saved to /Users/bipinrimal/Downloads/Thesis_work/results/confusion_matrices/all_models_r1_r2_r3.1_v2.png
2025-11-13 18:11:04 - utils - INFO - Creating ROC curves...
2025-11-13 18:11:04 - utils - ERROR - Evaluation failed: multiclass format is not supported
2025-11-13 18:11:35 - utils - INFO - Utility functions loaded successfully
2025-11-13 18:11:35 - utils - INFO - 
================================================================================
                 ISOLATION FOREST TRAINING (V2: MULTI-DATASET)                  
================================================================================

2025-11-13 18:11:35 - utils - INFO - Loading static features from: engineered_static_features_r1_r2_r3.1_v2.csv
2025-11-13 18:11:35 - utils - INFO - Model loaded from /Users/bipinrimal/Downloads/Thesis_work/models/static_feature_scaler_v2.pkl
2025-11-13 18:11:35 - utils - INFO - Data loaded: 4999 total samples, 9 insiders
2025-11-13 18:11:35 - utils - INFO - Training on: 3996 normal samples
2025-11-13 18:11:35 - utils - INFO - Calibrating on: 1000 normal samples
2025-11-13 18:11:35 - utils - INFO - Testing on: 4999 total samples (including 9 insiders)
2025-11-13 18:11:35 - utils - INFO - Initialized Isolation Forest (V2) with params: {'n_estimators': 50, 'max_samples': 256, 'contamination': 'auto', 'max_features': 1.0, 'bootstrap': False, 'n_jobs': -1, 'random_state': 42, 'verbose': 0}
2025-11-13 18:11:35 - utils - INFO - Training Isolation Forest on 3996 normal samples...
2025-11-13 18:11:35 - utils - INFO - Isolation Forest training completed
2025-11-13 18:11:35 - utils - INFO - Calibrating threshold for target FPR=0.05...
2025-11-13 18:11:35 - utils - INFO - Calibrated threshold: 0.5348
2025-11-13 18:11:35 - utils - INFO - Evaluating Isolation Forest (V2)...
2025-11-13 18:11:35 - utils - INFO - Test set contains 9 positive samples.
2025-11-13 18:11:35 - utils - INFO - 
============================================================
2025-11-13 18:11:35 - utils - INFO - Isolation Forest (V2) Performance Metrics
2025-11-13 18:11:35 - utils - INFO - ============================================================
2025-11-13 18:11:35 - utils - INFO - Accuracy:  0.9440
2025-11-13 18:11:35 - utils - INFO - Precision: 0.0071
2025-11-13 18:11:35 - utils - INFO - Recall:    0.6667
2025-11-13 18:11:35 - utils - INFO - F1-Score:  0.0141
2025-11-13 18:11:35 - utils - INFO - AUC-ROC:   0.9185
2025-11-13 18:11:35 - utils - INFO - ============================================================

2025-11-13 18:11:35 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest_v2.pkl
2025-11-13 18:11:35 - utils - INFO - Saving Isolation Forest model to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest_v2.pkl
2025-11-13 18:11:35 - utils - INFO - Isolation Forest (V2) training and evaluation completed!
2025-11-13 18:14:30 - utils - INFO - Utility functions loaded successfully
2025-11-13 18:14:30 - utils - INFO - 
================================================================================
                 ISOLATION FOREST TRAINING (V2: MULTI-DATASET)                  
================================================================================

2025-11-13 18:14:30 - utils - INFO - Loading static features from: engineered_static_features_r1_r2_r3.1_v2.csv
2025-11-13 18:14:30 - utils - INFO - Model loaded from /Users/bipinrimal/Downloads/Thesis_work/models/static_feature_scaler_v2.pkl
2025-11-13 18:14:30 - utils - INFO - Data loaded: 4999 total samples, 9 insiders
2025-11-13 18:14:30 - utils - INFO - Training on: 3996 normal samples
2025-11-13 18:14:30 - utils - INFO - Calibrating on: 1000 normal samples
2025-11-13 18:14:30 - utils - INFO - Testing on: 4999 total samples (including 9 insiders)
2025-11-13 18:14:30 - utils - INFO - Initialized Isolation Forest (V2) with params: {'n_estimators': 50, 'max_samples': 256, 'contamination': 'auto', 'max_features': 1.0, 'bootstrap': False, 'n_jobs': -1, 'random_state': 42, 'verbose': 0}
2025-11-13 18:14:30 - utils - INFO - Training Isolation Forest on 3996 normal samples...
2025-11-13 18:14:30 - utils - INFO - Isolation Forest training completed
2025-11-13 18:14:30 - utils - INFO - Calibrating threshold for target FPR=0.05...
2025-11-13 18:14:30 - utils - INFO - Calibrated threshold: 0.5348
2025-11-13 18:14:30 - utils - INFO - Evaluating Isolation Forest (V2)...
2025-11-13 18:14:30 - utils - INFO - Test set contains 9 positive samples.
2025-11-13 18:14:30 - utils - INFO - 
============================================================
2025-11-13 18:14:30 - utils - INFO - Isolation Forest (V2) Performance Metrics
2025-11-13 18:14:30 - utils - INFO - ============================================================
2025-11-13 18:14:30 - utils - INFO - Accuracy:  0.9440
2025-11-13 18:14:30 - utils - INFO - Precision: 0.0071
2025-11-13 18:14:30 - utils - INFO - Recall:    0.6667
2025-11-13 18:14:30 - utils - INFO - F1-Score:  0.0141
2025-11-13 18:14:30 - utils - INFO - AUC-ROC:   0.9185
2025-11-13 18:14:30 - utils - INFO - ============================================================

2025-11-13 18:14:30 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest_v2.pkl
2025-11-13 18:14:30 - utils - INFO - Saving Isolation Forest model to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest_v2.pkl
2025-11-13 18:14:30 - utils - INFO - Isolation Forest (V2) training and evaluation completed!
2025-11-13 18:14:33 - utils - INFO - Utility functions loaded successfully
2025-11-13 18:14:33 - utils - INFO - 
================================================================================
                      COMPREHENSIVE MODEL EVALUATION (V2)                       
================================================================================

2025-11-13 18:14:33 - utils - INFO - Loading V2 results for all models...
2025-11-13 18:14:33 - utils - INFO - Loaded results for isolation_forest
2025-11-13 18:14:33 - utils - INFO - Loaded results for deep_clustering
2025-11-13 18:14:33 - utils - INFO - Loaded results for lstm_autoencoder
2025-11-13 18:14:33 - utils - INFO - Loaded results for 3 models
2025-11-13 18:14:33 - utils - INFO - Creating metrics comparison table...
2025-11-13 18:14:33 - utils - INFO - Metrics comparison table created
2025-11-13 18:14:33 - utils - INFO - Creating confusion matrix plots...
2025-11-13 18:14:33 - utils - INFO - Confusion matrices saved to /Users/bipinrimal/Downloads/Thesis_work/results/confusion_matrices/all_models_r1_r2_r3.1_v2.png
2025-11-13 18:14:33 - utils - INFO - Creating ROC curves...
2025-11-13 18:14:33 - utils - WARNING - Skipping ROC for isolation_forest: Non-binary or invalid label format (multiclass)
2025-11-13 18:14:33 - utils - WARNING - Skipping ROC for deep_clustering: Non-binary or invalid label format (multiclass)
2025-11-13 18:14:33 - utils - INFO - ROC curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/roc_curves/roc_comparison_r1_r2_r3.1_v2.png
2025-11-13 18:14:33 - utils - INFO - Creating Precision-Recall curves...
2025-11-13 18:14:33 - utils - WARNING - Skipping PR for isolation_forest: Non-binary labels.
2025-11-13 18:14:33 - utils - WARNING - Skipping PR for deep_clustering: Non-binary labels.
2025-11-13 18:14:33 - utils - INFO - Precision-Recall curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/precision_recall_comparison_r1_r2_r3.1_v2.png
2025-11-13 18:14:33 - utils - INFO - Generating evaluation report...
2025-11-13 18:14:33 - utils - INFO - Evaluation report saved to /Users/bipinrimal/Downloads/Thesis_work/results/evaluation_report_r1_r2_r3.1_v2.txt
2025-11-13 18:14:33 - utils - INFO - Comprehensive V2 evaluation completed successfully!
2025-11-13 18:15:22 - utils - INFO - Utility functions loaded successfully
2025-11-13 18:15:22 - utils - INFO - 
================================================================================
              MODEL DIAGNOSIS & THRESHOLD TUNING (V2: r1_r2_r3.1)               
================================================================================

2025-11-13 18:15:22 - utils - INFO - 
================================================================================
2025-11-13 18:15:22 - utils - INFO - Diagnosing: Isolation Forest
2025-11-13 18:15:22 - utils - INFO - ================================================================================
2025-11-13 18:15:22 - utils - INFO - Loaded 4999 predictions for isolation_forest
2025-11-13 18:18:43 - utils - INFO - Utility functions loaded successfully
2025-11-13 18:18:43 - utils - INFO - 
================================================================================
              MODEL DIAGNOSIS & THRESHOLD TUNING (V2: r1_r2_r3.1)               
================================================================================

2025-11-13 18:18:43 - utils - INFO - 
================================================================================
2025-11-13 18:18:43 - utils - INFO - Diagnosing: Isolation Forest
2025-11-13 18:18:43 - utils - INFO - ================================================================================
2025-11-13 18:18:43 - utils - INFO - Loaded 4999 predictions for isolation_forest
2025-11-13 18:18:43 - utils - INFO - --- Optimal Threshold Found ---
2025-11-13 18:18:43 - utils - INFO - Best F1-Score: 0.0476
2025-11-13 18:18:43 - utils - INFO - Precision:     0.0256
2025-11-13 18:18:43 - utils - INFO - Recall:        0.3333
2025-11-13 18:18:43 - utils - INFO - Threshold:     0.7576
2025-11-13 18:18:44 - utils - INFO - Threshold analysis plot saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/isolation_forest_threshold_analysis_r1_r2_r3.1_v2.png
2025-11-13 18:18:44 - utils - INFO - 
================================================================================
2025-11-13 18:18:44 - utils - INFO - Diagnosing: Deep Clustering
2025-11-13 18:18:44 - utils - INFO - ================================================================================
2025-11-13 18:18:44 - utils - INFO - Loaded 4999 predictions for deep_clustering
2025-11-13 18:18:44 - utils - INFO - --- Optimal Threshold Found ---
2025-11-13 18:18:44 - utils - INFO - Best F1-Score: 0.0148
2025-11-13 18:18:44 - utils - INFO - Precision:     0.0075
2025-11-13 18:18:44 - utils - INFO - Recall:        0.6667
2025-11-13 18:18:44 - utils - INFO - Threshold:     0.6162
2025-11-13 18:18:44 - utils - INFO - Threshold analysis plot saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/deep_clustering_threshold_analysis_r1_r2_r3.1_v2.png
2025-11-13 18:18:44 - utils - INFO - 
================================================================================
2025-11-13 18:18:44 - utils - INFO - Diagnosing: Lstm Autoencoder
2025-11-13 18:18:44 - utils - INFO - ================================================================================
2025-11-13 18:18:44 - utils - INFO - Loaded 162520 predictions for lstm_autoencoder
2025-11-13 18:18:45 - utils - INFO - --- Optimal Threshold Found ---
2025-11-13 18:18:45 - utils - INFO - Best F1-Score: 0.0001
2025-11-13 18:18:45 - utils - INFO - Precision:     0.0001
2025-11-13 18:18:45 - utils - INFO - Recall:        1.0000
2025-11-13 18:18:45 - utils - INFO - Threshold:     0.1111
2025-11-13 18:18:46 - utils - INFO - Threshold analysis plot saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/lstm_autoencoder_threshold_analysis_r1_r2_r3.1_v2.png
2025-11-13 18:18:46 - utils - INFO - 
Optimal report saved to /Users/bipinrimal/Downloads/Thesis_work/results/optimal_evaluation_report_r1_r2_r3.1_v2.csv
2025-11-13 18:21:30 - utils - INFO - Utility functions loaded successfully
2025-11-13 18:21:30 - utils - INFO - 
================================================================================
                      COMPREHENSIVE MODEL EVALUATION (V2)                       
================================================================================

2025-11-13 18:21:30 - utils - INFO - Loading V2 results for all models...
2025-11-13 18:21:30 - utils - INFO - Loaded results for isolation_forest
2025-11-13 18:21:30 - utils - INFO - Loaded results for deep_clustering
2025-11-13 18:21:30 - utils - INFO - Loaded results for lstm_autoencoder
2025-11-13 18:21:30 - utils - INFO - Loaded results for 3 models
2025-11-13 18:21:30 - utils - INFO - Creating metrics comparison table...
2025-11-13 18:21:30 - utils - INFO - Metrics comparison table created
2025-11-13 18:21:30 - utils - INFO - Creating confusion matrix plots...
2025-11-13 18:21:30 - utils - INFO - Confusion matrices saved to /Users/bipinrimal/Downloads/Thesis_work/results/confusion_matrices/all_models_r1_r2_r3.1_v2.png
2025-11-13 18:21:30 - utils - INFO - Creating ROC curves...
2025-11-13 18:21:30 - utils - WARNING - Skipping ROC for isolation_forest: Non-binary or invalid label format (multiclass)
2025-11-13 18:21:30 - utils - WARNING - Skipping ROC for deep_clustering: Non-binary or invalid label format (multiclass)
2025-11-13 18:21:30 - utils - INFO - ROC curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/roc_curves/roc_comparison_r1_r2_r3.1_v2.png
2025-11-13 18:21:30 - utils - INFO - Creating Precision-Recall curves...
2025-11-13 18:21:30 - utils - WARNING - Skipping PR for isolation_forest: Non-binary labels.
2025-11-13 18:21:30 - utils - WARNING - Skipping PR for deep_clustering: Non-binary labels.
2025-11-13 18:21:30 - utils - INFO - Precision-Recall curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/precision_recall_comparison_r1_r2_r3.1_v2.png
2025-11-13 18:21:30 - utils - INFO - Generating evaluation report...
2025-11-13 18:21:30 - utils - INFO - Evaluation report saved to /Users/bipinrimal/Downloads/Thesis_work/results/evaluation_report_r1_r2_r3.1_v2.txt
2025-11-13 18:21:30 - utils - INFO - Comprehensive V2 evaluation completed successfully!
2025-11-13 18:21:33 - utils - INFO - Utility functions loaded successfully
2025-11-13 18:21:33 - utils - INFO - 
================================================================================
              MODEL DIAGNOSIS & THRESHOLD TUNING (V2: r1_r2_r3.1)               
================================================================================

2025-11-13 18:21:33 - utils - INFO - 
================================================================================
2025-11-13 18:21:33 - utils - INFO - Diagnosing: Isolation Forest
2025-11-13 18:21:33 - utils - INFO - ================================================================================
2025-11-13 18:21:33 - utils - INFO - Loaded 4999 predictions for isolation_forest
2025-11-13 18:21:33 - utils - INFO - --- Optimal Threshold Found ---
2025-11-13 18:21:33 - utils - INFO - Best F1-Score: 0.0476
2025-11-13 18:21:33 - utils - INFO - Precision:     0.0256
2025-11-13 18:21:33 - utils - INFO - Recall:        0.3333
2025-11-13 18:21:33 - utils - INFO - Threshold:     0.7576
2025-11-13 18:21:33 - utils - INFO - Threshold analysis plot saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/isolation_forest_threshold_analysis_r1_r2_r3.1_v2.png
2025-11-13 18:21:33 - utils - INFO - 
================================================================================
2025-11-13 18:21:33 - utils - INFO - Diagnosing: Deep Clustering
2025-11-13 18:21:33 - utils - INFO - ================================================================================
2025-11-13 18:21:33 - utils - INFO - Loaded 4999 predictions for deep_clustering
2025-11-13 18:21:33 - utils - INFO - --- Optimal Threshold Found ---
2025-11-13 18:21:33 - utils - INFO - Best F1-Score: 0.0148
2025-11-13 18:21:33 - utils - INFO - Precision:     0.0075
2025-11-13 18:21:33 - utils - INFO - Recall:        0.6667
2025-11-13 18:21:33 - utils - INFO - Threshold:     0.6162
2025-11-13 18:21:34 - utils - INFO - Threshold analysis plot saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/deep_clustering_threshold_analysis_r1_r2_r3.1_v2.png
2025-11-13 18:21:34 - utils - INFO - 
================================================================================
2025-11-13 18:21:34 - utils - INFO - Diagnosing: Lstm Autoencoder
2025-11-13 18:21:34 - utils - INFO - ================================================================================
2025-11-13 18:21:34 - utils - INFO - Loaded 162520 predictions for lstm_autoencoder
2025-11-13 18:21:34 - utils - INFO - --- Optimal Threshold Found ---
2025-11-13 18:21:34 - utils - INFO - Best F1-Score: 0.0001
2025-11-13 18:21:34 - utils - INFO - Precision:     0.0001
2025-11-13 18:21:34 - utils - INFO - Recall:        1.0000
2025-11-13 18:21:34 - utils - INFO - Threshold:     0.1111
2025-11-13 18:21:36 - utils - INFO - Threshold analysis plot saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/lstm_autoencoder_threshold_analysis_r1_r2_r3.1_v2.png
2025-11-13 18:21:36 - utils - INFO - 
Optimal report saved to /Users/bipinrimal/Downloads/Thesis_work/results/optimal_evaluation_report_r1_r2_r3.1_v2.csv
2025-11-13 18:41:37 - utils - INFO - Utility functions loaded successfully
2025-11-13 18:41:37 - utils - INFO - 
================================================================================
                         V2 THESIS VISUALIZATION SCRIPT                         
================================================================================

2025-11-13 18:41:37 - utils - INFO - Generating class imbalance plot from processed_unified_logs_r1_r2_r3.1_LABELED.csv...
2025-11-13 18:42:04 - utils - INFO - Class imbalance plot saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/class_imbalance_r1_r2_r3.1_v2.png
2025-11-13 18:42:04 - utils - INFO - Generating Sequential Aggregation Bias plot...
2025-11-13 18:42:04 - utils - INFO - Sequential bias plot saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/sequential_bias_r1_r2_r3.1_v2.png
2025-11-13 18:42:04 - utils - INFO - All supplementary visualizations created.
2025-11-16 08:13:27 - utils - INFO - Utility functions loaded successfully
2025-11-16 08:13:27 - utils - INFO - 
================================================================================
                          ENSEMBLE MODEL PIPELINE (V2)                          
================================================================================

2025-11-16 08:13:27 - utils - INFO - Loading V2 predictions from all models...
2025-11-16 08:13:27 - utils - INFO - Loaded 4999 IF preds, 4999 DC preds, 162520 LSTM preds
2025-11-16 08:13:27 - utils - INFO - Merging model predictions...
2025-11-16 08:13:27 - utils - INFO - Aggregating LSTM scores to user-level (this may take a moment)...
2025-11-16 08:13:27 - utils - INFO - Successfully merged scores for 4999 users.
2025-11-16 08:13:27 - utils - INFO - Calculating weighted ensemble score...
2025-11-16 08:13:27 - utils - INFO - Ensemble predictions saved to: ensemble_predictions_r1_r2_r3.1_v2.csv
2025-11-16 08:13:27 - utils - INFO - ================================================================================
2025-11-16 08:13:27 - utils - INFO - Ensemble V2 model complete!
2025-11-16 08:13:27 - utils - INFO - Next step: python diagnose_results_v2.py
2025-11-16 08:13:27 - utils - INFO - ================================================================================
2025-11-16 08:13:58 - utils - INFO - Utility functions loaded successfully
2025-11-16 08:13:58 - utils - INFO - 
================================================================================
              MODEL DIAGNOSIS & THRESHOLD TUNING (V2: r1_r2_r3.1)               
================================================================================

2025-11-16 08:13:58 - utils - INFO - 
================================================================================
2025-11-16 08:13:58 - utils - INFO - Diagnosing: Isolation Forest
2025-11-16 08:13:58 - utils - INFO - ================================================================================
2025-11-16 08:13:58 - utils - INFO - Loaded 4999 predictions for isolation_forest
2025-11-16 08:13:58 - utils - INFO - --- Optimal Threshold Found ---
2025-11-16 08:13:58 - utils - INFO - Best F1-Score: 0.0476
2025-11-16 08:13:58 - utils - INFO - Precision:     0.0256
2025-11-16 08:13:58 - utils - INFO - Recall:        0.3333
2025-11-16 08:13:58 - utils - INFO - Threshold:     0.7576
2025-11-16 08:13:59 - utils - INFO - Threshold analysis plot saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/isolation_forest_threshold_analysis_r1_r2_r3.1_v2.png
2025-11-16 08:13:59 - utils - INFO - 
================================================================================
2025-11-16 08:13:59 - utils - INFO - Diagnosing: Deep Clustering
2025-11-16 08:13:59 - utils - INFO - ================================================================================
2025-11-16 08:13:59 - utils - INFO - Loaded 4999 predictions for deep_clustering
2025-11-16 08:13:59 - utils - INFO - --- Optimal Threshold Found ---
2025-11-16 08:13:59 - utils - INFO - Best F1-Score: 0.0148
2025-11-16 08:13:59 - utils - INFO - Precision:     0.0075
2025-11-16 08:13:59 - utils - INFO - Recall:        0.6667
2025-11-16 08:13:59 - utils - INFO - Threshold:     0.6162
2025-11-16 08:13:59 - utils - INFO - Threshold analysis plot saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/deep_clustering_threshold_analysis_r1_r2_r3.1_v2.png
2025-11-16 08:13:59 - utils - INFO - 
================================================================================
2025-11-16 08:13:59 - utils - INFO - Diagnosing: Lstm Autoencoder
2025-11-16 08:13:59 - utils - INFO - ================================================================================
2025-11-16 08:13:59 - utils - INFO - Loaded 162520 predictions for lstm_autoencoder
2025-11-16 08:14:00 - utils - INFO - --- Optimal Threshold Found ---
2025-11-16 08:14:00 - utils - INFO - Best F1-Score: 0.0001
2025-11-16 08:14:00 - utils - INFO - Precision:     0.0001
2025-11-16 08:14:00 - utils - INFO - Recall:        1.0000
2025-11-16 08:14:00 - utils - INFO - Threshold:     0.1111
2025-11-16 08:14:01 - utils - INFO - Threshold analysis plot saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/lstm_autoencoder_threshold_analysis_r1_r2_r3.1_v2.png
2025-11-16 08:14:01 - utils - INFO - 
================================================================================
2025-11-16 08:14:01 - utils - INFO - Diagnosing: Ensemble
2025-11-16 08:14:01 - utils - INFO - ================================================================================
2025-11-16 08:14:01 - utils - INFO - Loaded 4999 predictions for ensemble
2025-11-16 08:14:01 - utils - INFO - --- Optimal Threshold Found ---
2025-11-16 08:14:01 - utils - INFO - Best F1-Score: 0.2222
2025-11-16 08:14:01 - utils - INFO - Precision:     0.1667
2025-11-16 08:14:01 - utils - INFO - Recall:        0.3333
2025-11-16 08:14:01 - utils - INFO - Threshold:     0.7423
2025-11-16 08:14:02 - utils - INFO - Threshold analysis plot saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/ensemble_threshold_analysis_r1_r2_r3.1_v2.png
2025-11-16 08:14:02 - utils - INFO - 
================================================================================
2025-11-16 08:14:02 - utils - INFO - OPTIMAL PERFORMANCE SUMMARY
2025-11-16 08:14:02 - utils - INFO - ================================================================================
2025-11-16 08:14:02 - utils - INFO - 
Optimal report saved to /Users/bipinrimal/Downloads/Thesis_work/results/optimal_evaluation_report_v2.csv
2025-11-19 10:24:56 - utils - INFO - Utility functions loaded successfully
2025-11-19 10:24:56 - utils - INFO - 
================================================================================
                       FEATURE IMPORTANCE ANALYSIS (SHAP)                       
================================================================================

2025-11-19 10:24:56 - utils - INFO - Loading Isolation Forest model from isolation_forest_v2.pkl...
2025-11-19 10:24:56 - utils - INFO - Loading feature data from engineered_static_features_r1_r2_r3.1_v2.csv...
2025-11-19 10:24:56 - utils - INFO - Analyzing 4999 users with 55 features.
2025-11-19 10:24:56 - utils - INFO - Found 0 insider(s) for detailed diagnosis.
2025-11-19 10:24:56 - utils - INFO - Initializing SHAP TreeExplainer (this may take a moment)...
2025-11-19 10:24:56 - utils - INFO - Calculating SHAP values...
2025-11-19 10:24:57 - utils - INFO - Generating Summary Plot (Global Feature Importance)...
2025-11-19 10:24:57 - utils - INFO - Saved summary plot to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/shap_summary_bar.png
2025-11-19 10:24:57 - utils - INFO - Generating Beeswarm Plot...
2025-11-19 10:24:57 - utils - INFO - Saved beeswarm plot to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/shap_summary_beeswarm.png
2025-11-19 10:24:57 - utils - INFO - ================================================================================
2025-11-19 10:24:57 - utils - INFO - SHAP Analysis Complete.
2025-11-19 10:24:57 - utils - INFO - The visualizations in 'results/visualizations' explain the theory behind your model.
2025-11-19 10:24:57 - utils - INFO - ================================================================================
2025-11-19 11:25:25 - utils - INFO - Utility functions loaded successfully
2025-11-19 11:25:25 - utils - INFO - Feature Engineer V2 initialized. Reading from: processed_unified_logs_r1_r2_r3.1_LABELED.csv
2025-11-19 11:25:25 - utils - INFO - 
================================================================================
                  FEATURE ENGINEERING PIPELINE V2 (MULTI-PASS)                  
================================================================================

2025-11-19 11:25:25 - utils - INFO - Found /Users/bipinrimal/Downloads/Thesis_work/data/processed/daily_features_unscaled_r1_r2_r3.1_v2.csv, skipping Pass 1.
2025-11-19 11:25:25 - utils - INFO - 
================================================================================
                     PASS 2: FEATURE ENRICHMENT (Z-SCORES)                      
================================================================================

2025-11-19 11:25:25 - utils - INFO - Verified 'role' column for Pass 2.
2025-11-19 11:25:25 - utils - INFO - Calculating self-relative Z-Scores (rolling 30-day)...
2025-11-19 11:25:29 - utils - INFO - Calculating peer-relative Z-Scores (by role)...
2025-11-19 11:25:30 - utils - INFO - PASS 2 complete. Enriched features created.
2025-11-19 11:25:30 - utils - INFO - Scaling and saving final daily features (for LSTM)...
2025-11-19 11:25:30 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/daily_feature_scaler_v2.pkl
2025-11-19 11:25:52 - utils - INFO - Saved /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_daily_features_r1_r2_r3.1_v2.csv
2025-11-19 11:25:52 - utils - INFO - 
================================================================================
                        PASS 3: STATIC FEATURE CREATION                         
================================================================================

2025-11-19 11:25:53 - utils - INFO - Created static features for 4999 users
2025-11-19 11:25:53 - utils - INFO - Scaling and saving static features...
2025-11-19 11:25:53 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/static_feature_scaler_v2.pkl
2025-11-19 11:25:53 - utils - INFO - PASS 3 complete. Saved /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_static_features_r1_r2_r3.1_v2.csv
2025-11-19 11:25:53 - utils - INFO - 
================================================================================
                           PASS 4: SEQUENCE CREATION                            
================================================================================

2025-11-19 11:25:53 - utils - INFO - Creating sequences (length=15, stride=10)...
2025-11-19 11:28:15 - utils - INFO - Created 162520 sequences from 4999 users
2025-11-19 11:28:16 - utils - INFO - PASS 4 complete. Saved sequence files to /Users/bipinrimal/Downloads/Thesis_work/data/processed
2025-11-19 11:28:16 - utils - INFO - ================================================================================
2025-11-19 11:28:16 - utils - INFO - V2 Feature Engineering Complete!
2025-11-19 11:28:16 - utils - INFO -   Static features created: /Users/bipinrimal/Downloads/Thesis_work/data/processed/engineered_static_features_r1_r2_r3.1_v2.csv
2025-11-19 11:28:16 - utils - INFO -   Sequence files created: /Users/bipinrimal/Downloads/Thesis_work/data/processed
2025-11-19 11:28:16 - utils - INFO - Next step: Train V2 models.
2025-11-19 11:28:16 - utils - INFO - ================================================================================
2025-11-19 11:31:09 - utils - INFO - Utility functions loaded successfully
2025-11-19 11:31:09 - utils - INFO - 
================================================================================
                       FEATURE IMPORTANCE ANALYSIS (SHAP)                       
================================================================================

2025-11-19 11:31:09 - utils - INFO - Loading Isolation Forest model from isolation_forest_v2.pkl...
2025-11-19 11:31:09 - utils - INFO - Loading feature data from engineered_static_features_r1_r2_r3.1_v2.csv...
2025-11-19 11:31:09 - utils - INFO - Analyzing 4999 users with 55 features.
2025-11-19 11:31:09 - utils - INFO - Found 0 insider(s) for detailed diagnosis.
2025-11-19 11:31:09 - utils - INFO - Initializing SHAP TreeExplainer (this may take a moment)...
2025-11-19 11:31:09 - utils - INFO - Calculating SHAP values...
2025-11-19 11:31:09 - utils - INFO - Generating Summary Plot (Global Feature Importance)...
2025-11-19 11:31:09 - utils - INFO - Saved summary plot to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/shap_summary_bar.png
2025-11-19 11:31:09 - utils - INFO - Generating Beeswarm Plot...
2025-11-19 11:31:10 - utils - INFO - Saved beeswarm plot to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/shap_summary_beeswarm.png
2025-11-19 11:31:10 - utils - INFO - ================================================================================
2025-11-19 11:31:10 - utils - INFO - SHAP Analysis Complete.
2025-11-19 11:31:10 - utils - INFO - The visualizations in 'results/visualizations' explain the theory behind your model.
2025-11-19 11:31:10 - utils - INFO - ================================================================================
2025-11-19 11:37:58 - utils - INFO - Utility functions loaded successfully
2025-11-19 11:37:58 - utils - INFO - Generating Figure 8 (Weird-but-Normal 3D Plot)...
2025-11-19 11:37:58 - utils - INFO - Running t-SNE on 2000 points...
2025-11-19 11:38:02 - utils - INFO - Saved Figure 8 to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/weird_but_normal_3d_plot.png
2025-11-19 11:52:56 - utils - INFO - Utility functions loaded successfully
2025-11-19 11:52:56 - utils - INFO - Generating Figure 8 (Weird-but-Normal 3D Plot)...
2025-11-19 11:52:56 - utils - INFO - Running t-SNE on 2000 points...
2025-11-19 11:52:59 - utils - INFO - Saved Figure 8 to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/weird_but_normal_3d_plot.png
2025-11-19 11:55:10 - utils - INFO - Utility functions loaded successfully
2025-11-19 11:55:10 - utils - INFO - 
================================================================================
                         COMPREHENSIVE MODEL EVALUATION                         
================================================================================

2025-11-19 11:55:10 - utils - INFO - Loading results for all models...
2025-11-19 11:55:10 - utils - INFO - Loaded results for isolation_forest
2025-11-19 11:55:10 - utils - INFO - Loaded results for lstm_autoencoder
2025-11-19 11:55:10 - utils - INFO - Loaded results for deep_clustering
2025-11-19 11:55:10 - utils - INFO - Loaded results for 3 models
2025-11-19 11:55:10 - utils - INFO - Creating metrics comparison table...
2025-11-19 11:55:10 - utils - INFO - Metrics comparison table created
2025-11-19 11:55:10 - utils - INFO - Creating confusion matrix plots...
2025-11-19 11:55:10 - utils - INFO - Confusion matrices saved to /Users/bipinrimal/Downloads/Thesis_work/results/confusion_matrices/all_models.png
2025-11-19 11:55:10 - utils - INFO - Creating ROC curves...
2025-11-19 11:55:10 - utils - INFO - ROC curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/roc_curves/roc_comparison.png
2025-11-19 11:55:10 - utils - INFO - Creating Precision-Recall curves...
2025-11-19 11:55:10 - utils - INFO - Precision-Recall curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/precision_recall_comparison.png
2025-11-19 11:55:10 - utils - INFO - Creating metrics comparison bar chart...
2025-11-19 11:55:10 - utils - INFO - Metrics comparison bar chart saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/metrics_comparison_bar.png
2025-11-19 11:55:10 - utils - INFO - Creating anomaly score distribution plots...
2025-11-19 11:55:11 - utils - INFO - Score distributions saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/score_distributions.png
2025-11-19 11:55:11 - utils - INFO - Generating evaluation report...
2025-11-19 11:55:11 - utils - INFO - Evaluation report saved to /Users/bipinrimal/Downloads/Thesis_work/results/evaluation_report.txt
2025-11-19 11:55:11 - utils - INFO - Comprehensive evaluation completed!
2025-11-19 11:55:22 - utils - INFO - Utility functions loaded successfully
2025-11-19 11:55:22 - utils - INFO - 
================================================================================
                      COMPREHENSIVE MODEL EVALUATION (V2)                       
================================================================================

2025-11-19 11:55:22 - utils - INFO - Loading V2 results for all models...
2025-11-19 11:55:22 - utils - INFO - Loaded results for isolation_forest
2025-11-19 11:55:22 - utils - INFO - Loaded results for deep_clustering
2025-11-19 11:55:22 - utils - INFO - Loaded results for lstm_autoencoder
2025-11-19 11:55:22 - utils - INFO - Loaded results for 3 models
2025-11-19 11:55:22 - utils - INFO - Creating metrics comparison table...
2025-11-19 11:55:22 - utils - INFO - Metrics comparison table created
2025-11-19 11:55:22 - utils - INFO - Creating confusion matrix plots...
2025-11-19 11:55:22 - utils - INFO - Confusion matrices saved to /Users/bipinrimal/Downloads/Thesis_work/results/confusion_matrices/all_models_r1_r2_r3.1_v2.png
2025-11-19 11:55:22 - utils - INFO - Creating ROC curves...
2025-11-19 11:55:22 - utils - WARNING - Skipping ROC for isolation_forest: Non-binary or invalid label format (multiclass)
2025-11-19 11:55:22 - utils - WARNING - Skipping ROC for deep_clustering: Non-binary or invalid label format (multiclass)
2025-11-19 11:55:22 - utils - INFO - ROC curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/roc_curves/roc_comparison_r1_r2_r3.1_v2.png
2025-11-19 11:55:22 - utils - INFO - Creating Precision-Recall curves...
2025-11-19 11:55:22 - utils - WARNING - Skipping PR for isolation_forest: Non-binary labels.
2025-11-19 11:55:22 - utils - WARNING - Skipping PR for deep_clustering: Non-binary labels.
2025-11-19 11:55:22 - utils - INFO - Precision-Recall curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/precision_recall_comparison_r1_r2_r3.1_v2.png
2025-11-19 11:55:22 - utils - INFO - Generating evaluation report...
2025-11-19 11:55:22 - utils - INFO - Evaluation report saved to /Users/bipinrimal/Downloads/Thesis_work/results/evaluation_report_r1_r2_r3.1_v2.txt
2025-11-19 11:55:22 - utils - INFO - Comprehensive V2 evaluation completed successfully!
2025-11-19 12:02:24 - utils - INFO - Utility functions loaded successfully
2025-11-19 12:02:24 - utils - INFO - 
================================================================================
              MODEL DIAGNOSIS & THRESHOLD TUNING (V2: r1_r2_r3.1)               
================================================================================

2025-11-19 12:02:24 - utils - INFO - 
================================================================================
2025-11-19 12:02:24 - utils - INFO - Diagnosing: Isolation Forest
2025-11-19 12:02:24 - utils - INFO - ================================================================================
2025-11-19 12:02:24 - utils - INFO - Loaded 4999 predictions for isolation_forest
2025-11-19 12:02:24 - utils - INFO - --- Optimal Threshold Found ---
2025-11-19 12:02:24 - utils - INFO - Best F1-Score: 0.0476
2025-11-19 12:02:24 - utils - INFO - Precision:     0.0256
2025-11-19 12:02:24 - utils - INFO - Recall:        0.3333
2025-11-19 12:02:24 - utils - INFO - Threshold:     0.7576
2025-11-19 12:02:24 - utils - INFO - Threshold analysis plot saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/isolation_forest_threshold_analysis_r1_r2_r3.1_v2.png
2025-11-19 12:02:24 - utils - INFO - 
================================================================================
2025-11-19 12:02:24 - utils - INFO - Diagnosing: Deep Clustering
2025-11-19 12:02:24 - utils - INFO - ================================================================================
2025-11-19 12:02:24 - utils - INFO - Loaded 4999 predictions for deep_clustering
2025-11-19 12:02:24 - utils - INFO - --- Optimal Threshold Found ---
2025-11-19 12:02:24 - utils - INFO - Best F1-Score: 0.0148
2025-11-19 12:02:24 - utils - INFO - Precision:     0.0075
2025-11-19 12:02:24 - utils - INFO - Recall:        0.6667
2025-11-19 12:02:24 - utils - INFO - Threshold:     0.6162
2025-11-19 12:02:25 - utils - INFO - Threshold analysis plot saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/deep_clustering_threshold_analysis_r1_r2_r3.1_v2.png
2025-11-19 12:02:25 - utils - INFO - 
================================================================================
2025-11-19 12:02:25 - utils - INFO - Diagnosing: Lstm Autoencoder
2025-11-19 12:02:25 - utils - INFO - ================================================================================
2025-11-19 12:02:25 - utils - INFO - Loaded 162520 predictions for lstm_autoencoder
2025-11-19 12:02:25 - utils - INFO - --- Optimal Threshold Found ---
2025-11-19 12:02:25 - utils - INFO - Best F1-Score: 0.0001
2025-11-19 12:02:25 - utils - INFO - Precision:     0.0001
2025-11-19 12:02:25 - utils - INFO - Recall:        1.0000
2025-11-19 12:02:25 - utils - INFO - Threshold:     0.1111
2025-11-19 12:02:27 - utils - INFO - Threshold analysis plot saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/lstm_autoencoder_threshold_analysis_r1_r2_r3.1_v2.png
2025-11-19 12:02:27 - utils - INFO - 
Optimal report saved to /Users/bipinrimal/Downloads/Thesis_work/results/optimal_evaluation_report_r1_r2_r3.1_v2.csv
2025-11-19 12:02:57 - utils - INFO - Utility functions loaded successfully
2025-11-19 12:02:57 - utils - INFO - 
================================================================================
                          ENSEMBLE MODEL PIPELINE (V2)                          
================================================================================

2025-11-19 12:02:57 - utils - INFO - Loading V2 predictions from all models...
2025-11-19 12:02:57 - utils - INFO - Loaded 4999 IF preds, 4999 DC preds, 162520 LSTM preds
2025-11-19 12:02:57 - utils - INFO - Merging model predictions...
2025-11-19 12:02:57 - utils - INFO - Aggregating LSTM scores to user-level (this may take a moment)...
2025-11-19 12:02:57 - utils - INFO - Successfully merged scores for 4999 users.
2025-11-19 12:02:57 - utils - INFO - Calculating weighted ensemble score...
2025-11-19 12:02:57 - utils - INFO - Ensemble predictions saved to: ensemble_predictions_r1_r2_r3.1_v2.csv
2025-11-19 12:02:57 - utils - INFO - ================================================================================
2025-11-19 12:02:57 - utils - INFO - Ensemble V2 model complete!
2025-11-19 12:02:57 - utils - INFO - Next step: python diagnose_results_v2.py
2025-11-19 12:02:57 - utils - INFO - ================================================================================
2025-11-19 12:03:02 - utils - INFO - Utility functions loaded successfully
2025-11-19 12:03:02 - utils - INFO - 
================================================================================
              MODEL DIAGNOSIS & THRESHOLD TUNING (V2: r1_r2_r3.1)               
================================================================================

2025-11-19 12:03:02 - utils - INFO - 
================================================================================
2025-11-19 12:03:02 - utils - INFO - Diagnosing: Isolation Forest
2025-11-19 12:03:02 - utils - INFO - ================================================================================
2025-11-19 12:03:02 - utils - INFO - Loaded 4999 predictions for isolation_forest
2025-11-19 12:03:02 - utils - INFO - --- Optimal Threshold Found ---
2025-11-19 12:03:02 - utils - INFO - Best F1-Score: 0.0476
2025-11-19 12:03:02 - utils - INFO - Precision:     0.0256
2025-11-19 12:03:02 - utils - INFO - Recall:        0.3333
2025-11-19 12:03:02 - utils - INFO - Threshold:     0.7576
2025-11-19 12:03:02 - utils - INFO - Threshold analysis plot saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/isolation_forest_threshold_analysis_r1_r2_r3.1_v2.png
2025-11-19 12:03:02 - utils - INFO - 
================================================================================
2025-11-19 12:03:02 - utils - INFO - Diagnosing: Deep Clustering
2025-11-19 12:03:02 - utils - INFO - ================================================================================
2025-11-19 12:03:02 - utils - INFO - Loaded 4999 predictions for deep_clustering
2025-11-19 12:03:03 - utils - INFO - --- Optimal Threshold Found ---
2025-11-19 12:03:03 - utils - INFO - Best F1-Score: 0.0148
2025-11-19 12:03:03 - utils - INFO - Precision:     0.0075
2025-11-19 12:03:03 - utils - INFO - Recall:        0.6667
2025-11-19 12:03:03 - utils - INFO - Threshold:     0.6162
2025-11-19 12:03:03 - utils - INFO - Threshold analysis plot saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/deep_clustering_threshold_analysis_r1_r2_r3.1_v2.png
2025-11-19 12:03:03 - utils - INFO - 
================================================================================
2025-11-19 12:03:03 - utils - INFO - Diagnosing: Lstm Autoencoder
2025-11-19 12:03:03 - utils - INFO - ================================================================================
2025-11-19 12:03:03 - utils - INFO - Loaded 162520 predictions for lstm_autoencoder
2025-11-19 12:03:03 - utils - INFO - --- Optimal Threshold Found ---
2025-11-19 12:03:03 - utils - INFO - Best F1-Score: 0.0001
2025-11-19 12:03:03 - utils - INFO - Precision:     0.0001
2025-11-19 12:03:03 - utils - INFO - Recall:        1.0000
2025-11-19 12:03:03 - utils - INFO - Threshold:     0.1111
2025-11-19 12:03:05 - utils - INFO - Threshold analysis plot saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/lstm_autoencoder_threshold_analysis_r1_r2_r3.1_v2.png
2025-11-19 12:03:05 - utils - INFO - 
Optimal report saved to /Users/bipinrimal/Downloads/Thesis_work/results/optimal_evaluation_report_r1_r2_r3.1_v2.csv
2025-11-19 12:03:21 - utils - INFO - Utility functions loaded successfully
2025-11-19 12:03:21 - utils - INFO - 
================================================================================
                          ENSEMBLE MODEL PIPELINE (V2)                          
================================================================================

2025-11-19 12:03:21 - utils - INFO - Loading V2 predictions from all models...
2025-11-19 12:03:21 - utils - INFO - Loaded 4999 IF preds, 4999 DC preds, 162520 LSTM preds
2025-11-19 12:03:21 - utils - INFO - Merging model predictions...
2025-11-19 12:03:21 - utils - INFO - Aggregating LSTM scores to user-level (this may take a moment)...
2025-11-19 12:03:21 - utils - INFO - Successfully merged scores for 4999 users.
2025-11-19 12:03:21 - utils - INFO - Calculating weighted ensemble score...
2025-11-19 12:03:21 - utils - INFO - Ensemble predictions saved to: ensemble_predictions_r1_r2_r3.1_v2.csv
2025-11-19 12:03:21 - utils - INFO - ================================================================================
2025-11-19 12:03:21 - utils - INFO - Ensemble V2 model complete!
2025-11-19 12:03:21 - utils - INFO - Next step: python diagnose_results_v2.py
2025-11-19 12:03:21 - utils - INFO - ================================================================================
2025-11-19 12:03:24 - utils - INFO - Utility functions loaded successfully
2025-11-19 12:03:24 - utils - INFO - 
================================================================================
              MODEL DIAGNOSIS & THRESHOLD TUNING (V2: r1_r2_r3.1)               
================================================================================

2025-11-19 12:03:24 - utils - INFO - 
================================================================================
2025-11-19 12:03:24 - utils - INFO - Diagnosing: Isolation Forest
2025-11-19 12:03:24 - utils - INFO - ================================================================================
2025-11-19 12:03:24 - utils - INFO - Loaded 4999 predictions for isolation_forest
2025-11-19 12:03:25 - utils - INFO - --- Optimal Threshold Found ---
2025-11-19 12:03:25 - utils - INFO - Best F1-Score: 0.0476
2025-11-19 12:03:25 - utils - INFO - Precision:     0.0256
2025-11-19 12:03:25 - utils - INFO - Recall:        0.3333
2025-11-19 12:03:25 - utils - INFO - Threshold:     0.7576
2025-11-19 12:03:25 - utils - INFO - Threshold analysis plot saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/isolation_forest_threshold_analysis_r1_r2_r3.1_v2.png
2025-11-19 12:03:25 - utils - INFO - 
================================================================================
2025-11-19 12:03:25 - utils - INFO - Diagnosing: Deep Clustering
2025-11-19 12:03:25 - utils - INFO - ================================================================================
2025-11-19 12:03:25 - utils - INFO - Loaded 4999 predictions for deep_clustering
2025-11-19 12:03:25 - utils - INFO - --- Optimal Threshold Found ---
2025-11-19 12:03:25 - utils - INFO - Best F1-Score: 0.0148
2025-11-19 12:03:25 - utils - INFO - Precision:     0.0075
2025-11-19 12:03:25 - utils - INFO - Recall:        0.6667
2025-11-19 12:03:25 - utils - INFO - Threshold:     0.6162
2025-11-19 12:03:25 - utils - INFO - Threshold analysis plot saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/deep_clustering_threshold_analysis_r1_r2_r3.1_v2.png
2025-11-19 12:03:25 - utils - INFO - 
================================================================================
2025-11-19 12:03:25 - utils - INFO - Diagnosing: Lstm Autoencoder
2025-11-19 12:03:25 - utils - INFO - ================================================================================
2025-11-19 12:03:25 - utils - INFO - Loaded 162520 predictions for lstm_autoencoder
2025-11-19 12:03:26 - utils - INFO - --- Optimal Threshold Found ---
2025-11-19 12:03:26 - utils - INFO - Best F1-Score: 0.0001
2025-11-19 12:03:26 - utils - INFO - Precision:     0.0001
2025-11-19 12:03:26 - utils - INFO - Recall:        1.0000
2025-11-19 12:03:26 - utils - INFO - Threshold:     0.1111
2025-11-19 12:03:27 - utils - INFO - Threshold analysis plot saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/lstm_autoencoder_threshold_analysis_r1_r2_r3.1_v2.png
2025-11-19 12:03:27 - utils - INFO - 
Optimal report saved to /Users/bipinrimal/Downloads/Thesis_work/results/optimal_evaluation_report_r1_r2_r3.1_v2.csv
2025-11-19 12:07:35 - utils - INFO - Utility functions loaded successfully
2025-11-19 12:07:35 - utils - INFO - 
================================================================================
              MODEL DIAGNOSIS & THRESHOLD TUNING (V2: r1_r2_r3.1)               
================================================================================

2025-11-19 12:07:35 - utils - INFO - 
================================================================================
2025-11-19 12:07:35 - utils - INFO - Diagnosing: Isolation Forest
2025-11-19 12:07:35 - utils - INFO - ================================================================================
2025-11-19 12:07:35 - utils - INFO - Loaded 4999 predictions for isolation_forest
2025-11-19 12:07:35 - utils - INFO - --- Optimal Threshold Found ---
2025-11-19 12:07:35 - utils - INFO - Best F1-Score: 0.0455
2025-11-19 12:07:35 - utils - INFO - Precision:     0.0244
2025-11-19 12:07:35 - utils - INFO - Recall:        0.3333
2025-11-19 12:07:35 - utils - INFO - Threshold:     0.7556
2025-11-19 12:07:35 - utils - INFO - Threshold analysis plot saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/isolation_forest_threshold_analysis_r1_r2_r3.1_v2.png
2025-11-19 12:07:35 - utils - INFO - 
================================================================================
2025-11-19 12:07:35 - utils - INFO - Diagnosing: Deep Clustering
2025-11-19 12:07:35 - utils - INFO - ================================================================================
2025-11-19 12:07:35 - utils - INFO - Loaded 4999 predictions for deep_clustering
2025-11-19 12:07:35 - utils - INFO - --- Optimal Threshold Found ---
2025-11-19 12:07:35 - utils - INFO - Best F1-Score: 0.0146
2025-11-19 12:07:35 - utils - INFO - Precision:     0.0074
2025-11-19 12:07:35 - utils - INFO - Recall:        0.6667
2025-11-19 12:07:35 - utils - INFO - Threshold:     0.6088
2025-11-19 12:07:35 - utils - INFO - Threshold analysis plot saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/deep_clustering_threshold_analysis_r1_r2_r3.1_v2.png
2025-11-19 12:07:35 - utils - INFO - 
================================================================================
2025-11-19 12:07:35 - utils - INFO - Diagnosing: Lstm Autoencoder
2025-11-19 12:07:35 - utils - INFO - ================================================================================
2025-11-19 12:07:35 - utils - INFO - Loaded 162520 predictions for lstm_autoencoder
2025-11-19 12:07:35 - utils - INFO - --- Optimal Threshold Found ---
2025-11-19 12:07:35 - utils - INFO - Best F1-Score: 0.0001
2025-11-19 12:07:35 - utils - INFO - Precision:     0.0001
2025-11-19 12:07:35 - utils - INFO - Recall:        1.0000
2025-11-19 12:07:35 - utils - INFO - Threshold:     0.1138
2025-11-19 12:07:35 - utils - INFO - Threshold analysis plot saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/lstm_autoencoder_threshold_analysis_r1_r2_r3.1_v2.png
2025-11-19 12:07:35 - utils - INFO - 
================================================================================
2025-11-19 12:07:35 - utils - INFO - Diagnosing: Ensemble
2025-11-19 12:07:35 - utils - INFO - ================================================================================
2025-11-19 12:07:35 - utils - INFO - Loaded 4999 predictions for ensemble
2025-11-19 12:07:35 - utils - INFO - --- Optimal Threshold Found ---
2025-11-19 12:07:35 - utils - INFO - Best F1-Score: 0.2222
2025-11-19 12:07:35 - utils - INFO - Precision:     0.1667
2025-11-19 12:07:35 - utils - INFO - Recall:        0.3333
2025-11-19 12:07:35 - utils - INFO - Threshold:     0.7725
2025-11-19 12:07:35 - utils - INFO - Threshold analysis plot saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/ensemble_threshold_analysis_r1_r2_r3.1_v2.png
2025-11-19 12:07:35 - utils - INFO - 
Optimal report saved to /Users/bipinrimal/Downloads/Thesis_work/results/optimal_evaluation_report_r1_r2_r3.1_v2.csv
2025-11-23 23:54:11 - utils - INFO - Utility functions loaded successfully
2025-11-23 23:54:11 - utils - INFO - 
================================================================================
                         V2 THESIS VISUALIZATION SCRIPT                         
================================================================================

2025-11-23 23:54:11 - utils - INFO - Generating class imbalance plot from processed_unified_logs_r1_r2_r3.1_LABELED.csv...
2025-11-23 23:54:39 - utils - INFO - Class imbalance plot saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/class_imbalance_r1_r2_r3.1_v2.png
2025-11-23 23:54:39 - utils - INFO - Generating Sequential Aggregation Bias plot...
2025-11-23 23:54:39 - utils - INFO - Sequential bias plot saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/sequential_bias_r1_r2_r3.1_v2.png
2025-11-23 23:54:39 - utils - INFO - All supplementary visualizations created.
2025-11-23 23:57:14 - utils - INFO - Utility functions loaded successfully
2025-11-23 23:57:14 - utils - INFO - Generating V1 vs V2 Comparison Bar Chart...
2025-11-23 23:57:14 - utils - INFO - Generating Comparative ROC Curves...
2025-11-23 23:57:14 - utils - INFO - Generating SHAP Beeswarm Plot...
2025-11-23 23:57:16 - utils - INFO - Generating 3D t-SNE Projection...
2025-11-23 23:57:16 - utils - ERROR - Failed to generate t-SNE plot: TSNE.__init__() got an unexpected keyword argument 'n_iter'
2025-11-23 23:57:16 - utils - INFO - Generating Forensic Timeline for ONS0995...
2025-11-24 00:08:04 - utils - WARNING - Could not generate forensic timeline (User ID mapping issue): positional indexers are out-of-bounds
2025-11-24 00:09:32 - utils - INFO - Utility functions loaded successfully
2025-11-24 00:09:32 - utils - INFO - Generating V1 vs V2 Comparison Bar Chart...
2025-11-24 00:09:32 - utils - INFO - Generating Comparative ROC Curves...
2025-11-24 00:09:32 - utils - INFO - Generating SHAP Beeswarm Plot...
2025-11-24 00:09:34 - utils - INFO - Generating 3D t-SNE Projection...
2025-11-24 00:09:36 - utils - INFO - 3D t-SNE plot generated successfully.
2025-11-24 00:09:36 - utils - INFO - Generating Forensic Timeline for ONS0995...
2025-11-24 00:20:13 - utils - WARNING - Could not generate forensic timeline (User ID mapping issue): positional indexers are out-of-bounds
2025-12-09 13:38:02 - utils - INFO - Utility functions loaded successfully
2025-12-09 13:38:03 - Verification - INFO - Starting Migration Verification...
2025-12-09 13:38:03 - Verification - INFO - Testing Data Preprocessing (Polars)...
2025-12-09 13:38:03 - utils - INFO - Processing SUBSET defined in config: ['r1', 'r2', 'r3.1', 'r3.2']
2025-12-09 13:38:03 - utils - INFO - 
================================================================================
                          DATA PREPROCESSING (POLARS)                           
================================================================================

2025-12-09 13:38:03 - utils - INFO - Scanning dataset: r1
2025-12-09 13:38:03 - utils - INFO - Scanning dataset: r2
2025-12-09 13:38:03 - utils - INFO - Scanning dataset: r3.1
2025-12-09 13:38:03 - utils - INFO - Scanning dataset: r3.2
2025-12-09 13:38:03 - utils - INFO - Constructing execution graph (Diagonal Concat)...
2025-12-09 13:38:03 - utils - INFO - Loaded Psychometric data: 2999 users
2025-12-09 13:38:03 - Verification - ERROR - FAIL: Preprocessing failed: unable to find column "date"; valid columns: ["{M8H9-W9NL75TH-1322KOLO}", "01/04/2010 07:08:47", "DTAA/AMA0606", "PC-1514", "http://cnet.com", "user_id", "pc_id", "activity_type", "dataset"]

Resolved plan until failure:

	---> FAILED HERE RESOLVING 'join' <---
 WITH_COLUMNS:
 ["http".alias("activity_type"), "r1".alias("dataset")] 
   WITH_COLUMNS:
   [null.cast(String).alias("pc_id")] 
     WITH_COLUMNS:
     ["UNKNOWN".alias("user_id")] 
      Csv SCAN [/Users/bipinrimal/Downloads/Thesis_work/data/all_data/r1/http.csv]
      PROJECT */5 COLUMNS
      ESTIMATED ROWS: 3456529
2025-12-09 13:40:02 - utils - INFO - Utility functions loaded successfully
2025-12-09 13:40:03 - Verification - INFO - Starting Migration Verification...
2025-12-09 13:40:03 - Verification - INFO - Testing Data Preprocessing (Polars)...
2025-12-09 13:40:03 - utils - INFO - Processing SUBSET defined in config: ['r1', 'r2', 'r3.1', 'r3.2']
2025-12-09 13:40:03 - utils - INFO - 
================================================================================
                          DATA PREPROCESSING (POLARS)                           
================================================================================

2025-12-09 13:40:03 - utils - INFO - Scanning dataset: r1
2025-12-09 13:40:03 - utils - INFO - Scanning dataset: r2
2025-12-09 13:40:03 - utils - INFO - Scanning dataset: r3.1
2025-12-09 13:40:03 - utils - INFO - Scanning dataset: r3.2
2025-12-09 13:40:03 - utils - INFO - Constructing execution graph (Diagonal Concat)...
2025-12-09 13:40:03 - utils - INFO - Loaded Psychometric data: 2999 users
2025-12-09 13:40:03 - Verification - ERROR - FAIL: Preprocessing failed: 'union'/'concat' inputs should all have the same schema,got
Schema:
name: id, field: String
name: date, field: Datetime('μs')
name: user_id, field: String
name: pc_id, field: String
name: activity, field: String
name: activity_type, field: String
name: dataset, field: String
name: is_logon, field: Int8
name: is_logoff, field: Int8
name: is_connect, field: Int8
name: is_disconnect, field: Int8
name: url, field: String
name: domain, field: String
name: is_suspicious_domain, field: Int8
name: to, field: String
name: email_size_kb, field: Float64
name: is_large_email, field: Int32
name: has_attachment, field: Int32
name: filename, field: String
name: content, field: String
name: file_extension, field: String
name: is_sensitive_file, field: Int8
name: size, field: Int64
name: attachments, field: Int64
 and 
Schema:
name: id, field: String
name: date, field: Datetime('μs')
name: user_id, field: String
name: pc_id, field: String
name: activity, field: String
name: activity_type, field: String
name: dataset, field: String
name: is_logon, field: Int8
name: is_logoff, field: Int8
name: is_connect, field: Int8
name: is_disconnect, field: Int8
name: url, field: String
name: domain, field: String
name: is_suspicious_domain, field: Int8
name: to, field: String
name: email_size_kb, field: Float64
name: is_large_email, field: Int8
name: has_attachment, field: Int8
name: filename, field: String
name: content, field: String
name: file_extension, field: String
name: is_sensitive_file, field: Int8
name: size, field: Int64
name: attachments, field: Int64


Resolved plan until failure:

	---> FAILED HERE RESOLVING 'join' <---
simple π 24/24 ["id", "date", "user_id", ... 21 other columns]
   WITH_COLUMNS:
   [null.alias("activity"), null.alias("is_logon"), null.alias("is_logoff"), null.alias("is_connect"), null.alias("is_disconnect"), null.alias("to"), null.alias("email_size_kb"), null.alias("is_large_email"), null.alias("has_attachment"), null.alias("filename"), null.alias("file_extension"), null.alias("is_sensitive_file"), null.alias("size"), null.alias("attachments")] 
     WITH_COLUMNS:
     [col("domain").str.to_lowercase().str.contains(["temp|anonymous|proxy|vpn|leak|hack"]).strict_cast(Int8).alias("is_suspicious_domain")] 
       WITH_COLUMNS:
       [col("url").str.extract(["https?://([^/]+)"]).alias("domain")] 
         WITH_COLUMNS:
         [col("date").str.strptime(["raise"])] 
           WITH_COLUMNS:
           ["http".alias("activity_type"), "r3.2".alias("dataset")] 
            SELECT [col("id"), col("date"), col("user_id"), col("pc").alias("pc_id"), col("url"), col("content")]
              SELECT [col("id"), col("date"), col("user").alias("user_id"), col("pc"), col("url"), col("content")]
                Csv SCAN [/Users/bipinrimal/Downloads/Thesis_work/data/all_data/r3.2/http.csv]
                PROJECT */6 COLUMNS
                ESTIMATED ROWS: 23837666
2025-12-09 13:40:25 - utils - INFO - Utility functions loaded successfully
2025-12-09 13:40:26 - Verification - INFO - Starting Migration Verification...
2025-12-09 13:40:26 - Verification - INFO - Testing Data Preprocessing (Polars)...
2025-12-09 13:40:26 - utils - INFO - Processing SUBSET defined in config: ['r1', 'r2', 'r3.1', 'r3.2']
2025-12-09 13:40:26 - utils - INFO - 
================================================================================
                          DATA PREPROCESSING (POLARS)                           
================================================================================

2025-12-09 13:40:26 - utils - INFO - Scanning dataset: r1
2025-12-09 13:40:26 - utils - INFO - Scanning dataset: r2
2025-12-09 13:40:26 - utils - INFO - Scanning dataset: r3.1
2025-12-09 13:40:26 - utils - INFO - Scanning dataset: r3.2
2025-12-09 13:40:26 - utils - INFO - Constructing execution graph (Diagonal Concat)...
2025-12-09 13:40:26 - utils - INFO - Loaded Psychometric data: 2999 users
2025-12-09 13:40:26 - utils - INFO - Streaming merged data to /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs_r1_r2_r3.1_r3.2_ENRICHED.csv...
2025-12-09 13:41:32 - utils - INFO - ✓ Preprocessing complete.
2025-12-09 13:41:32 - Verification - INFO - PASS: Preprocessing ran successfully.
2025-12-09 13:41:32 - Verification - INFO - Testing Feature Engineering (Polars)...
2025-12-09 13:41:32 - utils - INFO - Aggregating daily features...
2025-12-09 13:41:32 - Verification - ERROR - FAIL: Feature Engineering failed: unable to find column "role"; valid columns: ["id", "date", "user_id", "pc_id", "activity", "activity_type", "dataset", "is_logon", "is_logoff", "is_connect", "is_disconnect", "url", "domain", "is_suspicious_domain", "to", "email_size_kb", "is_large_email", "has_attachment", "filename", "content", "file_extension", "is_sensitive_file", "size", "attachments", "O", "C", "E", "A", "N", "is_insider", "day"]

Resolved plan until failure:

	---> FAILED HERE RESOLVING 'sink' <---
 WITH_COLUMNS:
 [col("date").dt.truncate(["1d"]).alias("day")] 
   WITH_COLUMNS:
   [col("date").str.strptime(["raise"])] 
    Csv SCAN [/Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs_r1_r2_r3.1_r3.2_ENRICHED.csv]
    PROJECT */30 COLUMNS
    ESTIMATED ROWS: 267560100
2025-12-09 13:45:02 - utils - INFO - Utility functions loaded successfully
2025-12-09 13:45:02 - Verification - INFO - Starting Migration Verification...
2025-12-09 13:45:02 - Verification - INFO - Testing Data Preprocessing (Polars)...
2025-12-09 13:45:02 - utils - INFO - Processing SUBSET defined in config: ['r1', 'r2', 'r3.1', 'r3.2']
2025-12-09 13:45:02 - utils - INFO - 
================================================================================
                          DATA PREPROCESSING (POLARS)                           
================================================================================

2025-12-09 13:45:02 - utils - INFO - Scanning dataset: r1
2025-12-09 13:45:02 - utils - INFO - Scanning dataset: r2
2025-12-09 13:45:02 - utils - INFO - Scanning dataset: r3.1
2025-12-09 13:45:02 - utils - INFO - Scanning dataset: r3.2
2025-12-09 13:45:02 - utils - INFO - Constructing execution graph (Diagonal Concat)...
2025-12-09 13:45:02 - utils - INFO - Loaded Psychometric data: 2999 users
2025-12-09 13:45:02 - utils - INFO - Streaming merged data to /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs_r1_r2_r3.1_r3.2_ENRICHED.csv...
2025-12-09 13:46:13 - utils - INFO - ✓ Preprocessing complete.
2025-12-09 13:46:13 - Verification - INFO - PASS: Preprocessing ran successfully.
2025-12-09 13:46:13 - Verification - INFO - Testing Feature Engineering (Polars)...
2025-12-09 13:46:13 - utils - INFO - Aggregating daily features...
2025-12-09 13:47:20 - utils - INFO - Daily aggregation complete: 6999 rows
2025-12-09 13:47:20 - utils - INFO - Calculating Z-scores...
2025-12-09 13:47:20 - utils - INFO - Creating static features...
2025-12-09 13:47:20 - utils - INFO - Saved static features: /Users/bipinrimal/Downloads/Thesis_work/data/processed/static_features_r1_r2_r3.1_r3.2_polars.csv
2025-12-09 13:47:20 - utils - INFO - Creating sequences...
2025-12-09 13:47:23 - utils - WARNING - No sequences created (insufficent data length per user?)
2025-12-09 13:47:23 - utils - INFO - Feature engineering complete.
2025-12-09 13:47:23 - Verification - INFO - PASS: Feature Engineering ran successfully.
2025-12-09 13:47:23 - Verification - INFO - ALL TESTS PASSED. Migration successful.
2025-12-09 13:59:34 - utils - INFO - Utility functions loaded successfully
2025-12-09 14:03:37 - utils - INFO - Utility functions loaded successfully
2025-12-09 14:03:41 - utils - INFO - ================================================================================
2025-12-09 14:03:41 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-12-09 14:03:41 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-12-09 14:03:41 - utils - INFO - ================================================================================
2025-12-09 14:03:41 - utils - INFO - 
================================================================================
2025-12-09 14:03:41 - utils - INFO - STARTING FULL PIPELINE EXECUTION
2025-12-09 14:03:41 - utils - INFO - ================================================================================

2025-12-09 14:03:41 - utils - INFO - 
================================================================================
                          STAGE 1: DATA PREPROCESSING                           
================================================================================

2025-12-09 14:03:41 - utils - INFO - Processing SUBSET defined in config: ['r1', 'r2', 'r3.1', 'r3.2']
2025-12-09 14:03:41 - utils - INFO - 
================================================================================
                          DATA PREPROCESSING (POLARS)                           
================================================================================

2025-12-09 14:03:41 - utils - INFO - Scanning dataset: r1
2025-12-09 14:03:41 - utils - INFO - Scanning dataset: r2
2025-12-09 14:03:42 - utils - INFO - Scanning dataset: r3.1
2025-12-09 14:03:42 - utils - INFO - Scanning dataset: r3.2
2025-12-09 14:03:42 - utils - INFO - Constructing execution graph (Diagonal Concat)...
2025-12-09 14:03:42 - utils - INFO - Loaded Psychometric data: 2999 users
2025-12-09 14:03:42 - utils - INFO - Streaming merged data to /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs_r1_r2_r3.1_r3.2_ENRICHED.csv...
2025-12-09 14:04:47 - utils - INFO - ✓ Preprocessing complete.
2025-12-09 14:04:47 - utils - INFO - ✓ Stage 1 completed: check output file.
2025-12-09 14:04:47 - utils - INFO - 
================================================================================
                          STAGE 2: FEATURE ENGINEERING                          
================================================================================

2025-12-09 14:04:47 - utils - ERROR - No preprocessed data found. Run stage 1 first.
2025-12-09 14:04:47 - utils - ERROR - 
✗ PIPELINE EXECUTION FAILED: cannot unpack non-iterable NoneType object
2025-12-09 14:07:15 - utils - INFO - Utility functions loaded successfully
2025-12-09 14:07:19 - utils - INFO - ================================================================================
2025-12-09 14:07:19 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-12-09 14:07:19 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-12-09 14:07:19 - utils - INFO - ================================================================================
2025-12-09 14:07:19 - utils - INFO - 
================================================================================
2025-12-09 14:07:19 - utils - INFO - STARTING FULL PIPELINE EXECUTION
2025-12-09 14:07:19 - utils - INFO - ================================================================================

2025-12-09 14:07:19 - utils - INFO - 
================================================================================
                          STAGE 1: DATA PREPROCESSING                           
================================================================================

2025-12-09 14:07:19 - utils - INFO - Processing SUBSET defined in config: ['r1', 'r2', 'r3.1', 'r3.2']
2025-12-09 14:07:19 - utils - INFO - 
================================================================================
                          DATA PREPROCESSING (POLARS)                           
================================================================================

2025-12-09 14:07:19 - utils - INFO - Scanning dataset: r1
2025-12-09 14:07:19 - utils - INFO - Scanning dataset: r2
2025-12-09 14:07:19 - utils - INFO - Scanning dataset: r3.1
2025-12-09 14:07:20 - utils - INFO - Scanning dataset: r3.2
2025-12-09 14:07:20 - utils - INFO - Constructing execution graph (Diagonal Concat)...
2025-12-09 14:07:20 - utils - INFO - Loaded Psychometric data: 2999 users
2025-12-09 14:07:20 - utils - INFO - Streaming merged data to /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv...
2025-12-09 14:08:25 - utils - INFO - ✓ Preprocessing complete.
2025-12-09 14:08:25 - utils - INFO - ✓ Stage 1 completed: check output file.
2025-12-09 14:08:25 - utils - INFO - 
================================================================================
                          STAGE 2: FEATURE ENGINEERING                          
================================================================================

2025-12-09 14:10:17 - utils - INFO - Utility functions loaded successfully
2025-12-09 14:10:21 - utils - INFO - ================================================================================
2025-12-09 14:10:21 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-12-09 14:10:21 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-12-09 14:10:21 - utils - INFO - ================================================================================
2025-12-09 14:10:21 - utils - INFO - 
================================================================================
2025-12-09 14:10:21 - utils - INFO - STARTING FULL PIPELINE EXECUTION
2025-12-09 14:10:21 - utils - INFO - ================================================================================

2025-12-09 14:10:21 - utils - INFO - 
================================================================================
                          STAGE 1: DATA PREPROCESSING                           
================================================================================

2025-12-09 14:10:21 - utils - INFO - Processing SUBSET defined in config: ['r1', 'r2', 'r3.1', 'r3.2']
2025-12-09 14:10:21 - utils - INFO - 
================================================================================
                          DATA PREPROCESSING (POLARS)                           
================================================================================

2025-12-09 14:10:21 - utils - INFO - Scanning dataset: r1
2025-12-09 14:10:21 - utils - INFO - Scanning dataset: r2
2025-12-09 14:10:21 - utils - INFO - Scanning dataset: r3.1
2025-12-09 14:10:22 - utils - INFO - Scanning dataset: r3.2
2025-12-09 14:10:22 - utils - INFO - Constructing execution graph (Diagonal Concat)...
2025-12-09 14:10:22 - utils - INFO - Loaded Psychometric data: 2999 users
2025-12-09 14:10:22 - utils - INFO - Streaming merged data to /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv...
2025-12-09 14:13:45 - utils - INFO - ✓ Preprocessing complete.
2025-12-09 14:13:45 - utils - INFO - ✓ Stage 1 completed: check output file.
2025-12-09 14:13:45 - utils - INFO - 
================================================================================
                          STAGE 2: FEATURE ENGINEERING                          
================================================================================

2025-12-09 14:36:30 - utils - INFO - Utility functions loaded successfully
2025-12-09 14:36:36 - utils - INFO - ================================================================================
2025-12-09 14:36:36 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-12-09 14:36:36 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-12-09 14:36:36 - utils - INFO - ================================================================================
2025-12-09 14:36:36 - utils - INFO - 
================================================================================
2025-12-09 14:36:36 - utils - INFO - STARTING FULL PIPELINE EXECUTION
2025-12-09 14:36:36 - utils - INFO - ================================================================================

2025-12-09 14:36:36 - utils - INFO - 
================================================================================
                          STAGE 1: DATA PREPROCESSING                           
================================================================================

2025-12-09 14:36:36 - utils - INFO - Processing SUBSET defined in config: ['r1', 'r2', 'r3.1', 'r3.2']
2025-12-09 14:36:36 - utils - INFO - 
================================================================================
                          DATA PREPROCESSING (POLARS)                           
================================================================================

2025-12-09 14:36:36 - utils - INFO - Scanning dataset: r1
2025-12-09 14:36:36 - utils - INFO - Scanning dataset: r2
2025-12-09 14:36:36 - utils - INFO - Scanning dataset: r3.1
2025-12-09 14:36:36 - utils - INFO - Scanning dataset: r3.2
2025-12-09 14:36:36 - utils - INFO - Constructing execution graph (Diagonal Concat)...
2025-12-09 14:36:36 - utils - INFO - Loaded Psychometric data: 2999 users
2025-12-09 14:36:36 - utils - INFO - Streaming merged data to /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv...
2025-12-09 14:38:35 - utils - INFO - ✓ Preprocessing complete.
2025-12-09 14:38:35 - utils - INFO - ✓ Stage 1 completed: check output file.
2025-12-09 14:38:35 - utils - INFO - 
================================================================================
                          STAGE 2: FEATURE ENGINEERING                          
================================================================================

2025-12-09 14:38:35 - utils - INFO - Aggregating daily features...
2025-12-09 14:39:43 - utils - INFO - Daily aggregation complete: 6999 rows
2025-12-09 14:39:43 - utils - INFO - Calculating Z-scores...
2025-12-09 14:39:43 - utils - INFO - Creating static features...
2025-12-09 14:39:43 - utils - INFO - Saved static features: /Users/bipinrimal/Downloads/Thesis_work/data/processed/static_features_r1_r2_r3.1_r3.2_polars.csv
2025-12-09 14:39:43 - utils - INFO - Creating sequences...
2025-12-09 14:39:47 - utils - WARNING - No sequences created (insufficent data length per user?)
2025-12-09 14:39:47 - utils - INFO - Feature engineering complete.
2025-12-09 14:39:47 - utils - INFO - ✓ Stage 2 completed: Polars pipeline finished.
2025-12-09 14:39:47 - utils - INFO - 
================================================================================
                            STAGE 3: MODEL TRAINING                             
================================================================================

2025-12-09 14:39:47 - utils - INFO - 
>>> Training Isolation Forest...
2025-12-09 14:39:47 - utils - INFO - 
================================================================================
                 ISOLATION FOREST TRAINING (V2: MULTI-DATASET)                  
================================================================================

2025-12-09 14:39:47 - utils - ERROR - ✗ Isolation Forest training failed: 'static_scaler_v2'
2025-12-09 14:39:47 - utils - INFO - 
>>> Training LSTM Autoencoder...
2025-12-09 14:39:47 - utils - INFO - 
================================================================================
                     LIGHTWEIGHT LSTM AUTOENCODER TRAINING                      
================================================================================

2025-12-09 14:39:47 - utils - ERROR - Sequence data not found. Run feature_engineering.py first.
2025-12-09 14:39:47 - utils - INFO - ✓ LSTM Autoencoder training completed
2025-12-09 14:39:47 - utils - INFO - 
>>> Training Deep Clustering...
2025-12-09 14:39:47 - utils - INFO - 
================================================================================
                      LIGHTWEIGHT DEEP CLUSTERING TRAINING                      
================================================================================

2025-12-09 14:39:47 - utils - ERROR - engineered_static_features.csv not found. Run feature_engineering.py first.
2025-12-09 14:39:47 - utils - INFO - ✓ Deep Clustering training completed
2025-12-09 14:39:47 - utils - INFO - 
✓ Stage 3 completed: 2 models trained
2025-12-09 14:39:47 - utils - INFO - 
================================================================================
                           STAGE 4: MODEL EVALUATION                            
================================================================================

2025-12-09 14:39:47 - utils - INFO - 
================================================================================
                         COMPREHENSIVE MODEL EVALUATION                         
================================================================================

2025-12-09 14:39:47 - utils - INFO - Loading results for all models...
2025-12-09 14:39:47 - utils - INFO - Loaded results for isolation_forest
2025-12-09 14:39:47 - utils - INFO - Loaded results for lstm_autoencoder
2025-12-09 14:39:47 - utils - INFO - Loaded results for deep_clustering
2025-12-09 14:39:47 - utils - INFO - Loaded results for 3 models
2025-12-09 14:39:47 - utils - INFO - Creating metrics comparison table...
2025-12-09 14:39:47 - utils - INFO - Metrics comparison table created
2025-12-09 14:39:47 - utils - INFO - Creating confusion matrix plots...
2025-12-09 14:39:47 - utils - INFO - Confusion matrices saved to /Users/bipinrimal/Downloads/Thesis_work/results/confusion_matrices/all_models.png
2025-12-09 14:39:47 - utils - INFO - Creating ROC curves...
2025-12-09 14:39:48 - utils - INFO - ROC curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/roc_curves/roc_comparison.png
2025-12-09 14:39:48 - utils - INFO - Creating Precision-Recall curves...
2025-12-09 14:39:48 - utils - INFO - Precision-Recall curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/precision_recall_comparison.png
2025-12-09 14:39:48 - utils - INFO - Creating metrics comparison bar chart...
2025-12-09 14:39:48 - utils - INFO - Metrics comparison bar chart saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/metrics_comparison_bar.png
2025-12-09 14:39:48 - utils - INFO - Creating anomaly score distribution plots...
2025-12-09 14:39:48 - utils - INFO - Score distributions saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/score_distributions.png
2025-12-09 14:39:48 - utils - INFO - Generating evaluation report...
2025-12-09 14:39:48 - utils - INFO - Evaluation report saved to /Users/bipinrimal/Downloads/Thesis_work/results/evaluation_report.txt
2025-12-09 14:39:48 - utils - INFO - Comprehensive evaluation completed!
2025-12-09 14:39:48 - utils - INFO - ✓ Stage 4 completed: Comprehensive evaluation report generated
2025-12-09 14:39:48 - utils - INFO - 
================================================================================
                         STAGE 5: ENSEMBLE INTEGRATION                          
================================================================================

2025-12-09 14:39:48 - utils - ERROR - Error with weighted ensemble: module 'config' has no attribute 'ENSEMBLE'
2025-12-09 14:39:48 - utils - ERROR - Error with majority ensemble: module 'config' has no attribute 'ENSEMBLE'
2025-12-09 14:39:48 - utils - ERROR - Error with cascade ensemble: module 'config' has no attribute 'ENSEMBLE'
2025-12-09 14:39:48 - utils - INFO - 
✓ Stage 5 completed: Best ensemble method = None (F1=0.0000)
2025-12-09 14:39:48 - utils - INFO - 
================================================================================
                             STAGE 6: VISUALIZATION                             
================================================================================

2025-12-09 14:39:48 - utils - INFO - 
================================================================================
                           GENERATING VISUALIZATIONS                            
================================================================================

2025-12-09 14:39:48 - utils - INFO - Creating alert severity distribution plot...
2025-12-09 14:39:48 - utils - WARNING - Alerts file not found
2025-12-09 14:39:48 - utils - INFO - Creating model agreement plot...
2025-12-09 14:39:48 - utils - WARNING - Alerts file not found
2025-12-09 14:39:48 - utils - INFO - Creating anomaly score timeline for ensemble_weighted...
2025-12-09 14:39:48 - utils - ERROR - 
✗ PIPELINE EXECUTION FAILED: module 'config' has no attribute 'ENSEMBLE'
2025-12-09 14:43:25 - utils - INFO - Utility functions loaded successfully
2025-12-09 14:43:29 - utils - INFO - ================================================================================
2025-12-09 14:43:29 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-12-09 14:43:29 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-12-09 14:43:29 - utils - INFO - ================================================================================
2025-12-09 14:43:29 - utils - INFO - 
================================================================================
2025-12-09 14:43:29 - utils - INFO - STARTING FULL PIPELINE EXECUTION
2025-12-09 14:43:29 - utils - INFO - ================================================================================

2025-12-09 14:43:29 - utils - INFO - 
================================================================================
                          STAGE 1: DATA PREPROCESSING                           
================================================================================

2025-12-09 14:43:29 - utils - INFO - Processing SUBSET defined in config: ['r1', 'r2', 'r3.1', 'r3.2']
2025-12-09 14:43:29 - utils - INFO - 
================================================================================
                          DATA PREPROCESSING (POLARS)                           
================================================================================

2025-12-09 14:43:29 - utils - INFO - Scanning dataset: r1
2025-12-09 14:43:29 - utils - INFO - Scanning dataset: r2
2025-12-09 14:43:29 - utils - INFO - Scanning dataset: r3.1
2025-12-09 14:43:29 - utils - INFO - Scanning dataset: r3.2
2025-12-09 14:43:29 - utils - INFO - Constructing execution graph (Diagonal Concat)...
2025-12-09 14:43:29 - utils - INFO - Loaded Psychometric data: 2999 users
2025-12-09 14:43:29 - utils - INFO - Streaming merged data to /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv...
2025-12-09 14:44:32 - utils - INFO - ✓ Preprocessing complete.
2025-12-09 14:44:32 - utils - INFO - ✓ Stage 1 completed: check output file.
2025-12-09 14:44:32 - utils - INFO - 
================================================================================
                          STAGE 2: FEATURE ENGINEERING                          
================================================================================

2025-12-09 14:44:32 - utils - INFO - Aggregating daily features...
2025-12-09 14:45:38 - utils - INFO - Daily aggregation complete: 6999 rows
2025-12-09 14:45:38 - utils - INFO - Calculating Z-scores...
2025-12-09 14:45:38 - utils - INFO - Creating static features...
2025-12-09 14:45:38 - utils - INFO - Saved static features: /Users/bipinrimal/Downloads/Thesis_work/data/processed/static_features_r1_r2_r3.1_r3.2_polars.csv
2025-12-09 14:45:38 - utils - INFO - Creating sequences...
2025-12-09 14:45:42 - utils - WARNING - No sequences created (insufficent data length per user?)
2025-12-09 14:45:42 - utils - INFO - Feature engineering complete.
2025-12-09 14:45:42 - utils - INFO - ✓ Stage 2 completed: Polars pipeline finished.
2025-12-09 14:45:42 - utils - INFO - 
================================================================================
                            STAGE 3: MODEL TRAINING                             
================================================================================

2025-12-09 14:45:42 - utils - INFO - 
>>> Training Isolation Forest...
2025-12-09 14:45:42 - utils - INFO - 
================================================================================
                 ISOLATION FOREST TRAINING (V2: MULTI-DATASET)                  
================================================================================

2025-12-09 14:45:42 - utils - ERROR - ✗ Isolation Forest training failed: 'static_scaler_v2'
2025-12-09 14:45:42 - utils - INFO - 
>>> Training LSTM Autoencoder...
2025-12-09 14:45:42 - utils - INFO - 
================================================================================
                     LIGHTWEIGHT LSTM AUTOENCODER TRAINING                      
================================================================================

2025-12-09 14:45:42 - utils - ERROR - Sequence data not found. Run feature_engineering.py first.
2025-12-09 14:45:42 - utils - INFO - ✓ LSTM Autoencoder training completed
2025-12-09 14:45:42 - utils - INFO - 
>>> Training Deep Clustering...
2025-12-09 14:45:42 - utils - INFO - 
================================================================================
                      LIGHTWEIGHT DEEP CLUSTERING TRAINING                      
================================================================================

2025-12-09 14:45:42 - utils - ERROR - engineered_static_features.csv not found. Run feature_engineering.py first.
2025-12-09 14:45:42 - utils - INFO - ✓ Deep Clustering training completed
2025-12-09 14:45:42 - utils - INFO - 
✓ Stage 3 completed: 2 models trained
2025-12-09 14:45:42 - utils - INFO - 
================================================================================
                           STAGE 4: MODEL EVALUATION                            
================================================================================

2025-12-09 14:45:42 - utils - INFO - 
================================================================================
                         COMPREHENSIVE MODEL EVALUATION                         
================================================================================

2025-12-09 14:45:42 - utils - INFO - Loading results for all models...
2025-12-09 14:45:42 - utils - INFO - Loaded results for isolation_forest
2025-12-09 14:45:42 - utils - INFO - Loaded results for lstm_autoencoder
2025-12-09 14:45:42 - utils - INFO - Loaded results for deep_clustering
2025-12-09 14:45:42 - utils - INFO - Loaded results for 3 models
2025-12-09 14:45:42 - utils - INFO - Creating metrics comparison table...
2025-12-09 14:45:42 - utils - INFO - Metrics comparison table created
2025-12-09 14:45:42 - utils - INFO - Creating confusion matrix plots...
2025-12-09 14:45:42 - utils - INFO - Confusion matrices saved to /Users/bipinrimal/Downloads/Thesis_work/results/confusion_matrices/all_models.png
2025-12-09 14:45:42 - utils - INFO - Creating ROC curves...
2025-12-09 14:45:42 - utils - INFO - ROC curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/roc_curves/roc_comparison.png
2025-12-09 14:45:42 - utils - INFO - Creating Precision-Recall curves...
2025-12-09 14:45:43 - utils - INFO - Precision-Recall curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/precision_recall_comparison.png
2025-12-09 14:45:43 - utils - INFO - Creating metrics comparison bar chart...
2025-12-09 14:45:43 - utils - INFO - Metrics comparison bar chart saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/metrics_comparison_bar.png
2025-12-09 14:45:43 - utils - INFO - Creating anomaly score distribution plots...
2025-12-09 14:45:43 - utils - INFO - Score distributions saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/score_distributions.png
2025-12-09 14:45:43 - utils - INFO - Generating evaluation report...
2025-12-09 14:45:43 - utils - INFO - Evaluation report saved to /Users/bipinrimal/Downloads/Thesis_work/results/evaluation_report.txt
2025-12-09 14:45:43 - utils - INFO - Comprehensive evaluation completed!
2025-12-09 14:45:43 - utils - INFO - ✓ Stage 4 completed: Comprehensive evaluation report generated
2025-12-09 14:45:43 - utils - INFO - 
================================================================================
                         STAGE 5: ENSEMBLE INTEGRATION                          
================================================================================

2025-12-09 14:45:43 - utils - INFO - Initialized Ensemble Detector with method: weighted
2025-12-09 14:45:43 - utils - INFO - 
================================================================================
                            ENSEMBLE SYSTEM PIPELINE                            
================================================================================

2025-12-09 14:45:43 - utils - INFO - Loading predictions from individual models...
2025-12-09 14:45:43 - utils - INFO - Loaded isolation_forest predictions: 1000 samples
2025-12-09 14:45:43 - utils - INFO - Loaded lstm_autoencoder predictions: 32531 samples
2025-12-09 14:45:43 - utils - INFO - Loaded deep_clustering predictions: 1000 samples
2025-12-09 14:45:43 - utils - WARNING - Models have different sample counts: {'isolation_forest': 1000, 'lstm_autoencoder': 32531, 'deep_clustering': 1000}
2025-12-09 14:45:43 - utils - INFO - Will use aggregation strategy to align predictions...
2025-12-09 14:45:43 - utils - INFO - Aligning predictions across models...
2025-12-09 14:45:43 - utils - INFO - Using isolation_forest as reference (1000 samples)
2025-12-09 14:45:43 - utils - INFO - Aggregating lstm_autoencoder from 32531 to 1000 samples
2025-12-09 14:45:43 - utils - INFO - Predictions aligned successfully
2025-12-09 14:45:43 - utils - INFO - Loaded predictions from 3 models
2025-12-09 14:45:43 - utils - INFO - Computing weighted ensemble...
2025-12-09 14:45:43 - utils - INFO - Weighted ensemble: 0 anomalies detected
2025-12-09 14:45:43 - utils - INFO - Evaluating ensemble performance...
2025-12-09 14:45:43 - utils - INFO - 
============================================================
2025-12-09 14:45:43 - utils - INFO - Ensemble (weighted) Performance Metrics
2025-12-09 14:45:43 - utils - INFO - ============================================================
2025-12-09 14:45:43 - utils - INFO - Accuracy:  0.9990
2025-12-09 14:45:43 - utils - INFO - Precision: 0.0000
2025-12-09 14:45:43 - utils - INFO - Recall:    0.0000
2025-12-09 14:45:43 - utils - INFO - F1-Score:  0.0000
2025-12-09 14:45:43 - utils - INFO - AUC-ROC:   0.7978
2025-12-09 14:45:43 - utils - INFO - ============================================================

2025-12-09 14:45:43 - utils - INFO - Comparing ensemble with individual models...
2025-12-09 14:45:43 - utils - INFO - Evaluating ensemble performance...
2025-12-09 14:45:43 - utils - INFO - 
============================================================
2025-12-09 14:45:43 - utils - INFO - Ensemble (weighted) Performance Metrics
2025-12-09 14:45:43 - utils - INFO - ============================================================
2025-12-09 14:45:43 - utils - INFO - Accuracy:  0.9990
2025-12-09 14:45:43 - utils - INFO - Precision: 0.0000
2025-12-09 14:45:43 - utils - INFO - Recall:    0.0000
2025-12-09 14:45:43 - utils - INFO - F1-Score:  0.0000
2025-12-09 14:45:43 - utils - INFO - AUC-ROC:   0.7978
2025-12-09 14:45:43 - utils - INFO - ============================================================

2025-12-09 14:45:43 - utils - INFO - 
Comparison Results:
2025-12-09 14:45:43 - utils - INFO - 
              model  accuracy  precision  recall  f1_score  auc_roc
   Isolation Forest     0.945        0.0     0.0       0.0   0.8208
   Lstm Autoencoder     0.946        0.0     0.0       0.0   0.1842
    Deep Clustering     0.959        0.0     0.0       0.0   0.7407
Ensemble (weighted)     0.999        0.0     0.0       0.0   0.7978
2025-12-09 14:45:43 - utils - INFO - Ensemble predictions saved
2025-12-09 14:45:43 - utils - INFO - Generating alerts...
2025-12-09 14:45:43 - utils - ERROR - Error with weighted ensemble: 'severity'
2025-12-09 14:45:43 - utils - INFO - Initialized Ensemble Detector with method: majority
2025-12-09 14:45:43 - utils - INFO - 
================================================================================
                            ENSEMBLE SYSTEM PIPELINE                            
================================================================================

2025-12-09 14:45:43 - utils - INFO - Loading predictions from individual models...
2025-12-09 14:45:43 - utils - INFO - Loaded isolation_forest predictions: 1000 samples
2025-12-09 14:45:43 - utils - INFO - Loaded lstm_autoencoder predictions: 32531 samples
2025-12-09 14:45:43 - utils - INFO - Loaded deep_clustering predictions: 1000 samples
2025-12-09 14:45:43 - utils - WARNING - Models have different sample counts: {'isolation_forest': 1000, 'lstm_autoencoder': 32531, 'deep_clustering': 1000}
2025-12-09 14:45:43 - utils - INFO - Will use aggregation strategy to align predictions...
2025-12-09 14:45:43 - utils - INFO - Aligning predictions across models...
2025-12-09 14:45:43 - utils - INFO - Using isolation_forest as reference (1000 samples)
2025-12-09 14:45:43 - utils - INFO - Aggregating lstm_autoencoder from 32531 to 1000 samples
2025-12-09 14:45:43 - utils - INFO - Predictions aligned successfully
2025-12-09 14:45:43 - utils - INFO - Loaded predictions from 3 models
2025-12-09 14:45:43 - utils - INFO - Computing majority voting ensemble...
2025-12-09 14:45:43 - utils - INFO - Majority voting: 11 anomalies detected
2025-12-09 14:45:43 - utils - INFO - Evaluating ensemble performance...
2025-12-09 14:45:43 - utils - INFO - 
============================================================
2025-12-09 14:45:43 - utils - INFO - Ensemble (majority) Performance Metrics
2025-12-09 14:45:43 - utils - INFO - ============================================================
2025-12-09 14:45:43 - utils - INFO - Accuracy:  0.9880
2025-12-09 14:45:43 - utils - INFO - Precision: 0.0000
2025-12-09 14:45:43 - utils - INFO - Recall:    0.0000
2025-12-09 14:45:43 - utils - INFO - F1-Score:  0.0000
2025-12-09 14:45:43 - utils - INFO - AUC-ROC:   0.8018
2025-12-09 14:45:43 - utils - INFO - ============================================================

2025-12-09 14:45:43 - utils - INFO - Comparing ensemble with individual models...
2025-12-09 14:45:43 - utils - INFO - Evaluating ensemble performance...
2025-12-09 14:45:43 - utils - INFO - 
============================================================
2025-12-09 14:45:43 - utils - INFO - Ensemble (majority) Performance Metrics
2025-12-09 14:45:43 - utils - INFO - ============================================================
2025-12-09 14:45:43 - utils - INFO - Accuracy:  0.9880
2025-12-09 14:45:43 - utils - INFO - Precision: 0.0000
2025-12-09 14:45:43 - utils - INFO - Recall:    0.0000
2025-12-09 14:45:43 - utils - INFO - F1-Score:  0.0000
2025-12-09 14:45:43 - utils - INFO - AUC-ROC:   0.8018
2025-12-09 14:45:43 - utils - INFO - ============================================================

2025-12-09 14:45:43 - utils - INFO - 
Comparison Results:
2025-12-09 14:45:43 - utils - INFO - 
              model  accuracy  precision  recall  f1_score  auc_roc
   Isolation Forest     0.945        0.0     0.0       0.0   0.8208
   Lstm Autoencoder     0.946        0.0     0.0       0.0   0.1842
    Deep Clustering     0.959        0.0     0.0       0.0   0.7407
Ensemble (majority)     0.988        0.0     0.0       0.0   0.8018
2025-12-09 14:45:43 - utils - INFO - Ensemble predictions saved
2025-12-09 14:45:43 - utils - INFO - Generating alerts...
2025-12-09 14:45:43 - utils - ERROR - Error with majority ensemble: 'severity'
2025-12-09 14:45:43 - utils - INFO - Initialized Ensemble Detector with method: cascade
2025-12-09 14:45:43 - utils - INFO - 
================================================================================
                            ENSEMBLE SYSTEM PIPELINE                            
================================================================================

2025-12-09 14:45:43 - utils - INFO - Loading predictions from individual models...
2025-12-09 14:45:43 - utils - INFO - Loaded isolation_forest predictions: 1000 samples
2025-12-09 14:45:43 - utils - INFO - Loaded lstm_autoencoder predictions: 32531 samples
2025-12-09 14:45:43 - utils - INFO - Loaded deep_clustering predictions: 1000 samples
2025-12-09 14:45:43 - utils - WARNING - Models have different sample counts: {'isolation_forest': 1000, 'lstm_autoencoder': 32531, 'deep_clustering': 1000}
2025-12-09 14:45:43 - utils - INFO - Will use aggregation strategy to align predictions...
2025-12-09 14:45:43 - utils - INFO - Aligning predictions across models...
2025-12-09 14:45:43 - utils - INFO - Using isolation_forest as reference (1000 samples)
2025-12-09 14:45:43 - utils - INFO - Aggregating lstm_autoencoder from 32531 to 1000 samples
2025-12-09 14:45:43 - utils - INFO - Predictions aligned successfully
2025-12-09 14:45:43 - utils - INFO - Loaded predictions from 3 models
2025-12-09 14:45:43 - utils - INFO - Computing cascade ensemble...
2025-12-09 14:45:43 - utils - INFO - Cascade ensemble: 0 anomalies detected
2025-12-09 14:45:43 - utils - INFO - Evaluating ensemble performance...
2025-12-09 14:45:43 - utils - INFO - 
============================================================
2025-12-09 14:45:43 - utils - INFO - Ensemble (cascade) Performance Metrics
2025-12-09 14:45:43 - utils - INFO - ============================================================
2025-12-09 14:45:43 - utils - INFO - Accuracy:  0.9990
2025-12-09 14:45:43 - utils - INFO - Precision: 0.0000
2025-12-09 14:45:43 - utils - INFO - Recall:    0.0000
2025-12-09 14:45:43 - utils - INFO - F1-Score:  0.0000
2025-12-09 14:45:43 - utils - INFO - AUC-ROC:   0.7067
2025-12-09 14:45:43 - utils - INFO - ============================================================

2025-12-09 14:45:43 - utils - INFO - Comparing ensemble with individual models...
2025-12-09 14:45:43 - utils - INFO - Evaluating ensemble performance...
2025-12-09 14:45:43 - utils - INFO - 
============================================================
2025-12-09 14:45:43 - utils - INFO - Ensemble (cascade) Performance Metrics
2025-12-09 14:45:43 - utils - INFO - ============================================================
2025-12-09 14:45:43 - utils - INFO - Accuracy:  0.9990
2025-12-09 14:45:43 - utils - INFO - Precision: 0.0000
2025-12-09 14:45:43 - utils - INFO - Recall:    0.0000
2025-12-09 14:45:43 - utils - INFO - F1-Score:  0.0000
2025-12-09 14:45:43 - utils - INFO - AUC-ROC:   0.7067
2025-12-09 14:45:43 - utils - INFO - ============================================================

2025-12-09 14:45:43 - utils - INFO - 
Comparison Results:
2025-12-09 14:45:43 - utils - INFO - 
             model  accuracy  precision  recall  f1_score  auc_roc
  Isolation Forest     0.945        0.0     0.0       0.0   0.8208
  Lstm Autoencoder     0.946        0.0     0.0       0.0   0.1842
   Deep Clustering     0.959        0.0     0.0       0.0   0.7407
Ensemble (cascade)     0.999        0.0     0.0       0.0   0.7067
2025-12-09 14:45:43 - utils - INFO - Ensemble predictions saved
2025-12-09 14:45:43 - utils - INFO - Generating alerts...
2025-12-09 14:45:43 - utils - INFO - Generated 35 alerts
2025-12-09 14:45:43 - utils - INFO - Severity distribution:
severity
low         22
high         5
medium       5
critical     3
Name: count, dtype: int64
2025-12-09 14:45:43 - utils - INFO - Alerts saved to /Users/bipinrimal/Downloads/Thesis_work/results/alerts.csv
2025-12-09 14:45:43 - utils - INFO - Ensemble pipeline completed!
2025-12-09 14:45:43 - utils - INFO - 
✓ Stage 5 completed: Best ensemble method = None (F1=0.0000)
2025-12-09 14:45:43 - utils - INFO - 
================================================================================
                             STAGE 6: VISUALIZATION                             
================================================================================

2025-12-09 14:45:43 - utils - INFO - 
================================================================================
                           GENERATING VISUALIZATIONS                            
================================================================================

2025-12-09 14:45:43 - utils - INFO - Creating alert severity distribution plot...
2025-12-09 14:45:43 - utils - INFO - Alert severity distribution plot saved
2025-12-09 14:45:43 - utils - INFO - Creating model agreement plot...
2025-12-09 14:45:43 - utils - INFO - Model agreement plot saved
2025-12-09 14:45:43 - utils - INFO - Creating anomaly score timeline for ensemble_weighted...
2025-12-09 14:45:43 - utils - INFO - Anomaly score timeline saved for ensemble_weighted
2025-12-09 14:45:43 - utils - INFO - Creating feature importance visualization...
2025-12-09 14:45:43 - utils - INFO - Feature importance heatmap saved
2025-12-09 14:45:43 - utils - INFO - Creating executive summary chart...
2025-12-09 14:45:44 - utils - INFO - Executive summary chart saved
2025-12-09 14:45:44 - utils - INFO - All visualizations saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations
2025-12-09 14:45:44 - utils - INFO - Visualization generation completed!
2025-12-09 14:45:44 - utils - INFO - ✓ Stage 6 completed: All visualizations generated
2025-12-09 14:45:44 - utils - INFO - 
================================================================================
2025-12-09 14:45:44 - utils - INFO - FINAL SUMMARY
2025-12-09 14:45:44 - utils - INFO - ================================================================================
2025-12-09 14:45:44 - utils - INFO - 
Model Performance:
2025-12-09 14:45:44 - utils - INFO - 
Lstm Autoencoder:
2025-12-09 14:45:44 - utils - ERROR - 
✗ PIPELINE EXECUTION FAILED: 'NoneType' object has no attribute 'get'
2025-12-09 14:46:59 - utils - INFO - Utility functions loaded successfully
2025-12-09 14:47:02 - utils - INFO - ================================================================================
2025-12-09 14:47:02 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-12-09 14:47:02 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-12-09 14:47:02 - utils - INFO - ================================================================================
2025-12-09 14:47:02 - utils - INFO - 
================================================================================
2025-12-09 14:47:02 - utils - INFO - STARTING FULL PIPELINE EXECUTION
2025-12-09 14:47:02 - utils - INFO - ================================================================================

2025-12-09 14:47:02 - utils - INFO - 
================================================================================
                          STAGE 1: DATA PREPROCESSING                           
================================================================================

2025-12-09 14:47:02 - utils - INFO - Processing SUBSET defined in config: ['r1', 'r2', 'r3.1', 'r3.2']
2025-12-09 14:47:02 - utils - INFO - 
================================================================================
                          DATA PREPROCESSING (POLARS)                           
================================================================================

2025-12-09 14:47:02 - utils - INFO - Scanning dataset: r1
2025-12-09 14:47:02 - utils - INFO - Scanning dataset: r2
2025-12-09 14:47:02 - utils - INFO - Scanning dataset: r3.1
2025-12-09 14:47:02 - utils - INFO - Scanning dataset: r3.2
2025-12-09 14:47:02 - utils - INFO - Constructing execution graph (Diagonal Concat)...
2025-12-09 14:47:02 - utils - INFO - Loaded Psychometric data: 2999 users
2025-12-09 14:47:02 - utils - INFO - Streaming merged data to /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv...
2025-12-09 14:47:45 - utils - INFO - Utility functions loaded successfully
2025-12-09 14:47:49 - utils - INFO - ================================================================================
2025-12-09 14:47:49 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-12-09 14:47:49 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-12-09 14:47:49 - utils - INFO - ================================================================================
2025-12-09 14:47:49 - utils - INFO - 
================================================================================
2025-12-09 14:47:49 - utils - INFO - STARTING FULL PIPELINE EXECUTION
2025-12-09 14:47:49 - utils - INFO - ================================================================================

2025-12-09 14:47:49 - utils - INFO - 
================================================================================
                          STAGE 1: DATA PREPROCESSING                           
================================================================================

2025-12-09 14:47:49 - utils - INFO - Processing SUBSET defined in config: ['r1', 'r2', 'r3.1', 'r3.2', 'r4.1', 'r4.2', 'r5.1', 'r5.2']
2025-12-09 14:47:49 - utils - INFO - 
================================================================================
                          DATA PREPROCESSING (POLARS)                           
================================================================================

2025-12-09 14:47:49 - utils - INFO - Scanning dataset: r1
2025-12-09 14:47:49 - utils - INFO - Scanning dataset: r2
2025-12-09 14:47:49 - utils - INFO - Scanning dataset: r3.1
2025-12-09 14:47:49 - utils - INFO - Scanning dataset: r3.2
2025-12-09 14:47:49 - utils - INFO - Scanning dataset: r4.1
2025-12-09 14:47:49 - utils - INFO - Scanning dataset: r4.2
2025-12-09 14:47:49 - utils - INFO - Scanning dataset: r5.1
2025-12-09 14:47:49 - utils - INFO - Scanning dataset: r5.2
2025-12-09 14:47:49 - utils - INFO - Constructing execution graph (Diagonal Concat)...
2025-12-09 14:47:49 - utils - INFO - Loaded Psychometric data: 8997 users
2025-12-09 14:47:49 - utils - ERROR - 
✗ PIPELINE EXECUTION FAILED: 'union'/'concat' inputs should all have the same schema,got
Schema:
name: id, field: String
name: date, field: Datetime('μs')
name: user_id, field: String
name: pc_id, field: String
name: activity, field: String
name: activity_type, field: String
name: dataset, field: String
name: is_logon, field: Int8
name: is_logoff, field: Int8
name: is_connect, field: Int8
name: is_disconnect, field: Int8
name: url, field: String
name: domain, field: String
name: is_suspicious_domain, field: Int8
name: to, field: String
name: email_size_kb, field: Float64
name: is_large_email, field: Int8
name: has_attachment, field: Int8
name: filename, field: String
name: content, field: String
name: file_extension, field: String
name: is_sensitive_file, field: Int8
name: size, field: Int64
name: attachments, field: Int64
name: cc, field: String
name: bcc, field: String
name: from, field: String
name: file_tree, field: String
name: to_removable_media, field: Boolean
name: from_removable_media, field: Boolean
 and 
Schema:
name: id, field: String
name: date, field: Datetime('μs')
name: user_id, field: String
name: pc_id, field: String
name: activity, field: String
name: activity_type, field: String
name: dataset, field: String
name: is_logon, field: Int8
name: is_logoff, field: Int8
name: is_connect, field: Int8
name: is_disconnect, field: Int8
name: url, field: String
name: domain, field: String
name: is_suspicious_domain, field: Int8
name: to, field: String
name: email_size_kb, field: Float64
name: is_large_email, field: Int8
name: has_attachment, field: Int8
name: filename, field: String
name: content, field: String
name: file_extension, field: String
name: is_sensitive_file, field: Int8
name: size, field: Int64
name: attachments, field: String
name: cc, field: String
name: bcc, field: String
name: from, field: String
name: file_tree, field: String
name: to_removable_media, field: Boolean
name: from_removable_media, field: Boolean


Resolved plan until failure:

	---> FAILED HERE RESOLVING 'join' <---
simple π 30/30 ["id", "date", "user_id", ... 27 other columns]
   WITH_COLUMNS:
   [null.alias("activity"), null.alias("is_logon"), null.alias("is_logoff"), null.alias("is_connect"), null.alias("is_disconnect"), null.alias("to"), null.alias("email_size_kb"), null.alias("is_large_email"), null.alias("has_attachment"), null.alias("filename"), null.alias("file_extension"), null.alias("is_sensitive_file"), null.alias("size"), null.alias("attachments"), null.alias("cc"), null.alias("bcc"), null.alias("from"), null.alias("file_tree"), null.alias("to_removable_media"), null.alias("from_removable_media")] 
     WITH_COLUMNS:
     [col("domain").str.to_lowercase().str.contains(["temp|anonymous|proxy|vpn|leak|hack"]).strict_cast(Int8).alias("is_suspicious_domain")] 
       WITH_COLUMNS:
       [col("url").str.extract(["https?://([^/]+)"]).alias("domain")] 
         WITH_COLUMNS:
         [col("date").str.strptime(["raise"])] 
           WITH_COLUMNS:
           ["http".alias("activity_type"), "r5.2".alias("dataset")] 
            SELECT [col("id"), col("date"), col("user_id"), col("pc").alias("pc_id"), col("url"), col("content")]
              SELECT [col("id"), col("date"), col("user").alias("user_id"), col("pc"), col("url"), col("content")]
                Csv SCAN [/Users/bipinrimal/Downloads/Thesis_work/data/all_data/r5.2/http.csv]
                PROJECT */6 COLUMNS
                ESTIMATED ROWS: 59265156
2025-12-09 14:48:06 - utils - INFO - Utility functions loaded successfully
2025-12-09 14:48:09 - utils - INFO - ================================================================================
2025-12-09 14:48:09 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-12-09 14:48:09 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-12-09 14:48:09 - utils - INFO - ================================================================================
2025-12-09 14:48:09 - utils - INFO - 
================================================================================
2025-12-09 14:48:09 - utils - INFO - STARTING FULL PIPELINE EXECUTION
2025-12-09 14:48:09 - utils - INFO - ================================================================================

2025-12-09 14:48:09 - utils - INFO - 
================================================================================
                          STAGE 1: DATA PREPROCESSING                           
================================================================================

2025-12-09 14:48:09 - utils - INFO - Processing SUBSET defined in config: ['r1', 'r2', 'r3.1', 'r3.2', 'r4.1']
2025-12-09 14:48:09 - utils - INFO - 
================================================================================
                          DATA PREPROCESSING (POLARS)                           
================================================================================

2025-12-09 14:48:09 - utils - INFO - Scanning dataset: r1
2025-12-09 14:48:09 - utils - INFO - Scanning dataset: r2
2025-12-09 14:48:09 - utils - INFO - Scanning dataset: r3.1
2025-12-09 14:48:09 - utils - INFO - Scanning dataset: r3.2
2025-12-09 14:48:09 - utils - INFO - Scanning dataset: r4.1
2025-12-09 14:48:09 - utils - INFO - Constructing execution graph (Diagonal Concat)...
2025-12-09 14:48:09 - utils - INFO - Loaded Psychometric data: 3999 users
2025-12-09 14:48:09 - utils - INFO - Streaming merged data to /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv...
2025-12-09 14:50:03 - utils - INFO - ✓ Preprocessing complete.
2025-12-09 14:50:03 - utils - INFO - ✓ Stage 1 completed: check output file.
2025-12-09 14:50:03 - utils - INFO - 
================================================================================
                          STAGE 2: FEATURE ENGINEERING                          
================================================================================

2025-12-09 14:50:03 - utils - INFO - Aggregating daily features...
2025-12-09 14:51:59 - utils - INFO - Daily aggregation complete: 7999 rows
2025-12-09 14:51:59 - utils - INFO - Calculating Z-scores...
2025-12-09 14:51:59 - utils - INFO - Creating static features...
2025-12-09 14:51:59 - utils - INFO - Saved static features: /Users/bipinrimal/Downloads/Thesis_work/data/processed/static_features_r1_r2_r3.1_r3.2_r4.1_polars.csv
2025-12-09 14:51:59 - utils - INFO - Creating sequences...
2025-12-09 14:52:04 - utils - WARNING - No sequences created (insufficent data length per user?)
2025-12-09 14:52:04 - utils - INFO - Feature engineering complete.
2025-12-09 14:52:04 - utils - INFO - ✓ Stage 2 completed: Polars pipeline finished.
2025-12-09 14:52:04 - utils - INFO - 
================================================================================
                            STAGE 3: MODEL TRAINING                             
================================================================================

2025-12-09 14:52:04 - utils - INFO - 
>>> Training Isolation Forest...
2025-12-09 14:52:04 - utils - INFO - 
================================================================================
                 ISOLATION FOREST TRAINING (V2: MULTI-DATASET)                  
================================================================================

2025-12-09 14:52:04 - utils - ERROR - ✗ Isolation Forest training failed: 'static_scaler_v2'
2025-12-09 14:52:04 - utils - INFO - 
>>> Training LSTM Autoencoder...
2025-12-09 14:52:04 - utils - INFO - 
================================================================================
                     LIGHTWEIGHT LSTM AUTOENCODER TRAINING                      
================================================================================

2025-12-09 14:52:04 - utils - ERROR - Sequence data not found. Run feature_engineering.py first.
2025-12-09 14:52:04 - utils - INFO - ✓ LSTM Autoencoder training completed
2025-12-09 14:52:04 - utils - INFO - 
>>> Training Deep Clustering...
2025-12-09 14:52:04 - utils - INFO - 
================================================================================
                      LIGHTWEIGHT DEEP CLUSTERING TRAINING                      
================================================================================

2025-12-09 14:52:04 - utils - ERROR - engineered_static_features.csv not found. Run feature_engineering.py first.
2025-12-09 14:52:04 - utils - INFO - ✓ Deep Clustering training completed
2025-12-09 14:52:04 - utils - INFO - 
✓ Stage 3 completed: 2 models trained
2025-12-09 14:52:04 - utils - INFO - 
================================================================================
                           STAGE 4: MODEL EVALUATION                            
================================================================================

2025-12-09 14:52:04 - utils - INFO - 
================================================================================
                         COMPREHENSIVE MODEL EVALUATION                         
================================================================================

2025-12-09 14:52:04 - utils - INFO - Loading results for all models...
2025-12-09 14:52:04 - utils - INFO - Loaded results for isolation_forest
2025-12-09 14:52:04 - utils - INFO - Loaded results for lstm_autoencoder
2025-12-09 14:52:04 - utils - INFO - Loaded results for deep_clustering
2025-12-09 14:52:04 - utils - INFO - Loaded results for 3 models
2025-12-09 14:52:04 - utils - INFO - Creating metrics comparison table...
2025-12-09 14:52:04 - utils - INFO - Metrics comparison table created
2025-12-09 14:52:04 - utils - INFO - Creating confusion matrix plots...
2025-12-09 14:52:04 - utils - INFO - Confusion matrices saved to /Users/bipinrimal/Downloads/Thesis_work/results/confusion_matrices/all_models.png
2025-12-09 14:52:04 - utils - INFO - Creating ROC curves...
2025-12-09 14:52:04 - utils - INFO - ROC curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/roc_curves/roc_comparison.png
2025-12-09 14:52:04 - utils - INFO - Creating Precision-Recall curves...
2025-12-09 14:52:04 - utils - INFO - Precision-Recall curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/precision_recall_comparison.png
2025-12-09 14:52:04 - utils - INFO - Creating metrics comparison bar chart...
2025-12-09 14:52:04 - utils - INFO - Metrics comparison bar chart saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/metrics_comparison_bar.png
2025-12-09 14:52:04 - utils - INFO - Creating anomaly score distribution plots...
2025-12-09 14:52:05 - utils - INFO - Score distributions saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/score_distributions.png
2025-12-09 14:52:05 - utils - INFO - Generating evaluation report...
2025-12-09 14:52:05 - utils - INFO - Evaluation report saved to /Users/bipinrimal/Downloads/Thesis_work/results/evaluation_report.txt
2025-12-09 14:52:05 - utils - INFO - Comprehensive evaluation completed!
2025-12-09 14:52:05 - utils - INFO - ✓ Stage 4 completed: Comprehensive evaluation report generated
2025-12-09 14:52:05 - utils - INFO - 
================================================================================
                         STAGE 5: ENSEMBLE INTEGRATION                          
================================================================================

2025-12-09 14:52:05 - utils - INFO - Initialized Ensemble Detector with method: weighted
2025-12-09 14:52:05 - utils - INFO - 
================================================================================
                            ENSEMBLE SYSTEM PIPELINE                            
================================================================================

2025-12-09 14:52:05 - utils - INFO - Loading predictions from individual models...
2025-12-09 14:52:05 - utils - INFO - Loaded isolation_forest predictions: 1000 samples
2025-12-09 14:52:05 - utils - INFO - Loaded lstm_autoencoder predictions: 32531 samples
2025-12-09 14:52:05 - utils - INFO - Loaded deep_clustering predictions: 1000 samples
2025-12-09 14:52:05 - utils - WARNING - Models have different sample counts: {'isolation_forest': 1000, 'lstm_autoencoder': 32531, 'deep_clustering': 1000}
2025-12-09 14:52:05 - utils - INFO - Will use aggregation strategy to align predictions...
2025-12-09 14:52:05 - utils - INFO - Aligning predictions across models...
2025-12-09 14:52:05 - utils - INFO - Using isolation_forest as reference (1000 samples)
2025-12-09 14:52:05 - utils - INFO - Aggregating lstm_autoencoder from 32531 to 1000 samples
2025-12-09 14:52:05 - utils - INFO - Predictions aligned successfully
2025-12-09 14:52:05 - utils - INFO - Loaded predictions from 3 models
2025-12-09 14:52:05 - utils - INFO - Computing weighted ensemble...
2025-12-09 14:52:05 - utils - INFO - Weighted ensemble: 0 anomalies detected
2025-12-09 14:52:05 - utils - INFO - Evaluating ensemble performance...
2025-12-09 14:52:05 - utils - INFO - 
============================================================
2025-12-09 14:52:05 - utils - INFO - Ensemble (weighted) Performance Metrics
2025-12-09 14:52:05 - utils - INFO - ============================================================
2025-12-09 14:52:05 - utils - INFO - Accuracy:  0.9990
2025-12-09 14:52:05 - utils - INFO - Precision: 0.0000
2025-12-09 14:52:05 - utils - INFO - Recall:    0.0000
2025-12-09 14:52:05 - utils - INFO - F1-Score:  0.0000
2025-12-09 14:52:05 - utils - INFO - AUC-ROC:   0.7978
2025-12-09 14:52:05 - utils - INFO - ============================================================

2025-12-09 14:52:05 - utils - INFO - Comparing ensemble with individual models...
2025-12-09 14:52:05 - utils - INFO - Evaluating ensemble performance...
2025-12-09 14:52:05 - utils - INFO - 
============================================================
2025-12-09 14:52:05 - utils - INFO - Ensemble (weighted) Performance Metrics
2025-12-09 14:52:05 - utils - INFO - ============================================================
2025-12-09 14:52:05 - utils - INFO - Accuracy:  0.9990
2025-12-09 14:52:05 - utils - INFO - Precision: 0.0000
2025-12-09 14:52:05 - utils - INFO - Recall:    0.0000
2025-12-09 14:52:05 - utils - INFO - F1-Score:  0.0000
2025-12-09 14:52:05 - utils - INFO - AUC-ROC:   0.7978
2025-12-09 14:52:05 - utils - INFO - ============================================================

2025-12-09 14:52:05 - utils - INFO - 
Comparison Results:
2025-12-09 14:52:05 - utils - INFO - 
              model  accuracy  precision  recall  f1_score  auc_roc
   Isolation Forest     0.945        0.0     0.0       0.0   0.8208
   Lstm Autoencoder     0.946        0.0     0.0       0.0   0.1842
    Deep Clustering     0.959        0.0     0.0       0.0   0.7407
Ensemble (weighted)     0.999        0.0     0.0       0.0   0.7978
2025-12-09 14:52:05 - utils - INFO - Ensemble predictions saved
2025-12-09 14:52:05 - utils - INFO - Generating alerts...
2025-12-09 14:52:05 - utils - ERROR - Error with weighted ensemble: 'severity'
2025-12-09 14:52:05 - utils - INFO - Initialized Ensemble Detector with method: majority
2025-12-09 14:52:05 - utils - INFO - 
================================================================================
                            ENSEMBLE SYSTEM PIPELINE                            
================================================================================

2025-12-09 14:52:05 - utils - INFO - Loading predictions from individual models...
2025-12-09 14:52:05 - utils - INFO - Loaded isolation_forest predictions: 1000 samples
2025-12-09 14:52:05 - utils - INFO - Loaded lstm_autoencoder predictions: 32531 samples
2025-12-09 14:52:05 - utils - INFO - Loaded deep_clustering predictions: 1000 samples
2025-12-09 14:52:05 - utils - WARNING - Models have different sample counts: {'isolation_forest': 1000, 'lstm_autoencoder': 32531, 'deep_clustering': 1000}
2025-12-09 14:52:05 - utils - INFO - Will use aggregation strategy to align predictions...
2025-12-09 14:52:05 - utils - INFO - Aligning predictions across models...
2025-12-09 14:52:05 - utils - INFO - Using isolation_forest as reference (1000 samples)
2025-12-09 14:52:05 - utils - INFO - Aggregating lstm_autoencoder from 32531 to 1000 samples
2025-12-09 14:52:05 - utils - INFO - Predictions aligned successfully
2025-12-09 14:52:05 - utils - INFO - Loaded predictions from 3 models
2025-12-09 14:52:05 - utils - INFO - Computing majority voting ensemble...
2025-12-09 14:52:05 - utils - INFO - Majority voting: 11 anomalies detected
2025-12-09 14:52:05 - utils - INFO - Evaluating ensemble performance...
2025-12-09 14:52:05 - utils - INFO - 
============================================================
2025-12-09 14:52:05 - utils - INFO - Ensemble (majority) Performance Metrics
2025-12-09 14:52:05 - utils - INFO - ============================================================
2025-12-09 14:52:05 - utils - INFO - Accuracy:  0.9880
2025-12-09 14:52:05 - utils - INFO - Precision: 0.0000
2025-12-09 14:52:05 - utils - INFO - Recall:    0.0000
2025-12-09 14:52:05 - utils - INFO - F1-Score:  0.0000
2025-12-09 14:52:05 - utils - INFO - AUC-ROC:   0.8018
2025-12-09 14:52:05 - utils - INFO - ============================================================

2025-12-09 14:52:05 - utils - INFO - Comparing ensemble with individual models...
2025-12-09 14:52:05 - utils - INFO - Evaluating ensemble performance...
2025-12-09 14:52:05 - utils - INFO - 
============================================================
2025-12-09 14:52:05 - utils - INFO - Ensemble (majority) Performance Metrics
2025-12-09 14:52:05 - utils - INFO - ============================================================
2025-12-09 14:52:05 - utils - INFO - Accuracy:  0.9880
2025-12-09 14:52:05 - utils - INFO - Precision: 0.0000
2025-12-09 14:52:05 - utils - INFO - Recall:    0.0000
2025-12-09 14:52:05 - utils - INFO - F1-Score:  0.0000
2025-12-09 14:52:05 - utils - INFO - AUC-ROC:   0.8018
2025-12-09 14:52:05 - utils - INFO - ============================================================

2025-12-09 14:52:05 - utils - INFO - 
Comparison Results:
2025-12-09 14:52:05 - utils - INFO - 
              model  accuracy  precision  recall  f1_score  auc_roc
   Isolation Forest     0.945        0.0     0.0       0.0   0.8208
   Lstm Autoencoder     0.946        0.0     0.0       0.0   0.1842
    Deep Clustering     0.959        0.0     0.0       0.0   0.7407
Ensemble (majority)     0.988        0.0     0.0       0.0   0.8018
2025-12-09 14:52:05 - utils - INFO - Ensemble predictions saved
2025-12-09 14:52:05 - utils - INFO - Generating alerts...
2025-12-09 14:52:05 - utils - ERROR - Error with majority ensemble: 'severity'
2025-12-09 14:52:05 - utils - INFO - Initialized Ensemble Detector with method: cascade
2025-12-09 14:52:05 - utils - INFO - 
================================================================================
                            ENSEMBLE SYSTEM PIPELINE                            
================================================================================

2025-12-09 14:52:05 - utils - INFO - Loading predictions from individual models...
2025-12-09 14:52:05 - utils - INFO - Loaded isolation_forest predictions: 1000 samples
2025-12-09 14:52:05 - utils - INFO - Loaded lstm_autoencoder predictions: 32531 samples
2025-12-09 14:52:05 - utils - INFO - Loaded deep_clustering predictions: 1000 samples
2025-12-09 14:52:05 - utils - WARNING - Models have different sample counts: {'isolation_forest': 1000, 'lstm_autoencoder': 32531, 'deep_clustering': 1000}
2025-12-09 14:52:05 - utils - INFO - Will use aggregation strategy to align predictions...
2025-12-09 14:52:05 - utils - INFO - Aligning predictions across models...
2025-12-09 14:52:05 - utils - INFO - Using isolation_forest as reference (1000 samples)
2025-12-09 14:52:05 - utils - INFO - Aggregating lstm_autoencoder from 32531 to 1000 samples
2025-12-09 14:52:05 - utils - INFO - Predictions aligned successfully
2025-12-09 14:52:05 - utils - INFO - Loaded predictions from 3 models
2025-12-09 14:52:05 - utils - INFO - Computing cascade ensemble...
2025-12-09 14:52:05 - utils - INFO - Cascade ensemble: 0 anomalies detected
2025-12-09 14:52:05 - utils - INFO - Evaluating ensemble performance...
2025-12-09 14:52:05 - utils - INFO - 
============================================================
2025-12-09 14:52:05 - utils - INFO - Ensemble (cascade) Performance Metrics
2025-12-09 14:52:05 - utils - INFO - ============================================================
2025-12-09 14:52:05 - utils - INFO - Accuracy:  0.9990
2025-12-09 14:52:05 - utils - INFO - Precision: 0.0000
2025-12-09 14:52:05 - utils - INFO - Recall:    0.0000
2025-12-09 14:52:05 - utils - INFO - F1-Score:  0.0000
2025-12-09 14:52:05 - utils - INFO - AUC-ROC:   0.7067
2025-12-09 14:52:05 - utils - INFO - ============================================================

2025-12-09 14:52:05 - utils - INFO - Comparing ensemble with individual models...
2025-12-09 14:52:05 - utils - INFO - Evaluating ensemble performance...
2025-12-09 14:52:05 - utils - INFO - 
============================================================
2025-12-09 14:52:05 - utils - INFO - Ensemble (cascade) Performance Metrics
2025-12-09 14:52:05 - utils - INFO - ============================================================
2025-12-09 14:52:05 - utils - INFO - Accuracy:  0.9990
2025-12-09 14:52:05 - utils - INFO - Precision: 0.0000
2025-12-09 14:52:05 - utils - INFO - Recall:    0.0000
2025-12-09 14:52:05 - utils - INFO - F1-Score:  0.0000
2025-12-09 14:52:05 - utils - INFO - AUC-ROC:   0.7067
2025-12-09 14:52:05 - utils - INFO - ============================================================

2025-12-09 14:52:05 - utils - INFO - 
Comparison Results:
2025-12-09 14:52:05 - utils - INFO - 
             model  accuracy  precision  recall  f1_score  auc_roc
  Isolation Forest     0.945        0.0     0.0       0.0   0.8208
  Lstm Autoencoder     0.946        0.0     0.0       0.0   0.1842
   Deep Clustering     0.959        0.0     0.0       0.0   0.7407
Ensemble (cascade)     0.999        0.0     0.0       0.0   0.7067
2025-12-09 14:52:05 - utils - INFO - Ensemble predictions saved
2025-12-09 14:52:05 - utils - INFO - Generating alerts...
2025-12-09 14:52:05 - utils - INFO - Generated 35 alerts
2025-12-09 14:52:05 - utils - INFO - Severity distribution:
severity
low         22
high         5
medium       5
critical     3
Name: count, dtype: int64
2025-12-09 14:52:05 - utils - INFO - Alerts saved to /Users/bipinrimal/Downloads/Thesis_work/results/alerts.csv
2025-12-09 14:52:05 - utils - INFO - Ensemble pipeline completed!
2025-12-09 14:52:05 - utils - INFO - 
✓ Stage 5 completed: Best ensemble method = None (F1=0.0000)
2025-12-09 14:52:05 - utils - INFO - 
================================================================================
                             STAGE 6: VISUALIZATION                             
================================================================================

2025-12-09 14:52:05 - utils - INFO - 
================================================================================
                           GENERATING VISUALIZATIONS                            
================================================================================

2025-12-09 14:52:05 - utils - INFO - Creating alert severity distribution plot...
2025-12-09 14:52:05 - utils - INFO - Alert severity distribution plot saved
2025-12-09 14:52:05 - utils - INFO - Creating model agreement plot...
2025-12-09 14:52:05 - utils - INFO - Model agreement plot saved
2025-12-09 14:52:05 - utils - INFO - Creating anomaly score timeline for ensemble_weighted...
2025-12-09 14:52:05 - utils - INFO - Anomaly score timeline saved for ensemble_weighted
2025-12-09 14:52:05 - utils - INFO - Creating feature importance visualization...
2025-12-09 14:52:05 - utils - INFO - Feature importance heatmap saved
2025-12-09 14:52:05 - utils - INFO - Creating executive summary chart...
2025-12-09 14:52:05 - utils - INFO - Executive summary chart saved
2025-12-09 14:52:05 - utils - INFO - All visualizations saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations
2025-12-09 14:52:05 - utils - INFO - Visualization generation completed!
2025-12-09 14:52:05 - utils - INFO - ✓ Stage 6 completed: All visualizations generated
2025-12-09 14:52:05 - utils - INFO - 
================================================================================
2025-12-09 14:52:05 - utils - INFO - FINAL SUMMARY
2025-12-09 14:52:05 - utils - INFO - ================================================================================
2025-12-09 14:52:05 - utils - INFO - 
Model Performance:
2025-12-09 14:52:05 - utils - INFO - 
Lstm Autoencoder:
2025-12-09 14:52:05 - utils - WARNING -   No metrics available for this model.
2025-12-09 14:52:05 - utils - INFO - 
Deep Clustering:
2025-12-09 14:52:05 - utils - WARNING -   No metrics available for this model.
2025-12-09 14:52:05 - utils - INFO - 
Generated Output Files:
2025-12-09 14:52:05 - utils - INFO -   - Processed Data: /Users/bipinrimal/Downloads/Thesis_work/data/processed
2025-12-09 14:52:05 - utils - INFO -   - Trained Models: /Users/bipinrimal/Downloads/Thesis_work/models
2025-12-09 14:52:05 - utils - INFO -   - Results & Metrics: /Users/bipinrimal/Downloads/Thesis_work/results
2025-12-09 14:52:05 - utils - INFO -   - Visualizations: /Users/bipinrimal/Downloads/Thesis_work/results/visualizations
2025-12-09 14:52:05 - utils - INFO -   - Alerts: /Users/bipinrimal/Downloads/Thesis_work/results/alerts.csv
2025-12-09 14:52:05 - utils - INFO -   - Logs: /Users/bipinrimal/Downloads/Thesis_work/logs/insider_threat_detection.log
2025-12-09 14:52:05 - utils - INFO - 
================================================================================

2025-12-09 14:52:05 - utils - INFO - 
================================================================================
2025-12-09 14:52:05 - utils - INFO - ✓ PIPELINE EXECUTION COMPLETED SUCCESSFULLY
2025-12-09 14:52:05 - utils - INFO - ================================================================================

2025-12-09 15:07:57 - utils - INFO - Utility functions loaded successfully
2025-12-09 15:08:02 - utils - INFO - ================================================================================
2025-12-09 15:08:02 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-12-09 15:08:02 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-12-09 15:08:02 - utils - INFO - ================================================================================
2025-12-09 15:08:02 - utils - INFO - 
================================================================================
2025-12-09 15:08:02 - utils - INFO - STARTING FULL PIPELINE EXECUTION
2025-12-09 15:08:02 - utils - INFO - ================================================================================

2025-12-09 15:08:02 - utils - INFO - 
================================================================================
                          STAGE 1: DATA PREPROCESSING                           
================================================================================

2025-12-09 15:08:02 - utils - INFO - Processing SUBSET defined in config: ['r1', 'r2', 'r3.1', 'r3.2', 'r4.1', 'r4.2']
2025-12-09 15:08:02 - utils - INFO - 
================================================================================
                          DATA PREPROCESSING (POLARS)                           
================================================================================

2025-12-09 15:08:02 - utils - INFO - Scanning dataset: r1
2025-12-09 15:08:02 - utils - INFO - Scanning dataset: r2
2025-12-09 15:08:02 - utils - INFO - Scanning dataset: r3.1
2025-12-09 15:08:02 - utils - INFO - Scanning dataset: r3.2
2025-12-09 15:08:02 - utils - INFO - Scanning dataset: r4.1
2025-12-09 15:08:02 - utils - INFO - Scanning dataset: r4.2
2025-12-09 15:08:02 - utils - INFO - Constructing execution graph (Diagonal Concat)...
2025-12-09 15:08:02 - utils - INFO - Loaded Psychometric data: 4998 users
2025-12-09 15:08:02 - utils - INFO - Streaming merged data to /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv...
2025-12-09 15:11:37 - utils - INFO - ✓ Preprocessing complete.
2025-12-09 15:11:37 - utils - INFO - ✓ Stage 1 completed: check output file.
2025-12-09 15:11:37 - utils - INFO - 
================================================================================
                          STAGE 2: FEATURE ENGINEERING                          
================================================================================

2025-12-09 15:11:37 - utils - INFO - Aggregating daily features...
2025-12-09 15:14:29 - utils - INFO - Daily aggregation complete: 8998 rows
2025-12-09 15:14:29 - utils - INFO - Calculating Z-scores...
2025-12-09 15:14:29 - utils - INFO - Creating static features...
2025-12-09 15:14:29 - utils - INFO - Saved static features: /Users/bipinrimal/Downloads/Thesis_work/data/processed/static_features_r1_r2_r3.1_r3.2_r4.1_r4.2_polars.csv
2025-12-09 15:14:29 - utils - INFO - Creating sequences...
2025-12-09 15:14:34 - utils - WARNING - No sequences created (insufficent data length per user?)
2025-12-09 15:14:34 - utils - INFO - Feature engineering complete.
2025-12-09 15:14:34 - utils - INFO - ✓ Stage 2 completed: Polars pipeline finished.
2025-12-09 15:14:34 - utils - INFO - 
================================================================================
                            STAGE 3: MODEL TRAINING                             
================================================================================

2025-12-09 15:14:34 - utils - INFO - 
>>> Training Isolation Forest...
2025-12-09 15:14:34 - utils - INFO - 
================================================================================
                 ISOLATION FOREST TRAINING (V2: MULTI-DATASET)                  
================================================================================

2025-12-09 15:14:34 - utils - ERROR - ✗ Isolation Forest training failed: 'static_scaler_v2'
2025-12-09 15:14:34 - utils - INFO - 
>>> Training LSTM Autoencoder...
2025-12-09 15:14:34 - utils - INFO - 
================================================================================
                     LIGHTWEIGHT LSTM AUTOENCODER TRAINING                      
================================================================================

2025-12-09 15:14:34 - utils - ERROR - Sequence data not found. Run feature_engineering.py first.
2025-12-09 15:14:34 - utils - INFO - ✓ LSTM Autoencoder training completed
2025-12-09 15:14:34 - utils - INFO - 
>>> Training Deep Clustering...
2025-12-09 15:14:34 - utils - INFO - 
================================================================================
                      LIGHTWEIGHT DEEP CLUSTERING TRAINING                      
================================================================================

2025-12-09 15:14:34 - utils - ERROR - engineered_static_features.csv not found. Run feature_engineering.py first.
2025-12-09 15:14:34 - utils - INFO - ✓ Deep Clustering training completed
2025-12-09 15:14:34 - utils - INFO - 
✓ Stage 3 completed: 2 models trained
2025-12-09 15:14:34 - utils - INFO - 
================================================================================
                           STAGE 4: MODEL EVALUATION                            
================================================================================

2025-12-09 15:14:34 - utils - INFO - 
================================================================================
                         COMPREHENSIVE MODEL EVALUATION                         
================================================================================

2025-12-09 15:14:34 - utils - INFO - Loading results for all models...
2025-12-09 15:14:34 - utils - INFO - Loaded results for isolation_forest
2025-12-09 15:14:34 - utils - INFO - Loaded results for lstm_autoencoder
2025-12-09 15:14:34 - utils - INFO - Loaded results for deep_clustering
2025-12-09 15:14:34 - utils - INFO - Loaded results for 3 models
2025-12-09 15:14:34 - utils - INFO - Creating metrics comparison table...
2025-12-09 15:14:34 - utils - INFO - Metrics comparison table created
2025-12-09 15:14:34 - utils - INFO - Creating confusion matrix plots...
2025-12-09 15:14:35 - utils - INFO - Confusion matrices saved to /Users/bipinrimal/Downloads/Thesis_work/results/confusion_matrices/all_models.png
2025-12-09 15:14:35 - utils - INFO - Creating ROC curves...
2025-12-09 15:14:35 - utils - INFO - ROC curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/roc_curves/roc_comparison.png
2025-12-09 15:14:35 - utils - INFO - Creating Precision-Recall curves...
2025-12-09 15:14:35 - utils - INFO - Precision-Recall curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/precision_recall_comparison.png
2025-12-09 15:14:35 - utils - INFO - Creating metrics comparison bar chart...
2025-12-09 15:14:35 - utils - INFO - Metrics comparison bar chart saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/metrics_comparison_bar.png
2025-12-09 15:14:35 - utils - INFO - Creating anomaly score distribution plots...
2025-12-09 15:14:35 - utils - INFO - Score distributions saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/score_distributions.png
2025-12-09 15:14:35 - utils - INFO - Generating evaluation report...
2025-12-09 15:14:35 - utils - INFO - Evaluation report saved to /Users/bipinrimal/Downloads/Thesis_work/results/evaluation_report.txt
2025-12-09 15:14:35 - utils - INFO - Comprehensive evaluation completed!
2025-12-09 15:14:35 - utils - INFO - ✓ Stage 4 completed: Comprehensive evaluation report generated
2025-12-09 15:14:35 - utils - INFO - 
================================================================================
                         STAGE 5: ENSEMBLE INTEGRATION                          
================================================================================

2025-12-09 15:14:35 - utils - INFO - Initialized Ensemble Detector with method: weighted
2025-12-09 15:14:35 - utils - INFO - 
================================================================================
                            ENSEMBLE SYSTEM PIPELINE                            
================================================================================

2025-12-09 15:14:35 - utils - INFO - Loading predictions from individual models...
2025-12-09 15:14:35 - utils - INFO - Loaded isolation_forest predictions: 1000 samples
2025-12-09 15:14:35 - utils - INFO - Loaded lstm_autoencoder predictions: 32531 samples
2025-12-09 15:14:35 - utils - INFO - Loaded deep_clustering predictions: 1000 samples
2025-12-09 15:14:35 - utils - WARNING - Models have different sample counts: {'isolation_forest': 1000, 'lstm_autoencoder': 32531, 'deep_clustering': 1000}
2025-12-09 15:14:35 - utils - INFO - Will use aggregation strategy to align predictions...
2025-12-09 15:14:35 - utils - INFO - Aligning predictions across models...
2025-12-09 15:14:35 - utils - INFO - Using isolation_forest as reference (1000 samples)
2025-12-09 15:14:35 - utils - INFO - Aggregating lstm_autoencoder from 32531 to 1000 samples
2025-12-09 15:14:35 - utils - INFO - Predictions aligned successfully
2025-12-09 15:14:35 - utils - INFO - Loaded predictions from 3 models
2025-12-09 15:14:35 - utils - INFO - Computing weighted ensemble...
2025-12-09 15:14:35 - utils - INFO - Weighted ensemble: 0 anomalies detected
2025-12-09 15:14:35 - utils - INFO - Evaluating ensemble performance...
2025-12-09 15:14:35 - utils - INFO - 
============================================================
2025-12-09 15:14:35 - utils - INFO - Ensemble (weighted) Performance Metrics
2025-12-09 15:14:35 - utils - INFO - ============================================================
2025-12-09 15:14:35 - utils - INFO - Accuracy:  0.9990
2025-12-09 15:14:35 - utils - INFO - Precision: 0.0000
2025-12-09 15:14:35 - utils - INFO - Recall:    0.0000
2025-12-09 15:14:35 - utils - INFO - F1-Score:  0.0000
2025-12-09 15:14:35 - utils - INFO - AUC-ROC:   0.7978
2025-12-09 15:14:35 - utils - INFO - ============================================================

2025-12-09 15:14:35 - utils - INFO - Comparing ensemble with individual models...
2025-12-09 15:14:35 - utils - INFO - Evaluating ensemble performance...
2025-12-09 15:14:35 - utils - INFO - 
============================================================
2025-12-09 15:14:35 - utils - INFO - Ensemble (weighted) Performance Metrics
2025-12-09 15:14:35 - utils - INFO - ============================================================
2025-12-09 15:14:35 - utils - INFO - Accuracy:  0.9990
2025-12-09 15:14:35 - utils - INFO - Precision: 0.0000
2025-12-09 15:14:35 - utils - INFO - Recall:    0.0000
2025-12-09 15:14:35 - utils - INFO - F1-Score:  0.0000
2025-12-09 15:14:35 - utils - INFO - AUC-ROC:   0.7978
2025-12-09 15:14:35 - utils - INFO - ============================================================

2025-12-09 15:14:35 - utils - INFO - 
Comparison Results:
2025-12-09 15:14:35 - utils - INFO - 
              model  accuracy  precision  recall  f1_score  auc_roc
   Isolation Forest     0.945        0.0     0.0       0.0   0.8208
   Lstm Autoencoder     0.946        0.0     0.0       0.0   0.1842
    Deep Clustering     0.959        0.0     0.0       0.0   0.7407
Ensemble (weighted)     0.999        0.0     0.0       0.0   0.7978
2025-12-09 15:14:35 - utils - INFO - Ensemble predictions saved
2025-12-09 15:14:35 - utils - INFO - Generating alerts...
2025-12-09 15:14:35 - utils - ERROR - Error with weighted ensemble: 'severity'
2025-12-09 15:14:35 - utils - INFO - Initialized Ensemble Detector with method: majority
2025-12-09 15:14:35 - utils - INFO - 
================================================================================
                            ENSEMBLE SYSTEM PIPELINE                            
================================================================================

2025-12-09 15:14:35 - utils - INFO - Loading predictions from individual models...
2025-12-09 15:14:35 - utils - INFO - Loaded isolation_forest predictions: 1000 samples
2025-12-09 15:14:35 - utils - INFO - Loaded lstm_autoencoder predictions: 32531 samples
2025-12-09 15:14:35 - utils - INFO - Loaded deep_clustering predictions: 1000 samples
2025-12-09 15:14:35 - utils - WARNING - Models have different sample counts: {'isolation_forest': 1000, 'lstm_autoencoder': 32531, 'deep_clustering': 1000}
2025-12-09 15:14:35 - utils - INFO - Will use aggregation strategy to align predictions...
2025-12-09 15:14:35 - utils - INFO - Aligning predictions across models...
2025-12-09 15:14:35 - utils - INFO - Using isolation_forest as reference (1000 samples)
2025-12-09 15:14:35 - utils - INFO - Aggregating lstm_autoencoder from 32531 to 1000 samples
2025-12-09 15:14:35 - utils - INFO - Predictions aligned successfully
2025-12-09 15:14:35 - utils - INFO - Loaded predictions from 3 models
2025-12-09 15:14:35 - utils - INFO - Computing majority voting ensemble...
2025-12-09 15:14:35 - utils - INFO - Majority voting: 11 anomalies detected
2025-12-09 15:14:35 - utils - INFO - Evaluating ensemble performance...
2025-12-09 15:14:35 - utils - INFO - 
============================================================
2025-12-09 15:14:35 - utils - INFO - Ensemble (majority) Performance Metrics
2025-12-09 15:14:35 - utils - INFO - ============================================================
2025-12-09 15:14:35 - utils - INFO - Accuracy:  0.9880
2025-12-09 15:14:35 - utils - INFO - Precision: 0.0000
2025-12-09 15:14:35 - utils - INFO - Recall:    0.0000
2025-12-09 15:14:35 - utils - INFO - F1-Score:  0.0000
2025-12-09 15:14:35 - utils - INFO - AUC-ROC:   0.8018
2025-12-09 15:14:35 - utils - INFO - ============================================================

2025-12-09 15:14:35 - utils - INFO - Comparing ensemble with individual models...
2025-12-09 15:14:35 - utils - INFO - Evaluating ensemble performance...
2025-12-09 15:14:35 - utils - INFO - 
============================================================
2025-12-09 15:14:35 - utils - INFO - Ensemble (majority) Performance Metrics
2025-12-09 15:14:35 - utils - INFO - ============================================================
2025-12-09 15:14:35 - utils - INFO - Accuracy:  0.9880
2025-12-09 15:14:35 - utils - INFO - Precision: 0.0000
2025-12-09 15:14:35 - utils - INFO - Recall:    0.0000
2025-12-09 15:14:35 - utils - INFO - F1-Score:  0.0000
2025-12-09 15:14:35 - utils - INFO - AUC-ROC:   0.8018
2025-12-09 15:14:35 - utils - INFO - ============================================================

2025-12-09 15:14:35 - utils - INFO - 
Comparison Results:
2025-12-09 15:14:35 - utils - INFO - 
              model  accuracy  precision  recall  f1_score  auc_roc
   Isolation Forest     0.945        0.0     0.0       0.0   0.8208
   Lstm Autoencoder     0.946        0.0     0.0       0.0   0.1842
    Deep Clustering     0.959        0.0     0.0       0.0   0.7407
Ensemble (majority)     0.988        0.0     0.0       0.0   0.8018
2025-12-09 15:14:35 - utils - INFO - Ensemble predictions saved
2025-12-09 15:14:35 - utils - INFO - Generating alerts...
2025-12-09 15:14:35 - utils - ERROR - Error with majority ensemble: 'severity'
2025-12-09 15:14:35 - utils - INFO - Initialized Ensemble Detector with method: cascade
2025-12-09 15:14:35 - utils - INFO - 
================================================================================
                            ENSEMBLE SYSTEM PIPELINE                            
================================================================================

2025-12-09 15:14:35 - utils - INFO - Loading predictions from individual models...
2025-12-09 15:14:35 - utils - INFO - Loaded isolation_forest predictions: 1000 samples
2025-12-09 15:14:35 - utils - INFO - Loaded lstm_autoencoder predictions: 32531 samples
2025-12-09 15:14:35 - utils - INFO - Loaded deep_clustering predictions: 1000 samples
2025-12-09 15:14:35 - utils - WARNING - Models have different sample counts: {'isolation_forest': 1000, 'lstm_autoencoder': 32531, 'deep_clustering': 1000}
2025-12-09 15:14:35 - utils - INFO - Will use aggregation strategy to align predictions...
2025-12-09 15:14:35 - utils - INFO - Aligning predictions across models...
2025-12-09 15:14:35 - utils - INFO - Using isolation_forest as reference (1000 samples)
2025-12-09 15:14:35 - utils - INFO - Aggregating lstm_autoencoder from 32531 to 1000 samples
2025-12-09 15:14:35 - utils - INFO - Predictions aligned successfully
2025-12-09 15:14:35 - utils - INFO - Loaded predictions from 3 models
2025-12-09 15:14:35 - utils - INFO - Computing cascade ensemble...
2025-12-09 15:14:35 - utils - INFO - Cascade ensemble: 0 anomalies detected
2025-12-09 15:14:35 - utils - INFO - Evaluating ensemble performance...
2025-12-09 15:14:35 - utils - INFO - 
============================================================
2025-12-09 15:14:35 - utils - INFO - Ensemble (cascade) Performance Metrics
2025-12-09 15:14:35 - utils - INFO - ============================================================
2025-12-09 15:14:35 - utils - INFO - Accuracy:  0.9990
2025-12-09 15:14:35 - utils - INFO - Precision: 0.0000
2025-12-09 15:14:35 - utils - INFO - Recall:    0.0000
2025-12-09 15:14:35 - utils - INFO - F1-Score:  0.0000
2025-12-09 15:14:35 - utils - INFO - AUC-ROC:   0.7067
2025-12-09 15:14:35 - utils - INFO - ============================================================

2025-12-09 15:14:35 - utils - INFO - Comparing ensemble with individual models...
2025-12-09 15:14:35 - utils - INFO - Evaluating ensemble performance...
2025-12-09 15:14:35 - utils - INFO - 
============================================================
2025-12-09 15:14:35 - utils - INFO - Ensemble (cascade) Performance Metrics
2025-12-09 15:14:35 - utils - INFO - ============================================================
2025-12-09 15:14:35 - utils - INFO - Accuracy:  0.9990
2025-12-09 15:14:35 - utils - INFO - Precision: 0.0000
2025-12-09 15:14:35 - utils - INFO - Recall:    0.0000
2025-12-09 15:14:35 - utils - INFO - F1-Score:  0.0000
2025-12-09 15:14:35 - utils - INFO - AUC-ROC:   0.7067
2025-12-09 15:14:35 - utils - INFO - ============================================================

2025-12-09 15:14:35 - utils - INFO - 
Comparison Results:
2025-12-09 15:14:35 - utils - INFO - 
             model  accuracy  precision  recall  f1_score  auc_roc
  Isolation Forest     0.945        0.0     0.0       0.0   0.8208
  Lstm Autoencoder     0.946        0.0     0.0       0.0   0.1842
   Deep Clustering     0.959        0.0     0.0       0.0   0.7407
Ensemble (cascade)     0.999        0.0     0.0       0.0   0.7067
2025-12-09 15:14:35 - utils - INFO - Ensemble predictions saved
2025-12-09 15:14:35 - utils - INFO - Generating alerts...
2025-12-09 15:14:35 - utils - INFO - Generated 35 alerts
2025-12-09 15:14:35 - utils - INFO - Severity distribution:
severity
low         22
high         5
medium       5
critical     3
Name: count, dtype: int64
2025-12-09 15:14:35 - utils - INFO - Alerts saved to /Users/bipinrimal/Downloads/Thesis_work/results/alerts.csv
2025-12-09 15:14:35 - utils - INFO - Ensemble pipeline completed!
2025-12-09 15:14:35 - utils - INFO - 
✓ Stage 5 completed: Best ensemble method = None (F1=0.0000)
2025-12-09 15:14:35 - utils - INFO - 
================================================================================
                             STAGE 6: VISUALIZATION                             
================================================================================

2025-12-09 15:14:35 - utils - INFO - 
================================================================================
                           GENERATING VISUALIZATIONS                            
================================================================================

2025-12-09 15:14:35 - utils - INFO - Creating alert severity distribution plot...
2025-12-09 15:14:35 - utils - INFO - Alert severity distribution plot saved
2025-12-09 15:14:35 - utils - INFO - Creating model agreement plot...
2025-12-09 15:14:35 - utils - INFO - Model agreement plot saved
2025-12-09 15:14:35 - utils - INFO - Creating anomaly score timeline for ensemble_weighted...
2025-12-09 15:14:35 - utils - INFO - Anomaly score timeline saved for ensemble_weighted
2025-12-09 15:14:35 - utils - INFO - Creating feature importance visualization...
2025-12-09 15:14:36 - utils - INFO - Feature importance heatmap saved
2025-12-09 15:14:36 - utils - INFO - Creating executive summary chart...
2025-12-09 15:14:36 - utils - INFO - Executive summary chart saved
2025-12-09 15:14:36 - utils - INFO - All visualizations saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations
2025-12-09 15:14:36 - utils - INFO - Visualization generation completed!
2025-12-09 15:14:36 - utils - INFO - ✓ Stage 6 completed: All visualizations generated
2025-12-09 15:14:36 - utils - INFO - 
================================================================================
2025-12-09 15:14:36 - utils - INFO - FINAL SUMMARY
2025-12-09 15:14:36 - utils - INFO - ================================================================================
2025-12-09 15:14:36 - utils - INFO - 
Model Performance:
2025-12-09 15:14:36 - utils - INFO - 
Lstm Autoencoder:
2025-12-09 15:14:36 - utils - WARNING -   No metrics available for this model.
2025-12-09 15:14:36 - utils - INFO - 
Deep Clustering:
2025-12-09 15:14:36 - utils - WARNING -   No metrics available for this model.
2025-12-09 15:14:36 - utils - INFO - 
Generated Output Files:
2025-12-09 15:14:36 - utils - INFO -   - Processed Data: /Users/bipinrimal/Downloads/Thesis_work/data/processed
2025-12-09 15:14:36 - utils - INFO -   - Trained Models: /Users/bipinrimal/Downloads/Thesis_work/models
2025-12-09 15:14:36 - utils - INFO -   - Results & Metrics: /Users/bipinrimal/Downloads/Thesis_work/results
2025-12-09 15:14:36 - utils - INFO -   - Visualizations: /Users/bipinrimal/Downloads/Thesis_work/results/visualizations
2025-12-09 15:14:36 - utils - INFO -   - Alerts: /Users/bipinrimal/Downloads/Thesis_work/results/alerts.csv
2025-12-09 15:14:36 - utils - INFO -   - Logs: /Users/bipinrimal/Downloads/Thesis_work/logs/insider_threat_detection.log
2025-12-09 15:14:36 - utils - INFO - 
================================================================================

2025-12-09 15:14:36 - utils - INFO - 
================================================================================
2025-12-09 15:14:36 - utils - INFO - ✓ PIPELINE EXECUTION COMPLETED SUCCESSFULLY
2025-12-09 15:14:36 - utils - INFO - ================================================================================

2025-12-09 15:19:07 - utils - INFO - Utility functions loaded successfully
2025-12-09 15:19:10 - utils - INFO - ================================================================================
2025-12-09 15:19:10 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-12-09 15:19:10 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-12-09 15:19:10 - utils - INFO - ================================================================================
2025-12-09 15:19:10 - utils - INFO - 
================================================================================
2025-12-09 15:19:10 - utils - INFO - STARTING FULL PIPELINE EXECUTION
2025-12-09 15:19:10 - utils - INFO - ================================================================================

2025-12-09 15:19:10 - utils - INFO - 
================================================================================
                          STAGE 1: DATA PREPROCESSING                           
================================================================================

2025-12-09 15:19:10 - utils - INFO - Processing SUBSET defined in config: ['r1', 'r2', 'r3.1', 'r3.2', 'r4.1', 'r4.2', 'r5.1']
2025-12-09 15:19:10 - utils - INFO - 
================================================================================
                          DATA PREPROCESSING (POLARS)                           
================================================================================

2025-12-09 15:19:10 - utils - INFO - Scanning dataset: r1
2025-12-09 15:19:10 - utils - INFO - Scanning dataset: r2
2025-12-09 15:19:10 - utils - INFO - Scanning dataset: r3.1
2025-12-09 15:19:10 - utils - INFO - Scanning dataset: r3.2
2025-12-09 15:19:10 - utils - INFO - Scanning dataset: r4.1
2025-12-09 15:19:10 - utils - INFO - Scanning dataset: r4.2
2025-12-09 15:19:10 - utils - INFO - Scanning dataset: r5.1
2025-12-09 15:19:10 - utils - INFO - Constructing execution graph (Diagonal Concat)...
2025-12-09 15:19:10 - utils - INFO - Loaded Psychometric data: 6998 users
2025-12-09 15:19:10 - utils - ERROR - 
✗ PIPELINE EXECUTION FAILED: 'union'/'concat' inputs should all have the same schema,got
Schema:
name: id, field: String
name: date, field: Datetime('μs')
name: user_id, field: String
name: pc_id, field: String
name: activity, field: String
name: activity_type, field: String
name: dataset, field: String
name: is_logon, field: Int8
name: is_logoff, field: Int8
name: is_connect, field: Int8
name: is_disconnect, field: Int8
name: url, field: String
name: domain, field: String
name: is_suspicious_domain, field: Int8
name: to, field: String
name: email_size_kb, field: Float64
name: is_large_email, field: Int8
name: has_attachment, field: Int8
name: filename, field: String
name: content, field: String
name: file_extension, field: String
name: is_sensitive_file, field: Int8
name: size, field: Int64
name: attachments, field: Int64
name: cc, field: String
name: bcc, field: String
name: from, field: String
name: file_tree, field: String
name: to_removable_media, field: Boolean
name: from_removable_media, field: Boolean
 and 
Schema:
name: id, field: String
name: date, field: Datetime('μs')
name: user_id, field: String
name: pc_id, field: String
name: activity, field: String
name: activity_type, field: String
name: dataset, field: String
name: is_logon, field: Int8
name: is_logoff, field: Int8
name: is_connect, field: Int8
name: is_disconnect, field: Int8
name: url, field: String
name: domain, field: String
name: is_suspicious_domain, field: Int8
name: to, field: String
name: email_size_kb, field: Float64
name: is_large_email, field: Int8
name: has_attachment, field: Int8
name: filename, field: String
name: content, field: String
name: file_extension, field: String
name: is_sensitive_file, field: Int8
name: size, field: Int64
name: attachments, field: String
name: cc, field: String
name: bcc, field: String
name: from, field: String
name: file_tree, field: String
name: to_removable_media, field: Boolean
name: from_removable_media, field: Boolean


Resolved plan until failure:

	---> FAILED HERE RESOLVING 'join' <---
simple π 30/30 ["id", "date", "user_id", ... 27 other columns]
   WITH_COLUMNS:
   [null.alias("activity"), null.alias("is_logon"), null.alias("is_logoff"), null.alias("is_connect"), null.alias("is_disconnect"), null.alias("to"), null.alias("email_size_kb"), null.alias("is_large_email"), null.alias("has_attachment"), null.alias("filename"), null.alias("file_extension"), null.alias("is_sensitive_file"), null.alias("size"), null.alias("attachments"), null.alias("cc"), null.alias("bcc"), null.alias("from"), null.alias("file_tree"), null.alias("to_removable_media"), null.alias("from_removable_media")] 
     WITH_COLUMNS:
     [col("domain").str.to_lowercase().str.contains(["temp|anonymous|proxy|vpn|leak|hack"]).strict_cast(Int8).alias("is_suspicious_domain")] 
       WITH_COLUMNS:
       [col("url").str.extract(["https?://([^/]+)"]).alias("domain")] 
         WITH_COLUMNS:
         [col("date").str.strptime(["raise"])] 
           WITH_COLUMNS:
           ["http".alias("activity_type"), "r5.1".alias("dataset")] 
            SELECT [col("id"), col("date"), col("user_id"), col("pc").alias("pc_id"), col("url"), col("content")]
              SELECT [col("id"), col("date"), col("user").alias("user_id"), col("pc"), col("url"), col("content")]
                Csv SCAN [/Users/bipinrimal/Downloads/Thesis_work/data/all_data/r5.1/http.csv]
                PROJECT */6 COLUMNS
                ESTIMATED ROWS: 59858168
2025-12-09 15:19:43 - utils - INFO - Utility functions loaded successfully
2025-12-09 15:19:46 - utils - INFO - ================================================================================
2025-12-09 15:19:46 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-12-09 15:19:46 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-12-09 15:19:46 - utils - INFO - ================================================================================
2025-12-09 15:19:46 - utils - INFO - 
================================================================================
2025-12-09 15:19:46 - utils - INFO - STARTING FULL PIPELINE EXECUTION
2025-12-09 15:19:46 - utils - INFO - ================================================================================

2025-12-09 15:19:46 - utils - INFO - 
================================================================================
                          STAGE 1: DATA PREPROCESSING                           
================================================================================

2025-12-09 15:19:46 - utils - INFO - Processing SUBSET defined in config: ['r1', 'r2', 'r3.1', 'r3.2', 'r4.1', 'r4.2']
2025-12-09 15:19:46 - utils - INFO - 
================================================================================
                          DATA PREPROCESSING (POLARS)                           
================================================================================

2025-12-09 15:19:46 - utils - INFO - Scanning dataset: r1
2025-12-09 15:19:46 - utils - INFO - Scanning dataset: r2
2025-12-09 15:19:46 - utils - INFO - Scanning dataset: r3.1
2025-12-09 15:19:46 - utils - INFO - Scanning dataset: r3.2
2025-12-09 15:19:46 - utils - INFO - Scanning dataset: r4.1
2025-12-09 15:19:46 - utils - INFO - Scanning dataset: r4.2
2025-12-09 15:19:46 - utils - INFO - Constructing execution graph (Diagonal Concat)...
2025-12-09 15:19:46 - utils - INFO - Loaded Psychometric data: 4998 users
2025-12-09 15:19:46 - utils - INFO - Streaming merged data to /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv...
2025-12-09 15:22:57 - utils - INFO - ✓ Preprocessing complete.
2025-12-09 15:22:57 - utils - INFO - ✓ Stage 1 completed: check output file.
2025-12-09 15:22:57 - utils - INFO - 
================================================================================
                          STAGE 2: FEATURE ENGINEERING                          
================================================================================

2025-12-09 15:22:57 - utils - INFO - Aggregating daily features...
2025-12-09 15:25:25 - utils - INFO - Daily aggregation complete: 8998 rows
2025-12-09 15:25:25 - utils - INFO - Calculating Z-scores...
2025-12-09 15:25:25 - utils - INFO - Creating static features...
2025-12-09 15:25:25 - utils - INFO - Saved static features: /Users/bipinrimal/Downloads/Thesis_work/data/processed/static_features_r1_r2_r3.1_r3.2_r4.1_r4.2_polars.csv
2025-12-09 15:25:25 - utils - INFO - Creating sequences...
2025-12-09 15:25:30 - utils - WARNING - No sequences created (insufficent data length per user?)
2025-12-09 15:25:30 - utils - INFO - Feature engineering complete.
2025-12-09 15:25:30 - utils - INFO - ✓ Stage 2 completed: Polars pipeline finished.
2025-12-09 15:25:30 - utils - INFO - 
================================================================================
                            STAGE 3: MODEL TRAINING                             
================================================================================

2025-12-09 15:25:30 - utils - INFO - 
>>> Training Isolation Forest...
2025-12-09 15:25:30 - utils - INFO - 
================================================================================
                 ISOLATION FOREST TRAINING (V2: MULTI-DATASET)                  
================================================================================

2025-12-09 15:25:30 - utils - ERROR - ✗ Isolation Forest training failed: 'static_scaler_v2'
2025-12-09 15:25:30 - utils - INFO - 
>>> Training LSTM Autoencoder...
2025-12-09 15:25:30 - utils - INFO - 
================================================================================
                     LIGHTWEIGHT LSTM AUTOENCODER TRAINING                      
================================================================================

2025-12-09 15:25:30 - utils - ERROR - Sequence data not found. Run feature_engineering.py first.
2025-12-09 15:25:30 - utils - INFO - ✓ LSTM Autoencoder training completed
2025-12-09 15:25:30 - utils - INFO - 
>>> Training Deep Clustering...
2025-12-09 15:25:30 - utils - INFO - 
================================================================================
                      LIGHTWEIGHT DEEP CLUSTERING TRAINING                      
================================================================================

2025-12-09 15:25:30 - utils - ERROR - engineered_static_features.csv not found. Run feature_engineering.py first.
2025-12-09 15:25:30 - utils - INFO - ✓ Deep Clustering training completed
2025-12-09 15:25:30 - utils - INFO - 
✓ Stage 3 completed: 2 models trained
2025-12-09 15:25:30 - utils - INFO - 
================================================================================
                           STAGE 4: MODEL EVALUATION                            
================================================================================

2025-12-09 15:25:30 - utils - INFO - 
================================================================================
                         COMPREHENSIVE MODEL EVALUATION                         
================================================================================

2025-12-09 15:25:30 - utils - INFO - Loading results for all models...
2025-12-09 15:25:30 - utils - INFO - Loaded results for isolation_forest
2025-12-09 15:25:30 - utils - INFO - Loaded results for lstm_autoencoder
2025-12-09 15:25:30 - utils - INFO - Loaded results for deep_clustering
2025-12-09 15:25:30 - utils - INFO - Loaded results for 3 models
2025-12-09 15:25:30 - utils - INFO - Creating metrics comparison table...
2025-12-09 15:25:30 - utils - INFO - Metrics comparison table created
2025-12-09 15:25:30 - utils - INFO - Creating confusion matrix plots...
2025-12-09 15:25:31 - utils - INFO - Confusion matrices saved to /Users/bipinrimal/Downloads/Thesis_work/results/confusion_matrices/all_models.png
2025-12-09 15:25:31 - utils - INFO - Creating ROC curves...
2025-12-09 15:25:31 - utils - INFO - ROC curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/roc_curves/roc_comparison.png
2025-12-09 15:25:31 - utils - INFO - Creating Precision-Recall curves...
2025-12-09 15:25:31 - utils - INFO - Precision-Recall curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/precision_recall_comparison.png
2025-12-09 15:25:31 - utils - INFO - Creating metrics comparison bar chart...
2025-12-09 15:25:31 - utils - INFO - Metrics comparison bar chart saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/metrics_comparison_bar.png
2025-12-09 15:25:31 - utils - INFO - Creating anomaly score distribution plots...
2025-12-09 15:25:31 - utils - INFO - Score distributions saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/score_distributions.png
2025-12-09 15:25:31 - utils - INFO - Generating evaluation report...
2025-12-09 15:25:31 - utils - INFO - Evaluation report saved to /Users/bipinrimal/Downloads/Thesis_work/results/evaluation_report.txt
2025-12-09 15:25:31 - utils - INFO - Comprehensive evaluation completed!
2025-12-09 15:25:31 - utils - INFO - ✓ Stage 4 completed: Comprehensive evaluation report generated
2025-12-09 15:25:31 - utils - INFO - 
================================================================================
                         STAGE 5: ENSEMBLE INTEGRATION                          
================================================================================

2025-12-09 15:25:31 - utils - INFO - Initialized Ensemble Detector with method: weighted
2025-12-09 15:25:31 - utils - INFO - 
================================================================================
                            ENSEMBLE SYSTEM PIPELINE                            
================================================================================

2025-12-09 15:25:31 - utils - INFO - Loading predictions from individual models...
2025-12-09 15:25:31 - utils - INFO - Loaded isolation_forest predictions: 1000 samples
2025-12-09 15:25:31 - utils - INFO - Loaded lstm_autoencoder predictions: 32531 samples
2025-12-09 15:25:31 - utils - INFO - Loaded deep_clustering predictions: 1000 samples
2025-12-09 15:25:31 - utils - WARNING - Models have different sample counts: {'isolation_forest': 1000, 'lstm_autoencoder': 32531, 'deep_clustering': 1000}
2025-12-09 15:25:31 - utils - INFO - Will use aggregation strategy to align predictions...
2025-12-09 15:25:31 - utils - INFO - Aligning predictions across models...
2025-12-09 15:25:31 - utils - INFO - Using isolation_forest as reference (1000 samples)
2025-12-09 15:25:31 - utils - INFO - Aggregating lstm_autoencoder from 32531 to 1000 samples
2025-12-09 15:25:31 - utils - INFO - Predictions aligned successfully
2025-12-09 15:25:31 - utils - INFO - Loaded predictions from 3 models
2025-12-09 15:25:31 - utils - INFO - Computing weighted ensemble...
2025-12-09 15:25:31 - utils - INFO - Weighted ensemble: 0 anomalies detected
2025-12-09 15:25:31 - utils - INFO - Evaluating ensemble performance...
2025-12-09 15:25:31 - utils - INFO - 
============================================================
2025-12-09 15:25:31 - utils - INFO - Ensemble (weighted) Performance Metrics
2025-12-09 15:25:31 - utils - INFO - ============================================================
2025-12-09 15:25:31 - utils - INFO - Accuracy:  0.9990
2025-12-09 15:25:31 - utils - INFO - Precision: 0.0000
2025-12-09 15:25:31 - utils - INFO - Recall:    0.0000
2025-12-09 15:25:31 - utils - INFO - F1-Score:  0.0000
2025-12-09 15:25:31 - utils - INFO - AUC-ROC:   0.7978
2025-12-09 15:25:31 - utils - INFO - ============================================================

2025-12-09 15:25:31 - utils - INFO - Comparing ensemble with individual models...
2025-12-09 15:25:31 - utils - INFO - Evaluating ensemble performance...
2025-12-09 15:25:31 - utils - INFO - 
============================================================
2025-12-09 15:25:31 - utils - INFO - Ensemble (weighted) Performance Metrics
2025-12-09 15:25:31 - utils - INFO - ============================================================
2025-12-09 15:25:31 - utils - INFO - Accuracy:  0.9990
2025-12-09 15:25:31 - utils - INFO - Precision: 0.0000
2025-12-09 15:25:31 - utils - INFO - Recall:    0.0000
2025-12-09 15:25:31 - utils - INFO - F1-Score:  0.0000
2025-12-09 15:25:31 - utils - INFO - AUC-ROC:   0.7978
2025-12-09 15:25:31 - utils - INFO - ============================================================

2025-12-09 15:25:31 - utils - INFO - 
Comparison Results:
2025-12-09 15:25:31 - utils - INFO - 
              model  accuracy  precision  recall  f1_score  auc_roc
   Isolation Forest     0.945        0.0     0.0       0.0   0.8208
   Lstm Autoencoder     0.946        0.0     0.0       0.0   0.1842
    Deep Clustering     0.959        0.0     0.0       0.0   0.7407
Ensemble (weighted)     0.999        0.0     0.0       0.0   0.7978
2025-12-09 15:25:31 - utils - INFO - Ensemble predictions saved
2025-12-09 15:25:31 - utils - INFO - Generating alerts...
2025-12-09 15:25:31 - utils - ERROR - Error with weighted ensemble: 'severity'
2025-12-09 15:25:31 - utils - INFO - Initialized Ensemble Detector with method: majority
2025-12-09 15:25:31 - utils - INFO - 
================================================================================
                            ENSEMBLE SYSTEM PIPELINE                            
================================================================================

2025-12-09 15:25:31 - utils - INFO - Loading predictions from individual models...
2025-12-09 15:25:31 - utils - INFO - Loaded isolation_forest predictions: 1000 samples
2025-12-09 15:25:31 - utils - INFO - Loaded lstm_autoencoder predictions: 32531 samples
2025-12-09 15:25:31 - utils - INFO - Loaded deep_clustering predictions: 1000 samples
2025-12-09 15:25:31 - utils - WARNING - Models have different sample counts: {'isolation_forest': 1000, 'lstm_autoencoder': 32531, 'deep_clustering': 1000}
2025-12-09 15:25:31 - utils - INFO - Will use aggregation strategy to align predictions...
2025-12-09 15:25:31 - utils - INFO - Aligning predictions across models...
2025-12-09 15:25:31 - utils - INFO - Using isolation_forest as reference (1000 samples)
2025-12-09 15:25:31 - utils - INFO - Aggregating lstm_autoencoder from 32531 to 1000 samples
2025-12-09 15:25:31 - utils - INFO - Predictions aligned successfully
2025-12-09 15:25:31 - utils - INFO - Loaded predictions from 3 models
2025-12-09 15:25:31 - utils - INFO - Computing majority voting ensemble...
2025-12-09 15:25:31 - utils - INFO - Majority voting: 11 anomalies detected
2025-12-09 15:25:31 - utils - INFO - Evaluating ensemble performance...
2025-12-09 15:25:31 - utils - INFO - 
============================================================
2025-12-09 15:25:31 - utils - INFO - Ensemble (majority) Performance Metrics
2025-12-09 15:25:31 - utils - INFO - ============================================================
2025-12-09 15:25:31 - utils - INFO - Accuracy:  0.9880
2025-12-09 15:25:31 - utils - INFO - Precision: 0.0000
2025-12-09 15:25:31 - utils - INFO - Recall:    0.0000
2025-12-09 15:25:31 - utils - INFO - F1-Score:  0.0000
2025-12-09 15:25:31 - utils - INFO - AUC-ROC:   0.8018
2025-12-09 15:25:31 - utils - INFO - ============================================================

2025-12-09 15:25:31 - utils - INFO - Comparing ensemble with individual models...
2025-12-09 15:25:31 - utils - INFO - Evaluating ensemble performance...
2025-12-09 15:25:31 - utils - INFO - 
============================================================
2025-12-09 15:25:31 - utils - INFO - Ensemble (majority) Performance Metrics
2025-12-09 15:25:31 - utils - INFO - ============================================================
2025-12-09 15:25:31 - utils - INFO - Accuracy:  0.9880
2025-12-09 15:25:31 - utils - INFO - Precision: 0.0000
2025-12-09 15:25:31 - utils - INFO - Recall:    0.0000
2025-12-09 15:25:31 - utils - INFO - F1-Score:  0.0000
2025-12-09 15:25:31 - utils - INFO - AUC-ROC:   0.8018
2025-12-09 15:25:31 - utils - INFO - ============================================================

2025-12-09 15:25:31 - utils - INFO - 
Comparison Results:
2025-12-09 15:25:31 - utils - INFO - 
              model  accuracy  precision  recall  f1_score  auc_roc
   Isolation Forest     0.945        0.0     0.0       0.0   0.8208
   Lstm Autoencoder     0.946        0.0     0.0       0.0   0.1842
    Deep Clustering     0.959        0.0     0.0       0.0   0.7407
Ensemble (majority)     0.988        0.0     0.0       0.0   0.8018
2025-12-09 15:25:31 - utils - INFO - Ensemble predictions saved
2025-12-09 15:25:31 - utils - INFO - Generating alerts...
2025-12-09 15:25:31 - utils - ERROR - Error with majority ensemble: 'severity'
2025-12-09 15:25:31 - utils - INFO - Initialized Ensemble Detector with method: cascade
2025-12-09 15:25:31 - utils - INFO - 
================================================================================
                            ENSEMBLE SYSTEM PIPELINE                            
================================================================================

2025-12-09 15:25:31 - utils - INFO - Loading predictions from individual models...
2025-12-09 15:25:31 - utils - INFO - Loaded isolation_forest predictions: 1000 samples
2025-12-09 15:25:31 - utils - INFO - Loaded lstm_autoencoder predictions: 32531 samples
2025-12-09 15:25:31 - utils - INFO - Loaded deep_clustering predictions: 1000 samples
2025-12-09 15:25:31 - utils - WARNING - Models have different sample counts: {'isolation_forest': 1000, 'lstm_autoencoder': 32531, 'deep_clustering': 1000}
2025-12-09 15:25:31 - utils - INFO - Will use aggregation strategy to align predictions...
2025-12-09 15:25:31 - utils - INFO - Aligning predictions across models...
2025-12-09 15:25:31 - utils - INFO - Using isolation_forest as reference (1000 samples)
2025-12-09 15:25:31 - utils - INFO - Aggregating lstm_autoencoder from 32531 to 1000 samples
2025-12-09 15:25:31 - utils - INFO - Predictions aligned successfully
2025-12-09 15:25:31 - utils - INFO - Loaded predictions from 3 models
2025-12-09 15:25:31 - utils - INFO - Computing cascade ensemble...
2025-12-09 15:25:31 - utils - INFO - Cascade ensemble: 0 anomalies detected
2025-12-09 15:25:31 - utils - INFO - Evaluating ensemble performance...
2025-12-09 15:25:31 - utils - INFO - 
============================================================
2025-12-09 15:25:31 - utils - INFO - Ensemble (cascade) Performance Metrics
2025-12-09 15:25:31 - utils - INFO - ============================================================
2025-12-09 15:25:31 - utils - INFO - Accuracy:  0.9990
2025-12-09 15:25:31 - utils - INFO - Precision: 0.0000
2025-12-09 15:25:31 - utils - INFO - Recall:    0.0000
2025-12-09 15:25:31 - utils - INFO - F1-Score:  0.0000
2025-12-09 15:25:31 - utils - INFO - AUC-ROC:   0.7067
2025-12-09 15:25:31 - utils - INFO - ============================================================

2025-12-09 15:25:31 - utils - INFO - Comparing ensemble with individual models...
2025-12-09 15:25:31 - utils - INFO - Evaluating ensemble performance...
2025-12-09 15:25:31 - utils - INFO - 
============================================================
2025-12-09 15:25:31 - utils - INFO - Ensemble (cascade) Performance Metrics
2025-12-09 15:25:31 - utils - INFO - ============================================================
2025-12-09 15:25:31 - utils - INFO - Accuracy:  0.9990
2025-12-09 15:25:31 - utils - INFO - Precision: 0.0000
2025-12-09 15:25:31 - utils - INFO - Recall:    0.0000
2025-12-09 15:25:31 - utils - INFO - F1-Score:  0.0000
2025-12-09 15:25:31 - utils - INFO - AUC-ROC:   0.7067
2025-12-09 15:25:31 - utils - INFO - ============================================================

2025-12-09 15:25:31 - utils - INFO - 
Comparison Results:
2025-12-09 15:25:31 - utils - INFO - 
             model  accuracy  precision  recall  f1_score  auc_roc
  Isolation Forest     0.945        0.0     0.0       0.0   0.8208
  Lstm Autoencoder     0.946        0.0     0.0       0.0   0.1842
   Deep Clustering     0.959        0.0     0.0       0.0   0.7407
Ensemble (cascade)     0.999        0.0     0.0       0.0   0.7067
2025-12-09 15:25:31 - utils - INFO - Ensemble predictions saved
2025-12-09 15:25:31 - utils - INFO - Generating alerts...
2025-12-09 15:25:31 - utils - INFO - Generated 35 alerts
2025-12-09 15:25:31 - utils - INFO - Severity distribution:
severity
low         22
high         5
medium       5
critical     3
Name: count, dtype: int64
2025-12-09 15:25:31 - utils - INFO - Alerts saved to /Users/bipinrimal/Downloads/Thesis_work/results/alerts.csv
2025-12-09 15:25:31 - utils - INFO - Ensemble pipeline completed!
2025-12-09 15:25:31 - utils - INFO - 
✓ Stage 5 completed: Best ensemble method = None (F1=0.0000)
2025-12-09 15:25:31 - utils - INFO - 
================================================================================
                             STAGE 6: VISUALIZATION                             
================================================================================

2025-12-09 15:25:31 - utils - INFO - 
================================================================================
                           GENERATING VISUALIZATIONS                            
================================================================================

2025-12-09 15:25:31 - utils - INFO - Creating alert severity distribution plot...
2025-12-09 15:25:31 - utils - INFO - Alert severity distribution plot saved
2025-12-09 15:25:31 - utils - INFO - Creating model agreement plot...
2025-12-09 15:25:31 - utils - INFO - Model agreement plot saved
2025-12-09 15:25:31 - utils - INFO - Creating anomaly score timeline for ensemble_weighted...
2025-12-09 15:25:31 - utils - INFO - Anomaly score timeline saved for ensemble_weighted
2025-12-09 15:25:31 - utils - INFO - Creating feature importance visualization...
2025-12-09 15:25:32 - utils - INFO - Feature importance heatmap saved
2025-12-09 15:25:32 - utils - INFO - Creating executive summary chart...
2025-12-09 15:25:32 - utils - INFO - Executive summary chart saved
2025-12-09 15:25:32 - utils - INFO - All visualizations saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations
2025-12-09 15:25:32 - utils - INFO - Visualization generation completed!
2025-12-09 15:25:32 - utils - INFO - ✓ Stage 6 completed: All visualizations generated
2025-12-09 15:25:32 - utils - INFO - 
================================================================================
2025-12-09 15:25:32 - utils - INFO - FINAL SUMMARY
2025-12-09 15:25:32 - utils - INFO - ================================================================================
2025-12-09 15:25:32 - utils - INFO - 
Model Performance:
2025-12-09 15:25:32 - utils - INFO - 
Lstm Autoencoder:
2025-12-09 15:25:32 - utils - WARNING -   No metrics available for this model.
2025-12-09 15:25:32 - utils - INFO - 
Deep Clustering:
2025-12-09 15:25:32 - utils - WARNING -   No metrics available for this model.
2025-12-09 15:25:32 - utils - INFO - 
Generated Output Files:
2025-12-09 15:25:32 - utils - INFO -   - Processed Data: /Users/bipinrimal/Downloads/Thesis_work/data/processed
2025-12-09 15:25:32 - utils - INFO -   - Trained Models: /Users/bipinrimal/Downloads/Thesis_work/models
2025-12-09 15:25:32 - utils - INFO -   - Results & Metrics: /Users/bipinrimal/Downloads/Thesis_work/results
2025-12-09 15:25:32 - utils - INFO -   - Visualizations: /Users/bipinrimal/Downloads/Thesis_work/results/visualizations
2025-12-09 15:25:32 - utils - INFO -   - Alerts: /Users/bipinrimal/Downloads/Thesis_work/results/alerts.csv
2025-12-09 15:25:32 - utils - INFO -   - Logs: /Users/bipinrimal/Downloads/Thesis_work/logs/insider_threat_detection.log
2025-12-09 15:25:32 - utils - INFO - 
================================================================================

2025-12-09 15:25:32 - utils - INFO - 
================================================================================
2025-12-09 15:25:32 - utils - INFO - ✓ PIPELINE EXECUTION COMPLETED SUCCESSFULLY
2025-12-09 15:25:32 - utils - INFO - ================================================================================

2025-12-09 16:03:12 - utils - INFO - Utility functions loaded successfully
2025-12-09 16:03:16 - utils - INFO - ================================================================================
2025-12-09 16:03:16 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-12-09 16:03:16 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-12-09 16:03:16 - utils - INFO - ================================================================================
2025-12-09 16:03:16 - utils - INFO - 
================================================================================
2025-12-09 16:03:16 - utils - INFO - STARTING FULL PIPELINE EXECUTION
2025-12-09 16:03:16 - utils - INFO - ================================================================================

2025-12-09 16:03:16 - utils - INFO - 
================================================================================
                          STAGE 1: DATA PREPROCESSING                           
================================================================================

2025-12-09 16:03:16 - utils - INFO - Processing SUBSET defined in config: ['r1', 'r2', 'r3.1', 'r3.2', 'r4.1', 'r4.2']
2025-12-09 16:03:16 - utils - INFO - 
================================================================================
                          DATA PREPROCESSING (POLARS)                           
================================================================================

2025-12-09 16:03:16 - utils - INFO - Scanning dataset: r1
2025-12-09 16:03:16 - utils - INFO - Scanning dataset: r2
2025-12-09 16:03:16 - utils - INFO - Scanning dataset: r3.1
2025-12-09 16:03:16 - utils - INFO - Scanning dataset: r3.2
2025-12-09 16:03:16 - utils - INFO - Scanning dataset: r4.1
2025-12-09 16:03:16 - utils - INFO - Scanning dataset: r4.2
2025-12-09 16:03:16 - utils - INFO - Constructing execution graph (Diagonal Concat)...
2025-12-09 16:03:16 - utils - INFO - Loaded Psychometric data: 4998 users
2025-12-09 16:03:16 - utils - INFO - Streaming merged data to /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv...
2025-12-09 16:05:58 - utils - INFO - ✓ Preprocessing complete.
2025-12-09 16:05:58 - utils - INFO - ✓ Stage 1 completed: check output file.
2025-12-09 16:05:58 - utils - INFO - 
================================================================================
                          STAGE 2: FEATURE ENGINEERING                          
================================================================================

2025-12-09 16:05:58 - utils - INFO - Aggregating daily features...
2025-12-09 16:08:07 - utils - INFO - Daily aggregation complete: 8998 rows
2025-12-09 16:08:07 - utils - INFO - Calculating Z-scores...
2025-12-09 16:08:07 - utils - INFO - Creating static features...
2025-12-09 16:08:07 - utils - INFO - Saved static features: /Users/bipinrimal/Downloads/Thesis_work/data/processed/static_features.csv
2025-12-09 16:08:07 - utils - INFO - Creating sequences...
2025-12-09 16:08:12 - utils - WARNING - No sequences created (insufficent data length per user?)
2025-12-09 16:08:12 - utils - INFO - Feature engineering complete.
2025-12-09 16:08:12 - utils - INFO - ✓ Stage 2 completed: Polars pipeline finished.
2025-12-09 16:08:12 - utils - INFO - 
================================================================================
                            STAGE 3: MODEL TRAINING                             
================================================================================

2025-12-09 16:08:12 - utils - INFO - 
>>> Training Isolation Forest...
2025-12-09 16:08:12 - utils - INFO - 
================================================================================
                 ISOLATION FOREST TRAINING (V2: MULTI-DATASET)                  
================================================================================

2025-12-09 16:08:12 - utils - INFO - Loading static features from: static_features.csv
2025-12-09 16:08:12 - utils - ERROR - Failed to load 'static_scaler.pkl'. Run feature_engineering.py first. Error: STACK_GLOBAL requires str
2025-12-09 16:08:12 - utils - INFO - ✓ Isolation Forest training completed
2025-12-09 16:08:12 - utils - INFO - 
>>> Training LSTM Autoencoder...
2025-12-09 16:08:12 - utils - INFO - 
================================================================================
                     LIGHTWEIGHT LSTM AUTOENCODER TRAINING                      
================================================================================

2025-12-09 16:08:12 - utils - ERROR - Sequence data not found. Run feature_engineering.py first. Error: [Errno 2] No such file or directory: '/Users/bipinrimal/Downloads/Thesis_work/data/processed/sequences.npy'
2025-12-09 16:08:12 - utils - INFO - ✓ LSTM Autoencoder training completed
2025-12-09 16:08:12 - utils - INFO - 
>>> Training Deep Clustering...
2025-12-09 16:08:12 - utils - INFO - 
================================================================================
                      LIGHTWEIGHT DEEP CLUSTERING TRAINING                      
================================================================================

2025-12-09 16:08:12 - utils - INFO - Loading static features from: static_features.csv
2025-12-09 16:08:12 - utils - ERROR - Failed to load 'static_scaler.pkl'. Run feature_engineering.py first. Error: STACK_GLOBAL requires str
2025-12-09 16:08:12 - utils - INFO - ✓ Deep Clustering training completed
2025-12-09 16:08:12 - utils - INFO - 
✓ Stage 3 completed: 3 models trained
2025-12-09 16:08:12 - utils - INFO - 
================================================================================
                           STAGE 4: MODEL EVALUATION                            
================================================================================

2025-12-09 16:08:12 - utils - INFO - 
================================================================================
                         COMPREHENSIVE MODEL EVALUATION                         
================================================================================

2025-12-09 16:08:12 - utils - INFO - Loading results for all models...
2025-12-09 16:08:12 - utils - INFO - Loaded results for isolation_forest
2025-12-09 16:08:12 - utils - INFO - Loaded results for lstm_autoencoder
2025-12-09 16:08:12 - utils - INFO - Loaded results for deep_clustering
2025-12-09 16:08:12 - utils - INFO - Loaded results for 3 models
2025-12-09 16:08:12 - utils - INFO - Creating metrics comparison table...
2025-12-09 16:08:12 - utils - INFO - Metrics comparison table created
2025-12-09 16:08:12 - utils - INFO - Creating confusion matrix plots...
2025-12-09 16:08:12 - utils - INFO - Confusion matrices saved to /Users/bipinrimal/Downloads/Thesis_work/results/confusion_matrices/all_models.png
2025-12-09 16:08:12 - utils - INFO - Creating ROC curves...
2025-12-09 16:08:12 - utils - INFO - ROC curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/roc_curves/roc_comparison.png
2025-12-09 16:08:12 - utils - INFO - Creating Precision-Recall curves...
2025-12-09 16:08:12 - utils - INFO - Precision-Recall curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/precision_recall_comparison.png
2025-12-09 16:08:12 - utils - INFO - Creating metrics comparison bar chart...
2025-12-09 16:08:12 - utils - INFO - Metrics comparison bar chart saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/metrics_comparison_bar.png
2025-12-09 16:08:12 - utils - INFO - Creating anomaly score distribution plots...
2025-12-09 16:08:13 - utils - INFO - Score distributions saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/score_distributions.png
2025-12-09 16:08:13 - utils - INFO - Generating evaluation report...
2025-12-09 16:08:13 - utils - INFO - Evaluation report saved to /Users/bipinrimal/Downloads/Thesis_work/results/evaluation_report.txt
2025-12-09 16:08:13 - utils - INFO - Comprehensive evaluation completed!
2025-12-09 16:08:13 - utils - INFO - ✓ Stage 4 completed: Comprehensive evaluation report generated
2025-12-09 16:08:13 - utils - INFO - 
================================================================================
                         STAGE 5: ENSEMBLE INTEGRATION                          
================================================================================

2025-12-09 16:08:13 - utils - INFO - Initialized Ensemble Detector with method: weighted
2025-12-09 16:08:13 - utils - INFO - 
================================================================================
                            ENSEMBLE SYSTEM PIPELINE                            
================================================================================

2025-12-09 16:08:13 - utils - INFO - Loading predictions from individual models...
2025-12-09 16:08:13 - utils - INFO - Loaded isolation_forest predictions: 1000 samples
2025-12-09 16:08:13 - utils - INFO - Loaded lstm_autoencoder predictions: 32531 samples
2025-12-09 16:08:13 - utils - INFO - Loaded deep_clustering predictions: 1000 samples
2025-12-09 16:08:13 - utils - WARNING - Models have different sample counts: {'isolation_forest': 1000, 'lstm_autoencoder': 32531, 'deep_clustering': 1000}
2025-12-09 16:08:13 - utils - INFO - Will use aggregation strategy to align predictions...
2025-12-09 16:08:13 - utils - INFO - Aligning predictions across models...
2025-12-09 16:08:13 - utils - INFO - Using isolation_forest as reference (1000 samples)
2025-12-09 16:08:13 - utils - INFO - Aggregating lstm_autoencoder from 32531 to 1000 samples
2025-12-09 16:08:13 - utils - INFO - Predictions aligned successfully
2025-12-09 16:08:13 - utils - INFO - Loaded predictions from 3 models
2025-12-09 16:08:13 - utils - INFO - Computing weighted ensemble...
2025-12-09 16:08:13 - utils - INFO - Weighted ensemble: 0 anomalies detected
2025-12-09 16:08:13 - utils - INFO - Evaluating ensemble performance...
2025-12-09 16:08:13 - utils - INFO - 
============================================================
2025-12-09 16:08:13 - utils - INFO - Ensemble (weighted) Performance Metrics
2025-12-09 16:08:13 - utils - INFO - ============================================================
2025-12-09 16:08:13 - utils - INFO - Accuracy:  0.9990
2025-12-09 16:08:13 - utils - INFO - Precision: 0.0000
2025-12-09 16:08:13 - utils - INFO - Recall:    0.0000
2025-12-09 16:08:13 - utils - INFO - F1-Score:  0.0000
2025-12-09 16:08:13 - utils - INFO - AUC-ROC:   0.7978
2025-12-09 16:08:13 - utils - INFO - ============================================================

2025-12-09 16:08:13 - utils - INFO - Comparing ensemble with individual models...
2025-12-09 16:08:13 - utils - INFO - Evaluating ensemble performance...
2025-12-09 16:08:13 - utils - INFO - 
============================================================
2025-12-09 16:08:13 - utils - INFO - Ensemble (weighted) Performance Metrics
2025-12-09 16:08:13 - utils - INFO - ============================================================
2025-12-09 16:08:13 - utils - INFO - Accuracy:  0.9990
2025-12-09 16:08:13 - utils - INFO - Precision: 0.0000
2025-12-09 16:08:13 - utils - INFO - Recall:    0.0000
2025-12-09 16:08:13 - utils - INFO - F1-Score:  0.0000
2025-12-09 16:08:13 - utils - INFO - AUC-ROC:   0.7978
2025-12-09 16:08:13 - utils - INFO - ============================================================

2025-12-09 16:08:13 - utils - INFO - 
Comparison Results:
2025-12-09 16:08:13 - utils - INFO - 
              model  accuracy  precision  recall  f1_score  auc_roc
   Isolation Forest     0.945        0.0     0.0       0.0   0.8208
   Lstm Autoencoder     0.946        0.0     0.0       0.0   0.1842
    Deep Clustering     0.959        0.0     0.0       0.0   0.7407
Ensemble (weighted)     0.999        0.0     0.0       0.0   0.7978
2025-12-09 16:08:13 - utils - INFO - Ensemble predictions saved
2025-12-09 16:08:13 - utils - INFO - Generating alerts...
2025-12-09 16:08:13 - utils - ERROR - Error with weighted ensemble: 'severity'
2025-12-09 16:08:13 - utils - INFO - Initialized Ensemble Detector with method: majority
2025-12-09 16:08:13 - utils - INFO - 
================================================================================
                            ENSEMBLE SYSTEM PIPELINE                            
================================================================================

2025-12-09 16:08:13 - utils - INFO - Loading predictions from individual models...
2025-12-09 16:08:13 - utils - INFO - Loaded isolation_forest predictions: 1000 samples
2025-12-09 16:08:13 - utils - INFO - Loaded lstm_autoencoder predictions: 32531 samples
2025-12-09 16:08:13 - utils - INFO - Loaded deep_clustering predictions: 1000 samples
2025-12-09 16:08:13 - utils - WARNING - Models have different sample counts: {'isolation_forest': 1000, 'lstm_autoencoder': 32531, 'deep_clustering': 1000}
2025-12-09 16:08:13 - utils - INFO - Will use aggregation strategy to align predictions...
2025-12-09 16:08:13 - utils - INFO - Aligning predictions across models...
2025-12-09 16:08:13 - utils - INFO - Using isolation_forest as reference (1000 samples)
2025-12-09 16:08:13 - utils - INFO - Aggregating lstm_autoencoder from 32531 to 1000 samples
2025-12-09 16:08:13 - utils - INFO - Predictions aligned successfully
2025-12-09 16:08:13 - utils - INFO - Loaded predictions from 3 models
2025-12-09 16:08:13 - utils - INFO - Computing majority voting ensemble...
2025-12-09 16:08:13 - utils - INFO - Majority voting: 11 anomalies detected
2025-12-09 16:08:13 - utils - INFO - Evaluating ensemble performance...
2025-12-09 16:08:13 - utils - INFO - 
============================================================
2025-12-09 16:08:13 - utils - INFO - Ensemble (majority) Performance Metrics
2025-12-09 16:08:13 - utils - INFO - ============================================================
2025-12-09 16:08:13 - utils - INFO - Accuracy:  0.9880
2025-12-09 16:08:13 - utils - INFO - Precision: 0.0000
2025-12-09 16:08:13 - utils - INFO - Recall:    0.0000
2025-12-09 16:08:13 - utils - INFO - F1-Score:  0.0000
2025-12-09 16:08:13 - utils - INFO - AUC-ROC:   0.8018
2025-12-09 16:08:13 - utils - INFO - ============================================================

2025-12-09 16:08:13 - utils - INFO - Comparing ensemble with individual models...
2025-12-09 16:08:13 - utils - INFO - Evaluating ensemble performance...
2025-12-09 16:08:13 - utils - INFO - 
============================================================
2025-12-09 16:08:13 - utils - INFO - Ensemble (majority) Performance Metrics
2025-12-09 16:08:13 - utils - INFO - ============================================================
2025-12-09 16:08:13 - utils - INFO - Accuracy:  0.9880
2025-12-09 16:08:13 - utils - INFO - Precision: 0.0000
2025-12-09 16:08:13 - utils - INFO - Recall:    0.0000
2025-12-09 16:08:13 - utils - INFO - F1-Score:  0.0000
2025-12-09 16:08:13 - utils - INFO - AUC-ROC:   0.8018
2025-12-09 16:08:13 - utils - INFO - ============================================================

2025-12-09 16:08:13 - utils - INFO - 
Comparison Results:
2025-12-09 16:08:13 - utils - INFO - 
              model  accuracy  precision  recall  f1_score  auc_roc
   Isolation Forest     0.945        0.0     0.0       0.0   0.8208
   Lstm Autoencoder     0.946        0.0     0.0       0.0   0.1842
    Deep Clustering     0.959        0.0     0.0       0.0   0.7407
Ensemble (majority)     0.988        0.0     0.0       0.0   0.8018
2025-12-09 16:08:13 - utils - INFO - Ensemble predictions saved
2025-12-09 16:08:13 - utils - INFO - Generating alerts...
2025-12-09 16:08:13 - utils - ERROR - Error with majority ensemble: 'severity'
2025-12-09 16:08:13 - utils - INFO - Initialized Ensemble Detector with method: cascade
2025-12-09 16:08:13 - utils - INFO - 
================================================================================
                            ENSEMBLE SYSTEM PIPELINE                            
================================================================================

2025-12-09 16:08:13 - utils - INFO - Loading predictions from individual models...
2025-12-09 16:08:13 - utils - INFO - Loaded isolation_forest predictions: 1000 samples
2025-12-09 16:08:13 - utils - INFO - Loaded lstm_autoencoder predictions: 32531 samples
2025-12-09 16:08:13 - utils - INFO - Loaded deep_clustering predictions: 1000 samples
2025-12-09 16:08:13 - utils - WARNING - Models have different sample counts: {'isolation_forest': 1000, 'lstm_autoencoder': 32531, 'deep_clustering': 1000}
2025-12-09 16:08:13 - utils - INFO - Will use aggregation strategy to align predictions...
2025-12-09 16:08:13 - utils - INFO - Aligning predictions across models...
2025-12-09 16:08:13 - utils - INFO - Using isolation_forest as reference (1000 samples)
2025-12-09 16:08:13 - utils - INFO - Aggregating lstm_autoencoder from 32531 to 1000 samples
2025-12-09 16:08:13 - utils - INFO - Predictions aligned successfully
2025-12-09 16:08:13 - utils - INFO - Loaded predictions from 3 models
2025-12-09 16:08:13 - utils - INFO - Computing cascade ensemble...
2025-12-09 16:08:13 - utils - INFO - Cascade ensemble: 0 anomalies detected
2025-12-09 16:08:13 - utils - INFO - Evaluating ensemble performance...
2025-12-09 16:08:13 - utils - INFO - 
============================================================
2025-12-09 16:08:13 - utils - INFO - Ensemble (cascade) Performance Metrics
2025-12-09 16:08:13 - utils - INFO - ============================================================
2025-12-09 16:08:13 - utils - INFO - Accuracy:  0.9990
2025-12-09 16:08:13 - utils - INFO - Precision: 0.0000
2025-12-09 16:08:13 - utils - INFO - Recall:    0.0000
2025-12-09 16:08:13 - utils - INFO - F1-Score:  0.0000
2025-12-09 16:08:13 - utils - INFO - AUC-ROC:   0.7067
2025-12-09 16:08:13 - utils - INFO - ============================================================

2025-12-09 16:08:13 - utils - INFO - Comparing ensemble with individual models...
2025-12-09 16:08:13 - utils - INFO - Evaluating ensemble performance...
2025-12-09 16:08:13 - utils - INFO - 
============================================================
2025-12-09 16:08:13 - utils - INFO - Ensemble (cascade) Performance Metrics
2025-12-09 16:08:13 - utils - INFO - ============================================================
2025-12-09 16:08:13 - utils - INFO - Accuracy:  0.9990
2025-12-09 16:08:13 - utils - INFO - Precision: 0.0000
2025-12-09 16:08:13 - utils - INFO - Recall:    0.0000
2025-12-09 16:08:13 - utils - INFO - F1-Score:  0.0000
2025-12-09 16:08:13 - utils - INFO - AUC-ROC:   0.7067
2025-12-09 16:08:13 - utils - INFO - ============================================================

2025-12-09 16:08:13 - utils - INFO - 
Comparison Results:
2025-12-09 16:08:13 - utils - INFO - 
             model  accuracy  precision  recall  f1_score  auc_roc
  Isolation Forest     0.945        0.0     0.0       0.0   0.8208
  Lstm Autoencoder     0.946        0.0     0.0       0.0   0.1842
   Deep Clustering     0.959        0.0     0.0       0.0   0.7407
Ensemble (cascade)     0.999        0.0     0.0       0.0   0.7067
2025-12-09 16:08:13 - utils - INFO - Ensemble predictions saved
2025-12-09 16:08:13 - utils - INFO - Generating alerts...
2025-12-09 16:08:13 - utils - INFO - Generated 35 alerts
2025-12-09 16:08:13 - utils - INFO - Severity distribution:
severity
low         22
high         5
medium       5
critical     3
Name: count, dtype: int64
2025-12-09 16:08:13 - utils - INFO - Alerts saved to /Users/bipinrimal/Downloads/Thesis_work/results/alerts.csv
2025-12-09 16:08:13 - utils - INFO - Ensemble pipeline completed!
2025-12-09 16:08:13 - utils - INFO - 
✓ Stage 5 completed: Best ensemble method = None (F1=0.0000)
2025-12-09 16:08:13 - utils - INFO - 
================================================================================
                             STAGE 6: VISUALIZATION                             
================================================================================

2025-12-09 16:08:13 - utils - INFO - 
================================================================================
                           GENERATING VISUALIZATIONS                            
================================================================================

2025-12-09 16:08:13 - utils - INFO - Creating alert severity distribution plot...
2025-12-09 16:08:13 - utils - INFO - Alert severity distribution plot saved
2025-12-09 16:08:13 - utils - INFO - Creating model agreement plot...
2025-12-09 16:08:13 - utils - INFO - Model agreement plot saved
2025-12-09 16:08:13 - utils - INFO - Creating anomaly score timeline for ensemble_weighted...
2025-12-09 16:08:13 - utils - INFO - Anomaly score timeline saved for ensemble_weighted
2025-12-09 16:08:13 - utils - INFO - Creating feature importance visualization...
2025-12-09 16:08:13 - utils - INFO - Feature importance heatmap saved
2025-12-09 16:08:13 - utils - INFO - Creating executive summary chart...
2025-12-09 16:08:13 - utils - INFO - Executive summary chart saved
2025-12-09 16:08:13 - utils - INFO - All visualizations saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations
2025-12-09 16:08:13 - utils - INFO - Visualization generation completed!
2025-12-09 16:08:13 - utils - INFO - ✓ Stage 6 completed: All visualizations generated
2025-12-09 16:08:13 - utils - INFO - 
================================================================================
2025-12-09 16:08:13 - utils - INFO - FINAL SUMMARY
2025-12-09 16:08:13 - utils - INFO - ================================================================================
2025-12-09 16:08:13 - utils - INFO - 
Model Performance:
2025-12-09 16:08:13 - utils - INFO - 
Isolation Forest:
2025-12-09 16:08:13 - utils - WARNING -   No metrics available for this model.
2025-12-09 16:08:13 - utils - INFO - 
Lstm Autoencoder:
2025-12-09 16:08:13 - utils - WARNING -   No metrics available for this model.
2025-12-09 16:08:13 - utils - INFO - 
Deep Clustering:
2025-12-09 16:08:13 - utils - WARNING -   No metrics available for this model.
2025-12-09 16:08:13 - utils - INFO - 
Generated Output Files:
2025-12-09 16:08:13 - utils - INFO -   - Processed Data: /Users/bipinrimal/Downloads/Thesis_work/data/processed
2025-12-09 16:08:13 - utils - INFO -   - Trained Models: /Users/bipinrimal/Downloads/Thesis_work/models
2025-12-09 16:08:13 - utils - INFO -   - Results & Metrics: /Users/bipinrimal/Downloads/Thesis_work/results
2025-12-09 16:08:13 - utils - INFO -   - Visualizations: /Users/bipinrimal/Downloads/Thesis_work/results/visualizations
2025-12-09 16:08:13 - utils - INFO -   - Alerts: /Users/bipinrimal/Downloads/Thesis_work/results/alerts.csv
2025-12-09 16:08:13 - utils - INFO -   - Logs: /Users/bipinrimal/Downloads/Thesis_work/logs/insider_threat_detection.log
2025-12-09 16:08:13 - utils - INFO - 
================================================================================

2025-12-09 16:08:13 - utils - INFO - 
================================================================================
2025-12-09 16:08:13 - utils - INFO - ✓ PIPELINE EXECUTION COMPLETED SUCCESSFULLY
2025-12-09 16:08:13 - utils - INFO - ================================================================================

2025-12-09 16:48:17 - utils - INFO - Utility functions loaded successfully
2025-12-09 16:48:21 - utils - INFO - ================================================================================
2025-12-09 16:48:21 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-12-09 16:48:21 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-12-09 16:48:21 - utils - INFO - ================================================================================
2025-12-09 16:48:21 - utils - INFO - 
================================================================================
2025-12-09 16:48:21 - utils - INFO - STARTING FULL PIPELINE EXECUTION
2025-12-09 16:48:21 - utils - INFO - ================================================================================

2025-12-09 16:48:21 - utils - INFO - 
================================================================================
                          STAGE 1: DATA PREPROCESSING                           
================================================================================

2025-12-09 16:48:21 - utils - INFO - Processing SUBSET defined in config: ['r1', 'r2', 'r3.1', 'r3.2', 'r4.1', 'r4.2']
2025-12-09 16:48:21 - utils - INFO - 
================================================================================
                          DATA PREPROCESSING (POLARS)                           
================================================================================

2025-12-09 16:48:21 - utils - INFO - Scanning dataset: r1
2025-12-09 16:48:21 - utils - INFO - Scanning dataset: r2
2025-12-09 16:48:21 - utils - INFO - Scanning dataset: r3.1
2025-12-09 16:48:22 - utils - INFO - Scanning dataset: r3.2
2025-12-09 16:48:22 - utils - INFO - Scanning dataset: r4.1
2025-12-09 16:48:22 - utils - INFO - Scanning dataset: r4.2
2025-12-09 16:48:22 - utils - INFO - Constructing execution graph (Diagonal Concat)...
2025-12-09 16:48:22 - utils - INFO - Loaded Psychometric data: 4998 users
2025-12-09 16:48:22 - utils - INFO - Streaming merged data to /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv...
2025-12-09 16:50:56 - utils - INFO - ✓ Preprocessing complete.
2025-12-09 16:50:56 - utils - INFO - ✓ Stage 1 completed: check output file.
2025-12-09 16:50:56 - utils - INFO - 
================================================================================
                          STAGE 2: FEATURE ENGINEERING                          
================================================================================

2025-12-09 16:50:56 - utils - INFO - Aggregating daily features...
2025-12-09 16:53:18 - utils - INFO - Daily aggregation complete: 8998 rows
2025-12-09 16:53:18 - utils - INFO - Calculating Z-scores...
2025-12-09 16:53:18 - utils - INFO - Creating static features...
2025-12-09 16:53:18 - utils - INFO - Saved static features: /Users/bipinrimal/Downloads/Thesis_work/data/processed/static_features.csv
2025-12-09 16:53:18 - utils - INFO - Creating sequences...
2025-12-09 16:53:23 - utils - WARNING - No sequences created (insufficent data length per user?)
2025-12-09 16:53:23 - utils - INFO - Feature engineering complete.
2025-12-09 16:53:23 - utils - INFO - ✓ Stage 2 completed: Polars pipeline finished.
2025-12-09 16:53:23 - utils - INFO - 
================================================================================
                            STAGE 3: MODEL TRAINING                             
================================================================================

2025-12-09 16:53:23 - utils - INFO - 
>>> Training Isolation Forest...
2025-12-09 16:53:23 - utils - INFO - 
================================================================================
                 ISOLATION FOREST TRAINING (V2: MULTI-DATASET)                  
================================================================================

2025-12-09 16:53:23 - utils - INFO - Loading static features from: static_features.csv
2025-12-09 16:53:23 - utils - ERROR - Failed to load 'static_scaler.pkl'. Run feature_engineering.py first. Error: STACK_GLOBAL requires str
2025-12-09 16:53:23 - utils - INFO - ✓ Isolation Forest training completed
2025-12-09 16:53:23 - utils - INFO - 
>>> Training LSTM Autoencoder...
2025-12-09 16:53:23 - utils - INFO - 
================================================================================
                     LIGHTWEIGHT LSTM AUTOENCODER TRAINING                      
================================================================================

2025-12-09 16:53:23 - utils - ERROR - Sequence data not found. Run feature_engineering.py first. Error: [Errno 2] No such file or directory: '/Users/bipinrimal/Downloads/Thesis_work/data/processed/sequences.npy'
2025-12-09 16:53:23 - utils - INFO - ✓ LSTM Autoencoder training completed
2025-12-09 16:53:23 - utils - INFO - 
>>> Training Deep Clustering...
2025-12-09 16:53:23 - utils - INFO - 
================================================================================
                      LIGHTWEIGHT DEEP CLUSTERING TRAINING                      
================================================================================

2025-12-09 16:53:23 - utils - INFO - Loading static features from: static_features.csv
2025-12-09 16:53:23 - utils - ERROR - Failed to load 'static_scaler.pkl'. Run feature_engineering.py first. Error: STACK_GLOBAL requires str
2025-12-09 16:53:23 - utils - INFO - ✓ Deep Clustering training completed
2025-12-09 16:53:23 - utils - INFO - 
✓ Stage 3 completed: 3 models trained
2025-12-09 16:53:23 - utils - INFO - 
================================================================================
                           STAGE 4: MODEL EVALUATION                            
================================================================================

2025-12-09 16:53:23 - utils - INFO - 
================================================================================
                         COMPREHENSIVE MODEL EVALUATION                         
================================================================================

2025-12-09 16:53:23 - utils - INFO - Loading results for all models...
2025-12-09 16:53:23 - utils - INFO - Loaded results for isolation_forest
2025-12-09 16:53:23 - utils - INFO - Loaded results for lstm_autoencoder
2025-12-09 16:53:23 - utils - INFO - Loaded results for deep_clustering
2025-12-09 16:53:23 - utils - INFO - Loaded results for 3 models
2025-12-09 16:53:23 - utils - INFO - Creating metrics comparison table...
2025-12-09 16:53:23 - utils - INFO - Metrics comparison table created
2025-12-09 16:53:23 - utils - INFO - Creating confusion matrix plots...
2025-12-09 16:53:23 - utils - INFO - Confusion matrices saved to /Users/bipinrimal/Downloads/Thesis_work/results/confusion_matrices/all_models.png
2025-12-09 16:53:23 - utils - INFO - Creating ROC curves...
2025-12-09 16:53:23 - utils - INFO - ROC curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/roc_curves/roc_comparison.png
2025-12-09 16:53:23 - utils - INFO - Creating Precision-Recall curves...
2025-12-09 16:53:23 - utils - INFO - Precision-Recall curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/precision_recall_comparison.png
2025-12-09 16:53:23 - utils - INFO - Creating metrics comparison bar chart...
2025-12-09 16:53:23 - utils - INFO - Metrics comparison bar chart saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/metrics_comparison_bar.png
2025-12-09 16:53:23 - utils - INFO - Creating anomaly score distribution plots...
2025-12-09 16:53:24 - utils - INFO - Score distributions saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/score_distributions.png
2025-12-09 16:53:24 - utils - INFO - Generating evaluation report...
2025-12-09 16:53:24 - utils - INFO - Evaluation report saved to /Users/bipinrimal/Downloads/Thesis_work/results/evaluation_report.txt
2025-12-09 16:53:24 - utils - INFO - Comprehensive evaluation completed!
2025-12-09 16:53:24 - utils - INFO - ✓ Stage 4 completed: Comprehensive evaluation report generated
2025-12-09 16:53:24 - utils - INFO - 
================================================================================
                         STAGE 5: ENSEMBLE INTEGRATION                          
================================================================================

2025-12-09 16:53:24 - utils - INFO - Initialized Ensemble Detector with method: weighted
2025-12-09 16:53:24 - utils - INFO - 
================================================================================
                            ENSEMBLE SYSTEM PIPELINE                            
================================================================================

2025-12-09 16:53:24 - utils - INFO - Loading predictions from individual models...
2025-12-09 16:53:24 - utils - INFO - Loaded isolation_forest predictions: 1000 samples
2025-12-09 16:53:24 - utils - INFO - Loaded lstm_autoencoder predictions: 32531 samples
2025-12-09 16:53:24 - utils - INFO - Loaded deep_clustering predictions: 1000 samples
2025-12-09 16:53:24 - utils - WARNING - Models have different sample counts: {'isolation_forest': 1000, 'lstm_autoencoder': 32531, 'deep_clustering': 1000}
2025-12-09 16:53:24 - utils - INFO - Will use aggregation strategy to align predictions...
2025-12-09 16:53:24 - utils - INFO - Aligning predictions across models...
2025-12-09 16:53:24 - utils - INFO - Using isolation_forest as reference (1000 samples)
2025-12-09 16:53:24 - utils - INFO - Aggregating lstm_autoencoder from 32531 to 1000 samples
2025-12-09 16:53:24 - utils - INFO - Predictions aligned successfully
2025-12-09 16:53:24 - utils - INFO - Loaded predictions from 3 models
2025-12-09 16:53:24 - utils - INFO - Computing weighted ensemble...
2025-12-09 16:53:24 - utils - INFO - Weighted ensemble: 0 anomalies detected
2025-12-09 16:53:24 - utils - INFO - Evaluating ensemble performance...
2025-12-09 16:53:24 - utils - INFO - 
============================================================
2025-12-09 16:53:24 - utils - INFO - Ensemble (weighted) Performance Metrics
2025-12-09 16:53:24 - utils - INFO - ============================================================
2025-12-09 16:53:24 - utils - INFO - Accuracy:  0.9990
2025-12-09 16:53:24 - utils - INFO - Precision: 0.0000
2025-12-09 16:53:24 - utils - INFO - Recall:    0.0000
2025-12-09 16:53:24 - utils - INFO - F1-Score:  0.0000
2025-12-09 16:53:24 - utils - INFO - AUC-ROC:   0.7978
2025-12-09 16:53:24 - utils - INFO - ============================================================

2025-12-09 16:53:24 - utils - INFO - Comparing ensemble with individual models...
2025-12-09 16:53:24 - utils - INFO - Evaluating ensemble performance...
2025-12-09 16:53:24 - utils - INFO - 
============================================================
2025-12-09 16:53:24 - utils - INFO - Ensemble (weighted) Performance Metrics
2025-12-09 16:53:24 - utils - INFO - ============================================================
2025-12-09 16:53:24 - utils - INFO - Accuracy:  0.9990
2025-12-09 16:53:24 - utils - INFO - Precision: 0.0000
2025-12-09 16:53:24 - utils - INFO - Recall:    0.0000
2025-12-09 16:53:24 - utils - INFO - F1-Score:  0.0000
2025-12-09 16:53:24 - utils - INFO - AUC-ROC:   0.7978
2025-12-09 16:53:24 - utils - INFO - ============================================================

2025-12-09 16:53:24 - utils - INFO - 
Comparison Results:
2025-12-09 16:53:24 - utils - INFO - 
              model  accuracy  precision  recall  f1_score  auc_roc
   Isolation Forest     0.945        0.0     0.0       0.0   0.8208
   Lstm Autoencoder     0.946        0.0     0.0       0.0   0.1842
    Deep Clustering     0.959        0.0     0.0       0.0   0.7407
Ensemble (weighted)     0.999        0.0     0.0       0.0   0.7978
2025-12-09 16:53:24 - utils - INFO - Ensemble predictions saved
2025-12-09 16:53:24 - utils - INFO - Generating alerts...
2025-12-09 16:53:24 - utils - ERROR - Error with weighted ensemble: 'severity'
2025-12-09 16:53:24 - utils - INFO - Initialized Ensemble Detector with method: majority
2025-12-09 16:53:24 - utils - INFO - 
================================================================================
                            ENSEMBLE SYSTEM PIPELINE                            
================================================================================

2025-12-09 16:53:24 - utils - INFO - Loading predictions from individual models...
2025-12-09 16:53:24 - utils - INFO - Loaded isolation_forest predictions: 1000 samples
2025-12-09 16:53:24 - utils - INFO - Loaded lstm_autoencoder predictions: 32531 samples
2025-12-09 16:53:24 - utils - INFO - Loaded deep_clustering predictions: 1000 samples
2025-12-09 16:53:24 - utils - WARNING - Models have different sample counts: {'isolation_forest': 1000, 'lstm_autoencoder': 32531, 'deep_clustering': 1000}
2025-12-09 16:53:24 - utils - INFO - Will use aggregation strategy to align predictions...
2025-12-09 16:53:24 - utils - INFO - Aligning predictions across models...
2025-12-09 16:53:24 - utils - INFO - Using isolation_forest as reference (1000 samples)
2025-12-09 16:53:24 - utils - INFO - Aggregating lstm_autoencoder from 32531 to 1000 samples
2025-12-09 16:53:24 - utils - INFO - Predictions aligned successfully
2025-12-09 16:53:24 - utils - INFO - Loaded predictions from 3 models
2025-12-09 16:53:24 - utils - INFO - Computing majority voting ensemble...
2025-12-09 16:53:24 - utils - INFO - Majority voting: 11 anomalies detected
2025-12-09 16:53:24 - utils - INFO - Evaluating ensemble performance...
2025-12-09 16:53:24 - utils - INFO - 
============================================================
2025-12-09 16:53:24 - utils - INFO - Ensemble (majority) Performance Metrics
2025-12-09 16:53:24 - utils - INFO - ============================================================
2025-12-09 16:53:24 - utils - INFO - Accuracy:  0.9880
2025-12-09 16:53:24 - utils - INFO - Precision: 0.0000
2025-12-09 16:53:24 - utils - INFO - Recall:    0.0000
2025-12-09 16:53:24 - utils - INFO - F1-Score:  0.0000
2025-12-09 16:53:24 - utils - INFO - AUC-ROC:   0.8018
2025-12-09 16:53:24 - utils - INFO - ============================================================

2025-12-09 16:53:24 - utils - INFO - Comparing ensemble with individual models...
2025-12-09 16:53:24 - utils - INFO - Evaluating ensemble performance...
2025-12-09 16:53:24 - utils - INFO - 
============================================================
2025-12-09 16:53:24 - utils - INFO - Ensemble (majority) Performance Metrics
2025-12-09 16:53:24 - utils - INFO - ============================================================
2025-12-09 16:53:24 - utils - INFO - Accuracy:  0.9880
2025-12-09 16:53:24 - utils - INFO - Precision: 0.0000
2025-12-09 16:53:24 - utils - INFO - Recall:    0.0000
2025-12-09 16:53:24 - utils - INFO - F1-Score:  0.0000
2025-12-09 16:53:24 - utils - INFO - AUC-ROC:   0.8018
2025-12-09 16:53:24 - utils - INFO - ============================================================

2025-12-09 16:53:24 - utils - INFO - 
Comparison Results:
2025-12-09 16:53:24 - utils - INFO - 
              model  accuracy  precision  recall  f1_score  auc_roc
   Isolation Forest     0.945        0.0     0.0       0.0   0.8208
   Lstm Autoencoder     0.946        0.0     0.0       0.0   0.1842
    Deep Clustering     0.959        0.0     0.0       0.0   0.7407
Ensemble (majority)     0.988        0.0     0.0       0.0   0.8018
2025-12-09 16:53:24 - utils - INFO - Ensemble predictions saved
2025-12-09 16:53:24 - utils - INFO - Generating alerts...
2025-12-09 16:53:24 - utils - ERROR - Error with majority ensemble: 'severity'
2025-12-09 16:53:24 - utils - INFO - Initialized Ensemble Detector with method: cascade
2025-12-09 16:53:24 - utils - INFO - 
================================================================================
                            ENSEMBLE SYSTEM PIPELINE                            
================================================================================

2025-12-09 16:53:24 - utils - INFO - Loading predictions from individual models...
2025-12-09 16:53:24 - utils - INFO - Loaded isolation_forest predictions: 1000 samples
2025-12-09 16:53:24 - utils - INFO - Loaded lstm_autoencoder predictions: 32531 samples
2025-12-09 16:53:24 - utils - INFO - Loaded deep_clustering predictions: 1000 samples
2025-12-09 16:53:24 - utils - WARNING - Models have different sample counts: {'isolation_forest': 1000, 'lstm_autoencoder': 32531, 'deep_clustering': 1000}
2025-12-09 16:53:24 - utils - INFO - Will use aggregation strategy to align predictions...
2025-12-09 16:53:24 - utils - INFO - Aligning predictions across models...
2025-12-09 16:53:24 - utils - INFO - Using isolation_forest as reference (1000 samples)
2025-12-09 16:53:24 - utils - INFO - Aggregating lstm_autoencoder from 32531 to 1000 samples
2025-12-09 16:53:24 - utils - INFO - Predictions aligned successfully
2025-12-09 16:53:24 - utils - INFO - Loaded predictions from 3 models
2025-12-09 16:53:24 - utils - INFO - Computing cascade ensemble...
2025-12-09 16:53:24 - utils - INFO - Cascade ensemble: 0 anomalies detected
2025-12-09 16:53:24 - utils - INFO - Evaluating ensemble performance...
2025-12-09 16:53:24 - utils - INFO - 
============================================================
2025-12-09 16:53:24 - utils - INFO - Ensemble (cascade) Performance Metrics
2025-12-09 16:53:24 - utils - INFO - ============================================================
2025-12-09 16:53:24 - utils - INFO - Accuracy:  0.9990
2025-12-09 16:53:24 - utils - INFO - Precision: 0.0000
2025-12-09 16:53:24 - utils - INFO - Recall:    0.0000
2025-12-09 16:53:24 - utils - INFO - F1-Score:  0.0000
2025-12-09 16:53:24 - utils - INFO - AUC-ROC:   0.7067
2025-12-09 16:53:24 - utils - INFO - ============================================================

2025-12-09 16:53:24 - utils - INFO - Comparing ensemble with individual models...
2025-12-09 16:53:24 - utils - INFO - Evaluating ensemble performance...
2025-12-09 16:53:24 - utils - INFO - 
============================================================
2025-12-09 16:53:24 - utils - INFO - Ensemble (cascade) Performance Metrics
2025-12-09 16:53:24 - utils - INFO - ============================================================
2025-12-09 16:53:24 - utils - INFO - Accuracy:  0.9990
2025-12-09 16:53:24 - utils - INFO - Precision: 0.0000
2025-12-09 16:53:24 - utils - INFO - Recall:    0.0000
2025-12-09 16:53:24 - utils - INFO - F1-Score:  0.0000
2025-12-09 16:53:24 - utils - INFO - AUC-ROC:   0.7067
2025-12-09 16:53:24 - utils - INFO - ============================================================

2025-12-09 16:53:24 - utils - INFO - 
Comparison Results:
2025-12-09 16:53:24 - utils - INFO - 
             model  accuracy  precision  recall  f1_score  auc_roc
  Isolation Forest     0.945        0.0     0.0       0.0   0.8208
  Lstm Autoencoder     0.946        0.0     0.0       0.0   0.1842
   Deep Clustering     0.959        0.0     0.0       0.0   0.7407
Ensemble (cascade)     0.999        0.0     0.0       0.0   0.7067
2025-12-09 16:53:24 - utils - INFO - Ensemble predictions saved
2025-12-09 16:53:24 - utils - INFO - Generating alerts...
2025-12-09 16:53:24 - utils - INFO - Generated 35 alerts
2025-12-09 16:53:24 - utils - INFO - Severity distribution:
severity
low         22
high         5
medium       5
critical     3
Name: count, dtype: int64
2025-12-09 16:53:24 - utils - INFO - Alerts saved to /Users/bipinrimal/Downloads/Thesis_work/results/alerts.csv
2025-12-09 16:53:24 - utils - INFO - Ensemble pipeline completed!
2025-12-09 16:53:24 - utils - INFO - 
✓ Stage 5 completed: Best ensemble method = None (F1=0.0000)
2025-12-09 16:53:24 - utils - INFO - 
================================================================================
                             STAGE 6: VISUALIZATION                             
================================================================================

2025-12-09 16:53:24 - utils - INFO - 
================================================================================
                           GENERATING VISUALIZATIONS                            
================================================================================

2025-12-09 16:53:24 - utils - INFO - Creating alert severity distribution plot...
2025-12-09 16:53:24 - utils - INFO - Alert severity distribution plot saved
2025-12-09 16:53:24 - utils - INFO - Creating model agreement plot...
2025-12-09 16:53:24 - utils - INFO - Model agreement plot saved
2025-12-09 16:53:24 - utils - INFO - Creating anomaly score timeline for ensemble_weighted...
2025-12-09 16:53:24 - utils - INFO - Anomaly score timeline saved for ensemble_weighted
2025-12-09 16:53:24 - utils - INFO - Creating feature importance visualization...
2025-12-09 16:53:24 - utils - INFO - Feature importance heatmap saved
2025-12-09 16:53:24 - utils - INFO - Creating executive summary chart...
2025-12-09 16:53:25 - utils - INFO - Executive summary chart saved
2025-12-09 16:53:25 - utils - INFO - All visualizations saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations
2025-12-09 16:53:25 - utils - INFO - Visualization generation completed!
2025-12-09 16:53:25 - utils - INFO - ✓ Stage 6 completed: All visualizations generated
2025-12-09 16:53:25 - utils - INFO - 
================================================================================
2025-12-09 16:53:25 - utils - INFO - FINAL SUMMARY
2025-12-09 16:53:25 - utils - INFO - ================================================================================
2025-12-09 16:53:25 - utils - INFO - 
Model Performance:
2025-12-09 16:53:25 - utils - INFO - 
Isolation Forest:
2025-12-09 16:53:25 - utils - WARNING -   No metrics available for this model.
2025-12-09 16:53:25 - utils - INFO - 
Lstm Autoencoder:
2025-12-09 16:53:25 - utils - WARNING -   No metrics available for this model.
2025-12-09 16:53:25 - utils - INFO - 
Deep Clustering:
2025-12-09 16:53:25 - utils - WARNING -   No metrics available for this model.
2025-12-09 16:53:25 - utils - INFO - 
Generated Output Files:
2025-12-09 16:53:25 - utils - INFO -   - Processed Data: /Users/bipinrimal/Downloads/Thesis_work/data/processed
2025-12-09 16:53:25 - utils - INFO -   - Trained Models: /Users/bipinrimal/Downloads/Thesis_work/models
2025-12-09 16:53:25 - utils - INFO -   - Results & Metrics: /Users/bipinrimal/Downloads/Thesis_work/results
2025-12-09 16:53:25 - utils - INFO -   - Visualizations: /Users/bipinrimal/Downloads/Thesis_work/results/visualizations
2025-12-09 16:53:25 - utils - INFO -   - Alerts: /Users/bipinrimal/Downloads/Thesis_work/results/alerts.csv
2025-12-09 16:53:25 - utils - INFO -   - Logs: /Users/bipinrimal/Downloads/Thesis_work/logs/insider_threat_detection.log
2025-12-09 16:53:25 - utils - INFO - 
================================================================================

2025-12-09 16:53:25 - utils - INFO - 
================================================================================
2025-12-09 16:53:25 - utils - INFO - ✓ PIPELINE EXECUTION COMPLETED SUCCESSFULLY
2025-12-09 16:53:25 - utils - INFO - ================================================================================

2025-12-09 18:22:42 - utils - INFO - Utility functions loaded successfully
2025-12-09 18:22:46 - utils - INFO - ================================================================================
2025-12-09 18:22:46 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-12-09 18:22:46 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-12-09 18:22:46 - utils - INFO - ================================================================================
2025-12-09 18:22:46 - utils - INFO - 
================================================================================
2025-12-09 18:22:46 - utils - INFO - STARTING FULL PIPELINE EXECUTION
2025-12-09 18:22:46 - utils - INFO - ================================================================================

2025-12-09 18:22:46 - utils - INFO - 
================================================================================
                          STAGE 1: DATA PREPROCESSING                           
================================================================================

2025-12-09 18:22:46 - utils - INFO - Processing SUBSET defined in config: ['r1', 'r2', 'r3.1', 'r3.2', 'r4.1', 'r4.2']
2025-12-09 18:22:46 - utils - INFO - 
================================================================================
                          DATA PREPROCESSING (POLARS)                           
================================================================================

2025-12-09 18:22:46 - utils - INFO - Scanning dataset: r1
2025-12-09 18:22:46 - utils - INFO - Scanning dataset: r2
2025-12-09 18:22:46 - utils - INFO - Scanning dataset: r3.1
2025-12-09 18:22:46 - utils - INFO - Scanning dataset: r3.2
2025-12-09 18:22:46 - utils - INFO - Scanning dataset: r4.1
2025-12-09 18:22:46 - utils - INFO - Scanning dataset: r4.2
2025-12-09 18:22:46 - utils - INFO - Constructing execution graph (Diagonal Concat)...
2025-12-09 18:22:46 - utils - INFO - Loaded Psychometric data: 4998 users
2025-12-09 18:22:46 - utils - INFO - Streaming merged data to /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv...
2025-12-09 18:25:14 - utils - INFO - ✓ Preprocessing complete.
2025-12-09 18:25:14 - utils - INFO - ✓ Stage 1 completed: check output file.
2025-12-09 18:25:14 - utils - INFO - 
================================================================================
                          STAGE 2: FEATURE ENGINEERING                          
================================================================================

2025-12-09 18:25:14 - utils - INFO - Aggregating daily features...
2025-12-09 18:27:30 - utils - INFO - Daily aggregation complete: 8998 rows
2025-12-09 18:27:30 - utils - INFO - Calculating Z-scores...
2025-12-09 18:27:30 - utils - INFO - Creating static features...
2025-12-09 18:27:30 - utils - INFO - Saved static features: /Users/bipinrimal/Downloads/Thesis_work/data/processed/static_features.csv
2025-12-09 18:27:30 - utils - INFO - Creating sequences...
2025-12-09 18:27:36 - utils - WARNING - No sequences created (insufficent data length per user?)
2025-12-09 18:27:36 - utils - INFO - Feature engineering complete.
2025-12-09 18:27:36 - utils - INFO - ✓ Stage 2 completed: Polars pipeline finished.
2025-12-09 18:27:36 - utils - INFO - 
================================================================================
                            STAGE 3: MODEL TRAINING                             
================================================================================

2025-12-09 18:27:36 - utils - INFO - 
>>> Training Isolation Forest...
2025-12-09 18:27:36 - utils - INFO - 
================================================================================
                 ISOLATION FOREST TRAINING (V2: MULTI-DATASET)                  
================================================================================

2025-12-09 18:27:36 - utils - INFO - Loading static features from: static_features.csv
2025-12-09 18:27:36 - utils - ERROR - Failed to load 'static_scaler.pkl'. Run feature_engineering.py first. Error: STACK_GLOBAL requires str
2025-12-09 18:27:36 - utils - INFO - ✓ Isolation Forest training completed
2025-12-09 18:27:36 - utils - INFO - 
>>> Training LSTM Autoencoder...
2025-12-09 18:27:36 - utils - INFO - 
================================================================================
                     LIGHTWEIGHT LSTM AUTOENCODER TRAINING                      
================================================================================

2025-12-09 18:27:36 - utils - ERROR - Sequence data not found. Run feature_engineering.py first. Error: [Errno 2] No such file or directory: '/Users/bipinrimal/Downloads/Thesis_work/data/processed/sequences.npy'
2025-12-09 18:27:36 - utils - INFO - ✓ LSTM Autoencoder training completed
2025-12-09 18:27:36 - utils - INFO - 
>>> Training Deep Clustering...
2025-12-09 18:27:36 - utils - INFO - 
================================================================================
                      LIGHTWEIGHT DEEP CLUSTERING TRAINING                      
================================================================================

2025-12-09 18:27:36 - utils - INFO - Loading static features from: static_features.csv
2025-12-09 18:27:36 - utils - ERROR - Failed to load 'static_scaler.pkl'. Run feature_engineering.py first. Error: STACK_GLOBAL requires str
2025-12-09 18:27:36 - utils - INFO - ✓ Deep Clustering training completed
2025-12-09 18:27:36 - utils - INFO - 
✓ Stage 3 completed: 3 models trained
2025-12-09 18:27:36 - utils - INFO - 
================================================================================
                           STAGE 4: MODEL EVALUATION                            
================================================================================

2025-12-09 18:27:36 - utils - INFO - 
================================================================================
                         COMPREHENSIVE MODEL EVALUATION                         
================================================================================

2025-12-09 18:27:36 - utils - INFO - Loading results for all models...
2025-12-09 18:27:36 - utils - INFO - Loaded results for isolation_forest
2025-12-09 18:27:36 - utils - INFO - Loaded results for lstm_autoencoder
2025-12-09 18:27:36 - utils - INFO - Loaded results for deep_clustering
2025-12-09 18:27:36 - utils - INFO - Loaded results for 3 models
2025-12-09 18:27:36 - utils - INFO - Creating metrics comparison table...
2025-12-09 18:27:36 - utils - INFO - Metrics comparison table created
2025-12-09 18:27:36 - utils - INFO - Creating confusion matrix plots...
2025-12-09 18:27:36 - utils - INFO - Confusion matrices saved to /Users/bipinrimal/Downloads/Thesis_work/results/confusion_matrices/all_models.png
2025-12-09 18:27:36 - utils - INFO - Creating ROC curves...
2025-12-09 18:27:36 - utils - INFO - ROC curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/roc_curves/roc_comparison.png
2025-12-09 18:27:36 - utils - INFO - Creating Precision-Recall curves...
2025-12-09 18:27:36 - utils - INFO - Precision-Recall curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/precision_recall_comparison.png
2025-12-09 18:27:36 - utils - INFO - Creating metrics comparison bar chart...
2025-12-09 18:27:36 - utils - INFO - Metrics comparison bar chart saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/metrics_comparison_bar.png
2025-12-09 18:27:36 - utils - INFO - Creating anomaly score distribution plots...
2025-12-09 18:27:37 - utils - INFO - Score distributions saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/score_distributions.png
2025-12-09 18:27:37 - utils - INFO - Generating evaluation report...
2025-12-09 18:27:37 - utils - INFO - Evaluation report saved to /Users/bipinrimal/Downloads/Thesis_work/results/evaluation_report.txt
2025-12-09 18:27:37 - utils - INFO - Comprehensive evaluation completed!
2025-12-09 18:27:37 - utils - INFO - ✓ Stage 4 completed: Comprehensive evaluation report generated
2025-12-09 18:27:37 - utils - INFO - 
================================================================================
                         STAGE 5: ENSEMBLE INTEGRATION                          
================================================================================

2025-12-09 18:27:37 - utils - INFO - Initialized Ensemble Detector with method: weighted
2025-12-09 18:27:37 - utils - INFO - 
================================================================================
                            ENSEMBLE SYSTEM PIPELINE                            
================================================================================

2025-12-09 18:27:37 - utils - INFO - Loading predictions from individual models...
2025-12-09 18:27:37 - utils - INFO - Loaded isolation_forest predictions: 1000 samples
2025-12-09 18:27:37 - utils - INFO - Loaded lstm_autoencoder predictions: 32531 samples
2025-12-09 18:27:37 - utils - INFO - Loaded deep_clustering predictions: 1000 samples
2025-12-09 18:27:37 - utils - WARNING - Models have different sample counts: {'isolation_forest': 1000, 'lstm_autoencoder': 32531, 'deep_clustering': 1000}
2025-12-09 18:27:37 - utils - INFO - Will use aggregation strategy to align predictions...
2025-12-09 18:27:37 - utils - INFO - Aligning predictions across models...
2025-12-09 18:27:37 - utils - INFO - Using isolation_forest as reference (1000 samples)
2025-12-09 18:27:37 - utils - INFO - Aggregating lstm_autoencoder from 32531 to 1000 samples
2025-12-09 18:27:37 - utils - INFO - Predictions aligned successfully
2025-12-09 18:27:37 - utils - INFO - Loaded predictions from 3 models
2025-12-09 18:27:37 - utils - INFO - Computing weighted ensemble...
2025-12-09 18:27:37 - utils - INFO - Weighted ensemble: 0 anomalies detected
2025-12-09 18:27:37 - utils - INFO - Evaluating ensemble performance...
2025-12-09 18:27:37 - utils - INFO - 
============================================================
2025-12-09 18:27:37 - utils - INFO - Ensemble (weighted) Performance Metrics
2025-12-09 18:27:37 - utils - INFO - ============================================================
2025-12-09 18:27:37 - utils - INFO - Accuracy:  0.9990
2025-12-09 18:27:37 - utils - INFO - Precision: 0.0000
2025-12-09 18:27:37 - utils - INFO - Recall:    0.0000
2025-12-09 18:27:37 - utils - INFO - F1-Score:  0.0000
2025-12-09 18:27:37 - utils - INFO - AUC-ROC:   0.7978
2025-12-09 18:27:37 - utils - INFO - ============================================================

2025-12-09 18:27:37 - utils - INFO - Comparing ensemble with individual models...
2025-12-09 18:27:37 - utils - INFO - Evaluating ensemble performance...
2025-12-09 18:27:37 - utils - INFO - 
============================================================
2025-12-09 18:27:37 - utils - INFO - Ensemble (weighted) Performance Metrics
2025-12-09 18:27:37 - utils - INFO - ============================================================
2025-12-09 18:27:37 - utils - INFO - Accuracy:  0.9990
2025-12-09 18:27:37 - utils - INFO - Precision: 0.0000
2025-12-09 18:27:37 - utils - INFO - Recall:    0.0000
2025-12-09 18:27:37 - utils - INFO - F1-Score:  0.0000
2025-12-09 18:27:37 - utils - INFO - AUC-ROC:   0.7978
2025-12-09 18:27:37 - utils - INFO - ============================================================

2025-12-09 18:27:37 - utils - INFO - 
Comparison Results:
2025-12-09 18:27:37 - utils - INFO - 
              model  accuracy  precision  recall  f1_score  auc_roc
   Isolation Forest     0.945        0.0     0.0       0.0   0.8208
   Lstm Autoencoder     0.946        0.0     0.0       0.0   0.1842
    Deep Clustering     0.959        0.0     0.0       0.0   0.7407
Ensemble (weighted)     0.999        0.0     0.0       0.0   0.7978
2025-12-09 18:27:37 - utils - INFO - Ensemble predictions saved
2025-12-09 18:27:37 - utils - INFO - Generating alerts...
2025-12-09 18:27:37 - utils - ERROR - Error with weighted ensemble: 'severity'
2025-12-09 18:27:37 - utils - INFO - Initialized Ensemble Detector with method: majority
2025-12-09 18:27:37 - utils - INFO - 
================================================================================
                            ENSEMBLE SYSTEM PIPELINE                            
================================================================================

2025-12-09 18:27:37 - utils - INFO - Loading predictions from individual models...
2025-12-09 18:27:37 - utils - INFO - Loaded isolation_forest predictions: 1000 samples
2025-12-09 18:27:37 - utils - INFO - Loaded lstm_autoencoder predictions: 32531 samples
2025-12-09 18:27:37 - utils - INFO - Loaded deep_clustering predictions: 1000 samples
2025-12-09 18:27:37 - utils - WARNING - Models have different sample counts: {'isolation_forest': 1000, 'lstm_autoencoder': 32531, 'deep_clustering': 1000}
2025-12-09 18:27:37 - utils - INFO - Will use aggregation strategy to align predictions...
2025-12-09 18:27:37 - utils - INFO - Aligning predictions across models...
2025-12-09 18:27:37 - utils - INFO - Using isolation_forest as reference (1000 samples)
2025-12-09 18:27:37 - utils - INFO - Aggregating lstm_autoencoder from 32531 to 1000 samples
2025-12-09 18:27:37 - utils - INFO - Predictions aligned successfully
2025-12-09 18:27:37 - utils - INFO - Loaded predictions from 3 models
2025-12-09 18:27:37 - utils - INFO - Computing majority voting ensemble...
2025-12-09 18:27:37 - utils - INFO - Majority voting: 11 anomalies detected
2025-12-09 18:27:37 - utils - INFO - Evaluating ensemble performance...
2025-12-09 18:27:37 - utils - INFO - 
============================================================
2025-12-09 18:27:37 - utils - INFO - Ensemble (majority) Performance Metrics
2025-12-09 18:27:37 - utils - INFO - ============================================================
2025-12-09 18:27:37 - utils - INFO - Accuracy:  0.9880
2025-12-09 18:27:37 - utils - INFO - Precision: 0.0000
2025-12-09 18:27:37 - utils - INFO - Recall:    0.0000
2025-12-09 18:27:37 - utils - INFO - F1-Score:  0.0000
2025-12-09 18:27:37 - utils - INFO - AUC-ROC:   0.8018
2025-12-09 18:27:37 - utils - INFO - ============================================================

2025-12-09 18:27:37 - utils - INFO - Comparing ensemble with individual models...
2025-12-09 18:27:37 - utils - INFO - Evaluating ensemble performance...
2025-12-09 18:27:37 - utils - INFO - 
============================================================
2025-12-09 18:27:37 - utils - INFO - Ensemble (majority) Performance Metrics
2025-12-09 18:27:37 - utils - INFO - ============================================================
2025-12-09 18:27:37 - utils - INFO - Accuracy:  0.9880
2025-12-09 18:27:37 - utils - INFO - Precision: 0.0000
2025-12-09 18:27:37 - utils - INFO - Recall:    0.0000
2025-12-09 18:27:37 - utils - INFO - F1-Score:  0.0000
2025-12-09 18:27:37 - utils - INFO - AUC-ROC:   0.8018
2025-12-09 18:27:37 - utils - INFO - ============================================================

2025-12-09 18:27:37 - utils - INFO - 
Comparison Results:
2025-12-09 18:27:37 - utils - INFO - 
              model  accuracy  precision  recall  f1_score  auc_roc
   Isolation Forest     0.945        0.0     0.0       0.0   0.8208
   Lstm Autoencoder     0.946        0.0     0.0       0.0   0.1842
    Deep Clustering     0.959        0.0     0.0       0.0   0.7407
Ensemble (majority)     0.988        0.0     0.0       0.0   0.8018
2025-12-09 18:27:37 - utils - INFO - Ensemble predictions saved
2025-12-09 18:27:37 - utils - INFO - Generating alerts...
2025-12-09 18:27:37 - utils - ERROR - Error with majority ensemble: 'severity'
2025-12-09 18:27:37 - utils - INFO - Initialized Ensemble Detector with method: cascade
2025-12-09 18:27:37 - utils - INFO - 
================================================================================
                            ENSEMBLE SYSTEM PIPELINE                            
================================================================================

2025-12-09 18:27:37 - utils - INFO - Loading predictions from individual models...
2025-12-09 18:27:37 - utils - INFO - Loaded isolation_forest predictions: 1000 samples
2025-12-09 18:27:37 - utils - INFO - Loaded lstm_autoencoder predictions: 32531 samples
2025-12-09 18:27:37 - utils - INFO - Loaded deep_clustering predictions: 1000 samples
2025-12-09 18:27:37 - utils - WARNING - Models have different sample counts: {'isolation_forest': 1000, 'lstm_autoencoder': 32531, 'deep_clustering': 1000}
2025-12-09 18:27:37 - utils - INFO - Will use aggregation strategy to align predictions...
2025-12-09 18:27:37 - utils - INFO - Aligning predictions across models...
2025-12-09 18:27:37 - utils - INFO - Using isolation_forest as reference (1000 samples)
2025-12-09 18:27:37 - utils - INFO - Aggregating lstm_autoencoder from 32531 to 1000 samples
2025-12-09 18:27:37 - utils - INFO - Predictions aligned successfully
2025-12-09 18:27:37 - utils - INFO - Loaded predictions from 3 models
2025-12-09 18:27:37 - utils - INFO - Computing cascade ensemble...
2025-12-09 18:27:37 - utils - INFO - Cascade ensemble: 0 anomalies detected
2025-12-09 18:27:37 - utils - INFO - Evaluating ensemble performance...
2025-12-09 18:27:37 - utils - INFO - 
============================================================
2025-12-09 18:27:37 - utils - INFO - Ensemble (cascade) Performance Metrics
2025-12-09 18:27:37 - utils - INFO - ============================================================
2025-12-09 18:27:37 - utils - INFO - Accuracy:  0.9990
2025-12-09 18:27:37 - utils - INFO - Precision: 0.0000
2025-12-09 18:27:37 - utils - INFO - Recall:    0.0000
2025-12-09 18:27:37 - utils - INFO - F1-Score:  0.0000
2025-12-09 18:27:37 - utils - INFO - AUC-ROC:   0.7067
2025-12-09 18:27:37 - utils - INFO - ============================================================

2025-12-09 18:27:37 - utils - INFO - Comparing ensemble with individual models...
2025-12-09 18:27:37 - utils - INFO - Evaluating ensemble performance...
2025-12-09 18:27:37 - utils - INFO - 
============================================================
2025-12-09 18:27:37 - utils - INFO - Ensemble (cascade) Performance Metrics
2025-12-09 18:27:37 - utils - INFO - ============================================================
2025-12-09 18:27:37 - utils - INFO - Accuracy:  0.9990
2025-12-09 18:27:37 - utils - INFO - Precision: 0.0000
2025-12-09 18:27:37 - utils - INFO - Recall:    0.0000
2025-12-09 18:27:37 - utils - INFO - F1-Score:  0.0000
2025-12-09 18:27:37 - utils - INFO - AUC-ROC:   0.7067
2025-12-09 18:27:37 - utils - INFO - ============================================================

2025-12-09 18:27:37 - utils - INFO - 
Comparison Results:
2025-12-09 18:27:37 - utils - INFO - 
             model  accuracy  precision  recall  f1_score  auc_roc
  Isolation Forest     0.945        0.0     0.0       0.0   0.8208
  Lstm Autoencoder     0.946        0.0     0.0       0.0   0.1842
   Deep Clustering     0.959        0.0     0.0       0.0   0.7407
Ensemble (cascade)     0.999        0.0     0.0       0.0   0.7067
2025-12-09 18:27:37 - utils - INFO - Ensemble predictions saved
2025-12-09 18:27:37 - utils - INFO - Generating alerts...
2025-12-09 18:27:37 - utils - INFO - Generated 35 alerts
2025-12-09 18:27:37 - utils - INFO - Severity distribution:
severity
low         22
high         5
medium       5
critical     3
Name: count, dtype: int64
2025-12-09 18:27:37 - utils - INFO - Alerts saved to /Users/bipinrimal/Downloads/Thesis_work/results/alerts.csv
2025-12-09 18:27:37 - utils - INFO - Ensemble pipeline completed!
2025-12-09 18:27:37 - utils - INFO - 
✓ Stage 5 completed: Best ensemble method = None (F1=0.0000)
2025-12-09 18:27:37 - utils - INFO - 
================================================================================
                             STAGE 6: VISUALIZATION                             
================================================================================

2025-12-09 18:27:37 - utils - INFO - 
================================================================================
                           GENERATING VISUALIZATIONS                            
================================================================================

2025-12-09 18:27:37 - utils - INFO - Creating alert severity distribution plot...
2025-12-09 18:27:37 - utils - INFO - Alert severity distribution plot saved
2025-12-09 18:27:37 - utils - INFO - Creating model agreement plot...
2025-12-09 18:27:37 - utils - INFO - Model agreement plot saved
2025-12-09 18:27:37 - utils - INFO - Creating anomaly score timeline for ensemble_weighted...
2025-12-09 18:27:37 - utils - INFO - Anomaly score timeline saved for ensemble_weighted
2025-12-09 18:27:37 - utils - INFO - Creating feature importance visualization...
2025-12-09 18:27:37 - utils - INFO - Feature importance heatmap saved
2025-12-09 18:27:37 - utils - INFO - Creating executive summary chart...
2025-12-09 18:27:37 - utils - INFO - Executive summary chart saved
2025-12-09 18:27:37 - utils - INFO - All visualizations saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations
2025-12-09 18:27:37 - utils - INFO - Visualization generation completed!
2025-12-09 18:27:37 - utils - INFO - ✓ Stage 6 completed: All visualizations generated
2025-12-09 18:27:37 - utils - INFO - 
================================================================================
2025-12-09 18:27:37 - utils - INFO - FINAL SUMMARY
2025-12-09 18:27:37 - utils - INFO - ================================================================================
2025-12-09 18:27:37 - utils - INFO - 
Model Performance:
2025-12-09 18:27:37 - utils - INFO - 
Isolation Forest:
2025-12-09 18:27:37 - utils - WARNING -   No metrics available for this model.
2025-12-09 18:27:37 - utils - INFO - 
Lstm Autoencoder:
2025-12-09 18:27:37 - utils - WARNING -   No metrics available for this model.
2025-12-09 18:27:37 - utils - INFO - 
Deep Clustering:
2025-12-09 18:27:37 - utils - WARNING -   No metrics available for this model.
2025-12-09 18:27:37 - utils - INFO - 
Generated Output Files:
2025-12-09 18:27:37 - utils - INFO -   - Processed Data: /Users/bipinrimal/Downloads/Thesis_work/data/processed
2025-12-09 18:27:37 - utils - INFO -   - Trained Models: /Users/bipinrimal/Downloads/Thesis_work/models
2025-12-09 18:27:37 - utils - INFO -   - Results & Metrics: /Users/bipinrimal/Downloads/Thesis_work/results
2025-12-09 18:27:37 - utils - INFO -   - Visualizations: /Users/bipinrimal/Downloads/Thesis_work/results/visualizations
2025-12-09 18:27:37 - utils - INFO -   - Alerts: /Users/bipinrimal/Downloads/Thesis_work/results/alerts.csv
2025-12-09 18:27:37 - utils - INFO -   - Logs: /Users/bipinrimal/Downloads/Thesis_work/logs/insider_threat_detection.log
2025-12-09 18:27:37 - utils - INFO - 
================================================================================

2025-12-09 18:27:37 - utils - INFO - 
================================================================================
2025-12-09 18:27:37 - utils - INFO - ✓ PIPELINE EXECUTION COMPLETED SUCCESSFULLY
2025-12-09 18:27:37 - utils - INFO - ================================================================================

2025-12-09 18:40:28 - utils - INFO - Utility functions loaded successfully
2025-12-09 18:40:32 - utils - INFO - ================================================================================
2025-12-09 18:40:32 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-12-09 18:40:32 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-12-09 18:40:32 - utils - INFO - ================================================================================
2025-12-09 18:40:32 - utils - INFO - 
================================================================================
2025-12-09 18:40:32 - utils - INFO - STARTING FULL PIPELINE EXECUTION
2025-12-09 18:40:32 - utils - INFO - ================================================================================

2025-12-09 18:40:32 - utils - INFO - 
================================================================================
                          STAGE 1: DATA PREPROCESSING                           
================================================================================

2025-12-09 18:40:32 - utils - INFO - Processing SUBSET defined in config: ['r1', 'r2', 'r3.1', 'r3.2', 'r4.1', 'r4.2']
2025-12-09 18:40:32 - utils - INFO - 
================================================================================
                          DATA PREPROCESSING (POLARS)                           
================================================================================

2025-12-09 18:40:32 - utils - INFO - Scanning dataset: r1
2025-12-09 18:40:32 - utils - INFO - Scanning dataset: r2
2025-12-09 18:40:32 - utils - INFO - Scanning dataset: r3.1
2025-12-09 18:40:32 - utils - INFO - Scanning dataset: r3.2
2025-12-09 18:40:32 - utils - INFO - Scanning dataset: r4.1
2025-12-09 18:40:32 - utils - INFO - Scanning dataset: r4.2
2025-12-09 18:40:32 - utils - INFO - Constructing execution graph (Diagonal Concat)...
2025-12-09 18:40:32 - utils - INFO - Loaded Psychometric data: 4998 users
2025-12-09 18:40:32 - utils - INFO - Streaming merged data to /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv...
2025-12-09 18:43:09 - utils - INFO - ✓ Preprocessing complete.
2025-12-09 18:43:09 - utils - INFO - ✓ Stage 1 completed: check output file.
2025-12-09 18:43:09 - utils - INFO - 
================================================================================
                          STAGE 2: FEATURE ENGINEERING                          
================================================================================

2025-12-09 18:43:09 - utils - INFO - Aggregating daily features...
2025-12-09 18:46:08 - utils - INFO - Daily aggregation complete: 2984897 rows
2025-12-09 18:46:08 - utils - INFO - Calculating Z-scores...
2025-12-09 18:46:08 - utils - INFO - Creating static features...
2025-12-09 18:46:09 - utils - INFO - Saved static features: /Users/bipinrimal/Downloads/Thesis_work/data/processed/static_features.csv
2025-12-09 18:46:09 - utils - INFO - Creating sequences...
2025-12-09 18:55:12 - utils - INFO - Saved sequences: (292703, 15, 33)
2025-12-09 18:55:12 - utils - INFO - Feature engineering complete.
2025-12-09 18:55:12 - utils - INFO - ✓ Stage 2 completed: Polars pipeline finished.
2025-12-09 18:55:12 - utils - INFO - 
================================================================================
                            STAGE 3: MODEL TRAINING                             
================================================================================

2025-12-09 18:55:12 - utils - INFO - 
>>> Training Isolation Forest...
2025-12-09 18:55:12 - utils - INFO - 
================================================================================
                 ISOLATION FOREST TRAINING (V2: MULTI-DATASET)                  
================================================================================

2025-12-09 18:55:12 - utils - INFO - Loading static features from: static_features.csv
2025-12-09 18:55:12 - utils - ERROR - Failed to load 'static_scaler.pkl'. Run feature_engineering.py first. Error: STACK_GLOBAL requires str
2025-12-09 18:55:12 - utils - INFO - ✓ Isolation Forest training completed
2025-12-09 18:55:12 - utils - INFO - 
>>> Training LSTM Autoencoder...
2025-12-09 18:55:12 - utils - INFO - 
================================================================================
                     LIGHTWEIGHT LSTM AUTOENCODER TRAINING                      
================================================================================

2025-12-09 18:55:12 - utils - INFO - Loaded sequences: (292703, 15, 33)
2025-12-09 18:55:12 - utils - INFO - Data split: Train=204892, Val=43905, Test=43906
2025-12-09 18:55:12 - utils - INFO - Insider labels split: Train=0, Val=0, Test=0
2025-12-09 18:55:13 - utils - INFO - Training on 204892 normal sequences
2025-12-09 18:55:13 - utils - ERROR - ✗ LSTM Autoencoder training failed: STACK_GLOBAL requires str
2025-12-09 18:55:13 - utils - INFO - 
>>> Training Deep Clustering...
2025-12-09 18:55:13 - utils - INFO - 
================================================================================
                      LIGHTWEIGHT DEEP CLUSTERING TRAINING                      
================================================================================

2025-12-09 18:55:13 - utils - INFO - Loading static features from: static_features.csv
2025-12-09 18:55:13 - utils - ERROR - Failed to load 'static_scaler.pkl'. Run feature_engineering.py first. Error: STACK_GLOBAL requires str
2025-12-09 18:55:13 - utils - INFO - ✓ Deep Clustering training completed
2025-12-09 18:55:13 - utils - INFO - 
✓ Stage 3 completed: 2 models trained
2025-12-09 18:55:13 - utils - INFO - 
================================================================================
                           STAGE 4: MODEL EVALUATION                            
================================================================================

2025-12-09 18:55:13 - utils - INFO - 
================================================================================
                         COMPREHENSIVE MODEL EVALUATION                         
================================================================================

2025-12-09 18:55:13 - utils - INFO - Loading results for all models...
2025-12-09 18:55:13 - utils - INFO - Loaded results for isolation_forest
2025-12-09 18:55:13 - utils - INFO - Loaded results for lstm_autoencoder
2025-12-09 18:55:13 - utils - INFO - Loaded results for deep_clustering
2025-12-09 18:55:13 - utils - INFO - Loaded results for 3 models
2025-12-09 18:55:13 - utils - INFO - Creating metrics comparison table...
2025-12-09 18:55:13 - utils - INFO - Metrics comparison table created
2025-12-09 18:55:13 - utils - INFO - Creating confusion matrix plots...
2025-12-09 18:55:13 - utils - INFO - Confusion matrices saved to /Users/bipinrimal/Downloads/Thesis_work/results/confusion_matrices/all_models.png
2025-12-09 18:55:13 - utils - INFO - Creating ROC curves...
2025-12-09 18:55:13 - utils - INFO - ROC curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/roc_curves/roc_comparison.png
2025-12-09 18:55:13 - utils - INFO - Creating Precision-Recall curves...
2025-12-09 18:55:14 - utils - INFO - Precision-Recall curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/precision_recall_comparison.png
2025-12-09 18:55:14 - utils - INFO - Creating metrics comparison bar chart...
2025-12-09 18:55:14 - utils - INFO - Metrics comparison bar chart saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/metrics_comparison_bar.png
2025-12-09 18:55:14 - utils - INFO - Creating anomaly score distribution plots...
2025-12-09 18:55:14 - utils - INFO - Score distributions saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/score_distributions.png
2025-12-09 18:55:14 - utils - INFO - Generating evaluation report...
2025-12-09 18:55:14 - utils - INFO - Evaluation report saved to /Users/bipinrimal/Downloads/Thesis_work/results/evaluation_report.txt
2025-12-09 18:55:14 - utils - INFO - Comprehensive evaluation completed!
2025-12-09 18:55:14 - utils - INFO - ✓ Stage 4 completed: Comprehensive evaluation report generated
2025-12-09 18:55:14 - utils - INFO - 
================================================================================
                         STAGE 5: ENSEMBLE INTEGRATION                          
================================================================================

2025-12-09 18:55:14 - utils - INFO - Initialized Ensemble Detector with method: weighted
2025-12-09 18:55:14 - utils - INFO - 
================================================================================
                            ENSEMBLE SYSTEM PIPELINE                            
================================================================================

2025-12-09 18:55:14 - utils - INFO - Loading predictions from individual models...
2025-12-09 18:55:14 - utils - INFO - Loaded isolation_forest predictions: 1000 samples
2025-12-09 18:55:14 - utils - INFO - Loaded lstm_autoencoder predictions: 32531 samples
2025-12-09 18:55:14 - utils - INFO - Loaded deep_clustering predictions: 1000 samples
2025-12-09 18:55:14 - utils - WARNING - Models have different sample counts: {'isolation_forest': 1000, 'lstm_autoencoder': 32531, 'deep_clustering': 1000}
2025-12-09 18:55:14 - utils - INFO - Will use aggregation strategy to align predictions...
2025-12-09 18:55:14 - utils - INFO - Aligning predictions across models...
2025-12-09 18:55:14 - utils - INFO - Using isolation_forest as reference (1000 samples)
2025-12-09 18:55:14 - utils - INFO - Aggregating lstm_autoencoder from 32531 to 1000 samples
2025-12-09 18:55:14 - utils - INFO - Predictions aligned successfully
2025-12-09 18:55:14 - utils - INFO - Loaded predictions from 3 models
2025-12-09 18:55:14 - utils - INFO - Computing weighted ensemble...
2025-12-09 18:55:14 - utils - INFO - Weighted ensemble: 0 anomalies detected
2025-12-09 18:55:14 - utils - INFO - Evaluating ensemble performance...
2025-12-09 18:55:14 - utils - INFO - 
============================================================
2025-12-09 18:55:14 - utils - INFO - Ensemble (weighted) Performance Metrics
2025-12-09 18:55:14 - utils - INFO - ============================================================
2025-12-09 18:55:14 - utils - INFO - Accuracy:  0.9990
2025-12-09 18:55:14 - utils - INFO - Precision: 0.0000
2025-12-09 18:55:14 - utils - INFO - Recall:    0.0000
2025-12-09 18:55:14 - utils - INFO - F1-Score:  0.0000
2025-12-09 18:55:14 - utils - INFO - AUC-ROC:   0.7978
2025-12-09 18:55:14 - utils - INFO - ============================================================

2025-12-09 18:55:14 - utils - INFO - Comparing ensemble with individual models...
2025-12-09 18:55:14 - utils - INFO - Evaluating ensemble performance...
2025-12-09 18:55:14 - utils - INFO - 
============================================================
2025-12-09 18:55:14 - utils - INFO - Ensemble (weighted) Performance Metrics
2025-12-09 18:55:14 - utils - INFO - ============================================================
2025-12-09 18:55:14 - utils - INFO - Accuracy:  0.9990
2025-12-09 18:55:14 - utils - INFO - Precision: 0.0000
2025-12-09 18:55:14 - utils - INFO - Recall:    0.0000
2025-12-09 18:55:14 - utils - INFO - F1-Score:  0.0000
2025-12-09 18:55:14 - utils - INFO - AUC-ROC:   0.7978
2025-12-09 18:55:14 - utils - INFO - ============================================================

2025-12-09 18:55:14 - utils - INFO - 
Comparison Results:
2025-12-09 18:55:14 - utils - INFO - 
              model  accuracy  precision  recall  f1_score  auc_roc
   Isolation Forest     0.945        0.0     0.0       0.0   0.8208
   Lstm Autoencoder     0.946        0.0     0.0       0.0   0.1842
    Deep Clustering     0.959        0.0     0.0       0.0   0.7407
Ensemble (weighted)     0.999        0.0     0.0       0.0   0.7978
2025-12-09 18:55:14 - utils - INFO - Ensemble predictions saved
2025-12-09 18:55:14 - utils - INFO - Generating alerts...
2025-12-09 18:55:14 - utils - ERROR - Error with weighted ensemble: 'severity'
2025-12-09 18:55:14 - utils - INFO - Initialized Ensemble Detector with method: majority
2025-12-09 18:55:14 - utils - INFO - 
================================================================================
                            ENSEMBLE SYSTEM PIPELINE                            
================================================================================

2025-12-09 18:55:14 - utils - INFO - Loading predictions from individual models...
2025-12-09 18:55:14 - utils - INFO - Loaded isolation_forest predictions: 1000 samples
2025-12-09 18:55:14 - utils - INFO - Loaded lstm_autoencoder predictions: 32531 samples
2025-12-09 18:55:14 - utils - INFO - Loaded deep_clustering predictions: 1000 samples
2025-12-09 18:55:14 - utils - WARNING - Models have different sample counts: {'isolation_forest': 1000, 'lstm_autoencoder': 32531, 'deep_clustering': 1000}
2025-12-09 18:55:14 - utils - INFO - Will use aggregation strategy to align predictions...
2025-12-09 18:55:14 - utils - INFO - Aligning predictions across models...
2025-12-09 18:55:14 - utils - INFO - Using isolation_forest as reference (1000 samples)
2025-12-09 18:55:14 - utils - INFO - Aggregating lstm_autoencoder from 32531 to 1000 samples
2025-12-09 18:55:14 - utils - INFO - Predictions aligned successfully
2025-12-09 18:55:14 - utils - INFO - Loaded predictions from 3 models
2025-12-09 18:55:14 - utils - INFO - Computing majority voting ensemble...
2025-12-09 18:55:14 - utils - INFO - Majority voting: 11 anomalies detected
2025-12-09 18:55:14 - utils - INFO - Evaluating ensemble performance...
2025-12-09 18:55:14 - utils - INFO - 
============================================================
2025-12-09 18:55:14 - utils - INFO - Ensemble (majority) Performance Metrics
2025-12-09 18:55:14 - utils - INFO - ============================================================
2025-12-09 18:55:14 - utils - INFO - Accuracy:  0.9880
2025-12-09 18:55:14 - utils - INFO - Precision: 0.0000
2025-12-09 18:55:14 - utils - INFO - Recall:    0.0000
2025-12-09 18:55:14 - utils - INFO - F1-Score:  0.0000
2025-12-09 18:55:14 - utils - INFO - AUC-ROC:   0.8018
2025-12-09 18:55:14 - utils - INFO - ============================================================

2025-12-09 18:55:14 - utils - INFO - Comparing ensemble with individual models...
2025-12-09 18:55:14 - utils - INFO - Evaluating ensemble performance...
2025-12-09 18:55:14 - utils - INFO - 
============================================================
2025-12-09 18:55:14 - utils - INFO - Ensemble (majority) Performance Metrics
2025-12-09 18:55:14 - utils - INFO - ============================================================
2025-12-09 18:55:14 - utils - INFO - Accuracy:  0.9880
2025-12-09 18:55:14 - utils - INFO - Precision: 0.0000
2025-12-09 18:55:14 - utils - INFO - Recall:    0.0000
2025-12-09 18:55:14 - utils - INFO - F1-Score:  0.0000
2025-12-09 18:55:14 - utils - INFO - AUC-ROC:   0.8018
2025-12-09 18:55:14 - utils - INFO - ============================================================

2025-12-09 18:55:14 - utils - INFO - 
Comparison Results:
2025-12-09 18:55:14 - utils - INFO - 
              model  accuracy  precision  recall  f1_score  auc_roc
   Isolation Forest     0.945        0.0     0.0       0.0   0.8208
   Lstm Autoencoder     0.946        0.0     0.0       0.0   0.1842
    Deep Clustering     0.959        0.0     0.0       0.0   0.7407
Ensemble (majority)     0.988        0.0     0.0       0.0   0.8018
2025-12-09 18:55:14 - utils - INFO - Ensemble predictions saved
2025-12-09 18:55:14 - utils - INFO - Generating alerts...
2025-12-09 18:55:14 - utils - ERROR - Error with majority ensemble: 'severity'
2025-12-09 18:55:14 - utils - INFO - Initialized Ensemble Detector with method: cascade
2025-12-09 18:55:14 - utils - INFO - 
================================================================================
                            ENSEMBLE SYSTEM PIPELINE                            
================================================================================

2025-12-09 18:55:14 - utils - INFO - Loading predictions from individual models...
2025-12-09 18:55:14 - utils - INFO - Loaded isolation_forest predictions: 1000 samples
2025-12-09 18:55:14 - utils - INFO - Loaded lstm_autoencoder predictions: 32531 samples
2025-12-09 18:55:14 - utils - INFO - Loaded deep_clustering predictions: 1000 samples
2025-12-09 18:55:14 - utils - WARNING - Models have different sample counts: {'isolation_forest': 1000, 'lstm_autoencoder': 32531, 'deep_clustering': 1000}
2025-12-09 18:55:14 - utils - INFO - Will use aggregation strategy to align predictions...
2025-12-09 18:55:14 - utils - INFO - Aligning predictions across models...
2025-12-09 18:55:14 - utils - INFO - Using isolation_forest as reference (1000 samples)
2025-12-09 18:55:14 - utils - INFO - Aggregating lstm_autoencoder from 32531 to 1000 samples
2025-12-09 18:55:14 - utils - INFO - Predictions aligned successfully
2025-12-09 18:55:14 - utils - INFO - Loaded predictions from 3 models
2025-12-09 18:55:14 - utils - INFO - Computing cascade ensemble...
2025-12-09 18:55:14 - utils - INFO - Cascade ensemble: 0 anomalies detected
2025-12-09 18:55:14 - utils - INFO - Evaluating ensemble performance...
2025-12-09 18:55:14 - utils - INFO - 
============================================================
2025-12-09 18:55:14 - utils - INFO - Ensemble (cascade) Performance Metrics
2025-12-09 18:55:14 - utils - INFO - ============================================================
2025-12-09 18:55:14 - utils - INFO - Accuracy:  0.9990
2025-12-09 18:55:14 - utils - INFO - Precision: 0.0000
2025-12-09 18:55:14 - utils - INFO - Recall:    0.0000
2025-12-09 18:55:14 - utils - INFO - F1-Score:  0.0000
2025-12-09 18:55:14 - utils - INFO - AUC-ROC:   0.7067
2025-12-09 18:55:14 - utils - INFO - ============================================================

2025-12-09 18:55:14 - utils - INFO - Comparing ensemble with individual models...
2025-12-09 18:55:14 - utils - INFO - Evaluating ensemble performance...
2025-12-09 18:55:14 - utils - INFO - 
============================================================
2025-12-09 18:55:14 - utils - INFO - Ensemble (cascade) Performance Metrics
2025-12-09 18:55:14 - utils - INFO - ============================================================
2025-12-09 18:55:14 - utils - INFO - Accuracy:  0.9990
2025-12-09 18:55:14 - utils - INFO - Precision: 0.0000
2025-12-09 18:55:14 - utils - INFO - Recall:    0.0000
2025-12-09 18:55:14 - utils - INFO - F1-Score:  0.0000
2025-12-09 18:55:14 - utils - INFO - AUC-ROC:   0.7067
2025-12-09 18:55:14 - utils - INFO - ============================================================

2025-12-09 18:55:14 - utils - INFO - 
Comparison Results:
2025-12-09 18:55:14 - utils - INFO - 
             model  accuracy  precision  recall  f1_score  auc_roc
  Isolation Forest     0.945        0.0     0.0       0.0   0.8208
  Lstm Autoencoder     0.946        0.0     0.0       0.0   0.1842
   Deep Clustering     0.959        0.0     0.0       0.0   0.7407
Ensemble (cascade)     0.999        0.0     0.0       0.0   0.7067
2025-12-09 18:55:14 - utils - INFO - Ensemble predictions saved
2025-12-09 18:55:14 - utils - INFO - Generating alerts...
2025-12-09 18:55:14 - utils - INFO - Generated 35 alerts
2025-12-09 18:55:14 - utils - INFO - Severity distribution:
severity
low         22
high         5
medium       5
critical     3
Name: count, dtype: int64
2025-12-09 18:55:14 - utils - INFO - Alerts saved to /Users/bipinrimal/Downloads/Thesis_work/results/alerts.csv
2025-12-09 18:55:14 - utils - INFO - Ensemble pipeline completed!
2025-12-09 18:55:14 - utils - INFO - 
✓ Stage 5 completed: Best ensemble method = None (F1=0.0000)
2025-12-09 18:55:14 - utils - INFO - 
================================================================================
                             STAGE 6: VISUALIZATION                             
================================================================================

2025-12-09 18:55:14 - utils - INFO - 
================================================================================
                           GENERATING VISUALIZATIONS                            
================================================================================

2025-12-09 18:55:14 - utils - INFO - Creating alert severity distribution plot...
2025-12-09 18:55:14 - utils - INFO - Alert severity distribution plot saved
2025-12-09 18:55:14 - utils - INFO - Creating model agreement plot...
2025-12-09 18:55:15 - utils - INFO - Model agreement plot saved
2025-12-09 18:55:15 - utils - INFO - Creating anomaly score timeline for ensemble_weighted...
2025-12-09 18:55:15 - utils - INFO - Anomaly score timeline saved for ensemble_weighted
2025-12-09 18:55:15 - utils - INFO - Creating feature importance visualization...
2025-12-09 18:55:15 - utils - INFO - Feature importance heatmap saved
2025-12-09 18:55:15 - utils - INFO - Creating executive summary chart...
2025-12-09 18:55:15 - utils - INFO - Executive summary chart saved
2025-12-09 18:55:15 - utils - INFO - All visualizations saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations
2025-12-09 18:55:15 - utils - INFO - Visualization generation completed!
2025-12-09 18:55:15 - utils - INFO - ✓ Stage 6 completed: All visualizations generated
2025-12-09 18:55:15 - utils - INFO - 
================================================================================
2025-12-09 18:55:15 - utils - INFO - FINAL SUMMARY
2025-12-09 18:55:15 - utils - INFO - ================================================================================
2025-12-09 18:55:15 - utils - INFO - 
Model Performance:
2025-12-09 18:55:15 - utils - INFO - 
Isolation Forest:
2025-12-09 18:55:15 - utils - WARNING -   No metrics available for this model.
2025-12-09 18:55:15 - utils - INFO - 
Deep Clustering:
2025-12-09 18:55:15 - utils - WARNING -   No metrics available for this model.
2025-12-09 18:55:15 - utils - INFO - 
Generated Output Files:
2025-12-09 18:55:15 - utils - INFO -   - Processed Data: /Users/bipinrimal/Downloads/Thesis_work/data/processed
2025-12-09 18:55:15 - utils - INFO -   - Trained Models: /Users/bipinrimal/Downloads/Thesis_work/models
2025-12-09 18:55:15 - utils - INFO -   - Results & Metrics: /Users/bipinrimal/Downloads/Thesis_work/results
2025-12-09 18:55:15 - utils - INFO -   - Visualizations: /Users/bipinrimal/Downloads/Thesis_work/results/visualizations
2025-12-09 18:55:15 - utils - INFO -   - Alerts: /Users/bipinrimal/Downloads/Thesis_work/results/alerts.csv
2025-12-09 18:55:15 - utils - INFO -   - Logs: /Users/bipinrimal/Downloads/Thesis_work/logs/insider_threat_detection.log
2025-12-09 18:55:15 - utils - INFO - 
================================================================================

2025-12-09 18:55:15 - utils - INFO - 
================================================================================
2025-12-09 18:55:15 - utils - INFO - ✓ PIPELINE EXECUTION COMPLETED SUCCESSFULLY
2025-12-09 18:55:15 - utils - INFO - ================================================================================

2025-12-09 18:58:04 - utils - INFO - Utility functions loaded successfully
2025-12-09 18:58:08 - utils - INFO - ================================================================================
2025-12-09 18:58:08 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-12-09 18:58:08 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-12-09 18:58:08 - utils - INFO - ================================================================================
2025-12-09 18:58:08 - utils - INFO - 
================================================================================
2025-12-09 18:58:08 - utils - INFO - STARTING FULL PIPELINE EXECUTION
2025-12-09 18:58:08 - utils - INFO - ================================================================================

2025-12-09 18:58:08 - utils - INFO - 
================================================================================
                          STAGE 1: DATA PREPROCESSING                           
================================================================================

2025-12-09 18:58:08 - utils - INFO - Processing SUBSET defined in config: ['r1', 'r2', 'r3.1', 'r3.2', 'r4.1', 'r4.2']
2025-12-09 18:58:08 - utils - INFO - 
================================================================================
                          DATA PREPROCESSING (POLARS)                           
================================================================================

2025-12-09 18:58:08 - utils - INFO - Scanning dataset: r1
2025-12-09 18:58:08 - utils - INFO - Scanning dataset: r2
2025-12-09 18:58:08 - utils - INFO - Scanning dataset: r3.1
2025-12-09 18:58:08 - utils - INFO - Scanning dataset: r3.2
2025-12-09 18:58:08 - utils - INFO - Scanning dataset: r4.1
2025-12-09 18:58:08 - utils - INFO - Scanning dataset: r4.2
2025-12-09 18:58:08 - utils - INFO - Constructing execution graph (Diagonal Concat)...
2025-12-09 18:58:08 - utils - INFO - Loaded Psychometric data: 4998 users
2025-12-09 18:58:08 - utils - INFO - Streaming merged data to /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv...
2025-12-09 19:00:46 - utils - INFO - ✓ Preprocessing complete.
2025-12-09 19:00:46 - utils - INFO - ✓ Stage 1 completed: check output file.
2025-12-09 19:00:46 - utils - INFO - 
================================================================================
                          STAGE 2: FEATURE ENGINEERING                          
================================================================================

2025-12-09 19:00:46 - utils - INFO - Aggregating daily features...
2025-12-09 19:03:32 - utils - INFO - Daily aggregation complete: 2984897 rows
2025-12-09 19:03:32 - utils - INFO - Calculating Z-scores...
2025-12-09 19:03:33 - utils - INFO - Creating static features...
2025-12-09 19:03:33 - utils - INFO - Saved static features: /Users/bipinrimal/Downloads/Thesis_work/data/processed/static_features.csv
2025-12-09 19:03:33 - utils - INFO - Creating sequences...
2025-12-09 19:12:25 - utils - INFO - Saved sequences: (292703, 15, 33)
2025-12-09 19:12:26 - utils - INFO - Feature engineering complete.
2025-12-09 19:12:26 - utils - INFO - ✓ Stage 2 completed: Polars pipeline finished.
2025-12-09 19:12:26 - utils - INFO - 
================================================================================
                            STAGE 3: MODEL TRAINING                             
================================================================================

2025-12-09 19:12:26 - utils - INFO - 
>>> Training Isolation Forest...
2025-12-09 19:12:26 - utils - INFO - 
================================================================================
                 ISOLATION FOREST TRAINING (V2: MULTI-DATASET)                  
================================================================================

2025-12-09 19:12:26 - utils - INFO - Loading static features from: static_features.csv
2025-12-09 19:12:26 - utils - ERROR - Failed to load 'static_scaler.pkl'. Run feature_engineering.py first. Error: STACK_GLOBAL requires str
2025-12-09 19:12:26 - utils - INFO - ✓ Isolation Forest training completed
2025-12-09 19:12:26 - utils - INFO - 
>>> Training LSTM Autoencoder...
2025-12-09 19:12:26 - utils - INFO - 
================================================================================
                     LIGHTWEIGHT LSTM AUTOENCODER TRAINING                      
================================================================================

2025-12-09 19:12:26 - utils - INFO - Loaded sequences: (292703, 15, 33)
2025-12-09 19:12:26 - utils - INFO - Data split: Train=204892, Val=43905, Test=43906
2025-12-09 19:12:26 - utils - INFO - Insider labels split: Train=0, Val=0, Test=0
2025-12-09 19:12:26 - utils - INFO - Training on 204892 normal sequences
2025-12-09 19:12:26 - utils - ERROR - ✗ LSTM Autoencoder training failed: STACK_GLOBAL requires str
2025-12-09 19:12:26 - utils - INFO - 
>>> Training Deep Clustering...
2025-12-09 19:12:26 - utils - INFO - 
================================================================================
                      LIGHTWEIGHT DEEP CLUSTERING TRAINING                      
================================================================================

2025-12-09 19:12:26 - utils - INFO - Loading static features from: static_features.csv
2025-12-09 19:12:27 - utils - ERROR - Failed to load 'static_scaler.pkl'. Run feature_engineering.py first. Error: STACK_GLOBAL requires str
2025-12-09 19:12:27 - utils - INFO - ✓ Deep Clustering training completed
2025-12-09 19:12:27 - utils - INFO - 
✓ Stage 3 completed: 2 models trained
2025-12-09 19:12:27 - utils - INFO - 
================================================================================
                           STAGE 4: MODEL EVALUATION                            
================================================================================

2025-12-09 19:12:27 - utils - INFO - 
================================================================================
                         COMPREHENSIVE MODEL EVALUATION                         
================================================================================

2025-12-09 19:12:27 - utils - INFO - Loading results for all models...
2025-12-09 19:12:27 - utils - INFO - Loaded results for isolation_forest
2025-12-09 19:12:27 - utils - INFO - Loaded results for lstm_autoencoder
2025-12-09 19:12:27 - utils - INFO - Loaded results for deep_clustering
2025-12-09 19:12:27 - utils - INFO - Loaded results for 3 models
2025-12-09 19:12:27 - utils - INFO - Creating metrics comparison table...
2025-12-09 19:12:27 - utils - INFO - Metrics comparison table created
2025-12-09 19:12:27 - utils - INFO - Creating confusion matrix plots...
2025-12-09 19:12:27 - utils - INFO - Confusion matrices saved to /Users/bipinrimal/Downloads/Thesis_work/results/confusion_matrices/all_models.png
2025-12-09 19:12:27 - utils - INFO - Creating ROC curves...
2025-12-09 19:12:27 - utils - INFO - ROC curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/roc_curves/roc_comparison.png
2025-12-09 19:12:27 - utils - INFO - Creating Precision-Recall curves...
2025-12-09 19:12:27 - utils - INFO - Precision-Recall curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/precision_recall_comparison.png
2025-12-09 19:12:27 - utils - INFO - Creating metrics comparison bar chart...
2025-12-09 19:12:27 - utils - INFO - Metrics comparison bar chart saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/metrics_comparison_bar.png
2025-12-09 19:12:27 - utils - INFO - Creating anomaly score distribution plots...
2025-12-09 19:12:28 - utils - INFO - Score distributions saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/score_distributions.png
2025-12-09 19:12:28 - utils - INFO - Generating evaluation report...
2025-12-09 19:12:28 - utils - INFO - Evaluation report saved to /Users/bipinrimal/Downloads/Thesis_work/results/evaluation_report.txt
2025-12-09 19:12:28 - utils - INFO - Comprehensive evaluation completed!
2025-12-09 19:12:28 - utils - INFO - ✓ Stage 4 completed: Comprehensive evaluation report generated
2025-12-09 19:12:28 - utils - INFO - 
================================================================================
                         STAGE 5: ENSEMBLE INTEGRATION                          
================================================================================

2025-12-09 19:12:28 - utils - INFO - Initialized Ensemble Detector with method: weighted
2025-12-09 19:12:28 - utils - INFO - 
================================================================================
                            ENSEMBLE SYSTEM PIPELINE                            
================================================================================

2025-12-09 19:12:28 - utils - INFO - Loading predictions from individual models...
2025-12-09 19:12:28 - utils - INFO - Loaded isolation_forest predictions: 1000 samples
2025-12-09 19:12:28 - utils - INFO - Loaded lstm_autoencoder predictions: 32531 samples
2025-12-09 19:12:28 - utils - INFO - Loaded deep_clustering predictions: 1000 samples
2025-12-09 19:12:28 - utils - WARNING - Models have different sample counts: {'isolation_forest': 1000, 'lstm_autoencoder': 32531, 'deep_clustering': 1000}
2025-12-09 19:12:28 - utils - INFO - Will use aggregation strategy to align predictions...
2025-12-09 19:12:28 - utils - INFO - Aligning predictions across models...
2025-12-09 19:12:28 - utils - INFO - Using isolation_forest as reference (1000 samples)
2025-12-09 19:12:28 - utils - INFO - Aggregating lstm_autoencoder from 32531 to 1000 samples
2025-12-09 19:12:28 - utils - INFO - Predictions aligned successfully
2025-12-09 19:12:28 - utils - INFO - Loaded predictions from 3 models
2025-12-09 19:12:28 - utils - INFO - Computing weighted ensemble...
2025-12-09 19:12:28 - utils - INFO - Weighted ensemble: 0 anomalies detected
2025-12-09 19:12:28 - utils - INFO - Evaluating ensemble performance...
2025-12-09 19:12:28 - utils - INFO - 
============================================================
2025-12-09 19:12:28 - utils - INFO - Ensemble (weighted) Performance Metrics
2025-12-09 19:12:28 - utils - INFO - ============================================================
2025-12-09 19:12:28 - utils - INFO - Accuracy:  0.9990
2025-12-09 19:12:28 - utils - INFO - Precision: 0.0000
2025-12-09 19:12:28 - utils - INFO - Recall:    0.0000
2025-12-09 19:12:28 - utils - INFO - F1-Score:  0.0000
2025-12-09 19:12:28 - utils - INFO - AUC-ROC:   0.7978
2025-12-09 19:12:28 - utils - INFO - ============================================================

2025-12-09 19:12:28 - utils - INFO - Comparing ensemble with individual models...
2025-12-09 19:12:28 - utils - INFO - Evaluating ensemble performance...
2025-12-09 19:12:28 - utils - INFO - 
============================================================
2025-12-09 19:12:28 - utils - INFO - Ensemble (weighted) Performance Metrics
2025-12-09 19:12:28 - utils - INFO - ============================================================
2025-12-09 19:12:28 - utils - INFO - Accuracy:  0.9990
2025-12-09 19:12:28 - utils - INFO - Precision: 0.0000
2025-12-09 19:12:28 - utils - INFO - Recall:    0.0000
2025-12-09 19:12:28 - utils - INFO - F1-Score:  0.0000
2025-12-09 19:12:28 - utils - INFO - AUC-ROC:   0.7978
2025-12-09 19:12:28 - utils - INFO - ============================================================

2025-12-09 19:12:28 - utils - INFO - 
Comparison Results:
2025-12-09 19:12:28 - utils - INFO - 
              model  accuracy  precision  recall  f1_score  auc_roc
   Isolation Forest     0.945        0.0     0.0       0.0   0.8208
   Lstm Autoencoder     0.946        0.0     0.0       0.0   0.1842
    Deep Clustering     0.959        0.0     0.0       0.0   0.7407
Ensemble (weighted)     0.999        0.0     0.0       0.0   0.7978
2025-12-09 19:12:28 - utils - INFO - Ensemble predictions saved
2025-12-09 19:12:28 - utils - INFO - Generating alerts...
2025-12-09 19:12:28 - utils - ERROR - Error with weighted ensemble: 'severity'
2025-12-09 19:12:28 - utils - INFO - Initialized Ensemble Detector with method: majority
2025-12-09 19:12:28 - utils - INFO - 
================================================================================
                            ENSEMBLE SYSTEM PIPELINE                            
================================================================================

2025-12-09 19:12:28 - utils - INFO - Loading predictions from individual models...
2025-12-09 19:12:28 - utils - INFO - Loaded isolation_forest predictions: 1000 samples
2025-12-09 19:12:28 - utils - INFO - Loaded lstm_autoencoder predictions: 32531 samples
2025-12-09 19:12:28 - utils - INFO - Loaded deep_clustering predictions: 1000 samples
2025-12-09 19:12:28 - utils - WARNING - Models have different sample counts: {'isolation_forest': 1000, 'lstm_autoencoder': 32531, 'deep_clustering': 1000}
2025-12-09 19:12:28 - utils - INFO - Will use aggregation strategy to align predictions...
2025-12-09 19:12:28 - utils - INFO - Aligning predictions across models...
2025-12-09 19:12:28 - utils - INFO - Using isolation_forest as reference (1000 samples)
2025-12-09 19:12:28 - utils - INFO - Aggregating lstm_autoencoder from 32531 to 1000 samples
2025-12-09 19:12:28 - utils - INFO - Predictions aligned successfully
2025-12-09 19:12:28 - utils - INFO - Loaded predictions from 3 models
2025-12-09 19:12:28 - utils - INFO - Computing majority voting ensemble...
2025-12-09 19:12:28 - utils - INFO - Majority voting: 11 anomalies detected
2025-12-09 19:12:28 - utils - INFO - Evaluating ensemble performance...
2025-12-09 19:12:28 - utils - INFO - 
============================================================
2025-12-09 19:12:28 - utils - INFO - Ensemble (majority) Performance Metrics
2025-12-09 19:12:28 - utils - INFO - ============================================================
2025-12-09 19:12:28 - utils - INFO - Accuracy:  0.9880
2025-12-09 19:12:28 - utils - INFO - Precision: 0.0000
2025-12-09 19:12:28 - utils - INFO - Recall:    0.0000
2025-12-09 19:12:28 - utils - INFO - F1-Score:  0.0000
2025-12-09 19:12:28 - utils - INFO - AUC-ROC:   0.8018
2025-12-09 19:12:28 - utils - INFO - ============================================================

2025-12-09 19:12:28 - utils - INFO - Comparing ensemble with individual models...
2025-12-09 19:12:28 - utils - INFO - Evaluating ensemble performance...
2025-12-09 19:12:28 - utils - INFO - 
============================================================
2025-12-09 19:12:28 - utils - INFO - Ensemble (majority) Performance Metrics
2025-12-09 19:12:28 - utils - INFO - ============================================================
2025-12-09 19:12:28 - utils - INFO - Accuracy:  0.9880
2025-12-09 19:12:28 - utils - INFO - Precision: 0.0000
2025-12-09 19:12:28 - utils - INFO - Recall:    0.0000
2025-12-09 19:12:28 - utils - INFO - F1-Score:  0.0000
2025-12-09 19:12:28 - utils - INFO - AUC-ROC:   0.8018
2025-12-09 19:12:28 - utils - INFO - ============================================================

2025-12-09 19:12:28 - utils - INFO - 
Comparison Results:
2025-12-09 19:12:28 - utils - INFO - 
              model  accuracy  precision  recall  f1_score  auc_roc
   Isolation Forest     0.945        0.0     0.0       0.0   0.8208
   Lstm Autoencoder     0.946        0.0     0.0       0.0   0.1842
    Deep Clustering     0.959        0.0     0.0       0.0   0.7407
Ensemble (majority)     0.988        0.0     0.0       0.0   0.8018
2025-12-09 19:12:28 - utils - INFO - Ensemble predictions saved
2025-12-09 19:12:28 - utils - INFO - Generating alerts...
2025-12-09 19:12:28 - utils - ERROR - Error with majority ensemble: 'severity'
2025-12-09 19:12:28 - utils - INFO - Initialized Ensemble Detector with method: cascade
2025-12-09 19:12:28 - utils - INFO - 
================================================================================
                            ENSEMBLE SYSTEM PIPELINE                            
================================================================================

2025-12-09 19:12:28 - utils - INFO - Loading predictions from individual models...
2025-12-09 19:12:28 - utils - INFO - Loaded isolation_forest predictions: 1000 samples
2025-12-09 19:12:28 - utils - INFO - Loaded lstm_autoencoder predictions: 32531 samples
2025-12-09 19:12:28 - utils - INFO - Loaded deep_clustering predictions: 1000 samples
2025-12-09 19:12:28 - utils - WARNING - Models have different sample counts: {'isolation_forest': 1000, 'lstm_autoencoder': 32531, 'deep_clustering': 1000}
2025-12-09 19:12:28 - utils - INFO - Will use aggregation strategy to align predictions...
2025-12-09 19:12:28 - utils - INFO - Aligning predictions across models...
2025-12-09 19:12:28 - utils - INFO - Using isolation_forest as reference (1000 samples)
2025-12-09 19:12:28 - utils - INFO - Aggregating lstm_autoencoder from 32531 to 1000 samples
2025-12-09 19:12:28 - utils - INFO - Predictions aligned successfully
2025-12-09 19:12:28 - utils - INFO - Loaded predictions from 3 models
2025-12-09 19:12:28 - utils - INFO - Computing cascade ensemble...
2025-12-09 19:12:28 - utils - INFO - Cascade ensemble: 0 anomalies detected
2025-12-09 19:12:28 - utils - INFO - Evaluating ensemble performance...
2025-12-09 19:12:28 - utils - INFO - 
============================================================
2025-12-09 19:12:28 - utils - INFO - Ensemble (cascade) Performance Metrics
2025-12-09 19:12:28 - utils - INFO - ============================================================
2025-12-09 19:12:28 - utils - INFO - Accuracy:  0.9990
2025-12-09 19:12:28 - utils - INFO - Precision: 0.0000
2025-12-09 19:12:28 - utils - INFO - Recall:    0.0000
2025-12-09 19:12:28 - utils - INFO - F1-Score:  0.0000
2025-12-09 19:12:28 - utils - INFO - AUC-ROC:   0.7067
2025-12-09 19:12:28 - utils - INFO - ============================================================

2025-12-09 19:12:28 - utils - INFO - Comparing ensemble with individual models...
2025-12-09 19:12:28 - utils - INFO - Evaluating ensemble performance...
2025-12-09 19:12:28 - utils - INFO - 
============================================================
2025-12-09 19:12:28 - utils - INFO - Ensemble (cascade) Performance Metrics
2025-12-09 19:12:28 - utils - INFO - ============================================================
2025-12-09 19:12:28 - utils - INFO - Accuracy:  0.9990
2025-12-09 19:12:28 - utils - INFO - Precision: 0.0000
2025-12-09 19:12:28 - utils - INFO - Recall:    0.0000
2025-12-09 19:12:28 - utils - INFO - F1-Score:  0.0000
2025-12-09 19:12:28 - utils - INFO - AUC-ROC:   0.7067
2025-12-09 19:12:28 - utils - INFO - ============================================================

2025-12-09 19:12:28 - utils - INFO - 
Comparison Results:
2025-12-09 19:12:28 - utils - INFO - 
             model  accuracy  precision  recall  f1_score  auc_roc
  Isolation Forest     0.945        0.0     0.0       0.0   0.8208
  Lstm Autoencoder     0.946        0.0     0.0       0.0   0.1842
   Deep Clustering     0.959        0.0     0.0       0.0   0.7407
Ensemble (cascade)     0.999        0.0     0.0       0.0   0.7067
2025-12-09 19:12:28 - utils - INFO - Ensemble predictions saved
2025-12-09 19:12:28 - utils - INFO - Generating alerts...
2025-12-09 19:12:28 - utils - INFO - Generated 35 alerts
2025-12-09 19:12:28 - utils - INFO - Severity distribution:
severity
low         22
high         5
medium       5
critical     3
Name: count, dtype: int64
2025-12-09 19:12:28 - utils - INFO - Alerts saved to /Users/bipinrimal/Downloads/Thesis_work/results/alerts.csv
2025-12-09 19:12:28 - utils - INFO - Ensemble pipeline completed!
2025-12-09 19:12:28 - utils - INFO - 
✓ Stage 5 completed: Best ensemble method = None (F1=0.0000)
2025-12-09 19:12:28 - utils - INFO - 
================================================================================
                             STAGE 6: VISUALIZATION                             
================================================================================

2025-12-09 19:12:28 - utils - INFO - 
================================================================================
                           GENERATING VISUALIZATIONS                            
================================================================================

2025-12-09 19:12:28 - utils - INFO - Creating alert severity distribution plot...
2025-12-09 19:12:28 - utils - INFO - Alert severity distribution plot saved
2025-12-09 19:12:28 - utils - INFO - Creating model agreement plot...
2025-12-09 19:12:28 - utils - INFO - Model agreement plot saved
2025-12-09 19:12:28 - utils - INFO - Creating anomaly score timeline for ensemble_weighted...
2025-12-09 19:12:29 - utils - INFO - Anomaly score timeline saved for ensemble_weighted
2025-12-09 19:12:29 - utils - INFO - Creating feature importance visualization...
2025-12-09 19:12:29 - utils - INFO - Feature importance heatmap saved
2025-12-09 19:12:29 - utils - INFO - Creating executive summary chart...
2025-12-09 19:12:29 - utils - INFO - Executive summary chart saved
2025-12-09 19:12:29 - utils - INFO - All visualizations saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations
2025-12-09 19:12:29 - utils - INFO - Visualization generation completed!
2025-12-09 19:12:29 - utils - INFO - ✓ Stage 6 completed: All visualizations generated
2025-12-09 19:12:29 - utils - INFO - 
================================================================================
2025-12-09 19:12:29 - utils - INFO - FINAL SUMMARY
2025-12-09 19:12:29 - utils - INFO - ================================================================================
2025-12-09 19:12:29 - utils - INFO - 
Model Performance:
2025-12-09 19:12:29 - utils - INFO - 
Isolation Forest:
2025-12-09 19:12:29 - utils - WARNING -   No metrics available for this model.
2025-12-09 19:12:29 - utils - INFO - 
Deep Clustering:
2025-12-09 19:12:29 - utils - WARNING -   No metrics available for this model.
2025-12-09 19:12:29 - utils - INFO - 
Generated Output Files:
2025-12-09 19:12:29 - utils - INFO -   - Processed Data: /Users/bipinrimal/Downloads/Thesis_work/data/processed
2025-12-09 19:12:29 - utils - INFO -   - Trained Models: /Users/bipinrimal/Downloads/Thesis_work/models
2025-12-09 19:12:29 - utils - INFO -   - Results & Metrics: /Users/bipinrimal/Downloads/Thesis_work/results
2025-12-09 19:12:29 - utils - INFO -   - Visualizations: /Users/bipinrimal/Downloads/Thesis_work/results/visualizations
2025-12-09 19:12:29 - utils - INFO -   - Alerts: /Users/bipinrimal/Downloads/Thesis_work/results/alerts.csv
2025-12-09 19:12:29 - utils - INFO -   - Logs: /Users/bipinrimal/Downloads/Thesis_work/logs/insider_threat_detection.log
2025-12-09 19:12:29 - utils - INFO - 
================================================================================

2025-12-09 19:12:29 - utils - INFO - 
================================================================================
2025-12-09 19:12:29 - utils - INFO - ✓ PIPELINE EXECUTION COMPLETED SUCCESSFULLY
2025-12-09 19:12:29 - utils - INFO - ================================================================================

2025-12-09 19:19:12 - utils - INFO - Utility functions loaded successfully
2025-12-09 19:19:15 - utils - INFO - ================================================================================
2025-12-09 19:19:15 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-12-09 19:19:15 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-12-09 19:19:15 - utils - INFO - ================================================================================
2025-12-09 19:19:28 - utils - INFO - Utility functions loaded successfully
2025-12-09 19:19:31 - utils - INFO - ================================================================================
2025-12-09 19:19:31 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-12-09 19:19:31 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-12-09 19:19:31 - utils - INFO - ================================================================================
2025-12-09 19:22:45 - utils - INFO - Utility functions loaded successfully
2025-12-09 19:22:48 - utils - INFO - ================================================================================
2025-12-09 19:22:48 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-12-09 19:22:48 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-12-09 19:22:48 - utils - INFO - ================================================================================
2025-12-09 19:22:48 - utils - INFO - 
================================================================================
2025-12-09 19:22:48 - utils - INFO - STARTING FULL PIPELINE EXECUTION
2025-12-09 19:22:48 - utils - INFO - ================================================================================

2025-12-09 19:22:48 - utils - INFO - 
================================================================================
                          STAGE 1: DATA PREPROCESSING                           
================================================================================

2025-12-09 19:22:48 - utils - INFO - Processing SUBSET defined in config: ['r1', 'r2', 'r3.1', 'r3.2', 'r4.1', 'r4.2']
2025-12-09 19:22:48 - utils - ERROR - ✗ Stage 1 failed: DataPreprocessorPolars.run_pipeline() got an unexpected keyword argument 'insider_list'
2025-12-09 19:22:48 - utils - ERROR - 
✗ PIPELINE EXECUTION FAILED: DataPreprocessorPolars.run_pipeline() got an unexpected keyword argument 'insider_list'
2025-12-09 19:28:59 - utils - INFO - Utility functions loaded successfully
2025-12-09 19:29:02 - utils - INFO - ================================================================================
2025-12-09 19:29:02 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-12-09 19:29:02 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-12-09 19:29:02 - utils - INFO - ================================================================================
2025-12-09 19:29:02 - utils - INFO - 
================================================================================
2025-12-09 19:29:02 - utils - INFO - STARTING FULL PIPELINE EXECUTION
2025-12-09 19:29:02 - utils - INFO - ================================================================================

2025-12-09 19:29:02 - utils - INFO - 
================================================================================
                          STAGE 1: DATA PREPROCESSING                           
================================================================================

2025-12-09 19:29:02 - utils - INFO - Processing SUBSET defined in config: ['r1', 'r2', 'r3.1', 'r3.2', 'r4.1', 'r4.2']
2025-12-09 19:29:02 - utils - INFO - 
================================================================================
                          DATA PREPROCESSING (POLARS)                           
================================================================================

2025-12-09 19:29:02 - utils - INFO - Scanning dataset: r1
2025-12-09 19:29:02 - utils - INFO - Scanning dataset: r2
2025-12-09 19:29:02 - utils - INFO - Scanning dataset: r3.1
2025-12-09 19:29:02 - utils - INFO - Scanning dataset: r3.2
2025-12-09 19:29:02 - utils - INFO - Scanning dataset: r4.1
2025-12-09 19:29:02 - utils - INFO - Scanning dataset: r4.2
2025-12-09 19:29:02 - utils - INFO - Constructing execution graph (Diagonal Concat)...
2025-12-09 19:29:02 - utils - INFO - Loaded Psychometric data: 4998 users
2025-12-09 19:29:02 - utils - INFO - Streaming merged data to /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv...
2025-12-09 19:31:47 - utils - INFO - ✓ Preprocessing complete.
2025-12-09 19:31:47 - utils - INFO - ✓ Stage 1 completed successfully.
2025-12-09 19:31:47 - utils - INFO - 
================================================================================
                          STAGE 2: FEATURE ENGINEERING                          
================================================================================

2025-12-09 19:31:47 - utils - ERROR - Missing required file for Stage 2: /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_data.parquet
2025-12-09 19:31:47 - utils - ERROR - Please run the previous stages first.
2025-12-09 19:31:47 - utils - INFO - 
================================================================================
                            STAGE 3: MODEL TRAINING                             
================================================================================

2025-12-09 19:31:47 - utils - ERROR - Missing required file for Isolation Forest: /Users/bipinrimal/Downloads/Thesis_work/data/processed/daily_features.parquet
2025-12-09 19:31:47 - utils - ERROR - Please run the previous stages first.
2025-12-09 19:31:47 - utils - INFO - 
================================================================================
                           STAGE 4: MODEL EVALUATION                            
================================================================================

2025-12-09 19:31:48 - utils - INFO - 
================================================================================
                         COMPREHENSIVE MODEL EVALUATION                         
================================================================================

2025-12-09 19:31:48 - utils - INFO - Loading results for all models...
2025-12-09 19:31:48 - utils - INFO - Loaded results for isolation_forest
2025-12-09 19:31:48 - utils - INFO - Loaded results for lstm_autoencoder
2025-12-09 19:31:48 - utils - INFO - Loaded results for deep_clustering
2025-12-09 19:31:48 - utils - INFO - Loaded results for 3 models
2025-12-09 19:31:48 - utils - INFO - Creating metrics comparison table...
2025-12-09 19:31:48 - utils - INFO - Metrics comparison table created
2025-12-09 19:31:48 - utils - INFO - Creating confusion matrix plots...
2025-12-09 19:31:48 - utils - INFO - Confusion matrices saved to /Users/bipinrimal/Downloads/Thesis_work/results/confusion_matrices/all_models.png
2025-12-09 19:31:48 - utils - INFO - Creating ROC curves...
2025-12-09 19:31:49 - utils - INFO - ROC curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/roc_curves/roc_comparison.png
2025-12-09 19:31:49 - utils - INFO - Creating Precision-Recall curves...
2025-12-09 19:31:49 - utils - INFO - Precision-Recall curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/precision_recall_comparison.png
2025-12-09 19:31:49 - utils - INFO - Creating metrics comparison bar chart...
2025-12-09 19:31:49 - utils - INFO - Metrics comparison bar chart saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/metrics_comparison_bar.png
2025-12-09 19:31:49 - utils - INFO - Creating anomaly score distribution plots...
2025-12-09 19:31:49 - utils - INFO - Score distributions saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/score_distributions.png
2025-12-09 19:31:49 - utils - INFO - Generating evaluation report...
2025-12-09 19:31:49 - utils - INFO - Evaluation report saved to /Users/bipinrimal/Downloads/Thesis_work/results/evaluation_report.txt
2025-12-09 19:31:49 - utils - INFO - Comprehensive evaluation completed!
2025-12-09 19:31:49 - utils - INFO - ✓ Stage 4 completed: Comprehensive evaluation report generated
2025-12-09 19:31:49 - utils - INFO - 
================================================================================
                         STAGE 5: ENSEMBLE INTEGRATION                          
================================================================================

2025-12-09 19:31:49 - utils - INFO - Testing ensemble method: weighted
2025-12-09 19:31:49 - utils - INFO - Initialized Ensemble Detector with method: weighted
2025-12-09 19:31:49 - utils - INFO - 
================================================================================
                            ENSEMBLE SYSTEM PIPELINE                            
================================================================================

2025-12-09 19:31:49 - utils - INFO - Loading predictions from individual models...
2025-12-09 19:31:49 - utils - INFO - Loaded isolation_forest predictions: 1000 samples
2025-12-09 19:31:49 - utils - INFO - Loaded lstm_autoencoder predictions: 32531 samples
2025-12-09 19:31:49 - utils - INFO - Loaded deep_clustering predictions: 1000 samples
2025-12-09 19:31:49 - utils - WARNING - Models have different sample counts: {'isolation_forest': 1000, 'lstm_autoencoder': 32531, 'deep_clustering': 1000}
2025-12-09 19:31:49 - utils - INFO - Will use aggregation strategy to align predictions...
2025-12-09 19:31:49 - utils - INFO - Aligning predictions across models...
2025-12-09 19:31:49 - utils - INFO - Using isolation_forest as reference (1000 samples)
2025-12-09 19:31:49 - utils - INFO - Aggregating lstm_autoencoder from 32531 to 1000 samples
2025-12-09 19:31:49 - utils - INFO - Predictions aligned successfully
2025-12-09 19:31:49 - utils - INFO - Loaded predictions from 3 models
2025-12-09 19:31:49 - utils - INFO - Computing weighted ensemble...
2025-12-09 19:31:49 - utils - INFO - Weighted ensemble: 0 anomalies detected
2025-12-09 19:31:49 - utils - INFO - Evaluating ensemble performance...
2025-12-09 19:31:49 - utils - INFO - 
============================================================
2025-12-09 19:31:49 - utils - INFO - Ensemble (weighted) Performance Metrics
2025-12-09 19:31:49 - utils - INFO - ============================================================
2025-12-09 19:31:49 - utils - INFO - Accuracy:  0.9990
2025-12-09 19:31:49 - utils - INFO - Precision: 0.0000
2025-12-09 19:31:49 - utils - INFO - Recall:    0.0000
2025-12-09 19:31:49 - utils - INFO - F1-Score:  0.0000
2025-12-09 19:31:49 - utils - INFO - AUC-ROC:   0.7978
2025-12-09 19:31:49 - utils - INFO - ============================================================

2025-12-09 19:31:49 - utils - INFO - Comparing ensemble with individual models...
2025-12-09 19:31:49 - utils - INFO - Evaluating ensemble performance...
2025-12-09 19:31:49 - utils - INFO - 
============================================================
2025-12-09 19:31:49 - utils - INFO - Ensemble (weighted) Performance Metrics
2025-12-09 19:31:49 - utils - INFO - ============================================================
2025-12-09 19:31:49 - utils - INFO - Accuracy:  0.9990
2025-12-09 19:31:49 - utils - INFO - Precision: 0.0000
2025-12-09 19:31:49 - utils - INFO - Recall:    0.0000
2025-12-09 19:31:49 - utils - INFO - F1-Score:  0.0000
2025-12-09 19:31:49 - utils - INFO - AUC-ROC:   0.7978
2025-12-09 19:31:49 - utils - INFO - ============================================================

2025-12-09 19:31:49 - utils - INFO - 
Comparison Results:
2025-12-09 19:31:49 - utils - INFO - 
              model  accuracy  precision  recall  f1_score  auc_roc
   Isolation Forest     0.945        0.0     0.0       0.0   0.8208
   Lstm Autoencoder     0.946        0.0     0.0       0.0   0.1842
    Deep Clustering     0.959        0.0     0.0       0.0   0.7407
Ensemble (weighted)     0.999        0.0     0.0       0.0   0.7978
2025-12-09 19:31:49 - utils - INFO - Ensemble predictions saved
2025-12-09 19:31:49 - utils - INFO - Generating alerts...
2025-12-09 19:31:49 - utils - ERROR - ✗ Stage 5 failed: 'severity'
2025-12-09 19:31:49 - utils - INFO - 
================================================================================
                             STAGE 6: VISUALIZATION                             
================================================================================

2025-12-09 19:31:49 - utils - INFO - 
================================================================================
                           GENERATING VISUALIZATIONS                            
================================================================================

2025-12-09 19:31:49 - utils - INFO - Creating alert severity distribution plot...
2025-12-09 19:31:49 - utils - INFO - Alert severity distribution plot saved
2025-12-09 19:31:49 - utils - INFO - Creating model agreement plot...
2025-12-09 19:31:49 - utils - INFO - Model agreement plot saved
2025-12-09 19:31:49 - utils - INFO - Creating anomaly score timeline for ensemble_weighted...
2025-12-09 19:31:49 - utils - INFO - Anomaly score timeline saved for ensemble_weighted
2025-12-09 19:31:49 - utils - INFO - Creating feature importance visualization...
2025-12-09 19:31:49 - utils - INFO - Feature importance heatmap saved
2025-12-09 19:31:49 - utils - INFO - Creating executive summary chart...
2025-12-09 19:31:50 - utils - INFO - Executive summary chart saved
2025-12-09 19:31:50 - utils - INFO - All visualizations saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations
2025-12-09 19:31:50 - utils - INFO - Visualization generation completed!
2025-12-09 19:31:50 - utils - INFO - ✓ Stage 6 completed: All visualizations generated
2025-12-09 19:31:50 - utils - INFO - 
================================================================================
2025-12-09 19:31:50 - utils - INFO - FINAL SUMMARY
2025-12-09 19:31:50 - utils - INFO - ================================================================================
2025-12-09 19:31:50 - utils - INFO - 
No model training results to display.
2025-12-09 19:31:50 - utils - INFO - 
Generated Output Locations:
2025-12-09 19:31:50 - utils - INFO -   - Processed Data: /Users/bipinrimal/Downloads/Thesis_work/data/processed
2025-12-09 19:31:50 - utils - INFO -   - Trained Models: /Users/bipinrimal/Downloads/Thesis_work/models
2025-12-09 19:31:50 - utils - INFO -   - Alert Logs:     /Users/bipinrimal/Downloads/Thesis_work/results/alerts.csv
2025-12-09 19:31:50 - utils - INFO -   - Logs:           /Users/bipinrimal/Downloads/Thesis_work/logs/insider_threat_detection.log
2025-12-09 19:31:50 - utils - INFO - 
================================================================================
2025-12-09 19:31:50 - utils - INFO - ✓ PIPELINE EXECUTION COMPLETED
2025-12-09 19:31:50 - utils - INFO - ================================================================================

2025-12-09 19:39:53 - utils - INFO - Utility functions loaded successfully
2025-12-09 19:39:57 - utils - INFO - ================================================================================
2025-12-09 19:39:57 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-12-09 19:39:57 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-12-09 19:39:57 - utils - INFO - ================================================================================
2025-12-09 19:39:57 - utils - INFO - 
================================================================================
2025-12-09 19:39:57 - utils - INFO - STARTING FULL PIPELINE EXECUTION
2025-12-09 19:39:57 - utils - INFO - ================================================================================

2025-12-09 19:39:57 - utils - INFO - 
================================================================================
                          STAGE 1: DATA PREPROCESSING                           
================================================================================

2025-12-09 19:39:57 - utils - INFO - Processing SUBSET defined in config: ['r1', 'r2', 'r3.1', 'r3.2', 'r4.1', 'r4.2']
2025-12-09 19:39:57 - utils - INFO - 
================================================================================
                          DATA PREPROCESSING (POLARS)                           
================================================================================

2025-12-09 19:39:57 - utils - INFO - Scanning dataset: r1
2025-12-09 19:39:57 - utils - INFO - Scanning dataset: r2
2025-12-09 19:39:57 - utils - INFO - Scanning dataset: r3.1
2025-12-09 19:39:57 - utils - INFO - Scanning dataset: r3.2
2025-12-09 19:39:57 - utils - INFO - Scanning dataset: r4.1
2025-12-09 19:39:57 - utils - INFO - Scanning dataset: r4.2
2025-12-09 19:39:57 - utils - INFO - Constructing execution graph (Diagonal Concat)...
2025-12-09 19:39:57 - utils - INFO - Loaded Psychometric data: 4998 users
2025-12-09 19:39:57 - utils - INFO - Streaming merged data to /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv...
2025-12-09 19:42:48 - utils - INFO - ✓ Preprocessing complete.
2025-12-09 19:42:48 - utils - INFO - ✓ Stage 1 completed successfully.
2025-12-09 19:42:48 - utils - INFO - 
================================================================================
                          STAGE 2: FEATURE ENGINEERING                          
================================================================================

2025-12-09 19:42:48 - utils - INFO - Aggregating daily features...
2025-12-09 19:45:37 - utils - INFO - Daily aggregation complete: 2984897 rows
2025-12-09 19:45:37 - utils - INFO - Calculating Z-scores...
2025-12-09 19:45:38 - utils - INFO - Creating static features...
2025-12-09 19:45:38 - utils - INFO - Saved static features: /Users/bipinrimal/Downloads/Thesis_work/data/processed/static_features.csv
2025-12-09 19:45:38 - utils - INFO - Creating sequences...
2025-12-09 19:54:32 - utils - INFO - Saved sequences: (292703, 15, 33)
2025-12-09 19:54:32 - utils - INFO - Feature engineering complete.
2025-12-09 19:54:32 - utils - INFO - ✓ Stage 2 completed: Feature files generated.
2025-12-09 19:54:32 - utils - INFO - 
================================================================================
                            STAGE 3: MODEL TRAINING                             
================================================================================

2025-12-09 19:54:32 - utils - ERROR - Missing required file for Isolation Forest: /Users/bipinrimal/Downloads/Thesis_work/data/processed/daily_features.parquet
2025-12-09 19:54:32 - utils - ERROR - Please run the previous stages first to generate this file.
2025-12-09 19:54:32 - utils - INFO - 
================================================================================
                           STAGE 4: MODEL EVALUATION                            
================================================================================

2025-12-09 19:54:32 - utils - INFO - 
================================================================================
                         COMPREHENSIVE MODEL EVALUATION                         
================================================================================

2025-12-09 19:54:32 - utils - INFO - Loading results for all models...
2025-12-09 19:54:32 - utils - INFO - Loaded results for isolation_forest
2025-12-09 19:54:32 - utils - INFO - Loaded results for lstm_autoencoder
2025-12-09 19:54:32 - utils - INFO - Loaded results for deep_clustering
2025-12-09 19:54:32 - utils - INFO - Loaded results for 3 models
2025-12-09 19:54:32 - utils - INFO - Creating metrics comparison table...
2025-12-09 19:54:32 - utils - INFO - Metrics comparison table created
2025-12-09 19:54:32 - utils - INFO - Creating confusion matrix plots...
2025-12-09 19:54:32 - utils - INFO - Confusion matrices saved to /Users/bipinrimal/Downloads/Thesis_work/results/confusion_matrices/all_models.png
2025-12-09 19:54:32 - utils - INFO - Creating ROC curves...
2025-12-09 19:54:33 - utils - INFO - ROC curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/roc_curves/roc_comparison.png
2025-12-09 19:54:33 - utils - INFO - Creating Precision-Recall curves...
2025-12-09 19:54:33 - utils - INFO - Precision-Recall curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/precision_recall_comparison.png
2025-12-09 19:54:33 - utils - INFO - Creating metrics comparison bar chart...
2025-12-09 19:54:33 - utils - INFO - Metrics comparison bar chart saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/metrics_comparison_bar.png
2025-12-09 19:54:33 - utils - INFO - Creating anomaly score distribution plots...
2025-12-09 19:54:33 - utils - INFO - Score distributions saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/score_distributions.png
2025-12-09 19:54:33 - utils - INFO - Generating evaluation report...
2025-12-09 19:54:33 - utils - INFO - Evaluation report saved to /Users/bipinrimal/Downloads/Thesis_work/results/evaluation_report.txt
2025-12-09 19:54:33 - utils - INFO - Comprehensive evaluation completed!
2025-12-09 19:54:33 - utils - INFO - ✓ Stage 4 completed: Comprehensive evaluation report generated
2025-12-09 19:54:33 - utils - INFO - 
================================================================================
                         STAGE 5: ENSEMBLE INTEGRATION                          
================================================================================

2025-12-09 19:54:33 - utils - INFO - Testing ensemble method: weighted
2025-12-09 19:54:33 - utils - INFO - Initialized Ensemble Detector with method: weighted
2025-12-09 19:54:33 - utils - INFO - 
================================================================================
                            ENSEMBLE SYSTEM PIPELINE                            
================================================================================

2025-12-09 19:54:33 - utils - INFO - Loading predictions from individual models...
2025-12-09 19:54:33 - utils - INFO - Loaded isolation_forest predictions: 1000 samples
2025-12-09 19:54:33 - utils - INFO - Loaded lstm_autoencoder predictions: 32531 samples
2025-12-09 19:54:33 - utils - INFO - Loaded deep_clustering predictions: 1000 samples
2025-12-09 19:54:33 - utils - WARNING - Models have different sample counts: {'isolation_forest': 1000, 'lstm_autoencoder': 32531, 'deep_clustering': 1000}
2025-12-09 19:54:33 - utils - INFO - Will use aggregation strategy to align predictions...
2025-12-09 19:54:33 - utils - INFO - Aligning predictions across models...
2025-12-09 19:54:33 - utils - INFO - Using isolation_forest as reference (1000 samples)
2025-12-09 19:54:33 - utils - INFO - Aggregating lstm_autoencoder from 32531 to 1000 samples
2025-12-09 19:54:33 - utils - INFO - Predictions aligned successfully
2025-12-09 19:54:33 - utils - INFO - Loaded predictions from 3 models
2025-12-09 19:54:33 - utils - INFO - Computing weighted ensemble...
2025-12-09 19:54:33 - utils - INFO - Weighted ensemble: 0 anomalies detected
2025-12-09 19:54:33 - utils - INFO - Evaluating ensemble performance...
2025-12-09 19:54:33 - utils - INFO - 
============================================================
2025-12-09 19:54:33 - utils - INFO - Ensemble (weighted) Performance Metrics
2025-12-09 19:54:33 - utils - INFO - ============================================================
2025-12-09 19:54:33 - utils - INFO - Accuracy:  0.9990
2025-12-09 19:54:33 - utils - INFO - Precision: 0.0000
2025-12-09 19:54:33 - utils - INFO - Recall:    0.0000
2025-12-09 19:54:33 - utils - INFO - F1-Score:  0.0000
2025-12-09 19:54:33 - utils - INFO - AUC-ROC:   0.7978
2025-12-09 19:54:33 - utils - INFO - ============================================================

2025-12-09 19:54:33 - utils - INFO - Comparing ensemble with individual models...
2025-12-09 19:54:33 - utils - INFO - Evaluating ensemble performance...
2025-12-09 19:54:33 - utils - INFO - 
============================================================
2025-12-09 19:54:33 - utils - INFO - Ensemble (weighted) Performance Metrics
2025-12-09 19:54:33 - utils - INFO - ============================================================
2025-12-09 19:54:33 - utils - INFO - Accuracy:  0.9990
2025-12-09 19:54:33 - utils - INFO - Precision: 0.0000
2025-12-09 19:54:33 - utils - INFO - Recall:    0.0000
2025-12-09 19:54:33 - utils - INFO - F1-Score:  0.0000
2025-12-09 19:54:33 - utils - INFO - AUC-ROC:   0.7978
2025-12-09 19:54:33 - utils - INFO - ============================================================

2025-12-09 19:54:33 - utils - INFO - 
Comparison Results:
2025-12-09 19:54:33 - utils - INFO - 
              model  accuracy  precision  recall  f1_score  auc_roc
   Isolation Forest     0.945        0.0     0.0       0.0   0.8208
   Lstm Autoencoder     0.946        0.0     0.0       0.0   0.1842
    Deep Clustering     0.959        0.0     0.0       0.0   0.7407
Ensemble (weighted)     0.999        0.0     0.0       0.0   0.7978
2025-12-09 19:54:33 - utils - INFO - Ensemble predictions saved
2025-12-09 19:54:33 - utils - INFO - Generating alerts...
2025-12-09 19:54:33 - utils - ERROR - ✗ Stage 5 failed (KeyError): 'severity' - likely missing columns due to pipeline issues.
2025-12-09 19:54:33 - utils - INFO - 
================================================================================
                             STAGE 6: VISUALIZATION                             
================================================================================

2025-12-09 19:54:33 - utils - INFO - 
================================================================================
                           GENERATING VISUALIZATIONS                            
================================================================================

2025-12-09 19:54:33 - utils - INFO - Creating alert severity distribution plot...
2025-12-09 19:54:33 - utils - INFO - Alert severity distribution plot saved
2025-12-09 19:54:33 - utils - INFO - Creating model agreement plot...
2025-12-09 19:54:33 - utils - INFO - Model agreement plot saved
2025-12-09 19:54:33 - utils - INFO - Creating anomaly score timeline for ensemble_weighted...
2025-12-09 19:54:34 - utils - INFO - Anomaly score timeline saved for ensemble_weighted
2025-12-09 19:54:34 - utils - INFO - Creating feature importance visualization...
2025-12-09 19:54:34 - utils - INFO - Feature importance heatmap saved
2025-12-09 19:54:34 - utils - INFO - Creating executive summary chart...
2025-12-09 19:54:34 - utils - INFO - Executive summary chart saved
2025-12-09 19:54:34 - utils - INFO - All visualizations saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations
2025-12-09 19:54:34 - utils - INFO - Visualization generation completed!
2025-12-09 19:54:34 - utils - INFO - ✓ Stage 6 completed: All visualizations generated
2025-12-09 19:54:34 - utils - INFO - 
================================================================================
2025-12-09 19:54:34 - utils - INFO - FINAL SUMMARY
2025-12-09 19:54:34 - utils - INFO - ================================================================================
2025-12-09 19:54:34 - utils - INFO - 
No model training results to display.
2025-12-09 19:54:34 - utils - INFO - 
Generated Output Locations:
2025-12-09 19:54:34 - utils - INFO -   - Processed Data: /Users/bipinrimal/Downloads/Thesis_work/data/processed
2025-12-09 19:54:34 - utils - INFO -   - Trained Models: /Users/bipinrimal/Downloads/Thesis_work/models
2025-12-09 19:54:34 - utils - INFO -   - Alert Logs:     /Users/bipinrimal/Downloads/Thesis_work/results/alerts.csv
2025-12-09 19:54:34 - utils - INFO -   - Logs:           /Users/bipinrimal/Downloads/Thesis_work/logs/insider_threat_detection.log
2025-12-09 19:54:34 - utils - INFO - 
================================================================================
2025-12-09 19:54:34 - utils - INFO - ✓ PIPELINE EXECUTION COMPLETED
2025-12-09 19:54:34 - utils - INFO - ================================================================================

2025-12-09 20:14:31 - utils - INFO - Utility functions loaded successfully
2025-12-09 20:14:35 - utils - INFO - ================================================================================
2025-12-09 20:14:35 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-12-09 20:14:35 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-12-09 20:14:35 - utils - INFO - ================================================================================
2025-12-09 20:14:35 - utils - INFO - 
================================================================================
2025-12-09 20:14:35 - utils - INFO - STARTING FULL PIPELINE EXECUTION
2025-12-09 20:14:35 - utils - INFO - ================================================================================

2025-12-09 20:14:35 - utils - INFO - 
================================================================================
                          STAGE 1: DATA PREPROCESSING                           
================================================================================

2025-12-09 20:14:35 - utils - INFO - Processing SUBSET defined in config: ['r1', 'r2', 'r3.1', 'r3.2', 'r4.1', 'r4.2']
2025-12-09 20:14:35 - utils - INFO - 
================================================================================
                          DATA PREPROCESSING (POLARS)                           
================================================================================

2025-12-09 20:14:35 - utils - INFO - Scanning dataset: r1
2025-12-09 20:14:35 - utils - INFO - Scanning dataset: r2
2025-12-09 20:14:35 - utils - INFO - Scanning dataset: r3.1
2025-12-09 20:14:35 - utils - INFO - Scanning dataset: r3.2
2025-12-09 20:14:35 - utils - INFO - Scanning dataset: r4.1
2025-12-09 20:14:35 - utils - INFO - Scanning dataset: r4.2
2025-12-09 20:14:35 - utils - INFO - Constructing execution graph (Diagonal Concat)...
2025-12-09 20:14:35 - utils - INFO - Loaded Psychometric data: 4998 users
2025-12-09 20:14:35 - utils - INFO - Streaming merged data to /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv...
2025-12-09 20:17:21 - utils - INFO - ✓ Preprocessing complete.
2025-12-09 20:17:21 - utils - INFO - ✓ Stage 1 completed successfully.
2025-12-09 20:17:21 - utils - INFO - 
================================================================================
                          STAGE 2: FEATURE ENGINEERING                          
================================================================================

2025-12-09 20:17:21 - utils - INFO - Starting Feature Engineering Pipeline (Polars)...
2025-12-09 20:17:21 - utils - INFO - Loading data from /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv
2025-12-09 20:23:55 - utils - INFO - Utility functions loaded successfully
2025-12-09 20:23:59 - utils - INFO - ================================================================================
2025-12-09 20:23:59 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-12-09 20:23:59 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-12-09 20:23:59 - utils - INFO - ================================================================================
2025-12-09 20:23:59 - utils - INFO - 
================================================================================
2025-12-09 20:23:59 - utils - INFO - STARTING FULL PIPELINE EXECUTION
2025-12-09 20:23:59 - utils - INFO - ================================================================================

2025-12-09 20:23:59 - utils - INFO - 
================================================================================
                          STAGE 1: DATA PREPROCESSING                           
================================================================================

2025-12-09 20:23:59 - utils - INFO - Processing SUBSET defined in config: ['r1', 'r2', 'r3.1', 'r3.2', 'r4.1', 'r4.2']
2025-12-09 20:23:59 - utils - INFO - 
================================================================================
                          DATA PREPROCESSING (POLARS)                           
================================================================================

2025-12-09 20:23:59 - utils - INFO - Scanning dataset: r1
2025-12-09 20:23:59 - utils - INFO - Scanning dataset: r2
2025-12-09 20:23:59 - utils - INFO - Scanning dataset: r3.1
2025-12-09 20:23:59 - utils - INFO - Scanning dataset: r3.2
2025-12-09 20:23:59 - utils - INFO - Scanning dataset: r4.1
2025-12-09 20:23:59 - utils - INFO - Scanning dataset: r4.2
2025-12-09 20:23:59 - utils - INFO - Constructing execution graph (Diagonal Concat)...
2025-12-09 20:23:59 - utils - INFO - Loaded Psychometric data: 4998 users
2025-12-09 20:23:59 - utils - INFO - Streaming merged data to /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv...
2025-12-09 20:26:44 - utils - INFO - ✓ Preprocessing complete.
2025-12-09 20:26:44 - utils - INFO - ✓ Stage 1 completed successfully.
2025-12-09 20:26:44 - utils - INFO - 
================================================================================
                          STAGE 2: FEATURE ENGINEERING                          
================================================================================

2025-12-09 20:26:44 - utils - INFO - Starting Feature Engineering Pipeline (Polars)...
2025-12-09 20:26:44 - utils - INFO - Loading data from /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv
2025-12-09 22:06:16 - utils - INFO - Utility functions loaded successfully
2025-12-09 22:06:20 - utils - INFO - ================================================================================
2025-12-09 22:06:20 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-12-09 22:06:20 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-12-09 22:06:20 - utils - INFO - ================================================================================
2025-12-09 22:06:20 - utils - INFO - 
================================================================================
2025-12-09 22:06:20 - utils - INFO - STARTING FULL PIPELINE EXECUTION
2025-12-09 22:06:20 - utils - INFO - ================================================================================

2025-12-09 22:06:20 - utils - INFO - 
================================================================================
                          STAGE 1: DATA PREPROCESSING                           
================================================================================

2025-12-09 22:06:20 - utils - INFO - Processing SUBSET defined in config: ['r1', 'r2', 'r3.1', 'r3.2', 'r4.1', 'r4.2']
2025-12-09 22:06:20 - utils - INFO - 
================================================================================
                          DATA PREPROCESSING (POLARS)                           
================================================================================

2025-12-09 22:06:20 - utils - INFO - Scanning dataset: r1
2025-12-09 22:06:20 - utils - INFO - Scanning dataset: r2
2025-12-09 22:06:20 - utils - INFO - Scanning dataset: r3.1
2025-12-09 22:06:20 - utils - INFO - Scanning dataset: r3.2
2025-12-09 22:06:20 - utils - INFO - Scanning dataset: r4.1
2025-12-09 22:06:20 - utils - INFO - Scanning dataset: r4.2
2025-12-09 22:06:20 - utils - INFO - Constructing execution graph (Diagonal Concat)...
2025-12-09 22:06:20 - utils - INFO - Loaded Psychometric data: 4998 users
2025-12-09 22:06:20 - utils - INFO - Streaming merged data to /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv...
2025-12-09 22:09:07 - utils - INFO - ✓ Preprocessing complete.
2025-12-09 22:09:07 - utils - INFO - ✓ Stage 1 completed successfully.
2025-12-09 22:09:07 - utils - INFO - 
================================================================================
                          STAGE 2: FEATURE ENGINEERING                          
================================================================================

2025-12-09 22:09:07 - utils - INFO - Starting Feature Engineering Pipeline (Polars)...
2025-12-09 22:09:07 - utils - INFO - Loading data from /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv
2025-12-09 22:22:13 - utils - INFO - Utility functions loaded successfully
2025-12-09 22:22:18 - utils - INFO - ================================================================================
2025-12-09 22:22:18 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-12-09 22:22:18 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-12-09 22:22:18 - utils - INFO - ================================================================================
2025-12-09 22:22:18 - utils - INFO - 
================================================================================
2025-12-09 22:22:18 - utils - INFO - STARTING FULL PIPELINE EXECUTION
2025-12-09 22:22:18 - utils - INFO - ================================================================================

2025-12-09 22:22:18 - utils - INFO - 
================================================================================
                          STAGE 1: DATA PREPROCESSING                           
================================================================================

2025-12-09 22:22:18 - utils - INFO - Processing SUBSET defined in config: ['r1', 'r2', 'r3.1', 'r3.2', 'r4.1', 'r4.2']
2025-12-09 22:22:18 - utils - INFO - 
================================================================================
                          DATA PREPROCESSING (POLARS)                           
================================================================================

2025-12-09 22:22:18 - utils - INFO - Scanning dataset: r1
2025-12-09 22:22:18 - utils - INFO - Scanning dataset: r2
2025-12-09 22:22:18 - utils - INFO - Scanning dataset: r3.1
2025-12-09 22:22:18 - utils - INFO - Scanning dataset: r3.2
2025-12-09 22:22:18 - utils - INFO - Scanning dataset: r4.1
2025-12-09 22:22:18 - utils - INFO - Scanning dataset: r4.2
2025-12-09 22:22:18 - utils - INFO - Constructing execution graph (Diagonal Concat)...
2025-12-09 22:22:18 - utils - INFO - Loaded Psychometric data: 4998 users
2025-12-09 22:22:18 - utils - INFO - Streaming merged data to /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv...
2025-12-09 22:25:40 - utils - INFO - ✓ Preprocessing complete.
2025-12-09 22:25:40 - utils - INFO - ✓ Stage 1 completed successfully.
2025-12-09 22:25:40 - utils - INFO - 
================================================================================
                          STAGE 2: FEATURE ENGINEERING                          
================================================================================

2025-12-09 22:25:40 - utils - INFO - Starting Feature Engineering Pipeline (Polars)...
2025-12-09 22:25:40 - utils - INFO - Loading data from /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv
2025-12-09 22:29:04 - utils - INFO - Utility functions loaded successfully
2025-12-09 22:29:08 - utils - INFO - ================================================================================
2025-12-09 22:29:08 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-12-09 22:29:08 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-12-09 22:29:08 - utils - INFO - ================================================================================
2025-12-09 22:29:08 - utils - INFO - 
================================================================================
2025-12-09 22:29:08 - utils - INFO - STARTING FULL PIPELINE EXECUTION
2025-12-09 22:29:08 - utils - INFO - ================================================================================

2025-12-09 22:29:08 - utils - INFO - 
================================================================================
                          STAGE 1: DATA PREPROCESSING                           
================================================================================

2025-12-09 22:29:08 - utils - INFO - Processing SUBSET defined in config: ['r1', 'r2', 'r3.1', 'r3.2', 'r4.1', 'r4.2']
2025-12-09 22:29:08 - utils - INFO - 
================================================================================
                          DATA PREPROCESSING (POLARS)                           
================================================================================

2025-12-09 22:29:08 - utils - INFO - Scanning dataset: r1
2025-12-09 22:29:08 - utils - INFO - Scanning dataset: r2
2025-12-09 22:29:08 - utils - INFO - Scanning dataset: r3.1
2025-12-09 22:29:08 - utils - INFO - Scanning dataset: r3.2
2025-12-09 22:29:08 - utils - INFO - Scanning dataset: r4.1
2025-12-09 22:29:08 - utils - INFO - Scanning dataset: r4.2
2025-12-09 22:29:08 - utils - INFO - Constructing execution graph (Diagonal Concat)...
2025-12-09 22:29:08 - utils - INFO - Loaded Psychometric data: 4998 users
2025-12-09 22:29:08 - utils - INFO - Streaming merged data to /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv...
2025-12-09 22:32:49 - utils - INFO - ✓ Preprocessing complete.
2025-12-09 22:32:49 - utils - INFO - ✓ Stage 1 completed successfully.
2025-12-09 22:32:49 - utils - INFO - 
================================================================================
                          STAGE 2: FEATURE ENGINEERING                          
================================================================================

2025-12-09 22:32:49 - utils - INFO - Starting Feature Engineering Pipeline (Polars Lazy Execution)...
2025-12-09 22:32:49 - utils - INFO - Scanning data from /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv
2025-12-09 22:32:49 - utils - INFO - Constructing execution graph for daily features...
2025-12-09 22:32:49 - utils - INFO - Executing aggregation (Streaming Mode)...
2025-12-09 22:32:49 - utils - ERROR - ✗ Stage 2 failed: unable to find column "user"; valid columns: ["id", "user_id", "pc_id", "activity", "activity_type", "dataset", "date", "is_logon", "is_logoff", "is_connect", "is_disconnect", "url", "domain", "is_suspicious_domain", "to", "email_size_kb", "is_large_email", "has_attachment", "filename", "content", "file_extension", "is_sensitive_file", "size", "attachments", "cc", "bcc", "from", "O", "C", "E", "A", "N", "role", "is_insider"]

Resolved plan until failure:

	---> FAILED HERE RESOLVING 'sink' <---
FILTER col("date").is_not_null()
FROM
   WITH_COLUMNS:
   [col("date").cast(Datetime('μs'))] 
    Csv SCAN [/Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv]
    PROJECT */34 COLUMNS
    ESTIMATED ROWS: 510992752
2025-12-09 22:32:49 - utils - ERROR - 
✗ PIPELINE EXECUTION FAILED: unable to find column "user"; valid columns: ["id", "user_id", "pc_id", "activity", "activity_type", "dataset", "date", "is_logon", "is_logoff", "is_connect", "is_disconnect", "url", "domain", "is_suspicious_domain", "to", "email_size_kb", "is_large_email", "has_attachment", "filename", "content", "file_extension", "is_sensitive_file", "size", "attachments", "cc", "bcc", "from", "O", "C", "E", "A", "N", "role", "is_insider"]

Resolved plan until failure:

	---> FAILED HERE RESOLVING 'sink' <---
FILTER col("date").is_not_null()
FROM
   WITH_COLUMNS:
   [col("date").cast(Datetime('μs'))] 
    Csv SCAN [/Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv]
    PROJECT */34 COLUMNS
    ESTIMATED ROWS: 510992752
2025-12-09 22:39:08 - utils - INFO - Utility functions loaded successfully
2025-12-09 22:39:12 - utils - INFO - ================================================================================
2025-12-09 22:39:12 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-12-09 22:39:12 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-12-09 22:39:12 - utils - INFO - ================================================================================
2025-12-09 22:39:12 - utils - INFO - 
================================================================================
2025-12-09 22:39:12 - utils - INFO - STARTING FULL PIPELINE EXECUTION
2025-12-09 22:39:12 - utils - INFO - ================================================================================

2025-12-09 22:39:12 - utils - INFO - 
================================================================================
                          STAGE 1: DATA PREPROCESSING                           
================================================================================

2025-12-09 22:39:12 - utils - INFO - Processing SUBSET defined in config: ['r1', 'r2', 'r3.1', 'r3.2', 'r4.1', 'r4.2']
2025-12-09 22:39:12 - utils - INFO - 
================================================================================
                          DATA PREPROCESSING (POLARS)                           
================================================================================

2025-12-09 22:39:12 - utils - INFO - Scanning dataset: r1
2025-12-09 22:39:12 - utils - INFO - Scanning dataset: r2
2025-12-09 22:39:12 - utils - INFO - Scanning dataset: r3.1
2025-12-09 22:39:12 - utils - INFO - Scanning dataset: r3.2
2025-12-09 22:39:12 - utils - INFO - Scanning dataset: r4.1
2025-12-09 22:39:12 - utils - INFO - Scanning dataset: r4.2
2025-12-09 22:39:12 - utils - INFO - Constructing execution graph (Diagonal Concat)...
2025-12-09 22:39:12 - utils - INFO - Loaded Psychometric data: 4998 users
2025-12-09 22:39:12 - utils - INFO - Streaming merged data to /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv...
2025-12-09 22:42:38 - utils - INFO - ✓ Preprocessing complete.
2025-12-09 22:42:38 - utils - INFO - ✓ Stage 1 completed successfully.
2025-12-09 22:42:38 - utils - INFO - 
================================================================================
                          STAGE 2: FEATURE ENGINEERING                          
================================================================================

2025-12-09 22:42:38 - utils - INFO - Starting Feature Engineering Pipeline (Polars Lazy Execution)...
2025-12-09 22:42:38 - utils - INFO - Scanning data from /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv
2025-12-09 22:42:38 - utils - INFO - Constructing execution graph for daily features...
2025-12-09 22:42:38 - utils - INFO - Executing aggregation (Streaming Mode)...
2025-12-09 22:45:03 - utils - INFO - Saved features to: /Users/bipinrimal/Downloads/Thesis_work/data/processed/daily_features.parquet
2025-12-09 22:45:03 - utils - INFO - Creating sequences...
2025-12-09 22:45:03 - utils - INFO - Saved features to: /Users/bipinrimal/Downloads/Thesis_work/data/processed/sequence_features.parquet
2025-12-09 22:45:03 - utils - INFO - Feature engineering pipeline completed successfully.
2025-12-09 22:45:03 - utils - INFO - ✓ Stage 2 completed: Feature files generated.
2025-12-09 22:45:03 - utils - INFO - 
================================================================================
                            STAGE 3: MODEL TRAINING                             
================================================================================

2025-12-09 22:45:03 - utils - INFO - 
>>> Training Isolation Forest...
2025-12-09 22:45:03 - utils - INFO - 
================================================================================
                 ISOLATION FOREST TRAINING (V2: MULTI-DATASET)                  
================================================================================

2025-12-09 22:45:03 - utils - INFO - Loading static features from: static_features.csv
2025-12-09 22:45:03 - utils - ERROR - Failed to load 'static_features.csv'. Run feature_engineering.py first. Error: [Errno 2] No such file or directory: '/Users/bipinrimal/Downloads/Thesis_work/data/processed/static_features.csv'
2025-12-09 22:45:03 - utils - INFO - ✓ Isolation Forest training completed
2025-12-09 22:45:03 - utils - INFO - 
>>> Training LSTM Autoencoder...
2025-12-09 22:45:03 - utils - INFO - 
================================================================================
                     LIGHTWEIGHT LSTM AUTOENCODER TRAINING                      
================================================================================

2025-12-09 22:45:03 - utils - ERROR - Sequence data not found. Run feature_engineering.py first. Error: [Errno 2] No such file or directory: '/Users/bipinrimal/Downloads/Thesis_work/data/processed/sequences.npy'
2025-12-09 22:45:03 - utils - INFO - ✓ LSTM Autoencoder training completed
2025-12-09 22:45:03 - utils - INFO - 
>>> Training Deep Clustering...
2025-12-09 22:45:03 - utils - INFO - 
================================================================================
                      LIGHTWEIGHT DEEP CLUSTERING TRAINING                      
================================================================================

2025-12-09 22:45:03 - utils - INFO - Loading static features from: static_features.csv
2025-12-09 22:45:03 - utils - ERROR - Failed to load 'static_features.csv'. Run feature_engineering.py first. Error: [Errno 2] No such file or directory: '/Users/bipinrimal/Downloads/Thesis_work/data/processed/static_features.csv'
2025-12-09 22:45:03 - utils - INFO - ✓ Deep Clustering training completed
2025-12-09 22:45:03 - utils - INFO - 
✓ Stage 3 completed: 3 models trained
2025-12-09 22:45:03 - utils - INFO - 
================================================================================
                           STAGE 4: MODEL EVALUATION                            
================================================================================

2025-12-09 22:45:03 - utils - INFO - 
================================================================================
                         COMPREHENSIVE MODEL EVALUATION                         
================================================================================

2025-12-09 22:45:03 - utils - INFO - Loading results for all models...
2025-12-09 22:45:03 - utils - INFO - Loaded results for isolation_forest
2025-12-09 22:45:03 - utils - INFO - Loaded results for lstm_autoencoder
2025-12-09 22:45:03 - utils - INFO - Loaded results for deep_clustering
2025-12-09 22:45:03 - utils - INFO - Loaded results for 3 models
2025-12-09 22:45:03 - utils - INFO - Creating metrics comparison table...
2025-12-09 22:45:03 - utils - INFO - Metrics comparison table created
2025-12-09 22:45:03 - utils - INFO - Creating confusion matrix plots...
2025-12-09 22:45:03 - utils - INFO - Confusion matrices saved to /Users/bipinrimal/Downloads/Thesis_work/results/confusion_matrices/all_models.png
2025-12-09 22:45:03 - utils - INFO - Creating ROC curves...
2025-12-09 22:45:03 - utils - INFO - ROC curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/roc_curves/roc_comparison.png
2025-12-09 22:45:03 - utils - INFO - Creating Precision-Recall curves...
2025-12-09 22:45:03 - utils - INFO - Precision-Recall curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/precision_recall_comparison.png
2025-12-09 22:45:03 - utils - INFO - Creating metrics comparison bar chart...
2025-12-09 22:45:04 - utils - INFO - Metrics comparison bar chart saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/metrics_comparison_bar.png
2025-12-09 22:45:04 - utils - INFO - Creating anomaly score distribution plots...
2025-12-09 22:45:04 - utils - INFO - Score distributions saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/score_distributions.png
2025-12-09 22:45:04 - utils - INFO - Generating evaluation report...
2025-12-09 22:45:04 - utils - INFO - Evaluation report saved to /Users/bipinrimal/Downloads/Thesis_work/results/evaluation_report.txt
2025-12-09 22:45:04 - utils - INFO - Comprehensive evaluation completed!
2025-12-09 22:45:04 - utils - INFO - ✓ Stage 4 completed: Comprehensive evaluation report generated
2025-12-09 22:45:04 - utils - INFO - 
================================================================================
                         STAGE 5: ENSEMBLE INTEGRATION                          
================================================================================

2025-12-09 22:45:04 - utils - INFO - Testing ensemble method: weighted
2025-12-09 22:45:04 - utils - INFO - Initialized Ensemble Detector with method: weighted
2025-12-09 22:45:04 - utils - INFO - 
================================================================================
                            ENSEMBLE SYSTEM PIPELINE                            
================================================================================

2025-12-09 22:45:04 - utils - INFO - Loading predictions from individual models...
2025-12-09 22:45:04 - utils - INFO - Loaded isolation_forest predictions: 1000 samples
2025-12-09 22:45:04 - utils - INFO - Loaded lstm_autoencoder predictions: 32531 samples
2025-12-09 22:45:04 - utils - INFO - Loaded deep_clustering predictions: 1000 samples
2025-12-09 22:45:04 - utils - WARNING - Models have different sample counts: {'isolation_forest': 1000, 'lstm_autoencoder': 32531, 'deep_clustering': 1000}
2025-12-09 22:45:04 - utils - INFO - Will use aggregation strategy to align predictions...
2025-12-09 22:45:04 - utils - INFO - Aligning predictions across models...
2025-12-09 22:45:04 - utils - INFO - Using isolation_forest as reference (1000 samples)
2025-12-09 22:45:04 - utils - INFO - Aggregating lstm_autoencoder from 32531 to 1000 samples
2025-12-09 22:45:04 - utils - INFO - Predictions aligned successfully
2025-12-09 22:45:04 - utils - INFO - Loaded predictions from 3 models
2025-12-09 22:45:04 - utils - INFO - Computing weighted ensemble...
2025-12-09 22:45:04 - utils - INFO - Weighted ensemble: 0 anomalies detected
2025-12-09 22:45:04 - utils - INFO - Evaluating ensemble performance...
2025-12-09 22:45:04 - utils - INFO - 
============================================================
2025-12-09 22:45:04 - utils - INFO - Ensemble (weighted) Performance Metrics
2025-12-09 22:45:04 - utils - INFO - ============================================================
2025-12-09 22:45:04 - utils - INFO - Accuracy:  0.9990
2025-12-09 22:45:04 - utils - INFO - Precision: 0.0000
2025-12-09 22:45:04 - utils - INFO - Recall:    0.0000
2025-12-09 22:45:04 - utils - INFO - F1-Score:  0.0000
2025-12-09 22:45:04 - utils - INFO - AUC-ROC:   0.7978
2025-12-09 22:45:04 - utils - INFO - ============================================================

2025-12-09 22:45:04 - utils - INFO - Comparing ensemble with individual models...
2025-12-09 22:45:04 - utils - INFO - Evaluating ensemble performance...
2025-12-09 22:45:04 - utils - INFO - 
============================================================
2025-12-09 22:45:04 - utils - INFO - Ensemble (weighted) Performance Metrics
2025-12-09 22:45:04 - utils - INFO - ============================================================
2025-12-09 22:45:04 - utils - INFO - Accuracy:  0.9990
2025-12-09 22:45:04 - utils - INFO - Precision: 0.0000
2025-12-09 22:45:04 - utils - INFO - Recall:    0.0000
2025-12-09 22:45:04 - utils - INFO - F1-Score:  0.0000
2025-12-09 22:45:04 - utils - INFO - AUC-ROC:   0.7978
2025-12-09 22:45:04 - utils - INFO - ============================================================

2025-12-09 22:45:04 - utils - INFO - 
Comparison Results:
2025-12-09 22:45:04 - utils - INFO - 
              model  accuracy  precision  recall  f1_score  auc_roc
   Isolation Forest     0.945        0.0     0.0       0.0   0.8208
   Lstm Autoencoder     0.946        0.0     0.0       0.0   0.1842
    Deep Clustering     0.959        0.0     0.0       0.0   0.7407
Ensemble (weighted)     0.999        0.0     0.0       0.0   0.7978
2025-12-09 22:45:04 - utils - INFO - Ensemble predictions saved
2025-12-09 22:45:04 - utils - INFO - Generating alerts...
2025-12-09 22:45:04 - utils - INFO - No anomalies detected above threshold. Returning empty alerts DataFrame.
2025-12-09 22:45:04 - utils - INFO - Alerts saved to /Users/bipinrimal/Downloads/Thesis_work/results/alerts.csv
2025-12-09 22:45:04 - utils - INFO - Ensemble pipeline completed!
2025-12-09 22:45:04 - utils - INFO - Testing ensemble method: majority
2025-12-09 22:45:04 - utils - INFO - Initialized Ensemble Detector with method: majority
2025-12-09 22:45:04 - utils - INFO - 
================================================================================
                            ENSEMBLE SYSTEM PIPELINE                            
================================================================================

2025-12-09 22:45:04 - utils - INFO - Loading predictions from individual models...
2025-12-09 22:45:04 - utils - INFO - Loaded isolation_forest predictions: 1000 samples
2025-12-09 22:45:04 - utils - INFO - Loaded lstm_autoencoder predictions: 32531 samples
2025-12-09 22:45:04 - utils - INFO - Loaded deep_clustering predictions: 1000 samples
2025-12-09 22:45:04 - utils - WARNING - Models have different sample counts: {'isolation_forest': 1000, 'lstm_autoencoder': 32531, 'deep_clustering': 1000}
2025-12-09 22:45:04 - utils - INFO - Will use aggregation strategy to align predictions...
2025-12-09 22:45:04 - utils - INFO - Aligning predictions across models...
2025-12-09 22:45:04 - utils - INFO - Using isolation_forest as reference (1000 samples)
2025-12-09 22:45:04 - utils - INFO - Aggregating lstm_autoencoder from 32531 to 1000 samples
2025-12-09 22:45:04 - utils - INFO - Predictions aligned successfully
2025-12-09 22:45:04 - utils - INFO - Loaded predictions from 3 models
2025-12-09 22:45:04 - utils - INFO - Computing majority voting ensemble...
2025-12-09 22:45:04 - utils - INFO - Majority voting: 11 anomalies detected
2025-12-09 22:45:04 - utils - INFO - Evaluating ensemble performance...
2025-12-09 22:45:04 - utils - INFO - 
============================================================
2025-12-09 22:45:04 - utils - INFO - Ensemble (majority) Performance Metrics
2025-12-09 22:45:04 - utils - INFO - ============================================================
2025-12-09 22:45:04 - utils - INFO - Accuracy:  0.9880
2025-12-09 22:45:04 - utils - INFO - Precision: 0.0000
2025-12-09 22:45:04 - utils - INFO - Recall:    0.0000
2025-12-09 22:45:04 - utils - INFO - F1-Score:  0.0000
2025-12-09 22:45:04 - utils - INFO - AUC-ROC:   0.8018
2025-12-09 22:45:04 - utils - INFO - ============================================================

2025-12-09 22:45:04 - utils - INFO - Comparing ensemble with individual models...
2025-12-09 22:45:04 - utils - INFO - Evaluating ensemble performance...
2025-12-09 22:45:04 - utils - INFO - 
============================================================
2025-12-09 22:45:04 - utils - INFO - Ensemble (majority) Performance Metrics
2025-12-09 22:45:04 - utils - INFO - ============================================================
2025-12-09 22:45:04 - utils - INFO - Accuracy:  0.9880
2025-12-09 22:45:04 - utils - INFO - Precision: 0.0000
2025-12-09 22:45:04 - utils - INFO - Recall:    0.0000
2025-12-09 22:45:04 - utils - INFO - F1-Score:  0.0000
2025-12-09 22:45:04 - utils - INFO - AUC-ROC:   0.8018
2025-12-09 22:45:04 - utils - INFO - ============================================================

2025-12-09 22:45:04 - utils - INFO - 
Comparison Results:
2025-12-09 22:45:04 - utils - INFO - 
              model  accuracy  precision  recall  f1_score  auc_roc
   Isolation Forest     0.945        0.0     0.0       0.0   0.8208
   Lstm Autoencoder     0.946        0.0     0.0       0.0   0.1842
    Deep Clustering     0.959        0.0     0.0       0.0   0.7407
Ensemble (majority)     0.988        0.0     0.0       0.0   0.8018
2025-12-09 22:45:04 - utils - INFO - Ensemble predictions saved
2025-12-09 22:45:04 - utils - INFO - Generating alerts...
2025-12-09 22:45:04 - utils - INFO - No anomalies detected above threshold. Returning empty alerts DataFrame.
2025-12-09 22:45:04 - utils - INFO - Alerts saved to /Users/bipinrimal/Downloads/Thesis_work/results/alerts.csv
2025-12-09 22:45:04 - utils - INFO - Ensemble pipeline completed!
2025-12-09 22:45:04 - utils - INFO - Testing ensemble method: cascade
2025-12-09 22:45:04 - utils - INFO - Initialized Ensemble Detector with method: cascade
2025-12-09 22:45:04 - utils - INFO - 
================================================================================
                            ENSEMBLE SYSTEM PIPELINE                            
================================================================================

2025-12-09 22:45:04 - utils - INFO - Loading predictions from individual models...
2025-12-09 22:45:04 - utils - INFO - Loaded isolation_forest predictions: 1000 samples
2025-12-09 22:45:04 - utils - INFO - Loaded lstm_autoencoder predictions: 32531 samples
2025-12-09 22:45:04 - utils - INFO - Loaded deep_clustering predictions: 1000 samples
2025-12-09 22:45:04 - utils - WARNING - Models have different sample counts: {'isolation_forest': 1000, 'lstm_autoencoder': 32531, 'deep_clustering': 1000}
2025-12-09 22:45:04 - utils - INFO - Will use aggregation strategy to align predictions...
2025-12-09 22:45:04 - utils - INFO - Aligning predictions across models...
2025-12-09 22:45:04 - utils - INFO - Using isolation_forest as reference (1000 samples)
2025-12-09 22:45:04 - utils - INFO - Aggregating lstm_autoencoder from 32531 to 1000 samples
2025-12-09 22:45:04 - utils - INFO - Predictions aligned successfully
2025-12-09 22:45:04 - utils - INFO - Loaded predictions from 3 models
2025-12-09 22:45:04 - utils - INFO - Computing cascade ensemble...
2025-12-09 22:45:04 - utils - INFO - Cascade ensemble: 0 anomalies detected
2025-12-09 22:45:04 - utils - INFO - Evaluating ensemble performance...
2025-12-09 22:45:04 - utils - INFO - 
============================================================
2025-12-09 22:45:04 - utils - INFO - Ensemble (cascade) Performance Metrics
2025-12-09 22:45:04 - utils - INFO - ============================================================
2025-12-09 22:45:04 - utils - INFO - Accuracy:  0.9990
2025-12-09 22:45:04 - utils - INFO - Precision: 0.0000
2025-12-09 22:45:04 - utils - INFO - Recall:    0.0000
2025-12-09 22:45:04 - utils - INFO - F1-Score:  0.0000
2025-12-09 22:45:04 - utils - INFO - AUC-ROC:   0.7067
2025-12-09 22:45:04 - utils - INFO - ============================================================

2025-12-09 22:45:04 - utils - INFO - Comparing ensemble with individual models...
2025-12-09 22:45:04 - utils - INFO - Evaluating ensemble performance...
2025-12-09 22:45:04 - utils - INFO - 
============================================================
2025-12-09 22:45:04 - utils - INFO - Ensemble (cascade) Performance Metrics
2025-12-09 22:45:04 - utils - INFO - ============================================================
2025-12-09 22:45:04 - utils - INFO - Accuracy:  0.9990
2025-12-09 22:45:04 - utils - INFO - Precision: 0.0000
2025-12-09 22:45:04 - utils - INFO - Recall:    0.0000
2025-12-09 22:45:04 - utils - INFO - F1-Score:  0.0000
2025-12-09 22:45:04 - utils - INFO - AUC-ROC:   0.7067
2025-12-09 22:45:04 - utils - INFO - ============================================================

2025-12-09 22:45:04 - utils - INFO - 
Comparison Results:
2025-12-09 22:45:04 - utils - INFO - 
             model  accuracy  precision  recall  f1_score  auc_roc
  Isolation Forest     0.945        0.0     0.0       0.0   0.8208
  Lstm Autoencoder     0.946        0.0     0.0       0.0   0.1842
   Deep Clustering     0.959        0.0     0.0       0.0   0.7407
Ensemble (cascade)     0.999        0.0     0.0       0.0   0.7067
2025-12-09 22:45:04 - utils - INFO - Ensemble predictions saved
2025-12-09 22:45:04 - utils - INFO - Generating alerts...
2025-12-09 22:45:04 - utils - INFO - Generated 35 alerts
2025-12-09 22:45:04 - utils - INFO - Severity distribution:
severity
low         22
high         5
medium       5
critical     3
Name: count, dtype: int64
2025-12-09 22:45:04 - utils - INFO - Alerts saved to /Users/bipinrimal/Downloads/Thesis_work/results/alerts.csv
2025-12-09 22:45:04 - utils - INFO - Ensemble pipeline completed!
2025-12-09 22:45:04 - utils - INFO - 
✓ Stage 5 completed. Best performing method: None
2025-12-09 22:45:04 - utils - INFO - 
================================================================================
                             STAGE 6: VISUALIZATION                             
================================================================================

2025-12-09 22:45:04 - utils - INFO - 
================================================================================
                           GENERATING VISUALIZATIONS                            
================================================================================

2025-12-09 22:45:04 - utils - INFO - Creating alert severity distribution plot...
2025-12-09 22:45:04 - utils - INFO - Alert severity distribution plot saved
2025-12-09 22:45:04 - utils - INFO - Creating model agreement plot...
2025-12-09 22:45:04 - utils - INFO - Model agreement plot saved
2025-12-09 22:45:04 - utils - INFO - Creating anomaly score timeline for ensemble_weighted...
2025-12-09 22:45:04 - utils - INFO - Anomaly score timeline saved for ensemble_weighted
2025-12-09 22:45:04 - utils - INFO - Creating feature importance visualization...
2025-12-09 22:45:04 - utils - INFO - Feature importance heatmap saved
2025-12-09 22:45:04 - utils - INFO - Creating executive summary chart...
2025-12-09 22:45:05 - utils - INFO - Executive summary chart saved
2025-12-09 22:45:05 - utils - INFO - All visualizations saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations
2025-12-09 22:45:05 - utils - INFO - Visualization generation completed!
2025-12-09 22:45:05 - utils - INFO - ✓ Stage 6 completed: All visualizations generated
2025-12-09 22:45:05 - utils - INFO - 
================================================================================
2025-12-09 22:45:05 - utils - INFO - FINAL SUMMARY
2025-12-09 22:45:05 - utils - INFO - ================================================================================
2025-12-09 22:45:05 - utils - INFO - 
Model Performance (on labeled validation set):
2025-12-09 22:45:05 - utils - INFO - 
Isolation Forest:
2025-12-09 22:45:05 - utils - WARNING -   No metrics available (unsupervised execution).
2025-12-09 22:45:05 - utils - INFO - 
Lstm Autoencoder:
2025-12-09 22:45:05 - utils - WARNING -   No metrics available (unsupervised execution).
2025-12-09 22:45:05 - utils - INFO - 
Deep Clustering:
2025-12-09 22:45:05 - utils - WARNING -   No metrics available (unsupervised execution).
2025-12-09 22:45:05 - utils - INFO - 
Generated Output Locations:
2025-12-09 22:45:05 - utils - INFO -   - Processed Data: /Users/bipinrimal/Downloads/Thesis_work/data/processed
2025-12-09 22:45:05 - utils - INFO -   - Trained Models: /Users/bipinrimal/Downloads/Thesis_work/models
2025-12-09 22:45:05 - utils - INFO -   - Alert Logs:     /Users/bipinrimal/Downloads/Thesis_work/results/alerts.csv
2025-12-09 22:45:05 - utils - INFO -   - Logs:           /Users/bipinrimal/Downloads/Thesis_work/logs/insider_threat_detection.log
2025-12-09 22:45:05 - utils - INFO - 
================================================================================
2025-12-09 22:45:05 - utils - INFO - ✓ PIPELINE EXECUTION COMPLETED
2025-12-09 22:45:05 - utils - INFO - ================================================================================

2025-12-09 23:14:06 - utils - INFO - Utility functions loaded successfully
2025-12-09 23:14:10 - utils - INFO - ================================================================================
2025-12-09 23:14:10 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-12-09 23:14:10 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-12-09 23:14:10 - utils - INFO - ================================================================================
2025-12-09 23:14:10 - utils - INFO - 
================================================================================
2025-12-09 23:14:10 - utils - INFO - STARTING FULL PIPELINE EXECUTION
2025-12-09 23:14:10 - utils - INFO - ================================================================================

2025-12-09 23:14:10 - utils - INFO - 
================================================================================
                          STAGE 1: DATA PREPROCESSING                           
================================================================================

2025-12-09 23:14:10 - utils - INFO - Processing SUBSET defined in config: ['r1', 'r2', 'r3.1', 'r3.2', 'r4.1', 'r4.2']
2025-12-09 23:14:10 - utils - INFO - 
================================================================================
                          DATA PREPROCESSING (POLARS)                           
================================================================================

2025-12-09 23:14:10 - utils - INFO - Scanning dataset: r1
2025-12-09 23:14:10 - utils - INFO - Scanning dataset: r2
2025-12-09 23:14:10 - utils - INFO - Scanning dataset: r3.1
2025-12-09 23:14:10 - utils - INFO - Scanning dataset: r3.2
2025-12-09 23:14:10 - utils - INFO - Scanning dataset: r4.1
2025-12-09 23:14:10 - utils - INFO - Scanning dataset: r4.2
2025-12-09 23:14:10 - utils - INFO - Constructing execution graph (Diagonal Concat)...
2025-12-09 23:14:10 - utils - INFO - Loaded Psychometric data: 4998 users
2025-12-09 23:14:10 - utils - INFO - Streaming merged data to /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv...
2025-12-09 23:17:45 - utils - INFO - ✓ Preprocessing complete.
2025-12-09 23:17:45 - utils - INFO - ✓ Stage 1 completed successfully.
2025-12-09 23:17:45 - utils - INFO - 
================================================================================
                          STAGE 2: FEATURE ENGINEERING                          
================================================================================

2025-12-09 23:17:45 - utils - INFO - Starting Feature Engineering Pipeline (Polars Lazy Execution)...
2025-12-09 23:17:45 - utils - INFO - Scanning data from /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv
2025-12-09 23:17:45 - utils - INFO - Constructing execution graph for daily features...
2025-12-09 23:17:45 - utils - INFO - Executing aggregation (Streaming Mode)...
2025-12-09 23:20:19 - utils - INFO - Saved features to: /Users/bipinrimal/Downloads/Thesis_work/data/processed/daily_features.parquet
2025-12-09 23:20:19 - utils - INFO - Creating static features...
2025-12-09 23:20:20 - utils - INFO - Generated static features for 8998 users
2025-12-09 23:20:20 - utils - INFO - Saved features to: /Users/bipinrimal/Downloads/Thesis_work/data/processed/static_features.csv
2025-12-09 23:20:20 - utils - INFO - Creating sequences...
2025-12-09 23:20:20 - utils - INFO - Saved features to: /Users/bipinrimal/Downloads/Thesis_work/data/processed/sequence_features.parquet
2025-12-09 23:20:20 - utils - INFO - Processing sequences with length 15...
2025-12-09 23:20:22 - utils - INFO - Generated sequences shape: (2858935, 15, 13)
2025-12-09 23:20:25 - utils - INFO - Saved sequences to /Users/bipinrimal/Downloads/Thesis_work/data/processed/sequences.npy
2025-12-09 23:20:25 - utils - INFO - Feature engineering pipeline completed successfully.
2025-12-09 23:20:25 - utils - INFO - ✓ Stage 2 completed: Feature files generated.
2025-12-09 23:20:25 - utils - INFO - 
================================================================================
                            STAGE 3: MODEL TRAINING                             
================================================================================

2025-12-09 23:20:25 - utils - INFO - 
>>> Training Isolation Forest...
2025-12-09 23:20:25 - utils - INFO - 
================================================================================
                 ISOLATION FOREST TRAINING (V2: MULTI-DATASET)                  
================================================================================

2025-12-09 23:20:25 - utils - INFO - Loading static features from: static_features.csv
2025-12-09 23:20:25 - utils - ERROR - Failed to load 'static_scaler.pkl'. Run feature_engineering.py first. Error: STACK_GLOBAL requires str
2025-12-09 23:20:25 - utils - INFO - ✓ Isolation Forest training completed
2025-12-09 23:20:25 - utils - INFO - 
>>> Training LSTM Autoencoder...
2025-12-09 23:20:25 - utils - INFO - 
================================================================================
                     LIGHTWEIGHT LSTM AUTOENCODER TRAINING                      
================================================================================

2025-12-09 23:20:26 - utils - ERROR - Sequence data not found. Run feature_engineering.py first. Error: [Errno 2] No such file or directory: '/Users/bipinrimal/Downloads/Thesis_work/data/processed/sequence_labels.npy'
2025-12-09 23:20:26 - utils - INFO - ✓ LSTM Autoencoder training completed
2025-12-09 23:20:26 - utils - INFO - 
>>> Training Deep Clustering...
2025-12-09 23:20:26 - utils - INFO - 
================================================================================
                      LIGHTWEIGHT DEEP CLUSTERING TRAINING                      
================================================================================

2025-12-09 23:20:26 - utils - INFO - Loading static features from: static_features.csv
2025-12-09 23:20:26 - utils - ERROR - Failed to load 'static_scaler.pkl'. Run feature_engineering.py first. Error: STACK_GLOBAL requires str
2025-12-09 23:20:26 - utils - INFO - ✓ Deep Clustering training completed
2025-12-09 23:20:26 - utils - INFO - 
✓ Stage 3 completed: 3 models trained
2025-12-09 23:20:26 - utils - INFO - 
================================================================================
                           STAGE 4: MODEL EVALUATION                            
================================================================================

2025-12-09 23:20:26 - utils - INFO - 
================================================================================
                         COMPREHENSIVE MODEL EVALUATION                         
================================================================================

2025-12-09 23:20:26 - utils - INFO - Loading results for all models...
2025-12-09 23:20:26 - utils - INFO - Loaded results for isolation_forest
2025-12-09 23:20:26 - utils - INFO - Loaded results for lstm_autoencoder
2025-12-09 23:20:26 - utils - INFO - Loaded results for deep_clustering
2025-12-09 23:20:26 - utils - INFO - Loaded results for 3 models
2025-12-09 23:20:26 - utils - INFO - Creating metrics comparison table...
2025-12-09 23:20:26 - utils - INFO - Metrics comparison table created
2025-12-09 23:20:26 - utils - INFO - Creating confusion matrix plots...
2025-12-09 23:20:27 - utils - INFO - Confusion matrices saved to /Users/bipinrimal/Downloads/Thesis_work/results/confusion_matrices/all_models.png
2025-12-09 23:20:27 - utils - INFO - Creating ROC curves...
2025-12-09 23:20:27 - utils - INFO - ROC curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/roc_curves/roc_comparison.png
2025-12-09 23:20:27 - utils - INFO - Creating Precision-Recall curves...
2025-12-09 23:20:27 - utils - INFO - Precision-Recall curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/precision_recall_comparison.png
2025-12-09 23:20:27 - utils - INFO - Creating metrics comparison bar chart...
2025-12-09 23:20:27 - utils - INFO - Metrics comparison bar chart saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/metrics_comparison_bar.png
2025-12-09 23:20:27 - utils - INFO - Creating anomaly score distribution plots...
2025-12-09 23:20:27 - utils - INFO - Score distributions saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/score_distributions.png
2025-12-09 23:20:27 - utils - INFO - Generating evaluation report...
2025-12-09 23:20:27 - utils - INFO - Evaluation report saved to /Users/bipinrimal/Downloads/Thesis_work/results/evaluation_report.txt
2025-12-09 23:20:27 - utils - INFO - Comprehensive evaluation completed!
2025-12-09 23:20:27 - utils - INFO - ✓ Stage 4 completed: Comprehensive evaluation report generated
2025-12-09 23:20:27 - utils - INFO - 
================================================================================
                         STAGE 5: ENSEMBLE INTEGRATION                          
================================================================================

2025-12-09 23:20:27 - utils - INFO - Testing ensemble method: weighted
2025-12-09 23:20:27 - utils - INFO - Initialized Ensemble Detector with method: weighted
2025-12-09 23:20:27 - utils - INFO - 
================================================================================
                            ENSEMBLE SYSTEM PIPELINE                            
================================================================================

2025-12-09 23:20:27 - utils - INFO - Loading predictions from individual models...
2025-12-09 23:20:27 - utils - INFO - Loaded isolation_forest predictions: 1000 samples
2025-12-09 23:20:27 - utils - INFO - Loaded lstm_autoencoder predictions: 32531 samples
2025-12-09 23:20:27 - utils - INFO - Loaded deep_clustering predictions: 1000 samples
2025-12-09 23:20:27 - utils - WARNING - Models have different sample counts: {'isolation_forest': 1000, 'lstm_autoencoder': 32531, 'deep_clustering': 1000}
2025-12-09 23:20:27 - utils - INFO - Will use aggregation strategy to align predictions...
2025-12-09 23:20:27 - utils - INFO - Aligning predictions across models...
2025-12-09 23:20:27 - utils - INFO - Using isolation_forest as reference (1000 samples)
2025-12-09 23:20:27 - utils - INFO - Aggregating lstm_autoencoder from 32531 to 1000 samples
2025-12-09 23:20:27 - utils - INFO - Predictions aligned successfully
2025-12-09 23:20:27 - utils - INFO - Loaded predictions from 3 models
2025-12-09 23:20:27 - utils - INFO - Computing weighted ensemble...
2025-12-09 23:20:27 - utils - INFO - Weighted ensemble: 0 anomalies detected
2025-12-09 23:20:27 - utils - INFO - Evaluating ensemble performance...
2025-12-09 23:20:27 - utils - INFO - 
============================================================
2025-12-09 23:20:27 - utils - INFO - Ensemble (weighted) Performance Metrics
2025-12-09 23:20:27 - utils - INFO - ============================================================
2025-12-09 23:20:27 - utils - INFO - Accuracy:  0.9990
2025-12-09 23:20:27 - utils - INFO - Precision: 0.0000
2025-12-09 23:20:27 - utils - INFO - Recall:    0.0000
2025-12-09 23:20:27 - utils - INFO - F1-Score:  0.0000
2025-12-09 23:20:27 - utils - INFO - AUC-ROC:   0.7978
2025-12-09 23:20:27 - utils - INFO - ============================================================

2025-12-09 23:20:27 - utils - INFO - Comparing ensemble with individual models...
2025-12-09 23:20:27 - utils - INFO - Evaluating ensemble performance...
2025-12-09 23:20:27 - utils - INFO - 
============================================================
2025-12-09 23:20:27 - utils - INFO - Ensemble (weighted) Performance Metrics
2025-12-09 23:20:27 - utils - INFO - ============================================================
2025-12-09 23:20:27 - utils - INFO - Accuracy:  0.9990
2025-12-09 23:20:27 - utils - INFO - Precision: 0.0000
2025-12-09 23:20:27 - utils - INFO - Recall:    0.0000
2025-12-09 23:20:27 - utils - INFO - F1-Score:  0.0000
2025-12-09 23:20:27 - utils - INFO - AUC-ROC:   0.7978
2025-12-09 23:20:27 - utils - INFO - ============================================================

2025-12-09 23:20:27 - utils - INFO - 
Comparison Results:
2025-12-09 23:20:27 - utils - INFO - 
              model  accuracy  precision  recall  f1_score  auc_roc
   Isolation Forest     0.945        0.0     0.0       0.0   0.8208
   Lstm Autoencoder     0.946        0.0     0.0       0.0   0.1842
    Deep Clustering     0.959        0.0     0.0       0.0   0.7407
Ensemble (weighted)     0.999        0.0     0.0       0.0   0.7978
2025-12-09 23:20:27 - utils - INFO - Ensemble predictions saved
2025-12-09 23:20:27 - utils - INFO - Generating alerts...
2025-12-09 23:20:27 - utils - INFO - No anomalies detected above threshold. Returning empty alerts DataFrame.
2025-12-09 23:20:27 - utils - INFO - Alerts saved to /Users/bipinrimal/Downloads/Thesis_work/results/alerts.csv
2025-12-09 23:20:27 - utils - INFO - Ensemble pipeline completed!
2025-12-09 23:20:27 - utils - INFO - Testing ensemble method: majority
2025-12-09 23:20:27 - utils - INFO - Initialized Ensemble Detector with method: majority
2025-12-09 23:20:27 - utils - INFO - 
================================================================================
                            ENSEMBLE SYSTEM PIPELINE                            
================================================================================

2025-12-09 23:20:27 - utils - INFO - Loading predictions from individual models...
2025-12-09 23:20:27 - utils - INFO - Loaded isolation_forest predictions: 1000 samples
2025-12-09 23:20:27 - utils - INFO - Loaded lstm_autoencoder predictions: 32531 samples
2025-12-09 23:20:27 - utils - INFO - Loaded deep_clustering predictions: 1000 samples
2025-12-09 23:20:27 - utils - WARNING - Models have different sample counts: {'isolation_forest': 1000, 'lstm_autoencoder': 32531, 'deep_clustering': 1000}
2025-12-09 23:20:27 - utils - INFO - Will use aggregation strategy to align predictions...
2025-12-09 23:20:27 - utils - INFO - Aligning predictions across models...
2025-12-09 23:20:27 - utils - INFO - Using isolation_forest as reference (1000 samples)
2025-12-09 23:20:27 - utils - INFO - Aggregating lstm_autoencoder from 32531 to 1000 samples
2025-12-09 23:20:27 - utils - INFO - Predictions aligned successfully
2025-12-09 23:20:27 - utils - INFO - Loaded predictions from 3 models
2025-12-09 23:20:27 - utils - INFO - Computing majority voting ensemble...
2025-12-09 23:20:27 - utils - INFO - Majority voting: 11 anomalies detected
2025-12-09 23:20:27 - utils - INFO - Evaluating ensemble performance...
2025-12-09 23:20:27 - utils - INFO - 
============================================================
2025-12-09 23:20:27 - utils - INFO - Ensemble (majority) Performance Metrics
2025-12-09 23:20:27 - utils - INFO - ============================================================
2025-12-09 23:20:27 - utils - INFO - Accuracy:  0.9880
2025-12-09 23:20:27 - utils - INFO - Precision: 0.0000
2025-12-09 23:20:27 - utils - INFO - Recall:    0.0000
2025-12-09 23:20:27 - utils - INFO - F1-Score:  0.0000
2025-12-09 23:20:27 - utils - INFO - AUC-ROC:   0.8018
2025-12-09 23:20:27 - utils - INFO - ============================================================

2025-12-09 23:20:27 - utils - INFO - Comparing ensemble with individual models...
2025-12-09 23:20:27 - utils - INFO - Evaluating ensemble performance...
2025-12-09 23:20:27 - utils - INFO - 
============================================================
2025-12-09 23:20:27 - utils - INFO - Ensemble (majority) Performance Metrics
2025-12-09 23:20:27 - utils - INFO - ============================================================
2025-12-09 23:20:27 - utils - INFO - Accuracy:  0.9880
2025-12-09 23:20:27 - utils - INFO - Precision: 0.0000
2025-12-09 23:20:27 - utils - INFO - Recall:    0.0000
2025-12-09 23:20:27 - utils - INFO - F1-Score:  0.0000
2025-12-09 23:20:27 - utils - INFO - AUC-ROC:   0.8018
2025-12-09 23:20:27 - utils - INFO - ============================================================

2025-12-09 23:20:27 - utils - INFO - 
Comparison Results:
2025-12-09 23:20:27 - utils - INFO - 
              model  accuracy  precision  recall  f1_score  auc_roc
   Isolation Forest     0.945        0.0     0.0       0.0   0.8208
   Lstm Autoencoder     0.946        0.0     0.0       0.0   0.1842
    Deep Clustering     0.959        0.0     0.0       0.0   0.7407
Ensemble (majority)     0.988        0.0     0.0       0.0   0.8018
2025-12-09 23:20:27 - utils - INFO - Ensemble predictions saved
2025-12-09 23:20:27 - utils - INFO - Generating alerts...
2025-12-09 23:20:27 - utils - INFO - No anomalies detected above threshold. Returning empty alerts DataFrame.
2025-12-09 23:20:27 - utils - INFO - Alerts saved to /Users/bipinrimal/Downloads/Thesis_work/results/alerts.csv
2025-12-09 23:20:27 - utils - INFO - Ensemble pipeline completed!
2025-12-09 23:20:27 - utils - INFO - Testing ensemble method: cascade
2025-12-09 23:20:27 - utils - INFO - Initialized Ensemble Detector with method: cascade
2025-12-09 23:20:27 - utils - INFO - 
================================================================================
                            ENSEMBLE SYSTEM PIPELINE                            
================================================================================

2025-12-09 23:20:27 - utils - INFO - Loading predictions from individual models...
2025-12-09 23:20:27 - utils - INFO - Loaded isolation_forest predictions: 1000 samples
2025-12-09 23:20:27 - utils - INFO - Loaded lstm_autoencoder predictions: 32531 samples
2025-12-09 23:20:27 - utils - INFO - Loaded deep_clustering predictions: 1000 samples
2025-12-09 23:20:27 - utils - WARNING - Models have different sample counts: {'isolation_forest': 1000, 'lstm_autoencoder': 32531, 'deep_clustering': 1000}
2025-12-09 23:20:27 - utils - INFO - Will use aggregation strategy to align predictions...
2025-12-09 23:20:27 - utils - INFO - Aligning predictions across models...
2025-12-09 23:20:27 - utils - INFO - Using isolation_forest as reference (1000 samples)
2025-12-09 23:20:27 - utils - INFO - Aggregating lstm_autoencoder from 32531 to 1000 samples
2025-12-09 23:20:27 - utils - INFO - Predictions aligned successfully
2025-12-09 23:20:27 - utils - INFO - Loaded predictions from 3 models
2025-12-09 23:20:27 - utils - INFO - Computing cascade ensemble...
2025-12-09 23:20:27 - utils - INFO - Cascade ensemble: 0 anomalies detected
2025-12-09 23:20:27 - utils - INFO - Evaluating ensemble performance...
2025-12-09 23:20:27 - utils - INFO - 
============================================================
2025-12-09 23:20:27 - utils - INFO - Ensemble (cascade) Performance Metrics
2025-12-09 23:20:27 - utils - INFO - ============================================================
2025-12-09 23:20:27 - utils - INFO - Accuracy:  0.9990
2025-12-09 23:20:27 - utils - INFO - Precision: 0.0000
2025-12-09 23:20:27 - utils - INFO - Recall:    0.0000
2025-12-09 23:20:27 - utils - INFO - F1-Score:  0.0000
2025-12-09 23:20:27 - utils - INFO - AUC-ROC:   0.7067
2025-12-09 23:20:27 - utils - INFO - ============================================================

2025-12-09 23:20:27 - utils - INFO - Comparing ensemble with individual models...
2025-12-09 23:20:27 - utils - INFO - Evaluating ensemble performance...
2025-12-09 23:20:27 - utils - INFO - 
============================================================
2025-12-09 23:20:27 - utils - INFO - Ensemble (cascade) Performance Metrics
2025-12-09 23:20:27 - utils - INFO - ============================================================
2025-12-09 23:20:27 - utils - INFO - Accuracy:  0.9990
2025-12-09 23:20:27 - utils - INFO - Precision: 0.0000
2025-12-09 23:20:27 - utils - INFO - Recall:    0.0000
2025-12-09 23:20:27 - utils - INFO - F1-Score:  0.0000
2025-12-09 23:20:27 - utils - INFO - AUC-ROC:   0.7067
2025-12-09 23:20:27 - utils - INFO - ============================================================

2025-12-09 23:20:27 - utils - INFO - 
Comparison Results:
2025-12-09 23:20:27 - utils - INFO - 
             model  accuracy  precision  recall  f1_score  auc_roc
  Isolation Forest     0.945        0.0     0.0       0.0   0.8208
  Lstm Autoencoder     0.946        0.0     0.0       0.0   0.1842
   Deep Clustering     0.959        0.0     0.0       0.0   0.7407
Ensemble (cascade)     0.999        0.0     0.0       0.0   0.7067
2025-12-09 23:20:27 - utils - INFO - Ensemble predictions saved
2025-12-09 23:20:27 - utils - INFO - Generating alerts...
2025-12-09 23:20:27 - utils - INFO - Generated 35 alerts
2025-12-09 23:20:27 - utils - INFO - Severity distribution:
severity
low         22
high         5
medium       5
critical     3
Name: count, dtype: int64
2025-12-09 23:20:27 - utils - INFO - Alerts saved to /Users/bipinrimal/Downloads/Thesis_work/results/alerts.csv
2025-12-09 23:20:27 - utils - INFO - Ensemble pipeline completed!
2025-12-09 23:20:27 - utils - INFO - 
✓ Stage 5 completed. Best performing method: None
2025-12-09 23:20:27 - utils - INFO - 
================================================================================
                             STAGE 6: VISUALIZATION                             
================================================================================

2025-12-09 23:20:27 - utils - INFO - 
================================================================================
                           GENERATING VISUALIZATIONS                            
================================================================================

2025-12-09 23:20:27 - utils - INFO - Creating alert severity distribution plot...
2025-12-09 23:20:27 - utils - INFO - Alert severity distribution plot saved
2025-12-09 23:20:27 - utils - INFO - Creating model agreement plot...
2025-12-09 23:20:27 - utils - INFO - Model agreement plot saved
2025-12-09 23:20:27 - utils - INFO - Creating anomaly score timeline for ensemble_weighted...
2025-12-09 23:20:27 - utils - INFO - Anomaly score timeline saved for ensemble_weighted
2025-12-09 23:20:27 - utils - INFO - Creating feature importance visualization...
2025-12-09 23:20:28 - utils - INFO - Feature importance heatmap saved
2025-12-09 23:20:28 - utils - INFO - Creating executive summary chart...
2025-12-09 23:20:28 - utils - INFO - Executive summary chart saved
2025-12-09 23:20:28 - utils - INFO - All visualizations saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations
2025-12-09 23:20:28 - utils - INFO - Visualization generation completed!
2025-12-09 23:20:28 - utils - INFO - ✓ Stage 6 completed: All visualizations generated
2025-12-09 23:20:28 - utils - INFO - 
================================================================================
2025-12-09 23:20:28 - utils - INFO - FINAL SUMMARY
2025-12-09 23:20:28 - utils - INFO - ================================================================================
2025-12-09 23:20:28 - utils - INFO - 
Model Performance (on labeled validation set):
2025-12-09 23:20:28 - utils - INFO - 
Isolation Forest:
2025-12-09 23:20:28 - utils - WARNING -   No metrics available (unsupervised execution).
2025-12-09 23:20:28 - utils - INFO - 
Lstm Autoencoder:
2025-12-09 23:20:28 - utils - WARNING -   No metrics available (unsupervised execution).
2025-12-09 23:20:28 - utils - INFO - 
Deep Clustering:
2025-12-09 23:20:28 - utils - WARNING -   No metrics available (unsupervised execution).
2025-12-09 23:20:28 - utils - INFO - 
Generated Output Locations:
2025-12-09 23:20:28 - utils - INFO -   - Processed Data: /Users/bipinrimal/Downloads/Thesis_work/data/processed
2025-12-09 23:20:28 - utils - INFO -   - Trained Models: /Users/bipinrimal/Downloads/Thesis_work/models
2025-12-09 23:20:28 - utils - INFO -   - Alert Logs:     /Users/bipinrimal/Downloads/Thesis_work/results/alerts.csv
2025-12-09 23:20:28 - utils - INFO -   - Logs:           /Users/bipinrimal/Downloads/Thesis_work/logs/insider_threat_detection.log
2025-12-09 23:20:28 - utils - INFO - 
================================================================================
2025-12-09 23:20:28 - utils - INFO - ✓ PIPELINE EXECUTION COMPLETED
2025-12-09 23:20:28 - utils - INFO - ================================================================================

2025-12-09 23:25:00 - utils - INFO - Utility functions loaded successfully
2025-12-09 23:25:03 - utils - INFO - ================================================================================
2025-12-09 23:25:03 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-12-09 23:25:03 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-12-09 23:25:03 - utils - INFO - ================================================================================
2025-12-09 23:25:03 - utils - INFO - 
================================================================================
2025-12-09 23:25:03 - utils - INFO - STARTING FULL PIPELINE EXECUTION
2025-12-09 23:25:03 - utils - INFO - ================================================================================

2025-12-09 23:25:03 - utils - INFO - 
================================================================================
                          STAGE 1: DATA PREPROCESSING                           
================================================================================

2025-12-09 23:25:03 - utils - INFO - Processing SUBSET defined in config: ['r1', 'r2', 'r3.1', 'r3.2', 'r4.1', 'r4.2']
2025-12-09 23:25:03 - utils - INFO - 
================================================================================
                          DATA PREPROCESSING (POLARS)                           
================================================================================

2025-12-09 23:25:03 - utils - INFO - Scanning dataset: r1
2025-12-09 23:25:03 - utils - INFO - Scanning dataset: r2
2025-12-09 23:25:04 - utils - INFO - Scanning dataset: r3.1
2025-12-09 23:25:04 - utils - INFO - Scanning dataset: r3.2
2025-12-09 23:25:04 - utils - INFO - Scanning dataset: r4.1
2025-12-09 23:25:04 - utils - INFO - Scanning dataset: r4.2
2025-12-09 23:25:04 - utils - INFO - Constructing execution graph (Diagonal Concat)...
2025-12-09 23:25:04 - utils - INFO - Loaded Psychometric data: 4998 users
2025-12-09 23:25:04 - utils - INFO - Streaming merged data to /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv...
2025-12-09 23:28:38 - utils - INFO - ✓ Preprocessing complete.
2025-12-09 23:28:38 - utils - INFO - ✓ Stage 1 completed successfully.
2025-12-09 23:28:38 - utils - INFO - 
================================================================================
                          STAGE 2: FEATURE ENGINEERING                          
================================================================================

2025-12-09 23:28:38 - utils - INFO - Starting Feature Engineering Pipeline (Polars Lazy Execution)...
2025-12-09 23:28:38 - utils - INFO - Scanning data from /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv
2025-12-09 23:28:38 - utils - INFO - Constructing execution graph for daily features...
2025-12-09 23:28:38 - utils - INFO - Executing aggregation (Streaming Mode)...
2025-12-09 23:31:07 - utils - INFO - Saved features to: /Users/bipinrimal/Downloads/Thesis_work/data/processed/daily_features.parquet
2025-12-09 23:31:07 - utils - INFO - Creating static features and fitting scaler...
2025-12-09 23:31:07 - utils - INFO - Generated static features for 8998 users
2025-12-09 23:31:07 - utils - INFO - Saved features to: /Users/bipinrimal/Downloads/Thesis_work/data/processed/static_features.csv
2025-12-09 23:31:07 - utils - INFO - Saved static scaler to /Users/bipinrimal/Downloads/Thesis_work/models/static_scaler.pkl
2025-12-09 23:31:07 - utils - INFO - Creating sequences...
2025-12-09 23:31:07 - utils - INFO - Saved features to: /Users/bipinrimal/Downloads/Thesis_work/data/processed/sequence_features.parquet
2025-12-09 23:31:07 - utils - INFO - Processing sequences with length 15...
2025-12-09 23:31:09 - utils - INFO - Generated sequences shape: (2858935, 15, 13)
2025-12-09 23:31:09 - utils - INFO - Generated labels shape: (2858935,)
2025-12-09 23:31:11 - utils - INFO - Saved sequences to /Users/bipinrimal/Downloads/Thesis_work/data/processed/sequences.npy
2025-12-09 23:31:12 - utils - INFO - Saved sequence labels to /Users/bipinrimal/Downloads/Thesis_work/data/processed/sequence_labels.npy
2025-12-09 23:31:12 - utils - INFO - Feature engineering pipeline completed successfully.
2025-12-09 23:31:12 - utils - INFO - ✓ Stage 2 completed: Feature files generated.
2025-12-09 23:31:12 - utils - INFO - 
================================================================================
                            STAGE 3: MODEL TRAINING                             
================================================================================

2025-12-09 23:31:12 - utils - INFO - 
>>> Training Isolation Forest...
2025-12-09 23:31:12 - utils - INFO - 
================================================================================
                 ISOLATION FOREST TRAINING (V2: MULTI-DATASET)                  
================================================================================

2025-12-09 23:31:12 - utils - INFO - Loading static features from: static_features.csv
2025-12-09 23:31:12 - utils - ERROR - Failed to load 'static_scaler.pkl'. Run feature_engineering.py first. Error: STACK_GLOBAL requires str
2025-12-09 23:31:12 - utils - INFO - ✓ Isolation Forest training completed
2025-12-09 23:31:12 - utils - INFO - 
>>> Training LSTM Autoencoder...
2025-12-09 23:31:12 - utils - INFO - 
================================================================================
                     LIGHTWEIGHT LSTM AUTOENCODER TRAINING                      
================================================================================

2025-12-09 23:31:12 - utils - INFO - Loaded sequences: (2858935, 15, 13)
2025-12-09 23:31:15 - utils - INFO - Data split: Train=2001254, Val=428840, Test=428841
2025-12-09 23:31:15 - utils - INFO - Insider labels split: Train=0, Val=0, Test=0
2025-12-09 23:31:16 - utils - INFO - Training on 2001254 normal sequences
2025-12-09 23:31:16 - utils - ERROR - ✗ LSTM Autoencoder training failed: STACK_GLOBAL requires str
2025-12-09 23:31:16 - utils - INFO - 
>>> Training Deep Clustering...
2025-12-09 23:31:16 - utils - INFO - 
================================================================================
                      LIGHTWEIGHT DEEP CLUSTERING TRAINING                      
================================================================================

2025-12-09 23:31:16 - utils - INFO - Loading static features from: static_features.csv
2025-12-09 23:31:16 - utils - ERROR - Failed to load 'static_scaler.pkl'. Run feature_engineering.py first. Error: STACK_GLOBAL requires str
2025-12-09 23:31:16 - utils - INFO - ✓ Deep Clustering training completed
2025-12-09 23:31:16 - utils - INFO - 
✓ Stage 3 completed: 2 models trained
2025-12-09 23:31:16 - utils - INFO - 
================================================================================
                           STAGE 4: MODEL EVALUATION                            
================================================================================

2025-12-09 23:31:16 - utils - INFO - 
================================================================================
                         COMPREHENSIVE MODEL EVALUATION                         
================================================================================

2025-12-09 23:31:16 - utils - INFO - Loading results for all models...
2025-12-09 23:31:16 - utils - INFO - Loaded results for isolation_forest
2025-12-09 23:31:16 - utils - INFO - Loaded results for lstm_autoencoder
2025-12-09 23:31:16 - utils - INFO - Loaded results for deep_clustering
2025-12-09 23:31:16 - utils - INFO - Loaded results for 3 models
2025-12-09 23:31:16 - utils - INFO - Creating metrics comparison table...
2025-12-09 23:31:16 - utils - INFO - Metrics comparison table created
2025-12-09 23:31:16 - utils - INFO - Creating confusion matrix plots...
2025-12-09 23:31:17 - utils - INFO - Confusion matrices saved to /Users/bipinrimal/Downloads/Thesis_work/results/confusion_matrices/all_models.png
2025-12-09 23:31:17 - utils - INFO - Creating ROC curves...
2025-12-09 23:31:17 - utils - INFO - ROC curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/roc_curves/roc_comparison.png
2025-12-09 23:31:17 - utils - INFO - Creating Precision-Recall curves...
2025-12-09 23:31:17 - utils - INFO - Precision-Recall curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/precision_recall_comparison.png
2025-12-09 23:31:17 - utils - INFO - Creating metrics comparison bar chart...
2025-12-09 23:31:17 - utils - INFO - Metrics comparison bar chart saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/metrics_comparison_bar.png
2025-12-09 23:31:17 - utils - INFO - Creating anomaly score distribution plots...
2025-12-09 23:31:18 - utils - INFO - Score distributions saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/score_distributions.png
2025-12-09 23:31:18 - utils - INFO - Generating evaluation report...
2025-12-09 23:31:18 - utils - INFO - Evaluation report saved to /Users/bipinrimal/Downloads/Thesis_work/results/evaluation_report.txt
2025-12-09 23:31:18 - utils - INFO - Comprehensive evaluation completed!
2025-12-09 23:31:18 - utils - INFO - ✓ Stage 4 completed: Comprehensive evaluation report generated
2025-12-09 23:31:18 - utils - INFO - 
================================================================================
                         STAGE 5: ENSEMBLE INTEGRATION                          
================================================================================

2025-12-09 23:31:18 - utils - INFO - Testing ensemble method: weighted
2025-12-09 23:31:18 - utils - INFO - Initialized Ensemble Detector with method: weighted
2025-12-09 23:31:18 - utils - INFO - 
================================================================================
                            ENSEMBLE SYSTEM PIPELINE                            
================================================================================

2025-12-09 23:31:18 - utils - INFO - Loading predictions from individual models...
2025-12-09 23:31:18 - utils - INFO - Loaded isolation_forest predictions: 1000 samples
2025-12-09 23:31:18 - utils - INFO - Loaded lstm_autoencoder predictions: 32531 samples
2025-12-09 23:31:18 - utils - INFO - Loaded deep_clustering predictions: 1000 samples
2025-12-09 23:31:18 - utils - WARNING - Models have different sample counts: {'isolation_forest': 1000, 'lstm_autoencoder': 32531, 'deep_clustering': 1000}
2025-12-09 23:31:18 - utils - INFO - Will use aggregation strategy to align predictions...
2025-12-09 23:31:18 - utils - INFO - Aligning predictions across models...
2025-12-09 23:31:18 - utils - INFO - Using isolation_forest as reference (1000 samples)
2025-12-09 23:31:18 - utils - INFO - Aggregating lstm_autoencoder from 32531 to 1000 samples
2025-12-09 23:31:18 - utils - INFO - Predictions aligned successfully
2025-12-09 23:31:18 - utils - INFO - Loaded predictions from 3 models
2025-12-09 23:31:18 - utils - INFO - Computing weighted ensemble...
2025-12-09 23:31:18 - utils - INFO - Weighted ensemble: 0 anomalies detected
2025-12-09 23:31:18 - utils - INFO - Evaluating ensemble performance...
2025-12-09 23:31:18 - utils - INFO - 
============================================================
2025-12-09 23:31:18 - utils - INFO - Ensemble (weighted) Performance Metrics
2025-12-09 23:31:18 - utils - INFO - ============================================================
2025-12-09 23:31:18 - utils - INFO - Accuracy:  0.9990
2025-12-09 23:31:18 - utils - INFO - Precision: 0.0000
2025-12-09 23:31:18 - utils - INFO - Recall:    0.0000
2025-12-09 23:31:18 - utils - INFO - F1-Score:  0.0000
2025-12-09 23:31:18 - utils - INFO - AUC-ROC:   0.7978
2025-12-09 23:31:18 - utils - INFO - ============================================================

2025-12-09 23:31:18 - utils - INFO - Comparing ensemble with individual models...
2025-12-09 23:31:18 - utils - INFO - Evaluating ensemble performance...
2025-12-09 23:31:18 - utils - INFO - 
============================================================
2025-12-09 23:31:18 - utils - INFO - Ensemble (weighted) Performance Metrics
2025-12-09 23:31:18 - utils - INFO - ============================================================
2025-12-09 23:31:18 - utils - INFO - Accuracy:  0.9990
2025-12-09 23:31:18 - utils - INFO - Precision: 0.0000
2025-12-09 23:31:18 - utils - INFO - Recall:    0.0000
2025-12-09 23:31:18 - utils - INFO - F1-Score:  0.0000
2025-12-09 23:31:18 - utils - INFO - AUC-ROC:   0.7978
2025-12-09 23:31:18 - utils - INFO - ============================================================

2025-12-09 23:31:18 - utils - INFO - 
Comparison Results:
2025-12-09 23:31:18 - utils - INFO - 
              model  accuracy  precision  recall  f1_score  auc_roc
   Isolation Forest     0.945        0.0     0.0       0.0   0.8208
   Lstm Autoencoder     0.946        0.0     0.0       0.0   0.1842
    Deep Clustering     0.959        0.0     0.0       0.0   0.7407
Ensemble (weighted)     0.999        0.0     0.0       0.0   0.7978
2025-12-09 23:31:18 - utils - INFO - Ensemble predictions saved
2025-12-09 23:31:18 - utils - INFO - Generating alerts...
2025-12-09 23:31:18 - utils - INFO - No anomalies detected above threshold. Returning empty alerts DataFrame.
2025-12-09 23:31:18 - utils - INFO - Alerts saved to /Users/bipinrimal/Downloads/Thesis_work/results/alerts.csv
2025-12-09 23:31:18 - utils - INFO - Ensemble pipeline completed!
2025-12-09 23:31:18 - utils - INFO - Testing ensemble method: majority
2025-12-09 23:31:18 - utils - INFO - Initialized Ensemble Detector with method: majority
2025-12-09 23:31:18 - utils - INFO - 
================================================================================
                            ENSEMBLE SYSTEM PIPELINE                            
================================================================================

2025-12-09 23:31:18 - utils - INFO - Loading predictions from individual models...
2025-12-09 23:31:18 - utils - INFO - Loaded isolation_forest predictions: 1000 samples
2025-12-09 23:31:18 - utils - INFO - Loaded lstm_autoencoder predictions: 32531 samples
2025-12-09 23:31:18 - utils - INFO - Loaded deep_clustering predictions: 1000 samples
2025-12-09 23:31:18 - utils - WARNING - Models have different sample counts: {'isolation_forest': 1000, 'lstm_autoencoder': 32531, 'deep_clustering': 1000}
2025-12-09 23:31:18 - utils - INFO - Will use aggregation strategy to align predictions...
2025-12-09 23:31:18 - utils - INFO - Aligning predictions across models...
2025-12-09 23:31:18 - utils - INFO - Using isolation_forest as reference (1000 samples)
2025-12-09 23:31:18 - utils - INFO - Aggregating lstm_autoencoder from 32531 to 1000 samples
2025-12-09 23:31:18 - utils - INFO - Predictions aligned successfully
2025-12-09 23:31:18 - utils - INFO - Loaded predictions from 3 models
2025-12-09 23:31:18 - utils - INFO - Computing majority voting ensemble...
2025-12-09 23:31:18 - utils - INFO - Majority voting: 11 anomalies detected
2025-12-09 23:31:18 - utils - INFO - Evaluating ensemble performance...
2025-12-09 23:31:18 - utils - INFO - 
============================================================
2025-12-09 23:31:18 - utils - INFO - Ensemble (majority) Performance Metrics
2025-12-09 23:31:18 - utils - INFO - ============================================================
2025-12-09 23:31:18 - utils - INFO - Accuracy:  0.9880
2025-12-09 23:31:18 - utils - INFO - Precision: 0.0000
2025-12-09 23:31:18 - utils - INFO - Recall:    0.0000
2025-12-09 23:31:18 - utils - INFO - F1-Score:  0.0000
2025-12-09 23:31:18 - utils - INFO - AUC-ROC:   0.8018
2025-12-09 23:31:18 - utils - INFO - ============================================================

2025-12-09 23:31:18 - utils - INFO - Comparing ensemble with individual models...
2025-12-09 23:31:18 - utils - INFO - Evaluating ensemble performance...
2025-12-09 23:31:18 - utils - INFO - 
============================================================
2025-12-09 23:31:18 - utils - INFO - Ensemble (majority) Performance Metrics
2025-12-09 23:31:18 - utils - INFO - ============================================================
2025-12-09 23:31:18 - utils - INFO - Accuracy:  0.9880
2025-12-09 23:31:18 - utils - INFO - Precision: 0.0000
2025-12-09 23:31:18 - utils - INFO - Recall:    0.0000
2025-12-09 23:31:18 - utils - INFO - F1-Score:  0.0000
2025-12-09 23:31:18 - utils - INFO - AUC-ROC:   0.8018
2025-12-09 23:31:18 - utils - INFO - ============================================================

2025-12-09 23:31:18 - utils - INFO - 
Comparison Results:
2025-12-09 23:31:18 - utils - INFO - 
              model  accuracy  precision  recall  f1_score  auc_roc
   Isolation Forest     0.945        0.0     0.0       0.0   0.8208
   Lstm Autoencoder     0.946        0.0     0.0       0.0   0.1842
    Deep Clustering     0.959        0.0     0.0       0.0   0.7407
Ensemble (majority)     0.988        0.0     0.0       0.0   0.8018
2025-12-09 23:31:18 - utils - INFO - Ensemble predictions saved
2025-12-09 23:31:18 - utils - INFO - Generating alerts...
2025-12-09 23:31:18 - utils - INFO - No anomalies detected above threshold. Returning empty alerts DataFrame.
2025-12-09 23:31:18 - utils - INFO - Alerts saved to /Users/bipinrimal/Downloads/Thesis_work/results/alerts.csv
2025-12-09 23:31:18 - utils - INFO - Ensemble pipeline completed!
2025-12-09 23:31:18 - utils - INFO - Testing ensemble method: cascade
2025-12-09 23:31:18 - utils - INFO - Initialized Ensemble Detector with method: cascade
2025-12-09 23:31:18 - utils - INFO - 
================================================================================
                            ENSEMBLE SYSTEM PIPELINE                            
================================================================================

2025-12-09 23:31:18 - utils - INFO - Loading predictions from individual models...
2025-12-09 23:31:18 - utils - INFO - Loaded isolation_forest predictions: 1000 samples
2025-12-09 23:31:18 - utils - INFO - Loaded lstm_autoencoder predictions: 32531 samples
2025-12-09 23:31:18 - utils - INFO - Loaded deep_clustering predictions: 1000 samples
2025-12-09 23:31:18 - utils - WARNING - Models have different sample counts: {'isolation_forest': 1000, 'lstm_autoencoder': 32531, 'deep_clustering': 1000}
2025-12-09 23:31:18 - utils - INFO - Will use aggregation strategy to align predictions...
2025-12-09 23:31:18 - utils - INFO - Aligning predictions across models...
2025-12-09 23:31:18 - utils - INFO - Using isolation_forest as reference (1000 samples)
2025-12-09 23:31:18 - utils - INFO - Aggregating lstm_autoencoder from 32531 to 1000 samples
2025-12-09 23:31:18 - utils - INFO - Predictions aligned successfully
2025-12-09 23:31:18 - utils - INFO - Loaded predictions from 3 models
2025-12-09 23:31:18 - utils - INFO - Computing cascade ensemble...
2025-12-09 23:31:18 - utils - INFO - Cascade ensemble: 0 anomalies detected
2025-12-09 23:31:18 - utils - INFO - Evaluating ensemble performance...
2025-12-09 23:31:18 - utils - INFO - 
============================================================
2025-12-09 23:31:18 - utils - INFO - Ensemble (cascade) Performance Metrics
2025-12-09 23:31:18 - utils - INFO - ============================================================
2025-12-09 23:31:18 - utils - INFO - Accuracy:  0.9990
2025-12-09 23:31:18 - utils - INFO - Precision: 0.0000
2025-12-09 23:31:18 - utils - INFO - Recall:    0.0000
2025-12-09 23:31:18 - utils - INFO - F1-Score:  0.0000
2025-12-09 23:31:18 - utils - INFO - AUC-ROC:   0.7067
2025-12-09 23:31:18 - utils - INFO - ============================================================

2025-12-09 23:31:18 - utils - INFO - Comparing ensemble with individual models...
2025-12-09 23:31:18 - utils - INFO - Evaluating ensemble performance...
2025-12-09 23:31:18 - utils - INFO - 
============================================================
2025-12-09 23:31:18 - utils - INFO - Ensemble (cascade) Performance Metrics
2025-12-09 23:31:18 - utils - INFO - ============================================================
2025-12-09 23:31:18 - utils - INFO - Accuracy:  0.9990
2025-12-09 23:31:18 - utils - INFO - Precision: 0.0000
2025-12-09 23:31:18 - utils - INFO - Recall:    0.0000
2025-12-09 23:31:18 - utils - INFO - F1-Score:  0.0000
2025-12-09 23:31:18 - utils - INFO - AUC-ROC:   0.7067
2025-12-09 23:31:18 - utils - INFO - ============================================================

2025-12-09 23:31:18 - utils - INFO - 
Comparison Results:
2025-12-09 23:31:18 - utils - INFO - 
             model  accuracy  precision  recall  f1_score  auc_roc
  Isolation Forest     0.945        0.0     0.0       0.0   0.8208
  Lstm Autoencoder     0.946        0.0     0.0       0.0   0.1842
   Deep Clustering     0.959        0.0     0.0       0.0   0.7407
Ensemble (cascade)     0.999        0.0     0.0       0.0   0.7067
2025-12-09 23:31:18 - utils - INFO - Ensemble predictions saved
2025-12-09 23:31:18 - utils - INFO - Generating alerts...
2025-12-09 23:31:18 - utils - INFO - Generated 35 alerts
2025-12-09 23:31:18 - utils - INFO - Severity distribution:
severity
low         22
high         5
medium       5
critical     3
Name: count, dtype: int64
2025-12-09 23:31:18 - utils - INFO - Alerts saved to /Users/bipinrimal/Downloads/Thesis_work/results/alerts.csv
2025-12-09 23:31:18 - utils - INFO - Ensemble pipeline completed!
2025-12-09 23:31:18 - utils - INFO - 
✓ Stage 5 completed. Best performing method: None
2025-12-09 23:31:18 - utils - INFO - 
================================================================================
                             STAGE 6: VISUALIZATION                             
================================================================================

2025-12-09 23:31:18 - utils - INFO - 
================================================================================
                           GENERATING VISUALIZATIONS                            
================================================================================

2025-12-09 23:31:18 - utils - INFO - Creating alert severity distribution plot...
2025-12-09 23:31:18 - utils - INFO - Alert severity distribution plot saved
2025-12-09 23:31:18 - utils - INFO - Creating model agreement plot...
2025-12-09 23:31:18 - utils - INFO - Model agreement plot saved
2025-12-09 23:31:18 - utils - INFO - Creating anomaly score timeline for ensemble_weighted...
2025-12-09 23:31:18 - utils - INFO - Anomaly score timeline saved for ensemble_weighted
2025-12-09 23:31:18 - utils - INFO - Creating feature importance visualization...
2025-12-09 23:31:18 - utils - INFO - Feature importance heatmap saved
2025-12-09 23:31:18 - utils - INFO - Creating executive summary chart...
2025-12-09 23:31:18 - utils - INFO - Executive summary chart saved
2025-12-09 23:31:18 - utils - INFO - All visualizations saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations
2025-12-09 23:31:18 - utils - INFO - Visualization generation completed!
2025-12-09 23:31:18 - utils - INFO - ✓ Stage 6 completed: All visualizations generated
2025-12-09 23:31:18 - utils - INFO - 
================================================================================
2025-12-09 23:31:18 - utils - INFO - FINAL SUMMARY
2025-12-09 23:31:18 - utils - INFO - ================================================================================
2025-12-09 23:31:18 - utils - INFO - 
Model Performance (on labeled validation set):
2025-12-09 23:31:18 - utils - INFO - 
Isolation Forest:
2025-12-09 23:31:18 - utils - WARNING -   No metrics available (unsupervised execution).
2025-12-09 23:31:18 - utils - INFO - 
Deep Clustering:
2025-12-09 23:31:18 - utils - WARNING -   No metrics available (unsupervised execution).
2025-12-09 23:31:18 - utils - INFO - 
Generated Output Locations:
2025-12-09 23:31:18 - utils - INFO -   - Processed Data: /Users/bipinrimal/Downloads/Thesis_work/data/processed
2025-12-09 23:31:18 - utils - INFO -   - Trained Models: /Users/bipinrimal/Downloads/Thesis_work/models
2025-12-09 23:31:18 - utils - INFO -   - Alert Logs:     /Users/bipinrimal/Downloads/Thesis_work/results/alerts.csv
2025-12-09 23:31:18 - utils - INFO -   - Logs:           /Users/bipinrimal/Downloads/Thesis_work/logs/insider_threat_detection.log
2025-12-09 23:31:18 - utils - INFO - 
================================================================================
2025-12-09 23:31:18 - utils - INFO - ✓ PIPELINE EXECUTION COMPLETED
2025-12-09 23:31:18 - utils - INFO - ================================================================================

2025-12-09 23:34:22 - utils - INFO - Utility functions loaded successfully
2025-12-09 23:34:26 - utils - INFO - ================================================================================
2025-12-09 23:34:26 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-12-09 23:34:26 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-12-09 23:34:26 - utils - INFO - ================================================================================
2025-12-09 23:34:26 - utils - INFO - 
================================================================================
2025-12-09 23:34:26 - utils - INFO - STARTING FULL PIPELINE EXECUTION
2025-12-09 23:34:26 - utils - INFO - ================================================================================

2025-12-09 23:34:26 - utils - INFO - 
================================================================================
                          STAGE 1: DATA PREPROCESSING                           
================================================================================

2025-12-09 23:34:26 - utils - INFO - Processing SUBSET defined in config: ['r1', 'r2', 'r3.1', 'r3.2', 'r4.1', 'r4.2']
2025-12-09 23:34:26 - utils - INFO - 
================================================================================
                          DATA PREPROCESSING (POLARS)                           
================================================================================

2025-12-09 23:34:26 - utils - INFO - Scanning dataset: r1
2025-12-09 23:34:26 - utils - INFO - Scanning dataset: r2
2025-12-09 23:34:26 - utils - INFO - Scanning dataset: r3.1
2025-12-09 23:34:26 - utils - INFO - Scanning dataset: r3.2
2025-12-09 23:34:26 - utils - INFO - Scanning dataset: r4.1
2025-12-09 23:34:26 - utils - INFO - Scanning dataset: r4.2
2025-12-09 23:34:26 - utils - INFO - Constructing execution graph (Diagonal Concat)...
2025-12-09 23:34:26 - utils - INFO - Loaded Psychometric data: 4998 users
2025-12-09 23:34:26 - utils - INFO - Streaming merged data to /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv...
2025-12-09 23:38:13 - utils - INFO - ✓ Preprocessing complete.
2025-12-09 23:38:13 - utils - INFO - ✓ Stage 1 completed successfully.
2025-12-09 23:38:13 - utils - INFO - 
================================================================================
                          STAGE 2: FEATURE ENGINEERING                          
================================================================================

2025-12-09 23:38:13 - utils - INFO - Starting Feature Engineering Pipeline (Polars Lazy Execution)...
2025-12-09 23:38:13 - utils - INFO - Scanning data from /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv
2025-12-09 23:38:13 - utils - INFO - Constructing execution graph for daily features...
2025-12-09 23:38:13 - utils - INFO - Executing aggregation (Streaming Mode)...
2025-12-09 23:40:39 - utils - INFO - Saved features to: /Users/bipinrimal/Downloads/Thesis_work/data/processed/daily_features.parquet
2025-12-09 23:40:39 - utils - INFO - Creating static features and fitting scaler...
2025-12-09 23:40:39 - utils - INFO - Generated static features for 8998 users
2025-12-09 23:40:39 - utils - INFO - Saved features to: /Users/bipinrimal/Downloads/Thesis_work/data/processed/static_features.csv
2025-12-09 23:40:39 - utils - INFO - Saved static scaler to /Users/bipinrimal/Downloads/Thesis_work/models/static_scaler.pkl
2025-12-09 23:40:39 - utils - INFO - Creating sequences...
2025-12-09 23:40:39 - utils - INFO - Saved features to: /Users/bipinrimal/Downloads/Thesis_work/data/processed/sequence_features.parquet
2025-12-09 23:40:39 - utils - INFO - Processing sequences with length 15...
2025-12-09 23:40:41 - utils - INFO - Generated sequences shape: (2858935, 15, 13)
2025-12-09 23:40:41 - utils - INFO - Generated labels shape: (2858935,)
2025-12-09 23:40:44 - utils - INFO - Saved sequences to /Users/bipinrimal/Downloads/Thesis_work/data/processed/sequences.npy
2025-12-09 23:40:44 - utils - INFO - Saved sequence labels to /Users/bipinrimal/Downloads/Thesis_work/data/processed/sequence_labels.npy
2025-12-09 23:40:44 - utils - INFO - Feature engineering pipeline completed successfully.
2025-12-09 23:40:44 - utils - INFO - ✓ Stage 2 completed: Feature files generated.
2025-12-09 23:40:44 - utils - INFO - 
================================================================================
                            STAGE 3: MODEL TRAINING                             
================================================================================

2025-12-09 23:40:44 - utils - INFO - 
>>> Training Isolation Forest...
2025-12-09 23:40:44 - utils - INFO - 
================================================================================
                 ISOLATION FOREST TRAINING (V2: MULTI-DATASET)                  
================================================================================

2025-12-09 23:40:44 - utils - INFO - Loading static features from: static_features.csv
2025-12-09 23:40:44 - utils - ERROR - Failed to load 'static_scaler.pkl'. Run feature_engineering.py first. Error: STACK_GLOBAL requires str
2025-12-09 23:40:44 - utils - INFO - ✓ Isolation Forest training completed
2025-12-09 23:40:44 - utils - INFO - 
>>> Training LSTM Autoencoder...
2025-12-09 23:40:44 - utils - INFO - 
================================================================================
                           LSTM AUTOENCODER TRAINING                            
================================================================================

2025-12-09 23:40:45 - utils - INFO - Loaded sequences: (2858935, 15, 13)
2025-12-09 23:40:48 - utils - INFO - Training on 2001254 normal sequences
2025-12-09 23:40:48 - utils - INFO - Model: "functional"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┓
┃ Layer (type)                         ┃ Output Shape                ┃         Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━┩
│ input_layer (InputLayer)             │ (None, 15, 13)              │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ lstm (LSTM)                          │ (None, 15, 32)              │           5,888 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout (Dropout)                    │ (None, 15, 32)              │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ lstm_1 (LSTM)                        │ (None, 16)                  │           3,136 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ repeat_vector (RepeatVector)         │ (None, 15, 16)              │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ lstm_2 (LSTM)                        │ (None, 15, 16)              │           2,112 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout_1 (Dropout)                  │ (None, 15, 16)              │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ lstm_3 (LSTM)                        │ (None, 15, 32)              │           6,272 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ time_distributed (TimeDistributed)   │ (None, 15, 13)              │             429 │
└──────────────────────────────────────┴─────────────────────────────┴─────────────────┘
 Total params: 17,837 (69.68 KB)
 Trainable params: 17,837 (69.68 KB)
 Non-trainable params: 0 (0.00 B)

2025-12-09 23:59:48 - utils - INFO - Utility functions loaded successfully
2025-12-09 23:59:52 - utils - INFO - ================================================================================
2025-12-09 23:59:52 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-12-09 23:59:52 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-12-09 23:59:52 - utils - INFO - ================================================================================
2025-12-09 23:59:52 - utils - INFO - 
================================================================================
2025-12-09 23:59:52 - utils - INFO - STARTING FULL PIPELINE EXECUTION
2025-12-09 23:59:52 - utils - INFO - ================================================================================

2025-12-09 23:59:52 - utils - INFO - 
================================================================================
                          STAGE 1: DATA PREPROCESSING                           
================================================================================

2025-12-09 23:59:52 - utils - INFO - Processing SUBSET defined in config: ['r1', 'r2', 'r3.1', 'r3.2', 'r4.1', 'r4.2']
2025-12-09 23:59:52 - utils - INFO - 
================================================================================
                          DATA PREPROCESSING (POLARS)                           
================================================================================

2025-12-09 23:59:52 - utils - INFO - Scanning dataset: r1
2025-12-09 23:59:52 - utils - INFO - Scanning dataset: r2
2025-12-09 23:59:52 - utils - INFO - Scanning dataset: r3.1
2025-12-09 23:59:52 - utils - INFO - Scanning dataset: r3.2
2025-12-09 23:59:52 - utils - INFO - Scanning dataset: r4.1
2025-12-09 23:59:52 - utils - INFO - Scanning dataset: r4.2
2025-12-09 23:59:52 - utils - INFO - Constructing execution graph (Diagonal Concat)...
2025-12-09 23:59:52 - utils - INFO - Loaded Psychometric data: 4998 users
2025-12-09 23:59:52 - utils - INFO - Streaming merged data to /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv...
2025-12-10 00:03:31 - utils - INFO - ✓ Preprocessing complete.
2025-12-10 00:03:31 - utils - INFO - ✓ Stage 1 completed successfully.
2025-12-10 00:03:31 - utils - INFO - 
================================================================================
                          STAGE 2: FEATURE ENGINEERING                          
================================================================================

2025-12-10 00:03:31 - utils - INFO - Starting Feature Engineering Pipeline (Polars Lazy Execution)...
2025-12-10 00:03:31 - utils - INFO - Scanning data from /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv
2025-12-10 00:03:31 - utils - INFO - Constructing execution graph for daily features...
2025-12-10 00:03:31 - utils - INFO - Executing aggregation (Streaming Mode)...
2025-12-10 00:05:59 - utils - INFO - Saved features to: /Users/bipinrimal/Downloads/Thesis_work/data/processed/daily_features.parquet
2025-12-10 00:05:59 - utils - INFO - Creating static features and fitting scaler...
2025-12-10 00:05:59 - utils - INFO - Generated static features for 8998 users
2025-12-10 00:05:59 - utils - INFO - Saved features to: /Users/bipinrimal/Downloads/Thesis_work/data/processed/static_features.csv
2025-12-10 00:05:59 - utils - INFO - Saved static scaler to /Users/bipinrimal/Downloads/Thesis_work/models/static_scaler.pkl
2025-12-10 00:05:59 - utils - INFO - Creating sequences...
2025-12-10 00:05:59 - utils - INFO - Saved features to: /Users/bipinrimal/Downloads/Thesis_work/data/processed/sequence_features.parquet
2025-12-10 00:05:59 - utils - INFO - Processing sequences with length 15...
2025-12-10 00:06:01 - utils - INFO - Generated sequences shape: (2858935, 15, 13)
2025-12-10 00:06:01 - utils - INFO - Generated labels shape: (2858935,)
2025-12-10 00:06:04 - utils - INFO - Saved sequences to /Users/bipinrimal/Downloads/Thesis_work/data/processed/sequences.npy
2025-12-10 00:06:04 - utils - INFO - Saved sequence labels to /Users/bipinrimal/Downloads/Thesis_work/data/processed/sequence_labels.npy
2025-12-10 00:06:04 - utils - INFO - Feature engineering pipeline completed successfully.
2025-12-10 00:06:04 - utils - INFO - ✓ Stage 2 completed: Feature files generated.
2025-12-10 00:06:04 - utils - INFO - 
================================================================================
                            STAGE 3: MODEL TRAINING                             
================================================================================

2025-12-10 00:06:04 - utils - INFO - 
>>> Training Isolation Forest...
2025-12-10 00:06:04 - utils - INFO - 
================================================================================
                 ISOLATION FOREST TRAINING (V2: MULTI-DATASET)                  
================================================================================

2025-12-10 00:06:04 - utils - INFO - Loading static features from: static_features.csv
2025-12-10 00:06:04 - utils - ERROR - Failed to load 'static_scaler.pkl'. Run feature_engineering.py first. Error: STACK_GLOBAL requires str
2025-12-10 00:06:04 - utils - INFO - ✓ Isolation Forest training completed
2025-12-10 00:06:04 - utils - INFO - 
>>> Training LSTM Autoencoder...
2025-12-10 00:06:04 - utils - INFO - 
================================================================================
                           LSTM AUTOENCODER TRAINING                            
================================================================================

2025-12-10 00:06:05 - utils - INFO - Loaded sequences: (2858935, 15, 13)
2025-12-10 00:06:09 - utils - INFO - Training on 2001254 normal sequences
2025-12-10 00:06:09 - utils - INFO - Model: "functional"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┓
┃ Layer (type)                         ┃ Output Shape                ┃         Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━┩
│ input_layer (InputLayer)             │ (None, 15, 13)              │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ lstm (LSTM)                          │ (None, 15, 32)              │           5,888 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout (Dropout)                    │ (None, 15, 32)              │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ lstm_1 (LSTM)                        │ (None, 16)                  │           3,136 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ repeat_vector (RepeatVector)         │ (None, 15, 16)              │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ lstm_2 (LSTM)                        │ (None, 15, 16)              │           2,112 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout_1 (Dropout)                  │ (None, 15, 16)              │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ lstm_3 (LSTM)                        │ (None, 15, 32)              │           6,272 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ time_distributed (TimeDistributed)   │ (None, 15, 13)              │             429 │
└──────────────────────────────────────┴─────────────────────────────┴─────────────────┘
 Total params: 17,837 (69.68 KB)
 Trainable params: 17,837 (69.68 KB)
 Non-trainable params: 0 (0.00 B)

2025-12-10 00:16:24 - utils - INFO - Utility functions loaded successfully
2025-12-10 00:16:28 - utils - INFO - ================================================================================
2025-12-10 00:16:28 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-12-10 00:16:28 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-12-10 00:16:28 - utils - INFO - ================================================================================
2025-12-10 00:16:28 - utils - INFO - 
================================================================================
2025-12-10 00:16:28 - utils - INFO - STARTING FULL PIPELINE EXECUTION
2025-12-10 00:16:28 - utils - INFO - ================================================================================

2025-12-10 00:16:28 - utils - INFO - 
================================================================================
                          STAGE 1: DATA PREPROCESSING                           
================================================================================

2025-12-10 00:16:28 - utils - INFO - Processing SUBSET defined in config: ['r1', 'r2', 'r3.1', 'r3.2']
2025-12-10 00:16:28 - utils - INFO - 
================================================================================
                          DATA PREPROCESSING (POLARS)                           
================================================================================

2025-12-10 00:16:28 - utils - INFO - Scanning dataset: r1
2025-12-10 00:16:28 - utils - INFO - Scanning dataset: r2
2025-12-10 00:16:28 - utils - INFO - Scanning dataset: r3.1
2025-12-10 00:16:28 - utils - INFO - Scanning dataset: r3.2
2025-12-10 00:16:28 - utils - INFO - Constructing execution graph (Diagonal Concat)...
2025-12-10 00:16:28 - utils - INFO - Loaded Psychometric data: 2999 users
2025-12-10 00:16:28 - utils - INFO - Streaming merged data to /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv...
2025-12-10 00:17:45 - utils - INFO - ✓ Preprocessing complete.
2025-12-10 00:17:45 - utils - INFO - ✓ Stage 1 completed successfully.
2025-12-10 00:17:45 - utils - INFO - 
================================================================================
                          STAGE 2: FEATURE ENGINEERING                          
================================================================================

2025-12-10 00:17:45 - utils - INFO - Starting Feature Engineering Pipeline (Polars Lazy Execution)...
2025-12-10 00:17:45 - utils - INFO - Scanning data from /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv
2025-12-10 00:17:45 - utils - INFO - Constructing execution graph for daily features...
2025-12-10 00:17:45 - utils - INFO - Executing aggregation (Streaming Mode)...
2025-12-10 00:18:45 - utils - INFO - Saved features to: /Users/bipinrimal/Downloads/Thesis_work/data/processed/daily_features.parquet
2025-12-10 00:18:45 - utils - INFO - Creating static features and fitting scaler...
2025-12-10 00:18:45 - utils - INFO - Generated static features for 6999 users
2025-12-10 00:18:45 - utils - INFO - Saved features to: /Users/bipinrimal/Downloads/Thesis_work/data/processed/static_features.csv
2025-12-10 00:18:45 - utils - INFO - Saved static scaler to /Users/bipinrimal/Downloads/Thesis_work/models/static_scaler.pkl
2025-12-10 00:18:45 - utils - INFO - Creating sequences...
2025-12-10 00:18:45 - utils - INFO - Saved features to: /Users/bipinrimal/Downloads/Thesis_work/data/processed/sequence_features.parquet
2025-12-10 00:18:45 - utils - INFO - Processing sequences with length 15...
2025-12-10 00:18:47 - utils - INFO - Generated sequences shape: (2214108, 15, 13)
2025-12-10 00:18:47 - utils - INFO - Generated labels shape: (2214108,)
2025-12-10 00:18:53 - utils - INFO - Saved sequences to /Users/bipinrimal/Downloads/Thesis_work/data/processed/sequences.npy
2025-12-10 00:18:53 - utils - INFO - Saved sequence labels to /Users/bipinrimal/Downloads/Thesis_work/data/processed/sequence_labels.npy
2025-12-10 00:18:53 - utils - INFO - Feature engineering pipeline completed successfully.
2025-12-10 00:18:53 - utils - INFO - ✓ Stage 2 completed: Feature files generated.
2025-12-10 00:18:53 - utils - INFO - 
================================================================================
                            STAGE 3: MODEL TRAINING                             
================================================================================

2025-12-10 00:18:53 - utils - INFO - 
>>> Training Isolation Forest...
2025-12-10 00:18:53 - utils - INFO - 
================================================================================
                 ISOLATION FOREST TRAINING (V2: MULTI-DATASET)                  
================================================================================

2025-12-10 00:18:53 - utils - INFO - Loading static features from: static_features.csv
2025-12-10 00:18:53 - utils - ERROR - Failed to load 'static_scaler.pkl'. Run feature_engineering.py first. Error: STACK_GLOBAL requires str
2025-12-10 00:18:53 - utils - INFO - ✓ Isolation Forest training completed
2025-12-10 00:18:53 - utils - INFO - 
>>> Training LSTM Autoencoder...
2025-12-10 00:18:53 - utils - INFO - 
================================================================================
                           LSTM AUTOENCODER TRAINING                            
================================================================================

2025-12-10 00:18:54 - utils - INFO - Loaded sequences: (2214108, 15, 13)
2025-12-10 00:18:56 - utils - INFO - Training on 1549875 normal sequences
2025-12-10 00:18:56 - utils - INFO - Model: "functional"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┓
┃ Layer (type)                         ┃ Output Shape                ┃         Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━┩
│ input_layer (InputLayer)             │ (None, 15, 13)              │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ lstm (LSTM)                          │ (None, 15, 32)              │           5,888 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout (Dropout)                    │ (None, 15, 32)              │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ lstm_1 (LSTM)                        │ (None, 16)                  │           3,136 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ repeat_vector (RepeatVector)         │ (None, 15, 16)              │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ lstm_2 (LSTM)                        │ (None, 15, 16)              │           2,112 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout_1 (Dropout)                  │ (None, 15, 16)              │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ lstm_3 (LSTM)                        │ (None, 15, 32)              │           6,272 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ time_distributed (TimeDistributed)   │ (None, 15, 13)              │             429 │
└──────────────────────────────────────┴─────────────────────────────┴─────────────────┘
 Total params: 17,837 (69.68 KB)
 Trainable params: 17,837 (69.68 KB)
 Non-trainable params: 0 (0.00 B)

2025-12-10 00:24:40 - utils - INFO - Utility functions loaded successfully
2025-12-10 00:24:43 - utils - INFO - ================================================================================
2025-12-10 00:24:43 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-12-10 00:24:43 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-12-10 00:24:43 - utils - INFO - ================================================================================
2025-12-10 00:24:43 - utils - INFO - 
================================================================================
2025-12-10 00:24:43 - utils - INFO - STARTING FULL PIPELINE EXECUTION
2025-12-10 00:24:43 - utils - INFO - ================================================================================

2025-12-10 00:24:43 - utils - INFO - 
================================================================================
                          STAGE 1: DATA PREPROCESSING                           
================================================================================

2025-12-10 00:24:43 - utils - INFO - Processing SUBSET defined in config: ['r1']
2025-12-10 00:24:43 - utils - INFO - 
================================================================================
                          DATA PREPROCESSING (POLARS)                           
================================================================================

2025-12-10 00:24:43 - utils - INFO - Scanning dataset: r1
2025-12-10 00:24:43 - utils - INFO - Constructing execution graph (Diagonal Concat)...
2025-12-10 00:24:43 - utils - INFO - Streaming merged data to /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv...
2025-12-10 00:24:45 - utils - INFO - ✓ Preprocessing complete.
2025-12-10 00:24:45 - utils - INFO - ✓ Stage 1 completed successfully.
2025-12-10 00:24:45 - utils - INFO - 
================================================================================
                          STAGE 2: FEATURE ENGINEERING                          
================================================================================

2025-12-10 00:24:45 - utils - INFO - Starting Feature Engineering Pipeline (Polars Lazy Execution)...
2025-12-10 00:24:45 - utils - INFO - Scanning data from /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv
2025-12-10 00:24:45 - utils - INFO - Constructing execution graph for daily features...
2025-12-10 00:24:45 - utils - INFO - Executing aggregation (Streaming Mode)...
2025-12-10 00:24:46 - utils - INFO - Saved features to: /Users/bipinrimal/Downloads/Thesis_work/data/processed/daily_features.parquet
2025-12-10 00:24:46 - utils - INFO - Creating static features and fitting scaler...
2025-12-10 00:24:46 - utils - INFO - Generated static features for 1000 users
2025-12-10 00:24:46 - utils - INFO - Saved features to: /Users/bipinrimal/Downloads/Thesis_work/data/processed/static_features.csv
2025-12-10 00:24:46 - utils - INFO - Saved static scaler to /Users/bipinrimal/Downloads/Thesis_work/models/static_scaler.pkl
2025-12-10 00:24:46 - utils - INFO - Creating sequences...
2025-12-10 00:24:46 - utils - INFO - Saved features to: /Users/bipinrimal/Downloads/Thesis_work/data/processed/sequence_features.parquet
2025-12-10 00:24:46 - utils - INFO - Processing sequences with length 15...
2025-12-10 00:24:46 - utils - INFO - Generated sequences shape: (320915, 15, 13)
2025-12-10 00:24:46 - utils - INFO - Generated labels shape: (320915,)
2025-12-10 00:24:46 - utils - INFO - Saved sequences to /Users/bipinrimal/Downloads/Thesis_work/data/processed/sequences.npy
2025-12-10 00:24:46 - utils - INFO - Saved sequence labels to /Users/bipinrimal/Downloads/Thesis_work/data/processed/sequence_labels.npy
2025-12-10 00:24:46 - utils - INFO - Feature engineering pipeline completed successfully.
2025-12-10 00:24:46 - utils - INFO - ✓ Stage 2 completed: Feature files generated.
2025-12-10 00:24:46 - utils - INFO - 
================================================================================
                            STAGE 3: MODEL TRAINING                             
================================================================================

2025-12-10 00:24:46 - utils - INFO - 
>>> Training Isolation Forest...
2025-12-10 00:24:46 - utils - INFO - 
================================================================================
                 ISOLATION FOREST TRAINING (V2: MULTI-DATASET)                  
================================================================================

2025-12-10 00:24:46 - utils - INFO - Loading static features from: static_features.csv
2025-12-10 00:24:46 - utils - ERROR - Failed to load 'static_scaler.pkl'. Run feature_engineering.py first. Error: STACK_GLOBAL requires str
2025-12-10 00:24:46 - utils - INFO - ✓ Isolation Forest training completed
2025-12-10 00:24:46 - utils - INFO - 
>>> Training LSTM Autoencoder...
2025-12-10 00:24:46 - utils - INFO - 
================================================================================
                           LSTM AUTOENCODER TRAINING                            
================================================================================

2025-12-10 00:24:46 - utils - INFO - Loaded sequences: (320915, 15, 13)
2025-12-10 00:24:46 - utils - INFO - Training on 224640 normal sequences
2025-12-10 00:24:46 - utils - INFO - Model: "functional"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┓
┃ Layer (type)                         ┃ Output Shape                ┃         Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━┩
│ input_layer (InputLayer)             │ (None, 15, 13)              │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ lstm (LSTM)                          │ (None, 15, 32)              │           5,888 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout (Dropout)                    │ (None, 15, 32)              │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ lstm_1 (LSTM)                        │ (None, 16)                  │           3,136 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ repeat_vector (RepeatVector)         │ (None, 15, 16)              │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ lstm_2 (LSTM)                        │ (None, 15, 16)              │           2,112 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout_1 (Dropout)                  │ (None, 15, 16)              │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ lstm_3 (LSTM)                        │ (None, 15, 32)              │           6,272 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ time_distributed (TimeDistributed)   │ (None, 15, 13)              │             429 │
└──────────────────────────────────────┴─────────────────────────────┴─────────────────┘
 Total params: 17,837 (69.68 KB)
 Trainable params: 17,837 (69.68 KB)
 Non-trainable params: 0 (0.00 B)

2025-12-10 00:29:33 - utils - INFO - Utility functions loaded successfully
2025-12-10 00:29:36 - utils - INFO - ================================================================================
2025-12-10 00:29:36 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-12-10 00:29:36 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-12-10 00:29:36 - utils - INFO - ================================================================================
2025-12-10 00:29:36 - utils - INFO - 
================================================================================
2025-12-10 00:29:36 - utils - INFO - STARTING FULL PIPELINE EXECUTION
2025-12-10 00:29:36 - utils - INFO - ================================================================================

2025-12-10 00:29:36 - utils - INFO - 
================================================================================
                          STAGE 1: DATA PREPROCESSING                           
================================================================================

2025-12-10 00:29:36 - utils - INFO - Processing SUBSET defined in config: ['r1']
2025-12-10 00:29:36 - utils - INFO - 
================================================================================
                          DATA PREPROCESSING (POLARS)                           
================================================================================

2025-12-10 00:29:36 - utils - INFO - Scanning dataset: r1
2025-12-10 00:29:36 - utils - INFO - Constructing execution graph (Diagonal Concat)...
2025-12-10 00:29:36 - utils - INFO - Streaming merged data to /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv...
2025-12-10 00:29:36 - utils - INFO - ✓ Preprocessing complete.
2025-12-10 00:29:36 - utils - INFO - ✓ Stage 1 completed successfully.
2025-12-10 00:29:36 - utils - INFO - 
================================================================================
                          STAGE 2: FEATURE ENGINEERING                          
================================================================================

2025-12-10 00:29:36 - utils - INFO - Starting Feature Engineering Pipeline (Polars Lazy Execution)...
2025-12-10 00:29:36 - utils - INFO - Scanning data from /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv
2025-12-10 00:29:36 - utils - INFO - Constructing execution graph for daily features...
2025-12-10 00:29:36 - utils - INFO - Executing aggregation (Streaming Mode)...
2025-12-10 00:29:36 - utils - INFO - Saved features to: /Users/bipinrimal/Downloads/Thesis_work/data/processed/daily_features.parquet
2025-12-10 00:29:36 - utils - INFO - Creating static features and fitting scaler...
2025-12-10 00:29:36 - utils - INFO - Generated static features for 1000 users
2025-12-10 00:29:36 - utils - INFO - Saved features to: /Users/bipinrimal/Downloads/Thesis_work/data/processed/static_features.csv
2025-12-10 00:29:36 - utils - INFO - Saved static scaler to /Users/bipinrimal/Downloads/Thesis_work/models/static_scaler.pkl
2025-12-10 00:29:36 - utils - INFO - Creating sequences...
2025-12-10 00:29:36 - utils - INFO - Saved features to: /Users/bipinrimal/Downloads/Thesis_work/data/processed/sequence_features.parquet
2025-12-10 00:29:36 - utils - INFO - Processing sequences with length 15...
2025-12-10 00:29:37 - utils - INFO - Generated sequences shape: (320915, 15, 13)
2025-12-10 00:29:37 - utils - INFO - Generated labels shape: (320915,)
2025-12-10 00:29:37 - utils - INFO - Saved sequences to /Users/bipinrimal/Downloads/Thesis_work/data/processed/sequences.npy
2025-12-10 00:29:37 - utils - INFO - Saved sequence labels to /Users/bipinrimal/Downloads/Thesis_work/data/processed/sequence_labels.npy
2025-12-10 00:29:37 - utils - INFO - Feature engineering pipeline completed successfully.
2025-12-10 00:29:37 - utils - INFO - ✓ Stage 2 completed: Feature files generated.
2025-12-10 00:29:37 - utils - INFO - 
================================================================================
                            STAGE 3: MODEL TRAINING                             
================================================================================

2025-12-10 00:29:37 - utils - INFO - 
>>> Training Isolation Forest...
2025-12-10 00:29:37 - utils - INFO - 
================================================================================
                 ISOLATION FOREST TRAINING (V2: MULTI-DATASET)                  
================================================================================

2025-12-10 00:29:41 - utils - INFO - Loaded daily features: (334905, 16)
2025-12-10 00:29:41 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest_model.pkl
2025-12-10 00:29:42 - utils - INFO - Predictions saved to /Users/bipinrimal/Downloads/Thesis_work/results/isolation_forest_predictions.csv
2025-12-10 00:29:42 - utils - WARNING - Only one class present in y_true, cannot calculate AUC-ROC
2025-12-10 00:29:42 - utils - INFO - 
============================================================
2025-12-10 00:29:42 - utils - INFO - Isolation Forest Performance Metrics
2025-12-10 00:29:42 - utils - INFO - ============================================================
2025-12-10 00:29:42 - utils - INFO - Accuracy:  0.8168
2025-12-10 00:29:42 - utils - INFO - Precision: 0.0000
2025-12-10 00:29:42 - utils - INFO - Recall:    0.0000
2025-12-10 00:29:42 - utils - INFO - F1-Score:  0.0000
2025-12-10 00:29:42 - utils - INFO - AUC-ROC:   0.0000
2025-12-10 00:29:42 - utils - INFO - ============================================================

2025-12-10 00:29:42 - utils - INFO - ✓ Isolation Forest training completed
2025-12-10 00:29:42 - utils - INFO - 
>>> Training LSTM Autoencoder...
2025-12-10 00:29:42 - utils - INFO - 
================================================================================
                           LSTM AUTOENCODER TRAINING                            
================================================================================

2025-12-10 00:29:42 - utils - INFO - Loaded sequences: (320915, 15, 13)
2025-12-10 00:29:42 - utils - INFO - Training on 224640 normal sequences
2025-12-10 00:29:42 - utils - INFO - Model: "functional"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┓
┃ Layer (type)                         ┃ Output Shape                ┃         Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━┩
│ input_layer (InputLayer)             │ (None, 15, 13)              │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ lstm (LSTM)                          │ (None, 15, 32)              │           5,888 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout (Dropout)                    │ (None, 15, 32)              │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ lstm_1 (LSTM)                        │ (None, 16)                  │           3,136 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ repeat_vector (RepeatVector)         │ (None, 15, 16)              │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ lstm_2 (LSTM)                        │ (None, 15, 16)              │           2,112 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout_1 (Dropout)                  │ (None, 15, 16)              │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ lstm_3 (LSTM)                        │ (None, 15, 32)              │           6,272 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ time_distributed (TimeDistributed)   │ (None, 15, 13)              │             429 │
└──────────────────────────────────────┴─────────────────────────────┴─────────────────┘
 Total params: 17,837 (69.68 KB)
 Trainable params: 17,837 (69.68 KB)
 Non-trainable params: 0 (0.00 B)

2025-12-10 00:33:02 - utils - INFO - Utility functions loaded successfully
2025-12-10 00:33:05 - utils - INFO - ================================================================================
2025-12-10 00:33:05 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-12-10 00:33:05 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-12-10 00:33:05 - utils - INFO - ================================================================================
2025-12-10 00:33:05 - utils - INFO - 
================================================================================
2025-12-10 00:33:05 - utils - INFO - STARTING FULL PIPELINE EXECUTION
2025-12-10 00:33:05 - utils - INFO - ================================================================================

2025-12-10 00:33:05 - utils - INFO - 
================================================================================
                          STAGE 1: DATA PREPROCESSING                           
================================================================================

2025-12-10 00:33:05 - utils - INFO - Processing SUBSET defined in config: ['r1']
2025-12-10 00:33:05 - utils - INFO - 
================================================================================
                          DATA PREPROCESSING (POLARS)                           
================================================================================

2025-12-10 00:33:05 - utils - INFO - Scanning dataset: r1
2025-12-10 00:33:05 - utils - INFO - Constructing execution graph (Diagonal Concat)...
2025-12-10 00:33:05 - utils - INFO - Streaming merged data to /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv...
2025-12-10 00:33:05 - utils - INFO - ✓ Preprocessing complete.
2025-12-10 00:33:05 - utils - INFO - ✓ Stage 1 completed successfully.
2025-12-10 00:33:05 - utils - INFO - 
================================================================================
                          STAGE 2: FEATURE ENGINEERING                          
================================================================================

2025-12-10 00:33:05 - utils - INFO - Starting Feature Engineering Pipeline (Polars Lazy Execution)...
2025-12-10 00:33:05 - utils - INFO - Scanning data from /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv
2025-12-10 00:33:05 - utils - INFO - Constructing execution graph for daily features...
2025-12-10 00:33:05 - utils - INFO - Executing aggregation (Streaming Mode)...
2025-12-10 00:33:05 - utils - INFO - Saved features to: /Users/bipinrimal/Downloads/Thesis_work/data/processed/daily_features.parquet
2025-12-10 00:33:05 - utils - INFO - Creating static features and fitting scaler...
2025-12-10 00:33:05 - utils - INFO - Generated static features for 1000 users
2025-12-10 00:33:05 - utils - INFO - Saved features to: /Users/bipinrimal/Downloads/Thesis_work/data/processed/static_features.csv
2025-12-10 00:33:05 - utils - INFO - Saved static scaler to /Users/bipinrimal/Downloads/Thesis_work/models/static_scaler.pkl
2025-12-10 00:33:05 - utils - INFO - Creating sequences...
2025-12-10 00:33:05 - utils - INFO - Saved features to: /Users/bipinrimal/Downloads/Thesis_work/data/processed/sequence_features.parquet
2025-12-10 00:33:05 - utils - INFO - Processing sequences with length 15...
2025-12-10 00:33:06 - utils - INFO - Generated sequences shape: (320915, 15, 13)
2025-12-10 00:33:06 - utils - INFO - Generated labels shape: (320915,)
2025-12-10 00:33:06 - utils - INFO - Saved sequences to /Users/bipinrimal/Downloads/Thesis_work/data/processed/sequences.npy
2025-12-10 00:33:06 - utils - INFO - Saved sequence labels to /Users/bipinrimal/Downloads/Thesis_work/data/processed/sequence_labels.npy
2025-12-10 00:33:06 - utils - INFO - Feature engineering pipeline completed successfully.
2025-12-10 00:33:06 - utils - INFO - ✓ Stage 2 completed: Feature files generated.
2025-12-10 00:33:06 - utils - INFO - 
================================================================================
                            STAGE 3: MODEL TRAINING                             
================================================================================

2025-12-10 00:33:06 - utils - INFO - 
>>> Training Isolation Forest...
2025-12-10 00:33:06 - utils - INFO - 
================================================================================
                 ISOLATION FOREST TRAINING (V2: MULTI-DATASET)                  
================================================================================

2025-12-10 00:33:06 - utils - INFO - Loaded daily features: (334905, 16)
2025-12-10 00:33:06 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest_model.pkl
2025-12-10 00:33:07 - utils - INFO - Predictions saved to /Users/bipinrimal/Downloads/Thesis_work/results/isolation_forest_predictions.csv
2025-12-10 00:33:07 - utils - WARNING - Only one class present in y_true, cannot calculate AUC-ROC
2025-12-10 00:33:07 - utils - INFO - 
============================================================
2025-12-10 00:33:07 - utils - INFO - Isolation Forest Performance Metrics
2025-12-10 00:33:07 - utils - INFO - ============================================================
2025-12-10 00:33:07 - utils - INFO - Accuracy:  0.8168
2025-12-10 00:33:07 - utils - INFO - Precision: 0.0000
2025-12-10 00:33:07 - utils - INFO - Recall:    0.0000
2025-12-10 00:33:07 - utils - INFO - F1-Score:  0.0000
2025-12-10 00:33:07 - utils - INFO - AUC-ROC:   0.0000
2025-12-10 00:33:07 - utils - INFO - ============================================================

2025-12-10 00:33:07 - utils - INFO - ✓ Isolation Forest training completed
2025-12-10 00:33:07 - utils - INFO - 
>>> Training LSTM Autoencoder...
2025-12-10 00:33:07 - utils - INFO - 
================================================================================
                           LSTM AUTOENCODER TRAINING                            
================================================================================

2025-12-10 00:33:07 - utils - INFO - Loaded sequences: (320915, 15, 13)
2025-12-10 00:33:07 - utils - INFO - Training on 224640 normal sequences
2025-12-10 00:33:07 - utils - INFO - Model: "functional"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┓
┃ Layer (type)                         ┃ Output Shape                ┃         Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━┩
│ input_layer (InputLayer)             │ (None, 15, 13)              │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ lstm (LSTM)                          │ (None, 15, 32)              │           5,888 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout (Dropout)                    │ (None, 15, 32)              │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ lstm_1 (LSTM)                        │ (None, 16)                  │           3,136 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ repeat_vector (RepeatVector)         │ (None, 15, 16)              │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ lstm_2 (LSTM)                        │ (None, 15, 16)              │           2,112 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout_1 (Dropout)                  │ (None, 15, 16)              │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ lstm_3 (LSTM)                        │ (None, 15, 32)              │           6,272 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ time_distributed (TimeDistributed)   │ (None, 15, 13)              │             429 │
└──────────────────────────────────────┴─────────────────────────────┴─────────────────┘
 Total params: 17,837 (69.68 KB)
 Trainable params: 17,837 (69.68 KB)
 Non-trainable params: 0 (0.00 B)

2025-12-10 00:39:56 - utils - INFO - Utility functions loaded successfully
2025-12-10 00:39:59 - utils - INFO - ================================================================================
2025-12-10 00:39:59 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-12-10 00:39:59 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-12-10 00:39:59 - utils - INFO - ================================================================================
2025-12-10 00:39:59 - utils - INFO - 
================================================================================
2025-12-10 00:39:59 - utils - INFO - STARTING FULL PIPELINE EXECUTION
2025-12-10 00:39:59 - utils - INFO - ================================================================================

2025-12-10 00:39:59 - utils - INFO - 
================================================================================
                          STAGE 1: DATA PREPROCESSING                           
================================================================================

2025-12-10 00:39:59 - utils - INFO - Processing SUBSET defined in config: ['r1']
2025-12-10 00:39:59 - utils - INFO - 
================================================================================
                          DATA PREPROCESSING (POLARS)                           
================================================================================

2025-12-10 00:39:59 - utils - INFO - Scanning dataset: r1
2025-12-10 00:39:59 - utils - INFO - Constructing execution graph (Diagonal Concat)...
2025-12-10 00:39:59 - utils - INFO - Streaming merged data to /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv...
2025-12-10 00:39:59 - utils - INFO - ✓ Preprocessing complete.
2025-12-10 00:39:59 - utils - INFO - ✓ Stage 1 completed successfully.
2025-12-10 00:39:59 - utils - INFO - 
================================================================================
                          STAGE 2: FEATURE ENGINEERING                          
================================================================================

2025-12-10 00:39:59 - utils - INFO - Starting Feature Engineering Pipeline (Polars Lazy Execution)...
2025-12-10 00:39:59 - utils - INFO - Scanning data from /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv
2025-12-10 00:39:59 - utils - INFO - Constructing execution graph for daily features...
2025-12-10 00:39:59 - utils - INFO - Executing aggregation (Streaming Mode)...
2025-12-10 00:40:00 - utils - INFO - Saved features to: /Users/bipinrimal/Downloads/Thesis_work/data/processed/daily_features.parquet
2025-12-10 00:40:00 - utils - INFO - Creating static features and fitting scaler...
2025-12-10 00:40:00 - utils - INFO - Generated static features for 1000 users
2025-12-10 00:40:00 - utils - INFO - Saved features to: /Users/bipinrimal/Downloads/Thesis_work/data/processed/static_features.csv
2025-12-10 00:40:00 - utils - INFO - Saved static scaler to /Users/bipinrimal/Downloads/Thesis_work/models/static_scaler.pkl
2025-12-10 00:40:00 - utils - INFO - Creating sequences...
2025-12-10 00:40:00 - utils - INFO - Saved features to: /Users/bipinrimal/Downloads/Thesis_work/data/processed/sequence_features.parquet
2025-12-10 00:40:00 - utils - INFO - Processing sequences with length 15...
2025-12-10 00:40:00 - utils - INFO - Generated sequences shape: (320915, 15, 13)
2025-12-10 00:40:00 - utils - INFO - Generated labels shape: (320915,)
2025-12-10 00:40:00 - utils - INFO - Saved sequences to /Users/bipinrimal/Downloads/Thesis_work/data/processed/sequences.npy
2025-12-10 00:40:00 - utils - INFO - Saved sequence labels to /Users/bipinrimal/Downloads/Thesis_work/data/processed/sequence_labels.npy
2025-12-10 00:40:00 - utils - INFO - Feature engineering pipeline completed successfully.
2025-12-10 00:40:00 - utils - INFO - ✓ Stage 2 completed: Feature files generated.
2025-12-10 00:40:00 - utils - INFO - 
================================================================================
                            STAGE 3: MODEL TRAINING                             
================================================================================

2025-12-10 00:40:00 - utils - INFO - 
>>> Training Isolation Forest...
2025-12-10 00:40:00 - utils - INFO - 
================================================================================
                 ISOLATION FOREST TRAINING (V2: MULTI-DATASET)                  
================================================================================

2025-12-10 00:40:00 - utils - INFO - Loaded daily features: (334905, 16)
2025-12-10 00:40:01 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest_model.pkl
2025-12-10 00:40:01 - utils - INFO - Predictions saved to /Users/bipinrimal/Downloads/Thesis_work/results/isolation_forest_predictions.csv
2025-12-10 00:40:01 - utils - WARNING - Only one class present in y_true, cannot calculate AUC-ROC
2025-12-10 00:40:01 - utils - INFO - 
============================================================
2025-12-10 00:40:01 - utils - INFO - Isolation Forest Performance Metrics
2025-12-10 00:40:01 - utils - INFO - ============================================================
2025-12-10 00:40:01 - utils - INFO - Accuracy:  0.8168
2025-12-10 00:40:01 - utils - INFO - Precision: 0.0000
2025-12-10 00:40:01 - utils - INFO - Recall:    0.0000
2025-12-10 00:40:01 - utils - INFO - F1-Score:  0.0000
2025-12-10 00:40:01 - utils - INFO - AUC-ROC:   0.0000
2025-12-10 00:40:01 - utils - INFO - ============================================================

2025-12-10 00:40:01 - utils - INFO - ✓ Isolation Forest training completed
2025-12-10 00:40:01 - utils - INFO - 
>>> Training LSTM Autoencoder...
2025-12-10 00:40:01 - utils - INFO - 
================================================================================
                           LSTM AUTOENCODER TRAINING                            
================================================================================

2025-12-10 00:40:01 - utils - WARNING - DEBUG MODE: Slicing data from 320915 to 5000 samples.
2025-12-10 00:40:01 - utils - INFO - Loaded sequences: (5000, 15, 13)
2025-12-10 00:40:01 - utils - INFO - Training on 3499 normal sequences
2025-12-10 00:40:01 - utils - INFO - Model: "functional"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┓
┃ Layer (type)                         ┃ Output Shape                ┃         Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━┩
│ input_layer (InputLayer)             │ (None, 15, 13)              │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ lstm (LSTM)                          │ (None, 15, 32)              │           5,888 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout (Dropout)                    │ (None, 15, 32)              │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ lstm_1 (LSTM)                        │ (None, 16)                  │           3,136 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ repeat_vector (RepeatVector)         │ (None, 15, 16)              │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ lstm_2 (LSTM)                        │ (None, 15, 16)              │           2,112 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout_1 (Dropout)                  │ (None, 15, 16)              │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ lstm_3 (LSTM)                        │ (None, 15, 32)              │           6,272 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ time_distributed (TimeDistributed)   │ (None, 15, 13)              │             429 │
└──────────────────────────────────────┴─────────────────────────────┴─────────────────┘
 Total params: 17,837 (69.68 KB)
 Trainable params: 17,837 (69.68 KB)
 Non-trainable params: 0 (0.00 B)

2025-12-10 00:40:01 - utils - INFO - Starting training for 1 epoch(s)...
2025-12-13 01:39:17 - utils - INFO - Utility functions loaded successfully
2025-12-13 01:39:30 - utils - INFO - ================================================================================
2025-12-13 01:39:30 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-12-13 01:39:30 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-12-13 01:39:30 - utils - INFO - ================================================================================
2025-12-13 01:39:30 - utils - INFO - 
================================================================================
2025-12-13 01:39:30 - utils - INFO - STARTING FULL PIPELINE EXECUTION
2025-12-13 01:39:30 - utils - INFO - ================================================================================

2025-12-13 01:39:30 - utils - INFO - 
================================================================================
                          STAGE 1: DATA PREPROCESSING                           
================================================================================

2025-12-13 01:39:30 - utils - INFO - Processing SUBSET defined in config: ['r1']
2025-12-13 01:39:30 - utils - INFO - 
================================================================================
                          DATA PREPROCESSING (POLARS)                           
================================================================================

2025-12-13 01:39:30 - utils - INFO - Scanning dataset: r1
2025-12-13 01:39:30 - utils - INFO - Constructing execution graph (Diagonal Concat)...
2025-12-13 01:39:30 - utils - INFO - Streaming merged data to /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv...
2025-12-13 01:39:31 - utils - INFO - ✓ Preprocessing complete.
2025-12-13 01:39:31 - utils - INFO - ✓ Stage 1 completed successfully.
2025-12-13 01:39:31 - utils - INFO - 
================================================================================
                          STAGE 2: FEATURE ENGINEERING                          
================================================================================

2025-12-13 01:39:31 - utils - INFO - Starting Feature Engineering Pipeline (Polars Lazy Execution)...
2025-12-13 01:39:31 - utils - INFO - Scanning data from /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv
2025-12-13 01:39:31 - utils - INFO - Constructing execution graph for daily features...
2025-12-13 01:39:31 - utils - INFO - Executing aggregation (Streaming Mode)...
2025-12-13 01:39:31 - utils - INFO - Saved features to: /Users/bipinrimal/Downloads/Thesis_work/data/processed/daily_features.parquet
2025-12-13 01:39:31 - utils - INFO - Creating static features and fitting scaler...
2025-12-13 01:39:31 - utils - INFO - Generated static features for 1000 users
2025-12-13 01:39:31 - utils - INFO - Saved features to: /Users/bipinrimal/Downloads/Thesis_work/data/processed/static_features.csv
2025-12-13 01:39:31 - utils - INFO - Saved static scaler to /Users/bipinrimal/Downloads/Thesis_work/models/static_scaler.pkl
2025-12-13 01:39:31 - utils - INFO - Creating sequences...
2025-12-13 01:39:31 - utils - INFO - Saved features to: /Users/bipinrimal/Downloads/Thesis_work/data/processed/sequence_features.parquet
2025-12-13 01:39:31 - utils - INFO - Processing sequences with length 15...
2025-12-13 01:39:32 - utils - INFO - Generated sequences shape: (320915, 15, 13)
2025-12-13 01:39:32 - utils - INFO - Generated labels shape: (320915,)
2025-12-13 01:39:32 - utils - INFO - Saved sequences to /Users/bipinrimal/Downloads/Thesis_work/data/processed/sequences.npy
2025-12-13 01:39:32 - utils - INFO - Saved sequence labels to /Users/bipinrimal/Downloads/Thesis_work/data/processed/sequence_labels.npy
2025-12-13 01:39:32 - utils - INFO - Feature engineering pipeline completed successfully.
2025-12-13 01:39:32 - utils - INFO - ✓ Stage 2 completed: Feature files generated.
2025-12-13 01:39:32 - utils - INFO - 
================================================================================
                            STAGE 3: MODEL TRAINING                             
================================================================================

2025-12-13 01:39:32 - utils - INFO - 
>>> Training Isolation Forest...
2025-12-13 01:39:32 - utils - INFO - 
================================================================================
                 ISOLATION FOREST TRAINING (V2: MULTI-DATASET)                  
================================================================================

2025-12-13 01:39:32 - utils - INFO - Loaded daily features: (334905, 16)
2025-12-13 01:39:33 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest_model.pkl
2025-12-13 01:39:33 - utils - INFO - Predictions saved to /Users/bipinrimal/Downloads/Thesis_work/results/isolation_forest_predictions.csv
2025-12-13 01:39:33 - utils - WARNING - Only one class present in y_true, cannot calculate AUC-ROC
2025-12-13 01:39:33 - utils - INFO - 
============================================================
2025-12-13 01:39:33 - utils - INFO - Isolation Forest Performance Metrics
2025-12-13 01:39:33 - utils - INFO - ============================================================
2025-12-13 01:39:33 - utils - INFO - Accuracy:  0.8168
2025-12-13 01:39:33 - utils - INFO - Precision: 0.0000
2025-12-13 01:39:33 - utils - INFO - Recall:    0.0000
2025-12-13 01:39:33 - utils - INFO - F1-Score:  0.0000
2025-12-13 01:39:33 - utils - INFO - AUC-ROC:   0.0000
2025-12-13 01:39:33 - utils - INFO - ============================================================

2025-12-13 01:39:33 - utils - INFO - ✓ Isolation Forest training completed
2025-12-13 01:39:33 - utils - INFO - 
>>> Training LSTM Autoencoder...
2025-12-13 01:39:33 - utils - INFO - 
================================================================================
                           LSTM AUTOENCODER TRAINING                            
================================================================================

2025-12-13 01:39:33 - utils - WARNING - DEBUG MODE: Slicing data from 320915 to 5000 samples.
2025-12-13 01:39:33 - utils - INFO - Loaded sequences: (5000, 15, 13)
2025-12-13 01:39:33 - utils - INFO - Training on 3499 normal sequences
2025-12-13 01:39:33 - utils - INFO - Model: "functional"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┓
┃ Layer (type)                    ┃ Output Shape           ┃       Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━┩
│ input_layer (InputLayer)        │ (None, 15, 13)         │             0 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ lstm (LSTM)                     │ (None, 15, 32)         │         5,888 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dropout (Dropout)               │ (None, 15, 32)         │             0 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ lstm_1 (LSTM)                   │ (None, 16)             │         3,136 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ repeat_vector (RepeatVector)    │ (None, 15, 16)         │             0 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ lstm_2 (LSTM)                   │ (None, 15, 16)         │         2,112 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dropout_1 (Dropout)             │ (None, 15, 16)         │             0 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ lstm_3 (LSTM)                   │ (None, 15, 32)         │         6,272 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ time_distributed                │ (None, 15, 13)         │           429 │
│ (TimeDistributed)               │                        │               │
└─────────────────────────────────┴────────────────────────┴───────────────┘
 Total params: 17,837 (69.68 KB)
 Trainable params: 17,837 (69.68 KB)
 Non-trainable params: 0 (0.00 B)

2025-12-13 01:39:33 - utils - INFO - Starting training for 1 epoch(s)...
2025-12-13 01:42:20 - utils - INFO - Utility functions loaded successfully
2025-12-13 01:42:24 - utils - INFO - ================================================================================
2025-12-13 01:42:24 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-12-13 01:42:24 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-12-13 01:42:24 - utils - INFO - ================================================================================
2025-12-13 01:42:24 - utils - INFO - 
================================================================================
2025-12-13 01:42:24 - utils - INFO - STARTING FULL PIPELINE EXECUTION
2025-12-13 01:42:24 - utils - INFO - ================================================================================

2025-12-13 01:42:24 - utils - INFO - Skipping Stage 1: Data Preprocessing
2025-12-13 01:42:24 - utils - INFO - Skipping Stage 2: Feature Engineering
2025-12-13 01:42:24 - utils - INFO - 
================================================================================
                            STAGE 3: MODEL TRAINING                             
================================================================================

2025-12-13 01:42:24 - utils - INFO - 
>>> Training Isolation Forest...
2025-12-13 01:42:24 - utils - INFO - 
================================================================================
                 ISOLATION FOREST TRAINING (V2: MULTI-DATASET)                  
================================================================================

2025-12-13 01:42:24 - utils - INFO - Loaded daily features: (334905, 16)
2025-12-13 01:42:25 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest_model.pkl
2025-12-13 01:42:25 - utils - INFO - Predictions saved to /Users/bipinrimal/Downloads/Thesis_work/results/isolation_forest_predictions.csv
2025-12-13 01:42:25 - utils - WARNING - Only one class present in y_true, cannot calculate AUC-ROC
2025-12-13 01:42:25 - utils - INFO - 
============================================================
2025-12-13 01:42:25 - utils - INFO - Isolation Forest Performance Metrics
2025-12-13 01:42:25 - utils - INFO - ============================================================
2025-12-13 01:42:25 - utils - INFO - Accuracy:  0.8168
2025-12-13 01:42:25 - utils - INFO - Precision: 0.0000
2025-12-13 01:42:25 - utils - INFO - Recall:    0.0000
2025-12-13 01:42:25 - utils - INFO - F1-Score:  0.0000
2025-12-13 01:42:25 - utils - INFO - AUC-ROC:   0.0000
2025-12-13 01:42:25 - utils - INFO - ============================================================

2025-12-13 01:42:25 - utils - INFO - ✓ Isolation Forest training completed
2025-12-13 01:42:25 - utils - INFO - 
>>> Training LSTM Autoencoder...
2025-12-13 01:42:25 - utils - INFO - 
================================================================================
                           LSTM AUTOENCODER TRAINING                            
================================================================================

2025-12-13 01:42:25 - utils - WARNING - DEBUG MODE: Slicing data from 320915 to 5000 samples.
2025-12-13 01:42:25 - utils - INFO - Loaded sequences: (5000, 15, 13)
2025-12-13 01:42:25 - utils - INFO - Training on 3499 normal sequences
2025-12-13 01:42:25 - utils - INFO - Model: "functional"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┓
┃ Layer (type)                    ┃ Output Shape           ┃       Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━┩
│ input_layer (InputLayer)        │ (None, 15, 13)         │             0 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ lstm (LSTM)                     │ (None, 15, 32)         │         5,888 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dropout (Dropout)               │ (None, 15, 32)         │             0 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ lstm_1 (LSTM)                   │ (None, 16)             │         3,136 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ repeat_vector (RepeatVector)    │ (None, 15, 16)         │             0 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ lstm_2 (LSTM)                   │ (None, 15, 16)         │         2,112 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dropout_1 (Dropout)             │ (None, 15, 16)         │             0 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ lstm_3 (LSTM)                   │ (None, 15, 32)         │         6,272 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ time_distributed                │ (None, 15, 13)         │           429 │
│ (TimeDistributed)               │                        │               │
└─────────────────────────────────┴────────────────────────┴───────────────┘
 Total params: 17,837 (69.68 KB)
 Trainable params: 17,837 (69.68 KB)
 Non-trainable params: 0 (0.00 B)

2025-12-13 01:42:25 - utils - INFO - Starting training for 1 epoch(s)...
2025-12-13 01:44:24 - utils - INFO - Utility functions loaded successfully
2025-12-13 01:44:24 - utils - INFO - ================================================================================
2025-12-13 01:44:24 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-12-13 01:44:24 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-12-13 01:44:24 - utils - INFO - ================================================================================
2025-12-13 01:44:24 - utils - INFO - 
================================================================================
2025-12-13 01:44:24 - utils - INFO - STARTING FULL PIPELINE EXECUTION
2025-12-13 01:44:24 - utils - INFO - ================================================================================

2025-12-13 01:44:24 - utils - INFO - Skipping Stage 1: Data Preprocessing
2025-12-13 01:44:24 - utils - INFO - Skipping Stage 2: Feature Engineering
2025-12-13 01:44:24 - utils - INFO - 
================================================================================
                            STAGE 3: MODEL TRAINING                             
================================================================================

2025-12-13 01:44:24 - utils - INFO - 
>>> Training Isolation Forest...
2025-12-13 01:44:24 - utils - INFO - 
================================================================================
                 ISOLATION FOREST TRAINING (V2: MULTI-DATASET)                  
================================================================================

2025-12-13 01:44:24 - utils - INFO - Loaded daily features: (334905, 16)
2025-12-13 01:44:25 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest_model.pkl
2025-12-13 01:44:25 - utils - INFO - Predictions saved to /Users/bipinrimal/Downloads/Thesis_work/results/isolation_forest_predictions.csv
2025-12-13 01:44:25 - utils - WARNING - Only one class present in y_true, cannot calculate AUC-ROC
2025-12-13 01:44:25 - utils - INFO - 
============================================================
2025-12-13 01:44:25 - utils - INFO - Isolation Forest Performance Metrics
2025-12-13 01:44:25 - utils - INFO - ============================================================
2025-12-13 01:44:25 - utils - INFO - Accuracy:  0.8168
2025-12-13 01:44:25 - utils - INFO - Precision: 0.0000
2025-12-13 01:44:25 - utils - INFO - Recall:    0.0000
2025-12-13 01:44:25 - utils - INFO - F1-Score:  0.0000
2025-12-13 01:44:25 - utils - INFO - AUC-ROC:   0.0000
2025-12-13 01:44:25 - utils - INFO - ============================================================

2025-12-13 01:44:25 - utils - INFO - ✓ Isolation Forest training completed
2025-12-13 01:44:25 - utils - INFO - 
>>> Training LSTM Autoencoder...
2025-12-13 01:44:25 - utils - INFO - 
================================================================================
                           LSTM AUTOENCODER TRAINING                            
================================================================================

2025-12-13 01:44:25 - utils - WARNING - DEBUG MODE: Slicing data from 320915 to 5000 samples.
2025-12-13 01:44:25 - utils - INFO - Loaded sequences: (5000, 15, 13)
2025-12-13 01:44:25 - utils - INFO - Training on 3499 normal sequences
2025-12-13 01:44:25 - utils - INFO - Model: "functional"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┓
┃ Layer (type)                    ┃ Output Shape           ┃       Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━┩
│ input_layer (InputLayer)        │ (None, 15, 13)         │             0 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ lstm (LSTM)                     │ (None, 15, 32)         │         5,888 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dropout (Dropout)               │ (None, 15, 32)         │             0 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ lstm_1 (LSTM)                   │ (None, 16)             │         3,136 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ repeat_vector (RepeatVector)    │ (None, 15, 16)         │             0 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ lstm_2 (LSTM)                   │ (None, 15, 16)         │         2,112 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dropout_1 (Dropout)             │ (None, 15, 16)         │             0 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ lstm_3 (LSTM)                   │ (None, 15, 32)         │         6,272 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ time_distributed                │ (None, 15, 13)         │           429 │
│ (TimeDistributed)               │                        │               │
└─────────────────────────────────┴────────────────────────┴───────────────┘
 Total params: 17,837 (69.68 KB)
 Trainable params: 17,837 (69.68 KB)
 Non-trainable params: 0 (0.00 B)

2025-12-13 01:44:25 - utils - INFO - Starting training for 1 epoch(s)...
2025-12-13 01:44:28 - utils - INFO - Evaluating on Test Set...
2025-12-13 01:44:28 - utils - INFO - Predictions saved to /Users/bipinrimal/Downloads/Thesis_work/results/lstm_autoencoder_predictions.csv
2025-12-13 01:44:28 - utils - WARNING - Only one class present in y_true, cannot calculate AUC-ROC
2025-12-13 01:44:28 - utils - INFO - 
============================================================
2025-12-13 01:44:28 - utils - INFO - LSTM Autoencoder Performance Metrics
2025-12-13 01:44:28 - utils - INFO - ============================================================
2025-12-13 01:44:28 - utils - INFO - Accuracy:  0.9494
2025-12-13 01:44:28 - utils - INFO - Precision: 0.0000
2025-12-13 01:44:28 - utils - INFO - Recall:    0.0000
2025-12-13 01:44:28 - utils - INFO - F1-Score:  0.0000
2025-12-13 01:44:28 - utils - INFO - AUC-ROC:   0.0000
2025-12-13 01:44:28 - utils - INFO - ============================================================

2025-12-13 01:44:28 - utils - INFO - ✓ LSTM Autoencoder training completed
2025-12-13 01:44:28 - utils - INFO - 
>>> Training Deep Clustering...
2025-12-13 01:44:28 - utils - INFO - 
================================================================================
                      LIGHTWEIGHT DEEP CLUSTERING TRAINING                      
================================================================================

2025-12-13 01:44:40 - utils - INFO - Predictions saved to /Users/bipinrimal/Downloads/Thesis_work/results/deep_clustering_predictions.csv
2025-12-13 01:44:40 - utils - WARNING - Only one class present in y_true, cannot calculate AUC-ROC
2025-12-13 01:44:40 - utils - INFO - 
============================================================
2025-12-13 01:44:40 - utils - INFO - Deep Clustering Performance Metrics
2025-12-13 01:44:40 - utils - INFO - ============================================================
2025-12-13 01:44:40 - utils - INFO - Accuracy:  0.9503
2025-12-13 01:44:40 - utils - INFO - Precision: 0.0000
2025-12-13 01:44:40 - utils - INFO - Recall:    0.0000
2025-12-13 01:44:40 - utils - INFO - F1-Score:  0.0000
2025-12-13 01:44:40 - utils - INFO - AUC-ROC:   0.0000
2025-12-13 01:44:40 - utils - INFO - ============================================================

2025-12-13 01:44:40 - utils - INFO - ✓ Deep Clustering training completed
2025-12-13 01:44:40 - utils - INFO - 
✓ Stage 3 completed: 3 models trained
2025-12-13 01:44:40 - utils - INFO - 
================================================================================
                           STAGE 4: MODEL EVALUATION                            
================================================================================

2025-12-13 01:44:40 - utils - INFO - 
================================================================================
                         COMPREHENSIVE MODEL EVALUATION                         
================================================================================

2025-12-13 01:44:40 - utils - INFO - Loading results for all models...
2025-12-13 01:44:40 - utils - INFO - Loaded results for isolation_forest
2025-12-13 01:44:40 - utils - INFO - Loaded results for lstm_autoencoder
2025-12-13 01:44:40 - utils - INFO - Loaded results for deep_clustering
2025-12-13 01:44:40 - utils - INFO - Loaded results for 3 models
2025-12-13 01:44:40 - utils - INFO - Creating metrics comparison table...
2025-12-13 01:44:40 - utils - INFO - Metrics comparison table created
2025-12-13 01:44:40 - utils - INFO - Creating confusion matrix plots...
2025-12-13 01:44:41 - utils - INFO - Confusion matrices saved to /Users/bipinrimal/Downloads/Thesis_work/results/confusion_matrices/all_models.png
2025-12-13 01:44:41 - utils - INFO - Creating ROC curves...
2025-12-13 01:44:41 - utils - INFO - ROC curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/roc_curves/roc_comparison.png
2025-12-13 01:44:41 - utils - INFO - Creating Precision-Recall curves...
2025-12-13 01:44:41 - utils - INFO - Precision-Recall curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/precision_recall_comparison.png
2025-12-13 01:44:41 - utils - INFO - Creating metrics comparison bar chart...
2025-12-13 01:44:41 - utils - INFO - Metrics comparison bar chart saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/metrics_comparison_bar.png
2025-12-13 01:44:41 - utils - INFO - Creating anomaly score distribution plots...
2025-12-13 01:44:42 - utils - INFO - Score distributions saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/score_distributions.png
2025-12-13 01:44:42 - utils - INFO - Generating evaluation report...
2025-12-13 01:44:42 - utils - INFO - Evaluation report saved to /Users/bipinrimal/Downloads/Thesis_work/results/evaluation_report.txt
2025-12-13 01:44:42 - utils - INFO - Comprehensive evaluation completed!
2025-12-13 01:44:42 - utils - INFO - ✓ Stage 4 completed: Comprehensive evaluation report generated
2025-12-13 01:44:42 - utils - INFO - 
================================================================================
                         STAGE 5: ENSEMBLE INTEGRATION                          
================================================================================

2025-12-13 01:44:42 - utils - INFO - Testing ensemble method: weighted
2025-12-13 01:44:42 - utils - INFO - Initialized Ensemble Detector with method: weighted
2025-12-13 01:44:42 - utils - INFO - 
================================================================================
                            ENSEMBLE SYSTEM PIPELINE                            
================================================================================

2025-12-13 01:44:42 - utils - INFO - Loading predictions from individual models...
2025-12-13 01:44:42 - utils - INFO - Loaded isolation_forest predictions: 334905 samples
2025-12-13 01:44:42 - utils - INFO - Loaded lstm_autoencoder predictions: 751 samples
2025-12-13 01:44:42 - utils - INFO - Loaded deep_clustering predictions: 334905 samples
2025-12-13 01:44:42 - utils - WARNING - Models have different sample counts: {'isolation_forest': 334905, 'lstm_autoencoder': 751, 'deep_clustering': 334905}
2025-12-13 01:44:42 - utils - INFO - Will use aggregation strategy to align predictions...
2025-12-13 01:44:42 - utils - INFO - Aligning predictions across models...
2025-12-13 01:44:42 - utils - INFO - Using lstm_autoencoder as reference (751 samples)
2025-12-13 01:44:42 - utils - INFO - Aggregating isolation_forest from 334905 to 751 samples
2025-12-13 01:44:42 - utils - INFO - Aggregating deep_clustering from 334905 to 751 samples
2025-12-13 01:44:42 - utils - INFO - Predictions aligned successfully
2025-12-13 01:44:42 - utils - INFO - Loaded predictions from 3 models
2025-12-13 01:44:42 - utils - INFO - Computing weighted ensemble...
2025-12-13 01:44:42 - utils - INFO - Weighted ensemble: 751 anomalies detected
2025-12-13 01:44:42 - utils - INFO - Evaluating ensemble performance...
2025-12-13 01:44:42 - utils - WARNING - Only one class present in y_true, cannot calculate AUC-ROC
2025-12-13 01:44:42 - utils - INFO - 
============================================================
2025-12-13 01:44:42 - utils - INFO - Ensemble (weighted) Performance Metrics
2025-12-13 01:44:42 - utils - INFO - ============================================================
2025-12-13 01:44:42 - utils - INFO - Accuracy:  0.0000
2025-12-13 01:44:42 - utils - INFO - Precision: 0.0000
2025-12-13 01:44:42 - utils - INFO - Recall:    0.0000
2025-12-13 01:44:42 - utils - INFO - F1-Score:  0.0000
2025-12-13 01:44:42 - utils - INFO - AUC-ROC:   0.0000
2025-12-13 01:44:42 - utils - INFO - ============================================================

2025-12-13 01:44:42 - utils - INFO - Comparing ensemble with individual models...
2025-12-13 01:44:42 - utils - WARNING - Only one class present in y_true, cannot calculate AUC-ROC
2025-12-13 01:44:42 - utils - WARNING - Only one class present in y_true, cannot calculate AUC-ROC
2025-12-13 01:44:42 - utils - WARNING - Only one class present in y_true, cannot calculate AUC-ROC
2025-12-13 01:44:42 - utils - INFO - Evaluating ensemble performance...
2025-12-13 01:44:42 - utils - WARNING - Only one class present in y_true, cannot calculate AUC-ROC
2025-12-13 01:44:42 - utils - INFO - 
============================================================
2025-12-13 01:44:42 - utils - INFO - Ensemble (weighted) Performance Metrics
2025-12-13 01:44:42 - utils - INFO - ============================================================
2025-12-13 01:44:42 - utils - INFO - Accuracy:  0.0000
2025-12-13 01:44:42 - utils - INFO - Precision: 0.0000
2025-12-13 01:44:42 - utils - INFO - Recall:    0.0000
2025-12-13 01:44:42 - utils - INFO - F1-Score:  0.0000
2025-12-13 01:44:42 - utils - INFO - AUC-ROC:   0.0000
2025-12-13 01:44:42 - utils - INFO - ============================================================

2025-12-13 01:44:42 - utils - INFO - 
Comparison Results:
2025-12-13 01:44:42 - utils - INFO - 
              model  accuracy  precision  recall  f1_score  auc_roc
   Isolation Forest    0.8282        0.0     0.0       0.0      0.0
   Lstm Autoencoder    0.9494        0.0     0.0       0.0      0.0
    Deep Clustering    0.9507        0.0     0.0       0.0      0.0
Ensemble (weighted)    0.0000        0.0     0.0       0.0      0.0
2025-12-13 01:44:42 - utils - INFO - Ensemble predictions saved
2025-12-13 01:44:42 - utils - INFO - Generating alerts...
2025-12-13 01:44:42 - utils - INFO - Generated 751 alerts
2025-12-13 01:44:42 - utils - INFO - Severity distribution:
severity
low         707
high         23
critical     20
medium        1
Name: count, dtype: int64
2025-12-13 01:44:42 - utils - INFO - Alerts saved to /Users/bipinrimal/Downloads/Thesis_work/results/alerts.csv
2025-12-13 01:44:42 - utils - INFO - Ensemble pipeline completed!
2025-12-13 01:44:42 - utils - INFO - Testing ensemble method: majority
2025-12-13 01:44:42 - utils - INFO - Initialized Ensemble Detector with method: majority
2025-12-13 01:44:42 - utils - INFO - 
================================================================================
                            ENSEMBLE SYSTEM PIPELINE                            
================================================================================

2025-12-13 01:44:42 - utils - INFO - Loading predictions from individual models...
2025-12-13 01:44:42 - utils - INFO - Loaded isolation_forest predictions: 334905 samples
2025-12-13 01:44:42 - utils - INFO - Loaded lstm_autoencoder predictions: 751 samples
2025-12-13 01:44:42 - utils - INFO - Loaded deep_clustering predictions: 334905 samples
2025-12-13 01:44:42 - utils - WARNING - Models have different sample counts: {'isolation_forest': 334905, 'lstm_autoencoder': 751, 'deep_clustering': 334905}
2025-12-13 01:44:42 - utils - INFO - Will use aggregation strategy to align predictions...
2025-12-13 01:44:42 - utils - INFO - Aligning predictions across models...
2025-12-13 01:44:42 - utils - INFO - Using lstm_autoencoder as reference (751 samples)
2025-12-13 01:44:42 - utils - INFO - Aggregating isolation_forest from 334905 to 751 samples
2025-12-13 01:44:42 - utils - INFO - Aggregating deep_clustering from 334905 to 751 samples
2025-12-13 01:44:42 - utils - INFO - Predictions aligned successfully
2025-12-13 01:44:42 - utils - INFO - Loaded predictions from 3 models
2025-12-13 01:44:42 - utils - INFO - Computing majority voting ensemble...
2025-12-13 01:44:42 - utils - INFO - Majority voting: 44 anomalies detected
2025-12-13 01:44:42 - utils - INFO - Evaluating ensemble performance...
2025-12-13 01:44:42 - utils - WARNING - Only one class present in y_true, cannot calculate AUC-ROC
2025-12-13 01:44:42 - utils - INFO - 
============================================================
2025-12-13 01:44:42 - utils - INFO - Ensemble (majority) Performance Metrics
2025-12-13 01:44:42 - utils - INFO - ============================================================
2025-12-13 01:44:42 - utils - INFO - Accuracy:  0.9414
2025-12-13 01:44:42 - utils - INFO - Precision: 0.0000
2025-12-13 01:44:42 - utils - INFO - Recall:    0.0000
2025-12-13 01:44:42 - utils - INFO - F1-Score:  0.0000
2025-12-13 01:44:42 - utils - INFO - AUC-ROC:   0.0000
2025-12-13 01:44:42 - utils - INFO - ============================================================

2025-12-13 01:44:42 - utils - INFO - Comparing ensemble with individual models...
2025-12-13 01:44:42 - utils - WARNING - Only one class present in y_true, cannot calculate AUC-ROC
2025-12-13 01:44:42 - utils - WARNING - Only one class present in y_true, cannot calculate AUC-ROC
2025-12-13 01:44:42 - utils - WARNING - Only one class present in y_true, cannot calculate AUC-ROC
2025-12-13 01:44:42 - utils - INFO - Evaluating ensemble performance...
2025-12-13 01:44:42 - utils - WARNING - Only one class present in y_true, cannot calculate AUC-ROC
2025-12-13 01:44:42 - utils - INFO - 
============================================================
2025-12-13 01:44:42 - utils - INFO - Ensemble (majority) Performance Metrics
2025-12-13 01:44:42 - utils - INFO - ============================================================
2025-12-13 01:44:42 - utils - INFO - Accuracy:  0.9414
2025-12-13 01:44:42 - utils - INFO - Precision: 0.0000
2025-12-13 01:44:42 - utils - INFO - Recall:    0.0000
2025-12-13 01:44:42 - utils - INFO - F1-Score:  0.0000
2025-12-13 01:44:42 - utils - INFO - AUC-ROC:   0.0000
2025-12-13 01:44:42 - utils - INFO - ============================================================

2025-12-13 01:44:42 - utils - INFO - 
Comparison Results:
2025-12-13 01:44:42 - utils - INFO - 
              model  accuracy  precision  recall  f1_score  auc_roc
   Isolation Forest    0.8282        0.0     0.0       0.0      0.0
   Lstm Autoencoder    0.9494        0.0     0.0       0.0      0.0
    Deep Clustering    0.9507        0.0     0.0       0.0      0.0
Ensemble (majority)    0.9414        0.0     0.0       0.0      0.0
2025-12-13 01:44:42 - utils - INFO - Ensemble predictions saved
2025-12-13 01:44:42 - utils - INFO - Generating alerts...
2025-12-13 01:44:42 - utils - INFO - Generated 751 alerts
2025-12-13 01:44:42 - utils - INFO - Severity distribution:
severity
low         405
high        184
medium      123
critical     39
Name: count, dtype: int64
2025-12-13 01:44:42 - utils - INFO - Alerts saved to /Users/bipinrimal/Downloads/Thesis_work/results/alerts.csv
2025-12-13 01:44:42 - utils - INFO - Ensemble pipeline completed!
2025-12-13 01:44:42 - utils - INFO - Testing ensemble method: cascade
2025-12-13 01:44:42 - utils - INFO - Initialized Ensemble Detector with method: cascade
2025-12-13 01:44:42 - utils - INFO - 
================================================================================
                            ENSEMBLE SYSTEM PIPELINE                            
================================================================================

2025-12-13 01:44:42 - utils - INFO - Loading predictions from individual models...
2025-12-13 01:44:42 - utils - INFO - Loaded isolation_forest predictions: 334905 samples
2025-12-13 01:44:42 - utils - INFO - Loaded lstm_autoencoder predictions: 751 samples
2025-12-13 01:44:42 - utils - INFO - Loaded deep_clustering predictions: 334905 samples
2025-12-13 01:44:42 - utils - WARNING - Models have different sample counts: {'isolation_forest': 334905, 'lstm_autoencoder': 751, 'deep_clustering': 334905}
2025-12-13 01:44:42 - utils - INFO - Will use aggregation strategy to align predictions...
2025-12-13 01:44:42 - utils - INFO - Aligning predictions across models...
2025-12-13 01:44:42 - utils - INFO - Using lstm_autoencoder as reference (751 samples)
2025-12-13 01:44:42 - utils - INFO - Aggregating isolation_forest from 334905 to 751 samples
2025-12-13 01:44:42 - utils - INFO - Aggregating deep_clustering from 334905 to 751 samples
2025-12-13 01:44:42 - utils - INFO - Predictions aligned successfully
2025-12-13 01:44:42 - utils - INFO - Loaded predictions from 3 models
2025-12-13 01:44:42 - utils - INFO - Computing cascade ensemble...
2025-12-13 01:44:42 - utils - INFO - Cascade ensemble: 2 anomalies detected
2025-12-13 01:44:42 - utils - INFO - Evaluating ensemble performance...
2025-12-13 01:44:42 - utils - WARNING - Only one class present in y_true, cannot calculate AUC-ROC
2025-12-13 01:44:42 - utils - INFO - 
============================================================
2025-12-13 01:44:42 - utils - INFO - Ensemble (cascade) Performance Metrics
2025-12-13 01:44:42 - utils - INFO - ============================================================
2025-12-13 01:44:42 - utils - INFO - Accuracy:  0.9973
2025-12-13 01:44:42 - utils - INFO - Precision: 0.0000
2025-12-13 01:44:42 - utils - INFO - Recall:    0.0000
2025-12-13 01:44:42 - utils - INFO - F1-Score:  0.0000
2025-12-13 01:44:42 - utils - INFO - AUC-ROC:   0.0000
2025-12-13 01:44:42 - utils - INFO - ============================================================

2025-12-13 01:44:42 - utils - INFO - Comparing ensemble with individual models...
2025-12-13 01:44:42 - utils - WARNING - Only one class present in y_true, cannot calculate AUC-ROC
2025-12-13 01:44:42 - utils - WARNING - Only one class present in y_true, cannot calculate AUC-ROC
2025-12-13 01:44:42 - utils - WARNING - Only one class present in y_true, cannot calculate AUC-ROC
2025-12-13 01:44:42 - utils - INFO - Evaluating ensemble performance...
2025-12-13 01:44:42 - utils - WARNING - Only one class present in y_true, cannot calculate AUC-ROC
2025-12-13 01:44:42 - utils - INFO - 
============================================================
2025-12-13 01:44:42 - utils - INFO - Ensemble (cascade) Performance Metrics
2025-12-13 01:44:42 - utils - INFO - ============================================================
2025-12-13 01:44:42 - utils - INFO - Accuracy:  0.9973
2025-12-13 01:44:42 - utils - INFO - Precision: 0.0000
2025-12-13 01:44:42 - utils - INFO - Recall:    0.0000
2025-12-13 01:44:42 - utils - INFO - F1-Score:  0.0000
2025-12-13 01:44:42 - utils - INFO - AUC-ROC:   0.0000
2025-12-13 01:44:42 - utils - INFO - ============================================================

2025-12-13 01:44:42 - utils - INFO - 
Comparison Results:
2025-12-13 01:44:42 - utils - INFO - 
             model  accuracy  precision  recall  f1_score  auc_roc
  Isolation Forest    0.8282        0.0     0.0       0.0      0.0
  Lstm Autoencoder    0.9494        0.0     0.0       0.0      0.0
   Deep Clustering    0.9507        0.0     0.0       0.0      0.0
Ensemble (cascade)    0.9973        0.0     0.0       0.0      0.0
2025-12-13 01:44:42 - utils - INFO - Ensemble predictions saved
2025-12-13 01:44:42 - utils - INFO - Generating alerts...
2025-12-13 01:44:42 - utils - INFO - Generated 751 alerts
2025-12-13 01:44:42 - utils - INFO - Severity distribution:
severity
low    751
Name: count, dtype: int64
2025-12-13 01:44:42 - utils - INFO - Alerts saved to /Users/bipinrimal/Downloads/Thesis_work/results/alerts.csv
2025-12-13 01:44:42 - utils - INFO - Ensemble pipeline completed!
2025-12-13 01:44:42 - utils - INFO - 
✓ Stage 5 completed. Best performing method: None
2025-12-13 01:44:42 - utils - INFO - 
================================================================================
                             STAGE 6: VISUALIZATION                             
================================================================================

2025-12-13 01:44:42 - utils - INFO - 
================================================================================
                           GENERATING VISUALIZATIONS                            
================================================================================

2025-12-13 01:44:42 - utils - INFO - Creating alert severity distribution plot...
2025-12-13 01:44:42 - utils - INFO - Alert severity distribution plot saved
2025-12-13 01:44:42 - utils - INFO - Creating model agreement plot...
2025-12-13 01:44:42 - utils - INFO - Model agreement plot saved
2025-12-13 01:44:42 - utils - INFO - Creating anomaly score timeline for ensemble_weighted...
2025-12-13 01:44:42 - utils - INFO - Anomaly score timeline saved for ensemble_weighted
2025-12-13 01:44:42 - utils - INFO - Creating feature importance visualization...
2025-12-13 01:44:42 - utils - INFO - Feature importance heatmap saved
2025-12-13 01:44:42 - utils - INFO - Creating executive summary chart...
2025-12-13 01:44:43 - utils - INFO - Executive summary chart saved
2025-12-13 01:44:43 - utils - INFO - All visualizations saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations
2025-12-13 01:44:43 - utils - INFO - Visualization generation completed!
2025-12-13 01:44:43 - utils - INFO - ✓ Stage 6 completed: All visualizations generated
2025-12-13 01:44:43 - utils - INFO - 
================================================================================
2025-12-13 01:44:43 - utils - INFO - FINAL SUMMARY
2025-12-13 01:44:43 - utils - INFO - ================================================================================
2025-12-13 01:44:43 - utils - INFO - 
Model Performance (on labeled validation set):
2025-12-13 01:44:43 - utils - INFO - 
Isolation Forest:
2025-12-13 01:44:43 - utils - WARNING -   No metrics available (unsupervised execution).
2025-12-13 01:44:43 - utils - INFO - 
Lstm Autoencoder:
2025-12-13 01:44:43 - utils - WARNING -   No metrics available (unsupervised execution).
2025-12-13 01:44:43 - utils - INFO - 
Deep Clustering:
2025-12-13 01:44:43 - utils - WARNING -   No metrics available (unsupervised execution).
2025-12-13 01:44:43 - utils - INFO - 
Generated Output Locations:
2025-12-13 01:44:43 - utils - INFO -   - Processed Data: /Users/bipinrimal/Downloads/Thesis_work/data/processed
2025-12-13 01:44:43 - utils - INFO -   - Trained Models: /Users/bipinrimal/Downloads/Thesis_work/models
2025-12-13 01:44:43 - utils - INFO -   - Alert Logs:     /Users/bipinrimal/Downloads/Thesis_work/results/alerts.csv
2025-12-13 01:44:43 - utils - INFO -   - Logs:           /Users/bipinrimal/Downloads/Thesis_work/logs/insider_threat_detection.log
2025-12-13 01:44:43 - utils - INFO - 
================================================================================
2025-12-13 01:44:43 - utils - INFO - ✓ PIPELINE EXECUTION COMPLETED
2025-12-13 01:44:43 - utils - INFO - ================================================================================

2025-12-13 01:46:15 - utils - INFO - Utility functions loaded successfully
2025-12-13 01:46:16 - utils - INFO - ================================================================================
2025-12-13 01:46:16 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-12-13 01:46:16 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-12-13 01:46:16 - utils - INFO - ================================================================================
2025-12-13 01:46:16 - utils - INFO - 
================================================================================
2025-12-13 01:46:16 - utils - INFO - STARTING FULL PIPELINE EXECUTION
2025-12-13 01:46:16 - utils - INFO - ================================================================================

2025-12-13 01:46:16 - utils - INFO - 
================================================================================
                          STAGE 1: DATA PREPROCESSING                           
================================================================================

2025-12-13 01:46:16 - utils - INFO - Processing SUBSET defined in config: ['r1', 'r2', 'r3.1', 'r3.2', 'r4.1']
2025-12-13 01:46:16 - utils - INFO - 
================================================================================
                          DATA PREPROCESSING (POLARS)                           
================================================================================

2025-12-13 01:46:16 - utils - INFO - Scanning dataset: r1
2025-12-13 01:46:16 - utils - INFO - Scanning dataset: r2
2025-12-13 01:46:16 - utils - INFO - Scanning dataset: r3.1
2025-12-13 01:46:16 - utils - INFO - Scanning dataset: r3.2
2025-12-13 01:46:16 - utils - INFO - Scanning dataset: r4.1
2025-12-13 01:46:16 - utils - INFO - Constructing execution graph (Diagonal Concat)...
2025-12-13 01:46:16 - utils - INFO - Loaded Psychometric data: 3999 users
2025-12-13 01:46:16 - utils - INFO - Streaming merged data to /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv...
2025-12-13 01:48:15 - utils - INFO - ✓ Preprocessing complete.
2025-12-13 01:48:15 - utils - INFO - ✓ Stage 1 completed successfully.
2025-12-13 01:48:15 - utils - INFO - 
================================================================================
                          STAGE 2: FEATURE ENGINEERING                          
================================================================================

2025-12-13 01:48:15 - utils - INFO - Starting Feature Engineering Pipeline (Polars Lazy Execution)...
2025-12-13 01:48:15 - utils - INFO - Scanning data from /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv
2025-12-13 01:48:15 - utils - INFO - Constructing execution graph for daily features...
2025-12-13 01:48:15 - utils - INFO - Executing aggregation (Streaming Mode)...
2025-12-13 01:50:02 - utils - INFO - Saved features to: /Users/bipinrimal/Downloads/Thesis_work/data/processed/daily_features.parquet
2025-12-13 01:50:02 - utils - INFO - Creating static features and fitting scaler...
2025-12-13 01:50:02 - utils - INFO - Generated static features for 7999 users
2025-12-13 01:50:02 - utils - INFO - Saved features to: /Users/bipinrimal/Downloads/Thesis_work/data/processed/static_features.csv
2025-12-13 01:50:02 - utils - INFO - Saved static scaler to /Users/bipinrimal/Downloads/Thesis_work/models/static_scaler.pkl
2025-12-13 01:50:02 - utils - INFO - Creating sequences...
2025-12-13 01:50:02 - utils - INFO - Saved features to: /Users/bipinrimal/Downloads/Thesis_work/data/processed/sequence_features.parquet
2025-12-13 01:50:02 - utils - INFO - Processing sequences with length 15...
2025-12-13 01:50:04 - utils - INFO - Generated sequences shape: (2542814, 15, 13)
2025-12-13 01:50:04 - utils - INFO - Generated labels shape: (2542814,)
2025-12-13 01:50:07 - utils - INFO - Saved sequences to /Users/bipinrimal/Downloads/Thesis_work/data/processed/sequences.npy
2025-12-13 01:50:07 - utils - INFO - Saved sequence labels to /Users/bipinrimal/Downloads/Thesis_work/data/processed/sequence_labels.npy
2025-12-13 01:50:07 - utils - INFO - Feature engineering pipeline completed successfully.
2025-12-13 01:50:07 - utils - INFO - ✓ Stage 2 completed: Feature files generated.
2025-12-13 01:50:07 - utils - INFO - 
================================================================================
                            STAGE 3: MODEL TRAINING                             
================================================================================

2025-12-13 01:50:07 - utils - INFO - 
>>> Training Isolation Forest...
2025-12-13 01:50:07 - utils - INFO - 
================================================================================
                 ISOLATION FOREST TRAINING (V2: MULTI-DATASET)                  
================================================================================

2025-12-13 01:50:07 - utils - INFO - Loaded daily features: (2654790, 16)
2025-12-13 01:50:11 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest_model.pkl
2025-12-13 01:50:14 - utils - INFO - Predictions saved to /Users/bipinrimal/Downloads/Thesis_work/results/isolation_forest_predictions.csv
2025-12-13 01:50:14 - utils - WARNING - Only one class present in y_true, cannot calculate AUC-ROC
2025-12-13 01:50:14 - utils - INFO - 
============================================================
2025-12-13 01:50:14 - utils - INFO - Isolation Forest Performance Metrics
2025-12-13 01:50:14 - utils - INFO - ============================================================
2025-12-13 01:50:14 - utils - INFO - Accuracy:  0.9117
2025-12-13 01:50:14 - utils - INFO - Precision: 0.0000
2025-12-13 01:50:14 - utils - INFO - Recall:    0.0000
2025-12-13 01:50:14 - utils - INFO - F1-Score:  0.0000
2025-12-13 01:50:14 - utils - INFO - AUC-ROC:   0.0000
2025-12-13 01:50:14 - utils - INFO - ============================================================

2025-12-13 01:50:14 - utils - INFO - ✓ Isolation Forest training completed
2025-12-13 01:50:14 - utils - INFO - 
>>> Training LSTM Autoencoder...
2025-12-13 01:50:14 - utils - INFO - 
================================================================================
                           LSTM AUTOENCODER TRAINING                            
================================================================================

2025-12-13 01:50:15 - utils - WARNING - DEBUG MODE: Slicing data from 2542814 to 5000 samples.
2025-12-13 01:50:15 - utils - INFO - Loaded sequences: (5000, 15, 13)
2025-12-13 01:50:15 - utils - INFO - Training on 3499 normal sequences
2025-12-13 01:50:15 - utils - INFO - Model: "functional"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┓
┃ Layer (type)                         ┃ Output Shape                ┃         Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━┩
│ input_layer (InputLayer)             │ (None, 15, 13)              │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ lstm (LSTM)                          │ (None, 15, 32)              │           5,888 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout (Dropout)                    │ (None, 15, 32)              │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ lstm_1 (LSTM)                        │ (None, 16)                  │           3,136 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ repeat_vector (RepeatVector)         │ (None, 15, 16)              │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ lstm_2 (LSTM)                        │ (None, 15, 16)              │           2,112 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout_1 (Dropout)                  │ (None, 15, 16)              │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ lstm_3 (LSTM)                        │ (None, 15, 32)              │           6,272 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ time_distributed (TimeDistributed)   │ (None, 15, 13)              │             429 │
└──────────────────────────────────────┴─────────────────────────────┴─────────────────┘
 Total params: 17,837 (69.68 KB)
 Trainable params: 17,837 (69.68 KB)
 Non-trainable params: 0 (0.00 B)

2025-12-13 01:50:15 - utils - INFO - Starting training for 1 epoch(s)...
2025-12-13 01:50:18 - utils - INFO - Evaluating on Test Set...
2025-12-13 01:50:18 - utils - INFO - Predictions saved to /Users/bipinrimal/Downloads/Thesis_work/results/lstm_autoencoder_predictions.csv
2025-12-13 01:50:18 - utils - WARNING - Only one class present in y_true, cannot calculate AUC-ROC
2025-12-13 01:50:18 - utils - INFO - 
============================================================
2025-12-13 01:50:18 - utils - INFO - LSTM Autoencoder Performance Metrics
2025-12-13 01:50:18 - utils - INFO - ============================================================
2025-12-13 01:50:18 - utils - INFO - Accuracy:  0.9494
2025-12-13 01:50:18 - utils - INFO - Precision: 0.0000
2025-12-13 01:50:18 - utils - INFO - Recall:    0.0000
2025-12-13 01:50:18 - utils - INFO - F1-Score:  0.0000
2025-12-13 01:50:18 - utils - INFO - AUC-ROC:   0.0000
2025-12-13 01:50:18 - utils - INFO - ============================================================

2025-12-13 01:50:18 - utils - INFO - ✓ LSTM Autoencoder training completed
2025-12-13 01:50:18 - utils - INFO - 
>>> Training Deep Clustering...
2025-12-13 01:50:18 - utils - INFO - 
================================================================================
                      LIGHTWEIGHT DEEP CLUSTERING TRAINING                      
================================================================================

2025-12-13 01:51:53 - utils - INFO - Predictions saved to /Users/bipinrimal/Downloads/Thesis_work/results/deep_clustering_predictions.csv
2025-12-13 01:51:54 - utils - WARNING - Only one class present in y_true, cannot calculate AUC-ROC
2025-12-13 01:51:54 - utils - INFO - 
============================================================
2025-12-13 01:51:54 - utils - INFO - Deep Clustering Performance Metrics
2025-12-13 01:51:54 - utils - INFO - ============================================================
2025-12-13 01:51:54 - utils - INFO - Accuracy:  0.9506
2025-12-13 01:51:54 - utils - INFO - Precision: 0.0000
2025-12-13 01:51:54 - utils - INFO - Recall:    0.0000
2025-12-13 01:51:54 - utils - INFO - F1-Score:  0.0000
2025-12-13 01:51:54 - utils - INFO - AUC-ROC:   0.0000
2025-12-13 01:51:54 - utils - INFO - ============================================================

2025-12-13 01:51:54 - utils - INFO - ✓ Deep Clustering training completed
2025-12-13 01:51:54 - utils - INFO - 
✓ Stage 3 completed: 3 models trained
2025-12-13 01:51:54 - utils - INFO - 
================================================================================
                           STAGE 4: MODEL EVALUATION                            
================================================================================

2025-12-13 01:51:54 - utils - INFO - 
================================================================================
                         COMPREHENSIVE MODEL EVALUATION                         
================================================================================

2025-12-13 01:51:54 - utils - INFO - Loading results for all models...
2025-12-13 01:51:54 - utils - INFO - Loaded results for isolation_forest
2025-12-13 01:51:54 - utils - INFO - Loaded results for lstm_autoencoder
2025-12-13 01:51:54 - utils - INFO - Loaded results for deep_clustering
2025-12-13 01:51:54 - utils - INFO - Loaded results for 3 models
2025-12-13 01:51:54 - utils - INFO - Creating metrics comparison table...
2025-12-13 01:51:54 - utils - INFO - Metrics comparison table created
2025-12-13 01:51:54 - utils - INFO - Creating confusion matrix plots...
2025-12-13 01:51:55 - utils - INFO - Confusion matrices saved to /Users/bipinrimal/Downloads/Thesis_work/results/confusion_matrices/all_models.png
2025-12-13 01:51:55 - utils - INFO - Creating ROC curves...
2025-12-13 01:51:55 - utils - INFO - ROC curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/roc_curves/roc_comparison.png
2025-12-13 01:51:55 - utils - INFO - Creating Precision-Recall curves...
2025-12-13 01:51:56 - utils - INFO - Precision-Recall curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/precision_recall_comparison.png
2025-12-13 01:51:56 - utils - INFO - Creating metrics comparison bar chart...
2025-12-13 01:51:56 - utils - INFO - Metrics comparison bar chart saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/metrics_comparison_bar.png
2025-12-13 01:51:56 - utils - INFO - Creating anomaly score distribution plots...
2025-12-13 01:51:56 - utils - INFO - Score distributions saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/score_distributions.png
2025-12-13 01:51:56 - utils - INFO - Generating evaluation report...
2025-12-13 01:51:56 - utils - INFO - Evaluation report saved to /Users/bipinrimal/Downloads/Thesis_work/results/evaluation_report.txt
2025-12-13 01:51:56 - utils - INFO - Comprehensive evaluation completed!
2025-12-13 01:51:56 - utils - INFO - ✓ Stage 4 completed: Comprehensive evaluation report generated
2025-12-13 01:51:56 - utils - INFO - 
================================================================================
                         STAGE 5: ENSEMBLE INTEGRATION                          
================================================================================

2025-12-13 01:51:56 - utils - INFO - Testing ensemble method: weighted
2025-12-13 01:51:56 - utils - INFO - Initialized Ensemble Detector with method: weighted
2025-12-13 01:51:56 - utils - INFO - 
================================================================================
                            ENSEMBLE SYSTEM PIPELINE                            
================================================================================

2025-12-13 01:51:56 - utils - INFO - Loading predictions from individual models...
2025-12-13 01:51:56 - utils - INFO - Loaded isolation_forest predictions: 2654790 samples
2025-12-13 01:51:56 - utils - INFO - Loaded lstm_autoencoder predictions: 751 samples
2025-12-13 01:51:57 - utils - INFO - Loaded deep_clustering predictions: 2654790 samples
2025-12-13 01:51:57 - utils - WARNING - Models have different sample counts: {'isolation_forest': 2654790, 'lstm_autoencoder': 751, 'deep_clustering': 2654790}
2025-12-13 01:51:57 - utils - INFO - Will use aggregation strategy to align predictions...
2025-12-13 01:51:57 - utils - INFO - Aligning predictions across models...
2025-12-13 01:51:57 - utils - INFO - Using lstm_autoencoder as reference (751 samples)
2025-12-13 01:51:57 - utils - INFO - Aggregating isolation_forest from 2654790 to 751 samples
2025-12-13 01:51:57 - utils - INFO - Aggregating deep_clustering from 2654790 to 751 samples
2025-12-13 01:51:57 - utils - INFO - Predictions aligned successfully
2025-12-13 01:51:57 - utils - INFO - Loaded predictions from 3 models
2025-12-13 01:51:57 - utils - INFO - Computing weighted ensemble...
2025-12-13 01:51:57 - utils - INFO - Weighted ensemble: 750 anomalies detected
2025-12-13 01:51:57 - utils - INFO - Evaluating ensemble performance...
2025-12-13 01:51:57 - utils - WARNING - Only one class present in y_true, cannot calculate AUC-ROC
2025-12-13 01:51:57 - utils - INFO - 
============================================================
2025-12-13 01:51:57 - utils - INFO - Ensemble (weighted) Performance Metrics
2025-12-13 01:51:57 - utils - INFO - ============================================================
2025-12-13 01:51:57 - utils - INFO - Accuracy:  0.0013
2025-12-13 01:51:57 - utils - INFO - Precision: 0.0000
2025-12-13 01:51:57 - utils - INFO - Recall:    0.0000
2025-12-13 01:51:57 - utils - INFO - F1-Score:  0.0000
2025-12-13 01:51:57 - utils - INFO - AUC-ROC:   0.0000
2025-12-13 01:51:57 - utils - INFO - ============================================================

2025-12-13 01:51:57 - utils - INFO - Comparing ensemble with individual models...
2025-12-13 01:51:57 - utils - WARNING - Only one class present in y_true, cannot calculate AUC-ROC
2025-12-13 01:51:57 - utils - WARNING - Only one class present in y_true, cannot calculate AUC-ROC
2025-12-13 01:51:57 - utils - WARNING - Only one class present in y_true, cannot calculate AUC-ROC
2025-12-13 01:51:57 - utils - INFO - Evaluating ensemble performance...
2025-12-13 01:51:57 - utils - WARNING - Only one class present in y_true, cannot calculate AUC-ROC
2025-12-13 01:51:57 - utils - INFO - 
============================================================
2025-12-13 01:51:57 - utils - INFO - Ensemble (weighted) Performance Metrics
2025-12-13 01:51:57 - utils - INFO - ============================================================
2025-12-13 01:51:57 - utils - INFO - Accuracy:  0.0013
2025-12-13 01:51:57 - utils - INFO - Precision: 0.0000
2025-12-13 01:51:57 - utils - INFO - Recall:    0.0000
2025-12-13 01:51:57 - utils - INFO - F1-Score:  0.0000
2025-12-13 01:51:57 - utils - INFO - AUC-ROC:   0.0000
2025-12-13 01:51:57 - utils - INFO - ============================================================

2025-12-13 01:51:57 - utils - INFO - 
Comparison Results:
2025-12-13 01:51:57 - utils - INFO - 
              model  accuracy  precision  recall  f1_score  auc_roc
   Isolation Forest    0.9228        0.0     0.0       0.0      0.0
   Lstm Autoencoder    0.9494        0.0     0.0       0.0      0.0
    Deep Clustering    0.9494        0.0     0.0       0.0      0.0
Ensemble (weighted)    0.0013        0.0     0.0       0.0      0.0
2025-12-13 01:51:57 - utils - INFO - Ensemble predictions saved
2025-12-13 01:51:57 - utils - INFO - Generating alerts...
2025-12-13 01:51:57 - utils - INFO - Generated 750 alerts
2025-12-13 01:51:57 - utils - INFO - Severity distribution:
severity
low         677
high         38
medium       19
critical     16
Name: count, dtype: int64
2025-12-13 01:51:57 - utils - INFO - Alerts saved to /Users/bipinrimal/Downloads/Thesis_work/results/alerts.csv
2025-12-13 01:51:57 - utils - INFO - Ensemble pipeline completed!
2025-12-13 01:51:57 - utils - INFO - Testing ensemble method: majority
2025-12-13 01:51:57 - utils - INFO - Initialized Ensemble Detector with method: majority
2025-12-13 01:51:57 - utils - INFO - 
================================================================================
                            ENSEMBLE SYSTEM PIPELINE                            
================================================================================

2025-12-13 01:51:57 - utils - INFO - Loading predictions from individual models...
2025-12-13 01:51:57 - utils - INFO - Loaded isolation_forest predictions: 2654790 samples
2025-12-13 01:51:57 - utils - INFO - Loaded lstm_autoencoder predictions: 751 samples
2025-12-13 01:51:58 - utils - INFO - Loaded deep_clustering predictions: 2654790 samples
2025-12-13 01:51:58 - utils - WARNING - Models have different sample counts: {'isolation_forest': 2654790, 'lstm_autoencoder': 751, 'deep_clustering': 2654790}
2025-12-13 01:51:58 - utils - INFO - Will use aggregation strategy to align predictions...
2025-12-13 01:51:58 - utils - INFO - Aligning predictions across models...
2025-12-13 01:51:58 - utils - INFO - Using lstm_autoencoder as reference (751 samples)
2025-12-13 01:51:58 - utils - INFO - Aggregating isolation_forest from 2654790 to 751 samples
2025-12-13 01:51:58 - utils - INFO - Aggregating deep_clustering from 2654790 to 751 samples
2025-12-13 01:51:58 - utils - INFO - Predictions aligned successfully
2025-12-13 01:51:58 - utils - INFO - Loaded predictions from 3 models
2025-12-13 01:51:58 - utils - INFO - Computing majority voting ensemble...
2025-12-13 01:51:58 - utils - INFO - Majority voting: 30 anomalies detected
2025-12-13 01:51:58 - utils - INFO - Evaluating ensemble performance...
2025-12-13 01:51:58 - utils - WARNING - Only one class present in y_true, cannot calculate AUC-ROC
2025-12-13 01:51:58 - utils - INFO - 
============================================================
2025-12-13 01:51:58 - utils - INFO - Ensemble (majority) Performance Metrics
2025-12-13 01:51:58 - utils - INFO - ============================================================
2025-12-13 01:51:58 - utils - INFO - Accuracy:  0.9601
2025-12-13 01:51:58 - utils - INFO - Precision: 0.0000
2025-12-13 01:51:58 - utils - INFO - Recall:    0.0000
2025-12-13 01:51:58 - utils - INFO - F1-Score:  0.0000
2025-12-13 01:51:58 - utils - INFO - AUC-ROC:   0.0000
2025-12-13 01:51:58 - utils - INFO - ============================================================

2025-12-13 01:51:58 - utils - INFO - Comparing ensemble with individual models...
2025-12-13 01:51:58 - utils - WARNING - Only one class present in y_true, cannot calculate AUC-ROC
2025-12-13 01:51:58 - utils - WARNING - Only one class present in y_true, cannot calculate AUC-ROC
2025-12-13 01:51:58 - utils - WARNING - Only one class present in y_true, cannot calculate AUC-ROC
2025-12-13 01:51:58 - utils - INFO - Evaluating ensemble performance...
2025-12-13 01:51:58 - utils - WARNING - Only one class present in y_true, cannot calculate AUC-ROC
2025-12-13 01:51:58 - utils - INFO - 
============================================================
2025-12-13 01:51:58 - utils - INFO - Ensemble (majority) Performance Metrics
2025-12-13 01:51:58 - utils - INFO - ============================================================
2025-12-13 01:51:58 - utils - INFO - Accuracy:  0.9601
2025-12-13 01:51:58 - utils - INFO - Precision: 0.0000
2025-12-13 01:51:58 - utils - INFO - Recall:    0.0000
2025-12-13 01:51:58 - utils - INFO - F1-Score:  0.0000
2025-12-13 01:51:58 - utils - INFO - AUC-ROC:   0.0000
2025-12-13 01:51:58 - utils - INFO - ============================================================

2025-12-13 01:51:58 - utils - INFO - 
Comparison Results:
2025-12-13 01:51:58 - utils - INFO - 
              model  accuracy  precision  recall  f1_score  auc_roc
   Isolation Forest    0.9228        0.0     0.0       0.0      0.0
   Lstm Autoencoder    0.9494        0.0     0.0       0.0      0.0
    Deep Clustering    0.9494        0.0     0.0       0.0      0.0
Ensemble (majority)    0.9601        0.0     0.0       0.0      0.0
2025-12-13 01:51:58 - utils - INFO - Ensemble predictions saved
2025-12-13 01:51:58 - utils - INFO - Generating alerts...
2025-12-13 01:51:58 - utils - INFO - Generated 732 alerts
2025-12-13 01:51:58 - utils - INFO - Severity distribution:
severity
low         365
high        190
medium      117
critical     60
Name: count, dtype: int64
2025-12-13 01:51:58 - utils - INFO - Alerts saved to /Users/bipinrimal/Downloads/Thesis_work/results/alerts.csv
2025-12-13 01:51:58 - utils - INFO - Ensemble pipeline completed!
2025-12-13 01:51:58 - utils - INFO - Testing ensemble method: cascade
2025-12-13 01:51:58 - utils - INFO - Initialized Ensemble Detector with method: cascade
2025-12-13 01:51:58 - utils - INFO - 
================================================================================
                            ENSEMBLE SYSTEM PIPELINE                            
================================================================================

2025-12-13 01:51:58 - utils - INFO - Loading predictions from individual models...
2025-12-13 01:51:58 - utils - INFO - Loaded isolation_forest predictions: 2654790 samples
2025-12-13 01:51:58 - utils - INFO - Loaded lstm_autoencoder predictions: 751 samples
2025-12-13 01:51:59 - utils - INFO - Loaded deep_clustering predictions: 2654790 samples
2025-12-13 01:51:59 - utils - WARNING - Models have different sample counts: {'isolation_forest': 2654790, 'lstm_autoencoder': 751, 'deep_clustering': 2654790}
2025-12-13 01:51:59 - utils - INFO - Will use aggregation strategy to align predictions...
2025-12-13 01:51:59 - utils - INFO - Aligning predictions across models...
2025-12-13 01:51:59 - utils - INFO - Using lstm_autoencoder as reference (751 samples)
2025-12-13 01:51:59 - utils - INFO - Aggregating isolation_forest from 2654790 to 751 samples
2025-12-13 01:51:59 - utils - INFO - Aggregating deep_clustering from 2654790 to 751 samples
2025-12-13 01:51:59 - utils - INFO - Predictions aligned successfully
2025-12-13 01:51:59 - utils - INFO - Loaded predictions from 3 models
2025-12-13 01:51:59 - utils - INFO - Computing cascade ensemble...
2025-12-13 01:51:59 - utils - INFO - Cascade ensemble: 1 anomalies detected
2025-12-13 01:51:59 - utils - INFO - Evaluating ensemble performance...
2025-12-13 01:51:59 - utils - WARNING - Only one class present in y_true, cannot calculate AUC-ROC
2025-12-13 01:51:59 - utils - INFO - 
============================================================
2025-12-13 01:51:59 - utils - INFO - Ensemble (cascade) Performance Metrics
2025-12-13 01:51:59 - utils - INFO - ============================================================
2025-12-13 01:51:59 - utils - INFO - Accuracy:  0.9987
2025-12-13 01:51:59 - utils - INFO - Precision: 0.0000
2025-12-13 01:51:59 - utils - INFO - Recall:    0.0000
2025-12-13 01:51:59 - utils - INFO - F1-Score:  0.0000
2025-12-13 01:51:59 - utils - INFO - AUC-ROC:   0.0000
2025-12-13 01:51:59 - utils - INFO - ============================================================

2025-12-13 01:51:59 - utils - INFO - Comparing ensemble with individual models...
2025-12-13 01:51:59 - utils - WARNING - Only one class present in y_true, cannot calculate AUC-ROC
2025-12-13 01:51:59 - utils - WARNING - Only one class present in y_true, cannot calculate AUC-ROC
2025-12-13 01:51:59 - utils - WARNING - Only one class present in y_true, cannot calculate AUC-ROC
2025-12-13 01:51:59 - utils - INFO - Evaluating ensemble performance...
2025-12-13 01:51:59 - utils - WARNING - Only one class present in y_true, cannot calculate AUC-ROC
2025-12-13 01:51:59 - utils - INFO - 
============================================================
2025-12-13 01:51:59 - utils - INFO - Ensemble (cascade) Performance Metrics
2025-12-13 01:51:59 - utils - INFO - ============================================================
2025-12-13 01:51:59 - utils - INFO - Accuracy:  0.9987
2025-12-13 01:51:59 - utils - INFO - Precision: 0.0000
2025-12-13 01:51:59 - utils - INFO - Recall:    0.0000
2025-12-13 01:51:59 - utils - INFO - F1-Score:  0.0000
2025-12-13 01:51:59 - utils - INFO - AUC-ROC:   0.0000
2025-12-13 01:51:59 - utils - INFO - ============================================================

2025-12-13 01:51:59 - utils - INFO - 
Comparison Results:
2025-12-13 01:51:59 - utils - INFO - 
             model  accuracy  precision  recall  f1_score  auc_roc
  Isolation Forest    0.9228        0.0     0.0       0.0      0.0
  Lstm Autoencoder    0.9494        0.0     0.0       0.0      0.0
   Deep Clustering    0.9494        0.0     0.0       0.0      0.0
Ensemble (cascade)    0.9987        0.0     0.0       0.0      0.0
2025-12-13 01:51:59 - utils - INFO - Ensemble predictions saved
2025-12-13 01:51:59 - utils - INFO - Generating alerts...
2025-12-13 01:51:59 - utils - INFO - Generated 751 alerts
2025-12-13 01:51:59 - utils - INFO - Severity distribution:
severity
low    751
Name: count, dtype: int64
2025-12-13 01:51:59 - utils - INFO - Alerts saved to /Users/bipinrimal/Downloads/Thesis_work/results/alerts.csv
2025-12-13 01:51:59 - utils - INFO - Ensemble pipeline completed!
2025-12-13 01:51:59 - utils - INFO - 
✓ Stage 5 completed. Best performing method: None
2025-12-13 01:51:59 - utils - INFO - 
================================================================================
                             STAGE 6: VISUALIZATION                             
================================================================================

2025-12-13 01:51:59 - utils - INFO - 
================================================================================
                           GENERATING VISUALIZATIONS                            
================================================================================

2025-12-13 01:51:59 - utils - INFO - Creating alert severity distribution plot...
2025-12-13 01:51:59 - utils - INFO - Alert severity distribution plot saved
2025-12-13 01:51:59 - utils - INFO - Creating model agreement plot...
2025-12-13 01:51:59 - utils - INFO - Model agreement plot saved
2025-12-13 01:51:59 - utils - INFO - Creating anomaly score timeline for ensemble_weighted...
2025-12-13 01:51:59 - utils - INFO - Anomaly score timeline saved for ensemble_weighted
2025-12-13 01:51:59 - utils - INFO - Creating feature importance visualization...
2025-12-13 01:51:59 - utils - INFO - Feature importance heatmap saved
2025-12-13 01:51:59 - utils - INFO - Creating executive summary chart...
2025-12-13 01:52:00 - utils - INFO - Executive summary chart saved
2025-12-13 01:52:00 - utils - INFO - All visualizations saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations
2025-12-13 01:52:00 - utils - INFO - Visualization generation completed!
2025-12-13 01:52:00 - utils - INFO - ✓ Stage 6 completed: All visualizations generated
2025-12-13 01:52:00 - utils - INFO - 
================================================================================
2025-12-13 01:52:00 - utils - INFO - FINAL SUMMARY
2025-12-13 01:52:00 - utils - INFO - ================================================================================
2025-12-13 01:52:00 - utils - INFO - 
Model Performance (on labeled validation set):
2025-12-13 01:52:00 - utils - INFO - 
Isolation Forest:
2025-12-13 01:52:00 - utils - WARNING -   No metrics available (unsupervised execution).
2025-12-13 01:52:00 - utils - INFO - 
Lstm Autoencoder:
2025-12-13 01:52:00 - utils - WARNING -   No metrics available (unsupervised execution).
2025-12-13 01:52:00 - utils - INFO - 
Deep Clustering:
2025-12-13 01:52:00 - utils - WARNING -   No metrics available (unsupervised execution).
2025-12-13 01:52:00 - utils - INFO - 
Generated Output Locations:
2025-12-13 01:52:00 - utils - INFO -   - Processed Data: /Users/bipinrimal/Downloads/Thesis_work/data/processed
2025-12-13 01:52:00 - utils - INFO -   - Trained Models: /Users/bipinrimal/Downloads/Thesis_work/models
2025-12-13 01:52:00 - utils - INFO -   - Alert Logs:     /Users/bipinrimal/Downloads/Thesis_work/results/alerts.csv
2025-12-13 01:52:00 - utils - INFO -   - Logs:           /Users/bipinrimal/Downloads/Thesis_work/logs/insider_threat_detection.log
2025-12-13 01:52:00 - utils - INFO - 
================================================================================
2025-12-13 01:52:00 - utils - INFO - ✓ PIPELINE EXECUTION COMPLETED
2025-12-13 01:52:00 - utils - INFO - ================================================================================

2025-12-13 02:00:31 - utils - INFO - Utility functions loaded successfully
2025-12-13 02:00:32 - utils - INFO - ================================================================================
2025-12-13 02:00:32 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-12-13 02:00:32 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-12-13 02:00:32 - utils - INFO - ================================================================================
2025-12-13 02:00:32 - utils - INFO - 
================================================================================
2025-12-13 02:00:32 - utils - INFO - STARTING FULL PIPELINE EXECUTION
2025-12-13 02:00:32 - utils - INFO - ================================================================================

2025-12-13 02:00:32 - utils - INFO - 
================================================================================
                          STAGE 1: DATA PREPROCESSING                           
================================================================================

2025-12-13 02:00:32 - utils - INFO - Processing SUBSET defined in config: ['r1', 'r2', 'r3.1', 'r3.2', 'r4.1']
2025-12-13 02:00:32 - utils - INFO - ✓ Loaded 7 insider users from ground truth
2025-12-13 02:00:32 - utils - INFO -   Insiders: ['RCW0822', 'CCH0959', 'KTW0365', 'ABB0427', 'CSF0929', 'JCE0258', 'HFC0492']
2025-12-13 02:00:32 - utils - INFO - 
================================================================================
                          DATA PREPROCESSING (POLARS)                           
================================================================================

2025-12-13 02:00:32 - utils - INFO - Scanning dataset: r1
2025-12-13 02:00:32 - utils - INFO - Scanning dataset: r2
2025-12-13 02:00:32 - utils - INFO - Scanning dataset: r3.1
2025-12-13 02:00:32 - utils - INFO - Scanning dataset: r3.2
2025-12-13 02:00:32 - utils - INFO - Scanning dataset: r4.1
2025-12-13 02:00:32 - utils - INFO - Constructing execution graph (Diagonal Concat)...
2025-12-13 02:00:32 - utils - INFO - Loaded Psychometric data: 3999 users
2025-12-13 02:00:32 - utils - INFO - Marking records for 7 insider users...
2025-12-13 02:00:32 - utils - INFO - Streaming merged data to /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv...
2025-12-13 02:02:21 - utils - INFO - ✓ Preprocessing complete.
2025-12-13 02:02:21 - utils - INFO -   Insider users labeled: ['RCW0822', 'CCH0959', 'KTW0365', 'ABB0427', 'CSF0929']...
2025-12-13 02:02:21 - utils - INFO - ✓ Stage 1 completed successfully.
2025-12-13 02:02:21 - utils - INFO - 
================================================================================
                          STAGE 2: FEATURE ENGINEERING                          
================================================================================

2025-12-13 02:02:21 - utils - INFO - Starting Feature Engineering Pipeline (Polars Lazy Execution)...
2025-12-13 02:02:21 - utils - INFO - Scanning data from /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv
2025-12-13 02:02:21 - utils - INFO - Constructing execution graph for daily features...
2025-12-13 02:02:21 - utils - INFO - Executing aggregation (Streaming Mode)...
2025-12-13 02:04:09 - utils - INFO - Saved features to: /Users/bipinrimal/Downloads/Thesis_work/data/processed/daily_features.parquet
2025-12-13 02:04:09 - utils - INFO - Creating static features and fitting scaler...
2025-12-13 02:04:09 - utils - INFO - Generated static features for 7999 users
2025-12-13 02:04:09 - utils - INFO - Saved features to: /Users/bipinrimal/Downloads/Thesis_work/data/processed/static_features.csv
2025-12-13 02:04:09 - utils - INFO - Saved static scaler to /Users/bipinrimal/Downloads/Thesis_work/models/static_scaler.pkl
2025-12-13 02:04:09 - utils - INFO - Creating sequences...
2025-12-13 02:04:09 - utils - INFO - Saved features to: /Users/bipinrimal/Downloads/Thesis_work/data/processed/sequence_features.parquet
2025-12-13 02:04:09 - utils - INFO - Processing sequences with length 15...
2025-12-13 02:04:11 - utils - INFO - Generated sequences shape: (2542814, 15, 13)
2025-12-13 02:04:11 - utils - INFO - Generated labels shape: (2542814,)
2025-12-13 02:04:13 - utils - INFO - Saved sequences to /Users/bipinrimal/Downloads/Thesis_work/data/processed/sequences.npy
2025-12-13 02:04:13 - utils - INFO - Saved sequence labels to /Users/bipinrimal/Downloads/Thesis_work/data/processed/sequence_labels.npy
2025-12-13 02:04:13 - utils - INFO - Feature engineering pipeline completed successfully.
2025-12-13 02:04:13 - utils - INFO - ✓ Stage 2 completed: Feature files generated.
2025-12-13 02:04:13 - utils - INFO - 
================================================================================
                            STAGE 3: MODEL TRAINING                             
================================================================================

2025-12-13 02:04:13 - utils - INFO - 
>>> Training Isolation Forest...
2025-12-13 02:04:13 - utils - INFO - 
================================================================================
                 ISOLATION FOREST TRAINING (V2: MULTI-DATASET)                  
================================================================================

2025-12-13 02:04:13 - utils - INFO - Loaded daily features: (2654790, 16)
2025-12-13 02:04:17 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest_model.pkl
2025-12-13 02:04:20 - utils - INFO - Predictions saved to /Users/bipinrimal/Downloads/Thesis_work/results/isolation_forest_predictions.csv
2025-12-13 02:04:20 - utils - INFO - 
============================================================
2025-12-13 02:04:20 - utils - INFO - Isolation Forest Performance Metrics
2025-12-13 02:04:20 - utils - INFO - ============================================================
2025-12-13 02:04:20 - utils - INFO - Accuracy:  0.9115
2025-12-13 02:04:20 - utils - INFO - Precision: 0.0014
2025-12-13 02:04:20 - utils - INFO - Recall:    0.2579
2025-12-13 02:04:20 - utils - INFO - F1-Score:  0.0028
2025-12-13 02:04:20 - utils - INFO - AUC-ROC:   0.5701
2025-12-13 02:04:20 - utils - INFO - ============================================================

2025-12-13 02:04:20 - utils - INFO - ✓ Isolation Forest training completed
2025-12-13 02:04:20 - utils - INFO - 
>>> Training LSTM Autoencoder...
2025-12-13 02:04:20 - utils - INFO - 
================================================================================
                           LSTM AUTOENCODER TRAINING                            
================================================================================

2025-12-13 02:04:22 - utils - INFO - Loaded sequences: (2542814, 15, 13)
2025-12-13 02:04:25 - utils - INFO - Training on 1779165 normal sequences
2025-12-13 02:04:25 - utils - INFO - Model: "functional"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┓
┃ Layer (type)                         ┃ Output Shape                ┃         Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━┩
│ input_layer (InputLayer)             │ (None, 15, 13)              │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ lstm (LSTM)                          │ (None, 15, 32)              │           5,888 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout (Dropout)                    │ (None, 15, 32)              │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ lstm_1 (LSTM)                        │ (None, 16)                  │           3,136 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ repeat_vector (RepeatVector)         │ (None, 15, 16)              │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ lstm_2 (LSTM)                        │ (None, 15, 16)              │           2,112 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout_1 (Dropout)                  │ (None, 15, 16)              │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ lstm_3 (LSTM)                        │ (None, 15, 32)              │           6,272 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ time_distributed (TimeDistributed)   │ (None, 15, 13)              │             429 │
└──────────────────────────────────────┴─────────────────────────────┴─────────────────┘
 Total params: 17,837 (69.68 KB)
 Trainable params: 17,837 (69.68 KB)
 Non-trainable params: 0 (0.00 B)

2025-12-13 02:04:25 - utils - INFO - Starting training for 20 epoch(s)...
2025-12-13 02:14:45 - utils - INFO - Evaluating on Test Set...
2025-12-13 02:14:59 - utils - INFO - Predictions saved to /Users/bipinrimal/Downloads/Thesis_work/results/lstm_autoencoder_predictions.csv
2025-12-13 02:14:59 - utils - INFO - 
============================================================
2025-12-13 02:14:59 - utils - INFO - LSTM Autoencoder Performance Metrics
2025-12-13 02:14:59 - utils - INFO - ============================================================
2025-12-13 02:14:59 - utils - INFO - Accuracy:  0.9498
2025-12-13 02:14:59 - utils - INFO - Precision: 0.0032
2025-12-13 02:14:59 - utils - INFO - Recall:    0.3262
2025-12-13 02:14:59 - utils - INFO - F1-Score:  0.0063
2025-12-13 02:14:59 - utils - INFO - AUC-ROC:   0.6934
2025-12-13 02:14:59 - utils - INFO - ============================================================

2025-12-13 02:14:59 - utils - INFO - ✓ LSTM Autoencoder training completed
2025-12-13 02:14:59 - utils - INFO - 
>>> Training Deep Clustering...
2025-12-13 02:14:59 - utils - INFO - 
================================================================================
                      LIGHTWEIGHT DEEP CLUSTERING TRAINING                      
================================================================================

2025-12-13 02:16:24 - utils - INFO - Predictions saved to /Users/bipinrimal/Downloads/Thesis_work/results/deep_clustering_predictions.csv
2025-12-13 02:16:24 - utils - INFO - 
============================================================
2025-12-13 02:16:24 - utils - INFO - Deep Clustering Performance Metrics
2025-12-13 02:16:24 - utils - INFO - ============================================================
2025-12-13 02:16:24 - utils - INFO - Accuracy:  0.9518
2025-12-13 02:16:24 - utils - INFO - Precision: 0.0021
2025-12-13 02:16:24 - utils - INFO - Recall:    0.2137
2025-12-13 02:16:24 - utils - INFO - F1-Score:  0.0042
2025-12-13 02:16:24 - utils - INFO - AUC-ROC:   0.6152
2025-12-13 02:16:24 - utils - INFO - ============================================================

2025-12-13 02:16:24 - utils - INFO - ✓ Deep Clustering training completed
2025-12-13 02:16:24 - utils - INFO - 
✓ Stage 3 completed: 3 models trained
2025-12-13 02:16:24 - utils - INFO - 
================================================================================
                           STAGE 4: MODEL EVALUATION                            
================================================================================

2025-12-13 02:16:24 - utils - INFO - 
================================================================================
                         COMPREHENSIVE MODEL EVALUATION                         
================================================================================

2025-12-13 02:16:24 - utils - INFO - Loading results for all models...
2025-12-13 02:16:24 - utils - INFO - Loaded results for isolation_forest
2025-12-13 02:16:24 - utils - INFO - Loaded results for lstm_autoencoder
2025-12-13 02:16:25 - utils - INFO - Loaded results for deep_clustering
2025-12-13 02:16:25 - utils - INFO - Loaded results for 3 models
2025-12-13 02:16:25 - utils - INFO - Creating metrics comparison table...
2025-12-13 02:16:25 - utils - INFO - Metrics comparison table created
2025-12-13 02:16:25 - utils - INFO - Creating confusion matrix plots...
2025-12-13 02:16:25 - utils - INFO - Confusion matrices saved to /Users/bipinrimal/Downloads/Thesis_work/results/confusion_matrices/all_models.png
2025-12-13 02:16:25 - utils - INFO - Creating ROC curves...
2025-12-13 02:16:26 - utils - INFO - ROC curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/roc_curves/roc_comparison.png
2025-12-13 02:16:26 - utils - INFO - Creating Precision-Recall curves...
2025-12-13 02:16:26 - utils - INFO - Precision-Recall curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/precision_recall_comparison.png
2025-12-13 02:16:26 - utils - INFO - Creating metrics comparison bar chart...
2025-12-13 02:16:26 - utils - INFO - Metrics comparison bar chart saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/metrics_comparison_bar.png
2025-12-13 02:16:26 - utils - INFO - Creating anomaly score distribution plots...
2025-12-13 02:16:26 - utils - INFO - Score distributions saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/score_distributions.png
2025-12-13 02:16:26 - utils - INFO - Generating evaluation report...
2025-12-13 02:16:26 - utils - INFO - Evaluation report saved to /Users/bipinrimal/Downloads/Thesis_work/results/evaluation_report.txt
2025-12-13 02:16:26 - utils - INFO - Comprehensive evaluation completed!
2025-12-13 02:16:26 - utils - INFO - ✓ Stage 4 completed: Comprehensive evaluation report generated
2025-12-13 02:16:26 - utils - INFO - 
================================================================================
                         STAGE 5: ENSEMBLE INTEGRATION                          
================================================================================

2025-12-13 02:16:26 - utils - INFO - Testing ensemble method: weighted
2025-12-13 02:16:26 - utils - INFO - Initialized Ensemble Detector with method: weighted
2025-12-13 02:16:26 - utils - INFO - 
================================================================================
                            ENSEMBLE SYSTEM PIPELINE                            
================================================================================

2025-12-13 02:16:26 - utils - INFO - Loading predictions from individual models...
2025-12-13 02:16:27 - utils - INFO - Loaded isolation_forest predictions: 2654790 samples
2025-12-13 02:16:27 - utils - INFO - Loaded lstm_autoencoder predictions: 381423 samples
2025-12-13 02:16:27 - utils - INFO - Loaded deep_clustering predictions: 2654790 samples
2025-12-13 02:16:27 - utils - WARNING - Models have different sample counts: {'isolation_forest': 2654790, 'lstm_autoencoder': 381423, 'deep_clustering': 2654790}
2025-12-13 02:16:27 - utils - INFO - Will use aggregation strategy to align predictions...
2025-12-13 02:16:27 - utils - INFO - Aligning predictions across models...
2025-12-13 02:16:27 - utils - INFO - Using lstm_autoencoder as reference (381423 samples)
2025-12-13 02:16:27 - utils - INFO - Aggregating isolation_forest from 2654790 to 381423 samples
2025-12-13 02:16:27 - utils - INFO - Aggregating deep_clustering from 2654790 to 381423 samples
2025-12-13 02:16:27 - utils - INFO - Predictions aligned successfully
2025-12-13 02:16:27 - utils - INFO - Loaded predictions from 3 models
2025-12-13 02:16:27 - utils - INFO - Computing weighted ensemble...
2025-12-13 02:16:27 - utils - INFO - Weighted ensemble: 2660 anomalies detected
2025-12-13 02:16:27 - utils - INFO - Evaluating ensemble performance...
2025-12-13 02:16:27 - utils - INFO - 
============================================================
2025-12-13 02:16:27 - utils - INFO - Ensemble (weighted) Performance Metrics
2025-12-13 02:16:27 - utils - INFO - ============================================================
2025-12-13 02:16:27 - utils - INFO - Accuracy:  0.9926
2025-12-13 02:16:27 - utils - INFO - Precision: 0.0004
2025-12-13 02:16:27 - utils - INFO - Recall:    0.0055
2025-12-13 02:16:27 - utils - INFO - F1-Score:  0.0007
2025-12-13 02:16:27 - utils - INFO - AUC-ROC:   0.5603
2025-12-13 02:16:27 - utils - INFO - ============================================================

2025-12-13 02:16:27 - utils - INFO - Comparing ensemble with individual models...
2025-12-13 02:16:27 - utils - INFO - Evaluating ensemble performance...
2025-12-13 02:16:28 - utils - INFO - 
============================================================
2025-12-13 02:16:28 - utils - INFO - Ensemble (weighted) Performance Metrics
2025-12-13 02:16:28 - utils - INFO - ============================================================
2025-12-13 02:16:28 - utils - INFO - Accuracy:  0.9926
2025-12-13 02:16:28 - utils - INFO - Precision: 0.0004
2025-12-13 02:16:28 - utils - INFO - Recall:    0.0055
2025-12-13 02:16:28 - utils - INFO - F1-Score:  0.0007
2025-12-13 02:16:28 - utils - INFO - AUC-ROC:   0.5603
2025-12-13 02:16:28 - utils - INFO - ============================================================

2025-12-13 02:16:28 - utils - INFO - 
Comparison Results:
2025-12-13 02:16:28 - utils - INFO - 
              model  accuracy  precision  recall  f1_score  auc_roc
   Isolation Forest    0.9109     0.0014  0.2541    0.0027   0.5511
   Lstm Autoencoder    0.9496     0.0005  0.0552    0.0010   0.5165
    Deep Clustering    0.9515     0.0017  0.1713    0.0033   0.5947
Ensemble (weighted)    0.9926     0.0004  0.0055    0.0007   0.5603
2025-12-13 02:16:28 - utils - INFO - Ensemble predictions saved
2025-12-13 02:16:28 - utils - INFO - Generating alerts...
2025-12-13 02:16:28 - utils - INFO - Generated 2660 alerts
2025-12-13 02:16:28 - utils - INFO - Severity distribution:
severity
low         1669
medium       718
high         237
critical      36
Name: count, dtype: int64
2025-12-13 02:16:28 - utils - INFO - Alerts saved to /Users/bipinrimal/Downloads/Thesis_work/results/alerts.csv
2025-12-13 02:16:28 - utils - INFO - Ensemble pipeline completed!
2025-12-13 02:16:28 - utils - INFO - Testing ensemble method: majority
2025-12-13 02:16:28 - utils - INFO - Initialized Ensemble Detector with method: majority
2025-12-13 02:16:28 - utils - INFO - 
================================================================================
                            ENSEMBLE SYSTEM PIPELINE                            
================================================================================

2025-12-13 02:16:28 - utils - INFO - Loading predictions from individual models...
2025-12-13 02:16:28 - utils - INFO - Loaded isolation_forest predictions: 2654790 samples
2025-12-13 02:16:28 - utils - INFO - Loaded lstm_autoencoder predictions: 381423 samples
2025-12-13 02:16:29 - utils - INFO - Loaded deep_clustering predictions: 2654790 samples
2025-12-13 02:16:29 - utils - WARNING - Models have different sample counts: {'isolation_forest': 2654790, 'lstm_autoencoder': 381423, 'deep_clustering': 2654790}
2025-12-13 02:16:29 - utils - INFO - Will use aggregation strategy to align predictions...
2025-12-13 02:16:29 - utils - INFO - Aligning predictions across models...
2025-12-13 02:16:29 - utils - INFO - Using lstm_autoencoder as reference (381423 samples)
2025-12-13 02:16:29 - utils - INFO - Aggregating isolation_forest from 2654790 to 381423 samples
2025-12-13 02:16:29 - utils - INFO - Aggregating deep_clustering from 2654790 to 381423 samples
2025-12-13 02:16:29 - utils - INFO - Predictions aligned successfully
2025-12-13 02:16:29 - utils - INFO - Loaded predictions from 3 models
2025-12-13 02:16:29 - utils - INFO - Computing majority voting ensemble...
2025-12-13 02:16:29 - utils - INFO - Majority voting: 15422 anomalies detected
2025-12-13 02:16:29 - utils - INFO - Evaluating ensemble performance...
2025-12-13 02:16:29 - utils - INFO - 
============================================================
2025-12-13 02:16:29 - utils - INFO - Ensemble (majority) Performance Metrics
2025-12-13 02:16:29 - utils - INFO - ============================================================
2025-12-13 02:16:29 - utils - INFO - Accuracy:  0.9592
2025-12-13 02:16:29 - utils - INFO - Precision: 0.0017
2025-12-13 02:16:29 - utils - INFO - Recall:    0.1436
2025-12-13 02:16:29 - utils - INFO - F1-Score:  0.0033
2025-12-13 02:16:29 - utils - INFO - AUC-ROC:   0.5671
2025-12-13 02:16:29 - utils - INFO - ============================================================

2025-12-13 02:16:29 - utils - INFO - Comparing ensemble with individual models...
2025-12-13 02:16:29 - utils - INFO - Evaluating ensemble performance...
2025-12-13 02:16:29 - utils - INFO - 
============================================================
2025-12-13 02:16:29 - utils - INFO - Ensemble (majority) Performance Metrics
2025-12-13 02:16:29 - utils - INFO - ============================================================
2025-12-13 02:16:29 - utils - INFO - Accuracy:  0.9592
2025-12-13 02:16:29 - utils - INFO - Precision: 0.0017
2025-12-13 02:16:29 - utils - INFO - Recall:    0.1436
2025-12-13 02:16:29 - utils - INFO - F1-Score:  0.0033
2025-12-13 02:16:29 - utils - INFO - AUC-ROC:   0.5671
2025-12-13 02:16:29 - utils - INFO - ============================================================

2025-12-13 02:16:29 - utils - INFO - 
Comparison Results:
2025-12-13 02:16:29 - utils - INFO - 
              model  accuracy  precision  recall  f1_score  auc_roc
   Isolation Forest    0.9109     0.0014  0.2541    0.0027   0.5511
   Lstm Autoencoder    0.9496     0.0005  0.0552    0.0010   0.5165
    Deep Clustering    0.9515     0.0017  0.1713    0.0033   0.5947
Ensemble (majority)    0.9592     0.0017  0.1436    0.0033   0.5671
2025-12-13 02:16:29 - utils - INFO - Ensemble predictions saved
2025-12-13 02:16:29 - utils - INFO - Generating alerts...
2025-12-13 02:16:29 - utils - INFO - Generated 976 alerts
2025-12-13 02:16:29 - utils - INFO - Severity distribution:
severity
low         713
medium      167
high         74
critical     22
Name: count, dtype: int64
2025-12-13 02:16:29 - utils - INFO - Alerts saved to /Users/bipinrimal/Downloads/Thesis_work/results/alerts.csv
2025-12-13 02:16:29 - utils - INFO - Ensemble pipeline completed!
2025-12-13 02:16:29 - utils - INFO - Testing ensemble method: cascade
2025-12-13 02:16:29 - utils - INFO - Initialized Ensemble Detector with method: cascade
2025-12-13 02:16:29 - utils - INFO - 
================================================================================
                            ENSEMBLE SYSTEM PIPELINE                            
================================================================================

2025-12-13 02:16:29 - utils - INFO - Loading predictions from individual models...
2025-12-13 02:16:30 - utils - INFO - Loaded isolation_forest predictions: 2654790 samples
2025-12-13 02:16:30 - utils - INFO - Loaded lstm_autoencoder predictions: 381423 samples
2025-12-13 02:16:30 - utils - INFO - Loaded deep_clustering predictions: 2654790 samples
2025-12-13 02:16:30 - utils - WARNING - Models have different sample counts: {'isolation_forest': 2654790, 'lstm_autoencoder': 381423, 'deep_clustering': 2654790}
2025-12-13 02:16:30 - utils - INFO - Will use aggregation strategy to align predictions...
2025-12-13 02:16:30 - utils - INFO - Aligning predictions across models...
2025-12-13 02:16:30 - utils - INFO - Using lstm_autoencoder as reference (381423 samples)
2025-12-13 02:16:30 - utils - INFO - Aggregating isolation_forest from 2654790 to 381423 samples
2025-12-13 02:16:30 - utils - INFO - Aggregating deep_clustering from 2654790 to 381423 samples
2025-12-13 02:16:30 - utils - INFO - Predictions aligned successfully
2025-12-13 02:16:30 - utils - INFO - Loaded predictions from 3 models
2025-12-13 02:16:30 - utils - INFO - Computing cascade ensemble...
2025-12-13 02:16:30 - utils - INFO - Cascade ensemble: 736 anomalies detected
2025-12-13 02:16:30 - utils - INFO - Evaluating ensemble performance...
2025-12-13 02:16:30 - utils - INFO - 
============================================================
2025-12-13 02:16:30 - utils - INFO - Ensemble (cascade) Performance Metrics
2025-12-13 02:16:30 - utils - INFO - ============================================================
2025-12-13 02:16:30 - utils - INFO - Accuracy:  0.9976
2025-12-13 02:16:30 - utils - INFO - Precision: 0.0014
2025-12-13 02:16:30 - utils - INFO - Recall:    0.0055
2025-12-13 02:16:30 - utils - INFO - F1-Score:  0.0022
2025-12-13 02:16:30 - utils - INFO - AUC-ROC:   0.5194
2025-12-13 02:16:30 - utils - INFO - ============================================================

2025-12-13 02:16:30 - utils - INFO - Comparing ensemble with individual models...
2025-12-13 02:16:30 - utils - INFO - Evaluating ensemble performance...
2025-12-13 02:16:30 - utils - INFO - 
============================================================
2025-12-13 02:16:30 - utils - INFO - Ensemble (cascade) Performance Metrics
2025-12-13 02:16:30 - utils - INFO - ============================================================
2025-12-13 02:16:30 - utils - INFO - Accuracy:  0.9976
2025-12-13 02:16:30 - utils - INFO - Precision: 0.0014
2025-12-13 02:16:30 - utils - INFO - Recall:    0.0055
2025-12-13 02:16:30 - utils - INFO - F1-Score:  0.0022
2025-12-13 02:16:30 - utils - INFO - AUC-ROC:   0.5194
2025-12-13 02:16:30 - utils - INFO - ============================================================

2025-12-13 02:16:30 - utils - INFO - 
Comparison Results:
2025-12-13 02:16:30 - utils - INFO - 
             model  accuracy  precision  recall  f1_score  auc_roc
  Isolation Forest    0.9109     0.0014  0.2541    0.0027   0.5511
  Lstm Autoencoder    0.9496     0.0005  0.0552    0.0010   0.5165
   Deep Clustering    0.9515     0.0017  0.1713    0.0033   0.5947
Ensemble (cascade)    0.9976     0.0014  0.0055    0.0022   0.5194
2025-12-13 02:16:31 - utils - INFO - Ensemble predictions saved
2025-12-13 02:16:31 - utils - INFO - Generating alerts...
2025-12-13 02:16:31 - utils - INFO - Generated 16993 alerts
2025-12-13 02:16:31 - utils - INFO - Severity distribution:
severity
low         13156
medium       2266
high         1297
critical      274
Name: count, dtype: int64
2025-12-13 02:16:31 - utils - INFO - Alerts saved to /Users/bipinrimal/Downloads/Thesis_work/results/alerts.csv
2025-12-13 02:16:31 - utils - INFO - Ensemble pipeline completed!
2025-12-13 02:16:31 - utils - INFO - 
✓ Stage 5 completed. Best performing method: majority
2025-12-13 02:16:31 - utils - INFO - 
================================================================================
                             STAGE 6: VISUALIZATION                             
================================================================================

2025-12-13 02:16:31 - utils - INFO - 
================================================================================
                           GENERATING VISUALIZATIONS                            
================================================================================

2025-12-13 02:16:31 - utils - INFO - Creating alert severity distribution plot...
2025-12-13 02:16:31 - utils - INFO - Alert severity distribution plot saved
2025-12-13 02:16:31 - utils - INFO - Creating model agreement plot...
2025-12-13 02:16:31 - utils - INFO - Model agreement plot saved
2025-12-13 02:16:31 - utils - INFO - Creating anomaly score timeline for ensemble_weighted...
2025-12-13 02:16:32 - utils - INFO - Anomaly score timeline saved for ensemble_weighted
2025-12-13 02:16:32 - utils - INFO - Creating feature importance visualization...
2025-12-13 02:16:32 - utils - INFO - Feature importance heatmap saved
2025-12-13 02:16:32 - utils - INFO - Creating executive summary chart...
2025-12-13 02:16:33 - utils - INFO - Executive summary chart saved
2025-12-13 02:16:33 - utils - INFO - All visualizations saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations
2025-12-13 02:16:33 - utils - INFO - Visualization generation completed!
2025-12-13 02:16:33 - utils - INFO - ✓ Stage 6 completed: All visualizations generated
2025-12-13 02:16:33 - utils - INFO - 
================================================================================
2025-12-13 02:16:33 - utils - INFO - FINAL SUMMARY
2025-12-13 02:16:33 - utils - INFO - ================================================================================
2025-12-13 02:16:33 - utils - INFO - 
Model Performance (on labeled validation set):
2025-12-13 02:16:33 - utils - INFO - 
Isolation Forest:
2025-12-13 02:16:33 - utils - WARNING -   No metrics available (unsupervised execution).
2025-12-13 02:16:33 - utils - INFO - 
Lstm Autoencoder:
2025-12-13 02:16:33 - utils - WARNING -   No metrics available (unsupervised execution).
2025-12-13 02:16:33 - utils - INFO - 
Deep Clustering:
2025-12-13 02:16:33 - utils - WARNING -   No metrics available (unsupervised execution).
2025-12-13 02:16:33 - utils - INFO - 
Generated Output Locations:
2025-12-13 02:16:33 - utils - INFO -   - Processed Data: /Users/bipinrimal/Downloads/Thesis_work/data/processed
2025-12-13 02:16:33 - utils - INFO -   - Trained Models: /Users/bipinrimal/Downloads/Thesis_work/models
2025-12-13 02:16:33 - utils - INFO -   - Alert Logs:     /Users/bipinrimal/Downloads/Thesis_work/results/alerts.csv
2025-12-13 02:16:33 - utils - INFO -   - Logs:           /Users/bipinrimal/Downloads/Thesis_work/logs/insider_threat_detection.log
2025-12-13 02:16:33 - utils - INFO - 
================================================================================
2025-12-13 02:16:33 - utils - INFO - ✓ PIPELINE EXECUTION COMPLETED
2025-12-13 02:16:33 - utils - INFO - ================================================================================

2025-12-13 02:20:23 - utils - INFO - Utility functions loaded successfully
2025-12-13 02:20:23 - utils - INFO - ================================================================================
2025-12-13 02:20:23 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-12-13 02:20:23 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-12-13 02:20:23 - utils - INFO - ================================================================================
2025-12-13 02:20:23 - utils - INFO - 
================================================================================
2025-12-13 02:20:23 - utils - INFO - STARTING FULL PIPELINE EXECUTION
2025-12-13 02:20:23 - utils - INFO - ================================================================================

2025-12-13 02:20:23 - utils - INFO - 
================================================================================
                          STAGE 1: DATA PREPROCESSING                           
================================================================================

2025-12-13 02:20:23 - utils - INFO - Processing SUBSET defined in config: ['r1', 'r2', 'r3.1', 'r3.2', 'r4.1']
2025-12-13 02:20:23 - utils - INFO - ✓ Loaded 7 insider users from ground truth
2025-12-13 02:20:23 - utils - INFO -   Insiders: ['RCW0822', 'CCH0959', 'JCE0258', 'HFC0492', 'ABB0427', 'KTW0365', 'CSF0929']
2025-12-13 02:20:23 - utils - INFO -   Total malicious time windows: 7
2025-12-13 02:20:23 - utils - INFO - 
================================================================================
                          DATA PREPROCESSING (POLARS)                           
================================================================================

2025-12-13 02:20:23 - utils - INFO - Scanning dataset: r1
2025-12-13 02:20:23 - utils - INFO - Scanning dataset: r2
2025-12-13 02:20:23 - utils - INFO - Scanning dataset: r3.1
2025-12-13 02:20:23 - utils - INFO - Scanning dataset: r3.2
2025-12-13 02:20:23 - utils - INFO - Scanning dataset: r4.1
2025-12-13 02:20:23 - utils - INFO - Constructing execution graph (Diagonal Concat)...
2025-12-13 02:20:23 - utils - INFO - Loaded Psychometric data: 3999 users
2025-12-13 02:20:23 - utils - INFO - Created insider windows DataFrame with 7 entries
2025-12-13 02:20:23 - utils - INFO - Applying time-window based insider labeling...
2025-12-13 02:20:23 - utils - INFO - Collecting data for time-window labeling (this may take a while)...
2025-12-13 02:22:28 - utils - INFO - ✓ Labeled 20,812 records as insider (0.0202% of 103,242,062 total)
2025-12-13 02:22:28 - utils - INFO - Streaming merged data to /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv...
2025-12-13 02:26:30 - utils - INFO - ✓ Preprocessing complete.
2025-12-13 02:26:30 - utils - INFO -   Insider users labeled: ['RCW0822', 'CCH0959', 'JCE0258', 'HFC0492', 'ABB0427']...
2025-12-13 02:26:33 - utils - INFO - ✓ Stage 1 completed successfully.
2025-12-13 02:26:33 - utils - INFO - 
================================================================================
                          STAGE 2: FEATURE ENGINEERING                          
================================================================================

2025-12-13 02:26:33 - utils - INFO - Starting Feature Engineering Pipeline (Polars Lazy Execution)...
2025-12-13 02:26:33 - utils - INFO - Scanning data from /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv
2025-12-13 02:26:33 - utils - INFO - Constructing execution graph for daily features...
2025-12-13 02:26:33 - utils - INFO - Executing aggregation (Streaming Mode)...
2025-12-13 02:28:37 - utils - INFO - Saved features to: /Users/bipinrimal/Downloads/Thesis_work/data/processed/daily_features.parquet
2025-12-13 02:28:37 - utils - INFO - Creating static features and fitting scaler...
2025-12-13 02:28:37 - utils - INFO - Generated static features for 7999 users
2025-12-13 02:28:37 - utils - INFO - Saved features to: /Users/bipinrimal/Downloads/Thesis_work/data/processed/static_features.csv
2025-12-13 02:28:37 - utils - INFO - Saved static scaler to /Users/bipinrimal/Downloads/Thesis_work/models/static_scaler.pkl
2025-12-13 02:28:37 - utils - INFO - Creating sequences...
2025-12-13 02:28:37 - utils - INFO - Saved features to: /Users/bipinrimal/Downloads/Thesis_work/data/processed/sequence_features.parquet
2025-12-13 02:28:37 - utils - INFO - Processing sequences with length 15...
2025-12-13 02:28:39 - utils - INFO - Generated sequences shape: (2542814, 15, 13)
2025-12-13 02:28:39 - utils - INFO - Generated labels shape: (2542814,)
2025-12-13 02:28:41 - utils - INFO - Saved sequences to /Users/bipinrimal/Downloads/Thesis_work/data/processed/sequences.npy
2025-12-13 02:28:41 - utils - INFO - Saved sequence labels to /Users/bipinrimal/Downloads/Thesis_work/data/processed/sequence_labels.npy
2025-12-13 02:28:41 - utils - INFO - Feature engineering pipeline completed successfully.
2025-12-13 02:28:41 - utils - INFO - ✓ Stage 2 completed: Feature files generated.
2025-12-13 02:28:41 - utils - INFO - 
================================================================================
                            STAGE 3: MODEL TRAINING                             
================================================================================

2025-12-13 02:28:41 - utils - INFO - 
>>> Training Isolation Forest...
2025-12-13 02:28:41 - utils - INFO - 
================================================================================
                 ISOLATION FOREST TRAINING (V2: MULTI-DATASET)                  
================================================================================

2025-12-13 02:28:42 - utils - INFO - Loaded daily features: (2654790, 16)
2025-12-13 02:28:45 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest_model.pkl
2025-12-13 02:28:48 - utils - INFO - Predictions saved to /Users/bipinrimal/Downloads/Thesis_work/results/isolation_forest_predictions.csv
2025-12-13 02:28:48 - utils - INFO - 
============================================================
2025-12-13 02:28:48 - utils - INFO - Isolation Forest Performance Metrics
2025-12-13 02:28:48 - utils - INFO - ============================================================
2025-12-13 02:28:48 - utils - INFO - Accuracy:  0.9117
2025-12-13 02:28:48 - utils - INFO - Precision: 0.0003
2025-12-13 02:28:48 - utils - INFO - Recall:    0.3975
2025-12-13 02:28:48 - utils - INFO - F1-Score:  0.0005
2025-12-13 02:28:48 - utils - INFO - AUC-ROC:   0.7833
2025-12-13 02:28:48 - utils - INFO - ============================================================

2025-12-13 02:28:48 - utils - INFO - ✓ Isolation Forest training completed
2025-12-13 02:28:48 - utils - INFO - 
>>> Training LSTM Autoencoder...
2025-12-13 02:28:48 - utils - INFO - 
================================================================================
                           LSTM AUTOENCODER TRAINING                            
================================================================================

2025-12-13 02:28:49 - utils - INFO - Loaded sequences: (2542814, 15, 13)
2025-12-13 02:28:51 - utils - INFO - Training on 1779864 normal sequences
2025-12-13 02:28:52 - utils - INFO - Model: "functional"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┓
┃ Layer (type)                         ┃ Output Shape                ┃         Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━┩
│ input_layer (InputLayer)             │ (None, 15, 13)              │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ lstm (LSTM)                          │ (None, 15, 32)              │           5,888 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout (Dropout)                    │ (None, 15, 32)              │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ lstm_1 (LSTM)                        │ (None, 16)                  │           3,136 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ repeat_vector (RepeatVector)         │ (None, 15, 16)              │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ lstm_2 (LSTM)                        │ (None, 15, 16)              │           2,112 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout_1 (Dropout)                  │ (None, 15, 16)              │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ lstm_3 (LSTM)                        │ (None, 15, 32)              │           6,272 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ time_distributed (TimeDistributed)   │ (None, 15, 13)              │             429 │
└──────────────────────────────────────┴─────────────────────────────┴─────────────────┘
 Total params: 17,837 (69.68 KB)
 Trainable params: 17,837 (69.68 KB)
 Non-trainable params: 0 (0.00 B)

2025-12-13 02:28:52 - utils - INFO - Starting training for 20 epoch(s)...
2025-12-13 02:40:28 - utils - INFO - Evaluating on Test Set...
2025-12-13 02:40:42 - utils - INFO - Predictions saved to /Users/bipinrimal/Downloads/Thesis_work/results/lstm_autoencoder_predictions.csv
2025-12-13 02:40:42 - utils - INFO - 
============================================================
2025-12-13 02:40:42 - utils - INFO - LSTM Autoencoder Performance Metrics
2025-12-13 02:40:42 - utils - INFO - ============================================================
2025-12-13 02:40:42 - utils - INFO - Accuracy:  0.9500
2025-12-13 02:40:42 - utils - INFO - Precision: 0.0006
2025-12-13 02:40:42 - utils - INFO - Recall:    0.5217
2025-12-13 02:40:42 - utils - INFO - F1-Score:  0.0013
2025-12-13 02:40:42 - utils - INFO - AUC-ROC:   0.8806
2025-12-13 02:40:42 - utils - INFO - ============================================================

2025-12-13 02:40:42 - utils - INFO - ✓ LSTM Autoencoder training completed
2025-12-13 02:40:42 - utils - INFO - 
>>> Training Deep Clustering...
2025-12-13 02:40:42 - utils - INFO - 
================================================================================
                      LIGHTWEIGHT DEEP CLUSTERING TRAINING                      
================================================================================

2025-12-13 02:42:06 - utils - INFO - Predictions saved to /Users/bipinrimal/Downloads/Thesis_work/results/deep_clustering_predictions.csv
2025-12-13 02:42:07 - utils - INFO - 
============================================================
2025-12-13 02:42:07 - utils - INFO - Deep Clustering Performance Metrics
2025-12-13 02:42:07 - utils - INFO - ============================================================
2025-12-13 02:42:07 - utils - INFO - Accuracy:  0.9501
2025-12-13 02:42:07 - utils - INFO - Precision: 0.0005
2025-12-13 02:42:07 - utils - INFO - Recall:    0.3975
2025-12-13 02:42:07 - utils - INFO - F1-Score:  0.0010
2025-12-13 02:42:07 - utils - INFO - AUC-ROC:   0.8003
2025-12-13 02:42:07 - utils - INFO - ============================================================

2025-12-13 02:42:07 - utils - INFO - ✓ Deep Clustering training completed
2025-12-13 02:42:07 - utils - INFO - 
✓ Stage 3 completed: 3 models trained
2025-12-13 02:42:07 - utils - INFO - 
================================================================================
                           STAGE 4: MODEL EVALUATION                            
================================================================================

2025-12-13 02:42:07 - utils - INFO - 
================================================================================
                         COMPREHENSIVE MODEL EVALUATION                         
================================================================================

2025-12-13 02:42:07 - utils - INFO - Loading results for all models...
2025-12-13 02:42:07 - utils - INFO - Loaded results for isolation_forest
2025-12-13 02:42:07 - utils - INFO - Loaded results for lstm_autoencoder
2025-12-13 02:42:07 - utils - INFO - Loaded results for deep_clustering
2025-12-13 02:42:07 - utils - INFO - Loaded results for 3 models
2025-12-13 02:42:07 - utils - INFO - Creating metrics comparison table...
2025-12-13 02:42:07 - utils - INFO - Metrics comparison table created
2025-12-13 02:42:07 - utils - INFO - Creating confusion matrix plots...
2025-12-13 02:42:08 - utils - INFO - Confusion matrices saved to /Users/bipinrimal/Downloads/Thesis_work/results/confusion_matrices/all_models.png
2025-12-13 02:42:08 - utils - INFO - Creating ROC curves...
2025-12-13 02:42:08 - utils - INFO - ROC curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/roc_curves/roc_comparison.png
2025-12-13 02:42:08 - utils - INFO - Creating Precision-Recall curves...
2025-12-13 02:42:09 - utils - INFO - Precision-Recall curves saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/precision_recall_comparison.png
2025-12-13 02:42:09 - utils - INFO - Creating metrics comparison bar chart...
2025-12-13 02:42:09 - utils - INFO - Metrics comparison bar chart saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/metrics_comparison_bar.png
2025-12-13 02:42:09 - utils - INFO - Creating anomaly score distribution plots...
2025-12-13 02:42:09 - utils - INFO - Score distributions saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations/score_distributions.png
2025-12-13 02:42:09 - utils - INFO - Generating evaluation report...
2025-12-13 02:42:09 - utils - INFO - Evaluation report saved to /Users/bipinrimal/Downloads/Thesis_work/results/evaluation_report.txt
2025-12-13 02:42:09 - utils - INFO - Comprehensive evaluation completed!
2025-12-13 02:42:09 - utils - INFO - ✓ Stage 4 completed: Comprehensive evaluation report generated
2025-12-13 02:42:09 - utils - INFO - 
================================================================================
                         STAGE 5: ENSEMBLE INTEGRATION                          
================================================================================

2025-12-13 02:42:09 - utils - INFO - Testing ensemble method: weighted
2025-12-13 02:42:09 - utils - INFO - Initialized Ensemble Detector with method: weighted
2025-12-13 02:42:09 - utils - INFO - 
================================================================================
                            ENSEMBLE SYSTEM PIPELINE                            
================================================================================

2025-12-13 02:42:09 - utils - INFO - Loading predictions from individual models...
2025-12-13 02:42:09 - utils - INFO - Loaded isolation_forest predictions: 2654790 samples
2025-12-13 02:42:09 - utils - INFO - Loaded lstm_autoencoder predictions: 381423 samples
2025-12-13 02:42:10 - utils - INFO - Loaded deep_clustering predictions: 2654790 samples
2025-12-13 02:42:10 - utils - WARNING - Models have different sample counts: {'isolation_forest': 2654790, 'lstm_autoencoder': 381423, 'deep_clustering': 2654790}
2025-12-13 02:42:10 - utils - INFO - Will use aggregation strategy to align predictions...
2025-12-13 02:42:10 - utils - INFO - Aligning predictions across models...
2025-12-13 02:42:10 - utils - INFO - Using lstm_autoencoder as reference (381423 samples)
2025-12-13 02:42:10 - utils - INFO - Aggregating isolation_forest from 2654790 to 381423 samples
2025-12-13 02:42:10 - utils - INFO - Aggregating deep_clustering from 2654790 to 381423 samples
2025-12-13 02:42:10 - utils - INFO - Predictions aligned successfully
2025-12-13 02:42:10 - utils - INFO - Loaded predictions from 3 models
2025-12-13 02:42:10 - utils - INFO - Computing weighted ensemble...
2025-12-13 02:42:10 - utils - INFO - Weighted ensemble: 2080 anomalies detected
2025-12-13 02:42:10 - utils - INFO - Evaluating ensemble performance...
2025-12-13 02:42:10 - utils - INFO - 
============================================================
2025-12-13 02:42:10 - utils - INFO - Ensemble (weighted) Performance Metrics
2025-12-13 02:42:10 - utils - INFO - ============================================================
2025-12-13 02:42:10 - utils - INFO - Accuracy:  0.9945
2025-12-13 02:42:10 - utils - INFO - Precision: 0.0000
2025-12-13 02:42:10 - utils - INFO - Recall:    0.0000
2025-12-13 02:42:10 - utils - INFO - F1-Score:  0.0000
2025-12-13 02:42:10 - utils - INFO - AUC-ROC:   0.6849
2025-12-13 02:42:10 - utils - INFO - ============================================================

2025-12-13 02:42:10 - utils - INFO - Comparing ensemble with individual models...
2025-12-13 02:42:10 - utils - INFO - Evaluating ensemble performance...
2025-12-13 02:42:10 - utils - INFO - 
============================================================
2025-12-13 02:42:10 - utils - INFO - Ensemble (weighted) Performance Metrics
2025-12-13 02:42:10 - utils - INFO - ============================================================
2025-12-13 02:42:10 - utils - INFO - Accuracy:  0.9945
2025-12-13 02:42:10 - utils - INFO - Precision: 0.0000
2025-12-13 02:42:10 - utils - INFO - Recall:    0.0000
2025-12-13 02:42:10 - utils - INFO - F1-Score:  0.0000
2025-12-13 02:42:10 - utils - INFO - AUC-ROC:   0.6849
2025-12-13 02:42:10 - utils - INFO - ============================================================

2025-12-13 02:42:10 - utils - INFO - 
Comparison Results:
2025-12-13 02:42:10 - utils - INFO - 
              model  accuracy  precision  recall  f1_score  auc_roc
   Isolation Forest    0.9111     0.0002  0.3333    0.0005   0.7088
   Lstm Autoencoder    0.9499     0.0001  0.0417    0.0001   0.6069
    Deep Clustering    0.9500     0.0004  0.2917    0.0007   0.7400
Ensemble (weighted)    0.9945     0.0000  0.0000    0.0000   0.6849
2025-12-13 02:42:10 - utils - INFO - Ensemble predictions saved
2025-12-13 02:42:10 - utils - INFO - Generating alerts...
2025-12-13 02:42:10 - utils - INFO - Generated 2080 alerts
2025-12-13 02:42:10 - utils - INFO - Severity distribution:
severity
low         1387
medium       497
high         164
critical      32
Name: count, dtype: int64
2025-12-13 02:42:10 - utils - INFO - Alerts saved to /Users/bipinrimal/Downloads/Thesis_work/results/alerts.csv
2025-12-13 02:42:10 - utils - INFO - Ensemble pipeline completed!
2025-12-13 02:42:10 - utils - INFO - Testing ensemble method: majority
2025-12-13 02:42:10 - utils - INFO - Initialized Ensemble Detector with method: majority
2025-12-13 02:42:10 - utils - INFO - 
================================================================================
                            ENSEMBLE SYSTEM PIPELINE                            
================================================================================

2025-12-13 02:42:10 - utils - INFO - Loading predictions from individual models...
2025-12-13 02:42:11 - utils - INFO - Loaded isolation_forest predictions: 2654790 samples
2025-12-13 02:42:11 - utils - INFO - Loaded lstm_autoencoder predictions: 381423 samples
2025-12-13 02:42:11 - utils - INFO - Loaded deep_clustering predictions: 2654790 samples
2025-12-13 02:42:11 - utils - WARNING - Models have different sample counts: {'isolation_forest': 2654790, 'lstm_autoencoder': 381423, 'deep_clustering': 2654790}
2025-12-13 02:42:11 - utils - INFO - Will use aggregation strategy to align predictions...
2025-12-13 02:42:11 - utils - INFO - Aligning predictions across models...
2025-12-13 02:42:11 - utils - INFO - Using lstm_autoencoder as reference (381423 samples)
2025-12-13 02:42:11 - utils - INFO - Aggregating isolation_forest from 2654790 to 381423 samples
2025-12-13 02:42:11 - utils - INFO - Aggregating deep_clustering from 2654790 to 381423 samples
2025-12-13 02:42:11 - utils - INFO - Predictions aligned successfully
2025-12-13 02:42:11 - utils - INFO - Loaded predictions from 3 models
2025-12-13 02:42:11 - utils - INFO - Computing majority voting ensemble...
2025-12-13 02:42:11 - utils - INFO - Majority voting: 16047 anomalies detected
2025-12-13 02:42:11 - utils - INFO - Evaluating ensemble performance...
2025-12-13 02:42:11 - utils - INFO - 
============================================================
2025-12-13 02:42:11 - utils - INFO - Ensemble (majority) Performance Metrics
2025-12-13 02:42:11 - utils - INFO - ============================================================
2025-12-13 02:42:11 - utils - INFO - Accuracy:  0.9579
2025-12-13 02:42:11 - utils - INFO - Precision: 0.0003
2025-12-13 02:42:11 - utils - INFO - Recall:    0.2083
2025-12-13 02:42:11 - utils - INFO - F1-Score:  0.0006
2025-12-13 02:42:11 - utils - INFO - AUC-ROC:   0.7001
2025-12-13 02:42:11 - utils - INFO - ============================================================

2025-12-13 02:42:11 - utils - INFO - Comparing ensemble with individual models...
2025-12-13 02:42:11 - utils - INFO - Evaluating ensemble performance...
2025-12-13 02:42:12 - utils - INFO - 
============================================================
2025-12-13 02:42:12 - utils - INFO - Ensemble (majority) Performance Metrics
2025-12-13 02:42:12 - utils - INFO - ============================================================
2025-12-13 02:42:12 - utils - INFO - Accuracy:  0.9579
2025-12-13 02:42:12 - utils - INFO - Precision: 0.0003
2025-12-13 02:42:12 - utils - INFO - Recall:    0.2083
2025-12-13 02:42:12 - utils - INFO - F1-Score:  0.0006
2025-12-13 02:42:12 - utils - INFO - AUC-ROC:   0.7001
2025-12-13 02:42:12 - utils - INFO - ============================================================

2025-12-13 02:42:12 - utils - INFO - 
Comparison Results:
2025-12-13 02:42:12 - utils - INFO - 
              model  accuracy  precision  recall  f1_score  auc_roc
   Isolation Forest    0.9111     0.0002  0.3333    0.0005   0.7088
   Lstm Autoencoder    0.9499     0.0001  0.0417    0.0001   0.6069
    Deep Clustering    0.9500     0.0004  0.2917    0.0007   0.7400
Ensemble (majority)    0.9579     0.0003  0.2083    0.0006   0.7001
2025-12-13 02:42:12 - utils - INFO - Ensemble predictions saved
2025-12-13 02:42:12 - utils - INFO - Generating alerts...
2025-12-13 02:42:12 - utils - INFO - Generated 689 alerts
2025-12-13 02:42:12 - utils - INFO - Severity distribution:
severity
low         499
medium      123
high         52
critical     15
Name: count, dtype: int64
2025-12-13 02:42:12 - utils - INFO - Alerts saved to /Users/bipinrimal/Downloads/Thesis_work/results/alerts.csv
2025-12-13 02:42:12 - utils - INFO - Ensemble pipeline completed!
2025-12-13 02:42:12 - utils - INFO - Testing ensemble method: cascade
2025-12-13 02:42:12 - utils - INFO - Initialized Ensemble Detector with method: cascade
2025-12-13 02:42:12 - utils - INFO - 
================================================================================
                            ENSEMBLE SYSTEM PIPELINE                            
================================================================================

2025-12-13 02:42:12 - utils - INFO - Loading predictions from individual models...
2025-12-13 02:42:12 - utils - INFO - Loaded isolation_forest predictions: 2654790 samples
2025-12-13 02:42:12 - utils - INFO - Loaded lstm_autoencoder predictions: 381423 samples
2025-12-13 02:42:13 - utils - INFO - Loaded deep_clustering predictions: 2654790 samples
2025-12-13 02:42:13 - utils - WARNING - Models have different sample counts: {'isolation_forest': 2654790, 'lstm_autoencoder': 381423, 'deep_clustering': 2654790}
2025-12-13 02:42:13 - utils - INFO - Will use aggregation strategy to align predictions...
2025-12-13 02:42:13 - utils - INFO - Aligning predictions across models...
2025-12-13 02:42:13 - utils - INFO - Using lstm_autoencoder as reference (381423 samples)
2025-12-13 02:42:13 - utils - INFO - Aggregating isolation_forest from 2654790 to 381423 samples
2025-12-13 02:42:13 - utils - INFO - Aggregating deep_clustering from 2654790 to 381423 samples
2025-12-13 02:42:13 - utils - INFO - Predictions aligned successfully
2025-12-13 02:42:13 - utils - INFO - Loaded predictions from 3 models
2025-12-13 02:42:13 - utils - INFO - Computing cascade ensemble...
2025-12-13 02:42:13 - utils - INFO - Cascade ensemble: 771 anomalies detected
2025-12-13 02:42:13 - utils - INFO - Evaluating ensemble performance...
2025-12-13 02:42:13 - utils - INFO - 
============================================================
2025-12-13 02:42:13 - utils - INFO - Ensemble (cascade) Performance Metrics
2025-12-13 02:42:13 - utils - INFO - ============================================================
2025-12-13 02:42:13 - utils - INFO - Accuracy:  0.9979
2025-12-13 02:42:13 - utils - INFO - Precision: 0.0000
2025-12-13 02:42:13 - utils - INFO - Recall:    0.0000
2025-12-13 02:42:13 - utils - INFO - F1-Score:  0.0000
2025-12-13 02:42:13 - utils - INFO - AUC-ROC:   0.6054
2025-12-13 02:42:13 - utils - INFO - ============================================================

2025-12-13 02:42:13 - utils - INFO - Comparing ensemble with individual models...
2025-12-13 02:42:13 - utils - INFO - Evaluating ensemble performance...
2025-12-13 02:42:13 - utils - INFO - 
============================================================
2025-12-13 02:42:13 - utils - INFO - Ensemble (cascade) Performance Metrics
2025-12-13 02:42:13 - utils - INFO - ============================================================
2025-12-13 02:42:13 - utils - INFO - Accuracy:  0.9979
2025-12-13 02:42:13 - utils - INFO - Precision: 0.0000
2025-12-13 02:42:13 - utils - INFO - Recall:    0.0000
2025-12-13 02:42:13 - utils - INFO - F1-Score:  0.0000
2025-12-13 02:42:13 - utils - INFO - AUC-ROC:   0.6054
2025-12-13 02:42:13 - utils - INFO - ============================================================

2025-12-13 02:42:13 - utils - INFO - 
Comparison Results:
2025-12-13 02:42:13 - utils - INFO - 
             model  accuracy  precision  recall  f1_score  auc_roc
  Isolation Forest    0.9111     0.0002  0.3333    0.0005   0.7088
  Lstm Autoencoder    0.9499     0.0001  0.0417    0.0001   0.6069
   Deep Clustering    0.9500     0.0004  0.2917    0.0007   0.7400
Ensemble (cascade)    0.9979     0.0000  0.0000    0.0000   0.6054
2025-12-13 02:42:13 - utils - INFO - Ensemble predictions saved
2025-12-13 02:42:13 - utils - INFO - Generating alerts...
2025-12-13 02:42:13 - utils - INFO - Generated 16850 alerts
2025-12-13 02:42:13 - utils - INFO - Severity distribution:
severity
low         13691
medium       1933
high         1012
critical      214
Name: count, dtype: int64
2025-12-13 02:42:13 - utils - INFO - Alerts saved to /Users/bipinrimal/Downloads/Thesis_work/results/alerts.csv
2025-12-13 02:42:13 - utils - INFO - Ensemble pipeline completed!
2025-12-13 02:42:13 - utils - INFO - 
✓ Stage 5 completed. Best performing method: majority
2025-12-13 02:42:13 - utils - INFO - 
================================================================================
                             STAGE 6: VISUALIZATION                             
================================================================================

2025-12-13 02:42:13 - utils - INFO - 
================================================================================
                           GENERATING VISUALIZATIONS                            
================================================================================

2025-12-13 02:42:13 - utils - INFO - Creating alert severity distribution plot...
2025-12-13 02:42:13 - utils - INFO - Alert severity distribution plot saved
2025-12-13 02:42:13 - utils - INFO - Creating model agreement plot...
2025-12-13 02:42:13 - utils - INFO - Model agreement plot saved
2025-12-13 02:42:13 - utils - INFO - Creating anomaly score timeline for ensemble_weighted...
2025-12-13 02:42:14 - utils - INFO - Anomaly score timeline saved for ensemble_weighted
2025-12-13 02:42:14 - utils - INFO - Creating feature importance visualization...
2025-12-13 02:42:14 - utils - INFO - Feature importance heatmap saved
2025-12-13 02:42:14 - utils - INFO - Creating executive summary chart...
2025-12-13 02:42:16 - utils - INFO - Executive summary chart saved
2025-12-13 02:42:16 - utils - INFO - All visualizations saved to /Users/bipinrimal/Downloads/Thesis_work/results/visualizations
2025-12-13 02:42:16 - utils - INFO - Visualization generation completed!
2025-12-13 02:42:16 - utils - INFO - ✓ Stage 6 completed: All visualizations generated
2025-12-13 02:42:16 - utils - INFO - 
================================================================================
2025-12-13 02:42:16 - utils - INFO - FINAL SUMMARY
2025-12-13 02:42:16 - utils - INFO - ================================================================================
2025-12-13 02:42:16 - utils - INFO - 
Model Performance (on labeled validation set):
2025-12-13 02:42:16 - utils - INFO - 
Isolation Forest:
2025-12-13 02:42:16 - utils - WARNING -   No metrics available (unsupervised execution).
2025-12-13 02:42:16 - utils - INFO - 
Lstm Autoencoder:
2025-12-13 02:42:16 - utils - WARNING -   No metrics available (unsupervised execution).
2025-12-13 02:42:16 - utils - INFO - 
Deep Clustering:
2025-12-13 02:42:16 - utils - WARNING -   No metrics available (unsupervised execution).
2025-12-13 02:42:16 - utils - INFO - 
Generated Output Locations:
2025-12-13 02:42:16 - utils - INFO -   - Processed Data: /Users/bipinrimal/Downloads/Thesis_work/data/processed
2025-12-13 02:42:16 - utils - INFO -   - Trained Models: /Users/bipinrimal/Downloads/Thesis_work/models
2025-12-13 02:42:16 - utils - INFO -   - Alert Logs:     /Users/bipinrimal/Downloads/Thesis_work/results/alerts.csv
2025-12-13 02:42:16 - utils - INFO -   - Logs:           /Users/bipinrimal/Downloads/Thesis_work/logs/insider_threat_detection.log
2025-12-13 02:42:16 - utils - INFO - 
================================================================================
2025-12-13 02:42:16 - utils - INFO - ✓ PIPELINE EXECUTION COMPLETED
2025-12-13 02:42:16 - utils - INFO - ================================================================================

2025-12-14 23:17:02 - utils - INFO - Utility functions loaded successfully
2025-12-14 23:17:02 - utils - INFO - ================================================================================
2025-12-14 23:17:02 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-12-14 23:17:02 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-12-14 23:17:02 - utils - INFO - ================================================================================
2025-12-14 23:17:02 - utils - INFO - 
================================================================================
2025-12-14 23:17:02 - utils - INFO - STARTING FULL PIPELINE EXECUTION
2025-12-14 23:17:02 - utils - INFO - ================================================================================

2025-12-14 23:17:02 - utils - INFO - 
================================================================================
                          STAGE 1: DATA PREPROCESSING                           
================================================================================

2025-12-14 23:17:02 - utils - INFO - Processing SUBSET defined in config: ['r1', 'r2', 'r3.1', 'r3.2', 'r4.1', 'r5.1', 'r5.2']
2025-12-14 23:17:02 - utils - INFO - ✓ Loaded 110 insider users from ground truth
2025-12-14 23:17:02 - utils - INFO -   Insiders: ['SNK1280', 'NZL1395', 'HSN0675', 'ACA1126', 'ALW0764', 'IHC0561', 'KTW0365', 'OFS0030', 'WCW1013', 'JAL0811']...
2025-12-14 23:17:02 - utils - INFO -   Total malicious time windows: 110
2025-12-14 23:17:02 - utils - INFO - 
================================================================================
                          DATA PREPROCESSING (POLARS)                           
================================================================================

2025-12-14 23:17:02 - utils - INFO - Scanning dataset: r1
2025-12-14 23:17:02 - utils - INFO - Scanning dataset: r2
2025-12-14 23:17:02 - utils - INFO - Scanning dataset: r3.1
2025-12-14 23:17:02 - utils - INFO - Scanning dataset: r3.2
2025-12-14 23:17:02 - utils - INFO - Scanning dataset: r4.1
2025-12-14 23:17:02 - utils - INFO - Scanning dataset: r5.1
2025-12-14 23:17:02 - utils - INFO - Scanning dataset: r5.2
2025-12-14 23:17:02 - utils - INFO - Constructing execution graph (Diagonal Concat)...
2025-12-14 23:17:02 - utils - INFO - Loaded Psychometric data: 7998 users
2025-12-14 23:17:03 - utils - ERROR - ✗ Stage 1 failed: 'union'/'concat' inputs should all have the same schema,got
Schema:
name: id, field: String
name: user_id, field: String
name: pc_id, field: String
name: activity, field: String
name: activity_type, field: String
name: dataset, field: String
name: date, field: Datetime('μs')
name: is_logon, field: Int8
name: is_logoff, field: Int8
name: is_connect, field: Int8
name: is_disconnect, field: Int8
name: url, field: String
name: domain, field: String
name: is_suspicious_domain, field: Int8
name: to, field: String
name: email_size_kb, field: Float64
name: is_large_email, field: Int8
name: has_attachment, field: Int8
name: filename, field: String
name: content, field: String
name: file_extension, field: String
name: is_sensitive_file, field: Int8
name: size, field: Int64
name: attachments, field: Int64
name: cc, field: String
name: bcc, field: String
name: from, field: String
name: file_tree, field: String
name: to_removable_media, field: Boolean
name: from_removable_media, field: Boolean
 and 
Schema:
name: id, field: String
name: user_id, field: String
name: pc_id, field: String
name: activity, field: String
name: activity_type, field: String
name: dataset, field: String
name: date, field: Datetime('μs')
name: is_logon, field: Int8
name: is_logoff, field: Int8
name: is_connect, field: Int8
name: is_disconnect, field: Int8
name: url, field: String
name: domain, field: String
name: is_suspicious_domain, field: Int8
name: to, field: String
name: email_size_kb, field: Float64
name: is_large_email, field: Int8
name: has_attachment, field: Int8
name: filename, field: String
name: content, field: String
name: file_extension, field: String
name: is_sensitive_file, field: Int8
name: size, field: Int64
name: attachments, field: String
name: cc, field: String
name: bcc, field: String
name: from, field: String
name: file_tree, field: String
name: to_removable_media, field: Boolean
name: from_removable_media, field: Boolean


Resolved plan until failure:

	---> FAILED HERE RESOLVING 'join' <---
simple π 30/30 ["id", "user_id", "pc_id", ... 27 other columns]
   WITH_COLUMNS:
   [null.alias("activity"), null.alias("is_logon"), null.alias("is_logoff"), null.alias("is_connect"), null.alias("is_disconnect"), null.alias("to"), null.alias("email_size_kb"), null.alias("is_large_email"), null.alias("has_attachment"), null.alias("filename"), null.alias("file_extension"), null.alias("is_sensitive_file"), null.alias("size"), null.alias("attachments"), null.alias("cc"), null.alias("bcc"), null.alias("from"), null.alias("file_tree"), null.alias("to_removable_media"), null.alias("from_removable_media")] 
     WITH_COLUMNS:
     [col("domain").str.to_lowercase().str.contains(["temp|anonymous|proxy|vpn|leak|hack"]).strict_cast(Int8).alias("is_suspicious_domain")] 
       WITH_COLUMNS:
       [col("url").str.extract(["https?://([^/]+)"]).alias("domain")] 
        SELECT [col("id"), col("user_id"), col("pc_id"), col("url"), col("content"), col("activity_type"), col("dataset"), col("date_parsed").alias("date")]
          SELECT [col("id"), col("user_id"), col("pc_id"), col("url"), col("content"), col("activity_type"), col("dataset"), col("date_parsed")]
             WITH_COLUMNS:
             [col("date_fmt1").coalesce([col("date").str.strptime(["raise"])]).alias("date_parsed")] 
               WITH_COLUMNS:
               [col("date").str.strptime(["raise"]).alias("date_fmt1")] 
                 WITH_COLUMNS:
                 ["http".alias("activity_type"), "r5.2".alias("dataset")] 
                  SELECT [col("id"), col("date"), col("user_id"), col("pc").alias("pc_id"), col("url"), col("content")]
                    SELECT [col("id"), col("date"), col("user").alias("user_id"), col("pc"), col("url"), col("content")]
                      Csv SCAN [/Users/bipinrimal/Downloads/Thesis_work/data/all_data/r5.2/http.csv]
                      PROJECT */6 COLUMNS
                      ESTIMATED ROWS: 59265156
2025-12-14 23:17:03 - utils - ERROR - 
✗ PIPELINE EXECUTION FAILED: 'union'/'concat' inputs should all have the same schema,got
Schema:
name: id, field: String
name: user_id, field: String
name: pc_id, field: String
name: activity, field: String
name: activity_type, field: String
name: dataset, field: String
name: date, field: Datetime('μs')
name: is_logon, field: Int8
name: is_logoff, field: Int8
name: is_connect, field: Int8
name: is_disconnect, field: Int8
name: url, field: String
name: domain, field: String
name: is_suspicious_domain, field: Int8
name: to, field: String
name: email_size_kb, field: Float64
name: is_large_email, field: Int8
name: has_attachment, field: Int8
name: filename, field: String
name: content, field: String
name: file_extension, field: String
name: is_sensitive_file, field: Int8
name: size, field: Int64
name: attachments, field: Int64
name: cc, field: String
name: bcc, field: String
name: from, field: String
name: file_tree, field: String
name: to_removable_media, field: Boolean
name: from_removable_media, field: Boolean
 and 
Schema:
name: id, field: String
name: user_id, field: String
name: pc_id, field: String
name: activity, field: String
name: activity_type, field: String
name: dataset, field: String
name: date, field: Datetime('μs')
name: is_logon, field: Int8
name: is_logoff, field: Int8
name: is_connect, field: Int8
name: is_disconnect, field: Int8
name: url, field: String
name: domain, field: String
name: is_suspicious_domain, field: Int8
name: to, field: String
name: email_size_kb, field: Float64
name: is_large_email, field: Int8
name: has_attachment, field: Int8
name: filename, field: String
name: content, field: String
name: file_extension, field: String
name: is_sensitive_file, field: Int8
name: size, field: Int64
name: attachments, field: String
name: cc, field: String
name: bcc, field: String
name: from, field: String
name: file_tree, field: String
name: to_removable_media, field: Boolean
name: from_removable_media, field: Boolean


Resolved plan until failure:

	---> FAILED HERE RESOLVING 'join' <---
simple π 30/30 ["id", "user_id", "pc_id", ... 27 other columns]
   WITH_COLUMNS:
   [null.alias("activity"), null.alias("is_logon"), null.alias("is_logoff"), null.alias("is_connect"), null.alias("is_disconnect"), null.alias("to"), null.alias("email_size_kb"), null.alias("is_large_email"), null.alias("has_attachment"), null.alias("filename"), null.alias("file_extension"), null.alias("is_sensitive_file"), null.alias("size"), null.alias("attachments"), null.alias("cc"), null.alias("bcc"), null.alias("from"), null.alias("file_tree"), null.alias("to_removable_media"), null.alias("from_removable_media")] 
     WITH_COLUMNS:
     [col("domain").str.to_lowercase().str.contains(["temp|anonymous|proxy|vpn|leak|hack"]).strict_cast(Int8).alias("is_suspicious_domain")] 
       WITH_COLUMNS:
       [col("url").str.extract(["https?://([^/]+)"]).alias("domain")] 
        SELECT [col("id"), col("user_id"), col("pc_id"), col("url"), col("content"), col("activity_type"), col("dataset"), col("date_parsed").alias("date")]
          SELECT [col("id"), col("user_id"), col("pc_id"), col("url"), col("content"), col("activity_type"), col("dataset"), col("date_parsed")]
             WITH_COLUMNS:
             [col("date_fmt1").coalesce([col("date").str.strptime(["raise"])]).alias("date_parsed")] 
               WITH_COLUMNS:
               [col("date").str.strptime(["raise"]).alias("date_fmt1")] 
                 WITH_COLUMNS:
                 ["http".alias("activity_type"), "r5.2".alias("dataset")] 
                  SELECT [col("id"), col("date"), col("user_id"), col("pc").alias("pc_id"), col("url"), col("content")]
                    SELECT [col("id"), col("date"), col("user").alias("user_id"), col("pc"), col("url"), col("content")]
                      Csv SCAN [/Users/bipinrimal/Downloads/Thesis_work/data/all_data/r5.2/http.csv]
                      PROJECT */6 COLUMNS
                      ESTIMATED ROWS: 59265156
2025-12-14 23:17:33 - utils - INFO - Utility functions loaded successfully
2025-12-14 23:17:34 - utils - INFO - ================================================================================
2025-12-14 23:17:34 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-12-14 23:17:34 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-12-14 23:17:34 - utils - INFO - ================================================================================
2025-12-14 23:17:34 - utils - INFO - 
================================================================================
2025-12-14 23:17:34 - utils - INFO - STARTING FULL PIPELINE EXECUTION
2025-12-14 23:17:34 - utils - INFO - ================================================================================

2025-12-14 23:17:34 - utils - INFO - 
================================================================================
                          STAGE 1: DATA PREPROCESSING                           
================================================================================

2025-12-14 23:17:34 - utils - INFO - Processing SUBSET defined in config: ['r1', 'r2', 'r3.1', 'r3.2', 'r4.1', 'r5.1']
2025-12-14 23:17:34 - utils - INFO - ✓ Loaded 11 insider users from ground truth
2025-12-14 23:17:34 - utils - INFO -   Insiders: ['JTC1885', 'BGC0686', 'JAK0783', 'HFC0492', 'LBE0376', 'KTW0365', 'ABB0427', 'CCH0959', 'RCW0822', 'CSF0929']...
2025-12-14 23:17:34 - utils - INFO -   Total malicious time windows: 11
2025-12-14 23:17:34 - utils - INFO - 
================================================================================
                          DATA PREPROCESSING (POLARS)                           
================================================================================

2025-12-14 23:17:34 - utils - INFO - Scanning dataset: r1
2025-12-14 23:17:34 - utils - INFO - Scanning dataset: r2
2025-12-14 23:17:34 - utils - INFO - Scanning dataset: r3.1
2025-12-14 23:17:34 - utils - INFO - Scanning dataset: r3.2
2025-12-14 23:17:34 - utils - INFO - Scanning dataset: r4.1
2025-12-14 23:17:34 - utils - INFO - Scanning dataset: r5.1
2025-12-14 23:17:34 - utils - INFO - Constructing execution graph (Diagonal Concat)...
2025-12-14 23:17:34 - utils - INFO - Loaded Psychometric data: 5999 users
2025-12-14 23:17:34 - utils - ERROR - ✗ Stage 1 failed: 'union'/'concat' inputs should all have the same schema,got
Schema:
name: id, field: String
name: user_id, field: String
name: pc_id, field: String
name: activity, field: String
name: activity_type, field: String
name: dataset, field: String
name: date, field: Datetime('μs')
name: is_logon, field: Int8
name: is_logoff, field: Int8
name: is_connect, field: Int8
name: is_disconnect, field: Int8
name: url, field: String
name: domain, field: String
name: is_suspicious_domain, field: Int8
name: to, field: String
name: email_size_kb, field: Float64
name: is_large_email, field: Int8
name: has_attachment, field: Int8
name: filename, field: String
name: content, field: String
name: file_extension, field: String
name: is_sensitive_file, field: Int8
name: size, field: Int64
name: attachments, field: Int64
name: cc, field: String
name: bcc, field: String
name: from, field: String
name: file_tree, field: String
name: to_removable_media, field: Boolean
name: from_removable_media, field: Boolean
 and 
Schema:
name: id, field: String
name: user_id, field: String
name: pc_id, field: String
name: activity, field: String
name: activity_type, field: String
name: dataset, field: String
name: date, field: Datetime('μs')
name: is_logon, field: Int8
name: is_logoff, field: Int8
name: is_connect, field: Int8
name: is_disconnect, field: Int8
name: url, field: String
name: domain, field: String
name: is_suspicious_domain, field: Int8
name: to, field: String
name: email_size_kb, field: Float64
name: is_large_email, field: Int8
name: has_attachment, field: Int8
name: filename, field: String
name: content, field: String
name: file_extension, field: String
name: is_sensitive_file, field: Int8
name: size, field: Int64
name: attachments, field: String
name: cc, field: String
name: bcc, field: String
name: from, field: String
name: file_tree, field: String
name: to_removable_media, field: Boolean
name: from_removable_media, field: Boolean


Resolved plan until failure:

	---> FAILED HERE RESOLVING 'join' <---
simple π 30/30 ["id", "user_id", "pc_id", ... 27 other columns]
   WITH_COLUMNS:
   [null.alias("activity"), null.alias("is_logon"), null.alias("is_logoff"), null.alias("is_connect"), null.alias("is_disconnect"), null.alias("to"), null.alias("email_size_kb"), null.alias("is_large_email"), null.alias("has_attachment"), null.alias("filename"), null.alias("file_extension"), null.alias("is_sensitive_file"), null.alias("size"), null.alias("attachments"), null.alias("cc"), null.alias("bcc"), null.alias("from"), null.alias("file_tree"), null.alias("to_removable_media"), null.alias("from_removable_media")] 
     WITH_COLUMNS:
     [col("domain").str.to_lowercase().str.contains(["temp|anonymous|proxy|vpn|leak|hack"]).strict_cast(Int8).alias("is_suspicious_domain")] 
       WITH_COLUMNS:
       [col("url").str.extract(["https?://([^/]+)"]).alias("domain")] 
        SELECT [col("id"), col("user_id"), col("pc_id"), col("url"), col("content"), col("activity_type"), col("dataset"), col("date_parsed").alias("date")]
          SELECT [col("id"), col("user_id"), col("pc_id"), col("url"), col("content"), col("activity_type"), col("dataset"), col("date_parsed")]
             WITH_COLUMNS:
             [col("date_fmt1").coalesce([col("date").str.strptime(["raise"])]).alias("date_parsed")] 
               WITH_COLUMNS:
               [col("date").str.strptime(["raise"]).alias("date_fmt1")] 
                 WITH_COLUMNS:
                 ["http".alias("activity_type"), "r5.1".alias("dataset")] 
                  SELECT [col("id"), col("date"), col("user_id"), col("pc").alias("pc_id"), col("url"), col("content")]
                    SELECT [col("id"), col("date"), col("user").alias("user_id"), col("pc"), col("url"), col("content")]
                      Csv SCAN [/Users/bipinrimal/Downloads/Thesis_work/data/all_data/r5.1/http.csv]
                      PROJECT */6 COLUMNS
                      ESTIMATED ROWS: 59858168
2025-12-14 23:17:34 - utils - ERROR - 
✗ PIPELINE EXECUTION FAILED: 'union'/'concat' inputs should all have the same schema,got
Schema:
name: id, field: String
name: user_id, field: String
name: pc_id, field: String
name: activity, field: String
name: activity_type, field: String
name: dataset, field: String
name: date, field: Datetime('μs')
name: is_logon, field: Int8
name: is_logoff, field: Int8
name: is_connect, field: Int8
name: is_disconnect, field: Int8
name: url, field: String
name: domain, field: String
name: is_suspicious_domain, field: Int8
name: to, field: String
name: email_size_kb, field: Float64
name: is_large_email, field: Int8
name: has_attachment, field: Int8
name: filename, field: String
name: content, field: String
name: file_extension, field: String
name: is_sensitive_file, field: Int8
name: size, field: Int64
name: attachments, field: Int64
name: cc, field: String
name: bcc, field: String
name: from, field: String
name: file_tree, field: String
name: to_removable_media, field: Boolean
name: from_removable_media, field: Boolean
 and 
Schema:
name: id, field: String
name: user_id, field: String
name: pc_id, field: String
name: activity, field: String
name: activity_type, field: String
name: dataset, field: String
name: date, field: Datetime('μs')
name: is_logon, field: Int8
name: is_logoff, field: Int8
name: is_connect, field: Int8
name: is_disconnect, field: Int8
name: url, field: String
name: domain, field: String
name: is_suspicious_domain, field: Int8
name: to, field: String
name: email_size_kb, field: Float64
name: is_large_email, field: Int8
name: has_attachment, field: Int8
name: filename, field: String
name: content, field: String
name: file_extension, field: String
name: is_sensitive_file, field: Int8
name: size, field: Int64
name: attachments, field: String
name: cc, field: String
name: bcc, field: String
name: from, field: String
name: file_tree, field: String
name: to_removable_media, field: Boolean
name: from_removable_media, field: Boolean


Resolved plan until failure:

	---> FAILED HERE RESOLVING 'join' <---
simple π 30/30 ["id", "user_id", "pc_id", ... 27 other columns]
   WITH_COLUMNS:
   [null.alias("activity"), null.alias("is_logon"), null.alias("is_logoff"), null.alias("is_connect"), null.alias("is_disconnect"), null.alias("to"), null.alias("email_size_kb"), null.alias("is_large_email"), null.alias("has_attachment"), null.alias("filename"), null.alias("file_extension"), null.alias("is_sensitive_file"), null.alias("size"), null.alias("attachments"), null.alias("cc"), null.alias("bcc"), null.alias("from"), null.alias("file_tree"), null.alias("to_removable_media"), null.alias("from_removable_media")] 
     WITH_COLUMNS:
     [col("domain").str.to_lowercase().str.contains(["temp|anonymous|proxy|vpn|leak|hack"]).strict_cast(Int8).alias("is_suspicious_domain")] 
       WITH_COLUMNS:
       [col("url").str.extract(["https?://([^/]+)"]).alias("domain")] 
        SELECT [col("id"), col("user_id"), col("pc_id"), col("url"), col("content"), col("activity_type"), col("dataset"), col("date_parsed").alias("date")]
          SELECT [col("id"), col("user_id"), col("pc_id"), col("url"), col("content"), col("activity_type"), col("dataset"), col("date_parsed")]
             WITH_COLUMNS:
             [col("date_fmt1").coalesce([col("date").str.strptime(["raise"])]).alias("date_parsed")] 
               WITH_COLUMNS:
               [col("date").str.strptime(["raise"]).alias("date_fmt1")] 
                 WITH_COLUMNS:
                 ["http".alias("activity_type"), "r5.1".alias("dataset")] 
                  SELECT [col("id"), col("date"), col("user_id"), col("pc").alias("pc_id"), col("url"), col("content")]
                    SELECT [col("id"), col("date"), col("user").alias("user_id"), col("pc"), col("url"), col("content")]
                      Csv SCAN [/Users/bipinrimal/Downloads/Thesis_work/data/all_data/r5.1/http.csv]
                      PROJECT */6 COLUMNS
                      ESTIMATED ROWS: 59858168
2025-12-14 23:17:45 - utils - INFO - Utility functions loaded successfully
2025-12-14 23:17:46 - utils - INFO - ================================================================================
2025-12-14 23:17:46 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-12-14 23:17:46 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-12-14 23:17:46 - utils - INFO - ================================================================================
2025-12-14 23:17:46 - utils - INFO - 
================================================================================
2025-12-14 23:17:46 - utils - INFO - STARTING FULL PIPELINE EXECUTION
2025-12-14 23:17:46 - utils - INFO - ================================================================================

2025-12-14 23:17:46 - utils - INFO - 
================================================================================
                          STAGE 1: DATA PREPROCESSING                           
================================================================================

2025-12-14 23:17:46 - utils - INFO - Processing SUBSET defined in config: ['r1', 'r2', 'r3.1', 'r3.2', 'r4.1']
2025-12-14 23:17:46 - utils - INFO - ✓ Loaded 7 insider users from ground truth
2025-12-14 23:17:46 - utils - INFO -   Insiders: ['JCE0258', 'HFC0492', 'CCH0959', 'RCW0822', 'CSF0929', 'ABB0427', 'KTW0365']
2025-12-14 23:17:46 - utils - INFO -   Total malicious time windows: 7
2025-12-14 23:17:46 - utils - INFO - 
================================================================================
                          DATA PREPROCESSING (POLARS)                           
================================================================================

2025-12-14 23:17:46 - utils - INFO - Scanning dataset: r1
2025-12-14 23:17:46 - utils - INFO - Scanning dataset: r2
2025-12-14 23:17:46 - utils - INFO - Scanning dataset: r3.1
2025-12-14 23:17:46 - utils - INFO - Scanning dataset: r3.2
2025-12-14 23:17:46 - utils - INFO - Scanning dataset: r4.1
2025-12-14 23:17:46 - utils - INFO - Constructing execution graph (Diagonal Concat)...
2025-12-14 23:17:46 - utils - INFO - Loaded Psychometric data: 3999 users
2025-12-14 23:17:46 - utils - INFO - Created insider windows DataFrame with 7 entries
2025-12-14 23:17:46 - utils - INFO - Applying time-window based insider labeling...
2025-12-14 23:17:46 - utils - INFO - Collecting data for time-window labeling (this may take a while)...
2025-12-14 23:20:24 - utils - INFO - ✓ Labeled 20,812 records as insider (0.0202% of 103,242,062 total)
2025-12-14 23:20:24 - utils - INFO - Streaming merged data to /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv...
2025-12-14 23:25:57 - utils - INFO - Utility functions loaded successfully
2025-12-14 23:25:57 - utils - INFO - ================================================================================
2025-12-14 23:25:57 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-12-14 23:25:57 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-12-14 23:25:57 - utils - INFO - ================================================================================
2025-12-14 23:25:57 - utils - INFO - 
================================================================================
2025-12-14 23:25:57 - utils - INFO - STARTING FULL PIPELINE EXECUTION
2025-12-14 23:25:57 - utils - INFO - ================================================================================

2025-12-14 23:25:57 - utils - INFO - 
================================================================================
                          STAGE 1: DATA PREPROCESSING                           
================================================================================

2025-12-14 23:25:57 - utils - INFO - ✓ Loaded 180 insider users from ground truth
2025-12-14 23:25:57 - utils - INFO -   Insiders: ['TAP0551', 'BBS0039', 'BSS0369', 'WOS1834', 'HFC0492', 'PNL0301', 'CRD0272', 'CGF1056', 'JIG1593', 'VAH1292']...
2025-12-14 23:25:57 - utils - INFO -   Total malicious time windows: 180
2025-12-14 23:25:57 - utils - INFO - 
================================================================================
                          DATA PREPROCESSING (POLARS)                           
================================================================================

2025-12-14 23:25:57 - utils - INFO - Scanning dataset: r1
2025-12-14 23:25:57 - utils - INFO - Scanning dataset: r2
2025-12-14 23:25:57 - utils - INFO - Scanning dataset: r3.1
2025-12-14 23:25:57 - utils - INFO - Scanning dataset: r3.2
2025-12-14 23:25:57 - utils - INFO - Scanning dataset: r4.1
2025-12-14 23:25:57 - utils - INFO - Scanning dataset: r4.2
2025-12-14 23:25:57 - utils - INFO - Scanning dataset: r5.1
2025-12-14 23:25:57 - utils - INFO - Scanning dataset: r5.2
2025-12-14 23:25:57 - utils - INFO - Constructing execution graph (Diagonal Concat)...
2025-12-14 23:25:57 - utils - INFO - Loaded Psychometric data: 8997 users
2025-12-14 23:25:57 - utils - ERROR - ✗ Stage 1 failed: 'union'/'concat' inputs should all have the same schema,got
Schema:
name: id, field: String
name: user_id, field: String
name: pc_id, field: String
name: activity, field: String
name: activity_type, field: String
name: dataset, field: String
name: date, field: Datetime('μs')
name: is_logon, field: Int8
name: is_logoff, field: Int8
name: is_connect, field: Int8
name: is_disconnect, field: Int8
name: url, field: String
name: domain, field: String
name: is_suspicious_domain, field: Int8
name: to, field: String
name: email_size_kb, field: Float64
name: is_large_email, field: Int8
name: has_attachment, field: Int8
name: filename, field: String
name: content, field: String
name: file_extension, field: String
name: is_sensitive_file, field: Int8
name: size, field: Int64
name: attachments, field: Int64
name: cc, field: String
name: bcc, field: String
name: from, field: String
name: file_tree, field: String
name: to_removable_media, field: Boolean
name: from_removable_media, field: Boolean
 and 
Schema:
name: id, field: String
name: user_id, field: String
name: pc_id, field: String
name: activity, field: String
name: activity_type, field: String
name: dataset, field: String
name: date, field: Datetime('μs')
name: is_logon, field: Int8
name: is_logoff, field: Int8
name: is_connect, field: Int8
name: is_disconnect, field: Int8
name: url, field: String
name: domain, field: String
name: is_suspicious_domain, field: Int8
name: to, field: String
name: email_size_kb, field: Float64
name: is_large_email, field: Int8
name: has_attachment, field: Int8
name: filename, field: String
name: content, field: String
name: file_extension, field: String
name: is_sensitive_file, field: Int8
name: size, field: Int64
name: attachments, field: String
name: cc, field: String
name: bcc, field: String
name: from, field: String
name: file_tree, field: String
name: to_removable_media, field: Boolean
name: from_removable_media, field: Boolean


Resolved plan until failure:

	---> FAILED HERE RESOLVING 'join' <---
simple π 30/30 ["id", "user_id", "pc_id", ... 27 other columns]
   WITH_COLUMNS:
   [null.alias("activity"), null.alias("is_logon"), null.alias("is_logoff"), null.alias("is_connect"), null.alias("is_disconnect"), null.alias("to"), null.alias("email_size_kb"), null.alias("is_large_email"), null.alias("has_attachment"), null.alias("filename"), null.alias("file_extension"), null.alias("is_sensitive_file"), null.alias("size"), null.alias("attachments"), null.alias("cc"), null.alias("bcc"), null.alias("from"), null.alias("file_tree"), null.alias("to_removable_media"), null.alias("from_removable_media")] 
     WITH_COLUMNS:
     [col("domain").str.to_lowercase().str.contains(["temp|anonymous|proxy|vpn|leak|hack"]).strict_cast(Int8).alias("is_suspicious_domain")] 
       WITH_COLUMNS:
       [col("url").str.extract(["https?://([^/]+)"]).alias("domain")] 
        SELECT [col("id"), col("user_id"), col("pc_id"), col("url"), col("content"), col("activity_type"), col("dataset"), col("date_parsed").alias("date")]
          SELECT [col("id"), col("user_id"), col("pc_id"), col("url"), col("content"), col("activity_type"), col("dataset"), col("date_parsed")]
             WITH_COLUMNS:
             [col("date_fmt1").coalesce([col("date").str.strptime(["raise"])]).alias("date_parsed")] 
               WITH_COLUMNS:
               [col("date").str.strptime(["raise"]).alias("date_fmt1")] 
                 WITH_COLUMNS:
                 ["http".alias("activity_type"), "r5.2".alias("dataset")] 
                  SELECT [col("id"), col("date"), col("user_id"), col("pc").alias("pc_id"), col("url"), col("content")]
                    SELECT [col("id"), col("date"), col("user").alias("user_id"), col("pc"), col("url"), col("content")]
                      Csv SCAN [/Users/bipinrimal/Downloads/Thesis_work/data/all_data/r5.2/http.csv]
                      PROJECT */6 COLUMNS
                      ESTIMATED ROWS: 59265156
2025-12-14 23:25:57 - utils - ERROR - 
✗ PIPELINE EXECUTION FAILED: 'union'/'concat' inputs should all have the same schema,got
Schema:
name: id, field: String
name: user_id, field: String
name: pc_id, field: String
name: activity, field: String
name: activity_type, field: String
name: dataset, field: String
name: date, field: Datetime('μs')
name: is_logon, field: Int8
name: is_logoff, field: Int8
name: is_connect, field: Int8
name: is_disconnect, field: Int8
name: url, field: String
name: domain, field: String
name: is_suspicious_domain, field: Int8
name: to, field: String
name: email_size_kb, field: Float64
name: is_large_email, field: Int8
name: has_attachment, field: Int8
name: filename, field: String
name: content, field: String
name: file_extension, field: String
name: is_sensitive_file, field: Int8
name: size, field: Int64
name: attachments, field: Int64
name: cc, field: String
name: bcc, field: String
name: from, field: String
name: file_tree, field: String
name: to_removable_media, field: Boolean
name: from_removable_media, field: Boolean
 and 
Schema:
name: id, field: String
name: user_id, field: String
name: pc_id, field: String
name: activity, field: String
name: activity_type, field: String
name: dataset, field: String
name: date, field: Datetime('μs')
name: is_logon, field: Int8
name: is_logoff, field: Int8
name: is_connect, field: Int8
name: is_disconnect, field: Int8
name: url, field: String
name: domain, field: String
name: is_suspicious_domain, field: Int8
name: to, field: String
name: email_size_kb, field: Float64
name: is_large_email, field: Int8
name: has_attachment, field: Int8
name: filename, field: String
name: content, field: String
name: file_extension, field: String
name: is_sensitive_file, field: Int8
name: size, field: Int64
name: attachments, field: String
name: cc, field: String
name: bcc, field: String
name: from, field: String
name: file_tree, field: String
name: to_removable_media, field: Boolean
name: from_removable_media, field: Boolean


Resolved plan until failure:

	---> FAILED HERE RESOLVING 'join' <---
simple π 30/30 ["id", "user_id", "pc_id", ... 27 other columns]
   WITH_COLUMNS:
   [null.alias("activity"), null.alias("is_logon"), null.alias("is_logoff"), null.alias("is_connect"), null.alias("is_disconnect"), null.alias("to"), null.alias("email_size_kb"), null.alias("is_large_email"), null.alias("has_attachment"), null.alias("filename"), null.alias("file_extension"), null.alias("is_sensitive_file"), null.alias("size"), null.alias("attachments"), null.alias("cc"), null.alias("bcc"), null.alias("from"), null.alias("file_tree"), null.alias("to_removable_media"), null.alias("from_removable_media")] 
     WITH_COLUMNS:
     [col("domain").str.to_lowercase().str.contains(["temp|anonymous|proxy|vpn|leak|hack"]).strict_cast(Int8).alias("is_suspicious_domain")] 
       WITH_COLUMNS:
       [col("url").str.extract(["https?://([^/]+)"]).alias("domain")] 
        SELECT [col("id"), col("user_id"), col("pc_id"), col("url"), col("content"), col("activity_type"), col("dataset"), col("date_parsed").alias("date")]
          SELECT [col("id"), col("user_id"), col("pc_id"), col("url"), col("content"), col("activity_type"), col("dataset"), col("date_parsed")]
             WITH_COLUMNS:
             [col("date_fmt1").coalesce([col("date").str.strptime(["raise"])]).alias("date_parsed")] 
               WITH_COLUMNS:
               [col("date").str.strptime(["raise"]).alias("date_fmt1")] 
                 WITH_COLUMNS:
                 ["http".alias("activity_type"), "r5.2".alias("dataset")] 
                  SELECT [col("id"), col("date"), col("user_id"), col("pc").alias("pc_id"), col("url"), col("content")]
                    SELECT [col("id"), col("date"), col("user").alias("user_id"), col("pc"), col("url"), col("content")]
                      Csv SCAN [/Users/bipinrimal/Downloads/Thesis_work/data/all_data/r5.2/http.csv]
                      PROJECT */6 COLUMNS
                      ESTIMATED ROWS: 59265156
2025-12-14 23:26:33 - utils - INFO - Utility functions loaded successfully
2025-12-14 23:26:43 - utils - INFO - Utility functions loaded successfully
2025-12-14 23:26:43 - utils - INFO - ================================================================================
2025-12-14 23:26:43 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-12-14 23:26:43 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-12-14 23:26:43 - utils - INFO - ================================================================================
2025-12-14 23:26:43 - utils - INFO - 
================================================================================
2025-12-14 23:26:43 - utils - INFO - STARTING FULL PIPELINE EXECUTION
2025-12-14 23:26:43 - utils - INFO - ================================================================================

2025-12-14 23:26:43 - utils - INFO - 
================================================================================
                          STAGE 1: DATA PREPROCESSING                           
================================================================================

2025-12-14 23:26:43 - utils - INFO - ✓ Loaded 180 insider users from ground truth
2025-12-14 23:26:43 - utils - INFO -   Insiders: ['ZEH0685', 'HIS1394', 'BYO1846', 'OHS0036', 'JLM0364', 'CEJ0109', 'KRL0501', 'MAR0955', 'WDD0366', 'RRS0056']...
2025-12-14 23:26:43 - utils - INFO -   Total malicious time windows: 180
2025-12-14 23:26:43 - utils - INFO - 
================================================================================
                          DATA PREPROCESSING (POLARS)                           
================================================================================

2025-12-14 23:26:43 - utils - INFO - Scanning dataset: r1
2025-12-14 23:26:43 - utils - INFO - Scanning dataset: r2
2025-12-14 23:26:43 - utils - INFO - Scanning dataset: r3.1
2025-12-14 23:26:43 - utils - INFO - Scanning dataset: r3.2
2025-12-14 23:26:43 - utils - INFO - Scanning dataset: r4.1
2025-12-14 23:26:43 - utils - INFO - Scanning dataset: r4.2
2025-12-14 23:26:43 - utils - INFO - Scanning dataset: r5.1
2025-12-14 23:26:43 - utils - INFO - Scanning dataset: r5.2
2025-12-14 23:26:43 - utils - INFO - Constructing execution graph (Diagonal Concat)...
2025-12-14 23:26:43 - utils - INFO - Loaded Psychometric data: 8997 users
2025-12-14 23:26:43 - utils - ERROR - ✗ Stage 1 failed: 'union'/'concat' inputs should all have the same schema,got
Schema:
name: id, field: String
name: user_id, field: String
name: pc_id, field: String
name: activity, field: String
name: activity_type, field: String
name: dataset, field: String
name: date, field: Datetime('μs')
name: is_logon, field: Int8
name: is_logoff, field: Int8
name: is_connect, field: Int8
name: is_disconnect, field: Int8
name: url, field: String
name: domain, field: String
name: is_suspicious_domain, field: Int8
name: to, field: String
name: email_size_kb, field: Float64
name: is_large_email, field: Int8
name: has_attachment, field: Int8
name: filename, field: String
name: content, field: String
name: file_extension, field: String
name: is_sensitive_file, field: Int8
name: size, field: Int64
name: attachments, field: Int64
name: cc, field: String
name: bcc, field: String
name: from, field: String
name: file_tree, field: String
name: to_removable_media, field: Boolean
name: from_removable_media, field: Boolean
 and 
Schema:
name: id, field: String
name: user_id, field: String
name: pc_id, field: String
name: activity, field: String
name: activity_type, field: String
name: dataset, field: String
name: date, field: Datetime('μs')
name: is_logon, field: Int8
name: is_logoff, field: Int8
name: is_connect, field: Int8
name: is_disconnect, field: Int8
name: url, field: String
name: domain, field: String
name: is_suspicious_domain, field: Int8
name: to, field: String
name: email_size_kb, field: Float64
name: is_large_email, field: Int8
name: has_attachment, field: Int8
name: filename, field: String
name: content, field: String
name: file_extension, field: String
name: is_sensitive_file, field: Int8
name: size, field: Int64
name: attachments, field: String
name: cc, field: String
name: bcc, field: String
name: from, field: String
name: file_tree, field: String
name: to_removable_media, field: Boolean
name: from_removable_media, field: Boolean


Resolved plan until failure:

	---> FAILED HERE RESOLVING 'join' <---
simple π 30/30 ["id", "user_id", "pc_id", ... 27 other columns]
   WITH_COLUMNS:
   [null.alias("activity"), null.alias("is_logon"), null.alias("is_logoff"), null.alias("is_connect"), null.alias("is_disconnect"), null.alias("to"), null.alias("email_size_kb"), null.alias("is_large_email"), null.alias("has_attachment"), null.alias("filename"), null.alias("file_extension"), null.alias("is_sensitive_file"), null.alias("size"), null.alias("attachments"), null.alias("cc"), null.alias("bcc"), null.alias("from"), null.alias("file_tree"), null.alias("to_removable_media"), null.alias("from_removable_media")] 
     WITH_COLUMNS:
     [col("domain").str.to_lowercase().str.contains(["temp|anonymous|proxy|vpn|leak|hack"]).strict_cast(Int8).alias("is_suspicious_domain")] 
       WITH_COLUMNS:
       [col("url").str.extract(["https?://([^/]+)"]).alias("domain")] 
        SELECT [col("id"), col("user_id"), col("pc_id"), col("url"), col("content"), col("activity_type"), col("dataset"), col("date_parsed").alias("date")]
          SELECT [col("id"), col("user_id"), col("pc_id"), col("url"), col("content"), col("activity_type"), col("dataset"), col("date_parsed")]
             WITH_COLUMNS:
             [col("date_fmt1").coalesce([col("date").str.strptime(["raise"])]).alias("date_parsed")] 
               WITH_COLUMNS:
               [col("date").str.strptime(["raise"]).alias("date_fmt1")] 
                 WITH_COLUMNS:
                 ["http".alias("activity_type"), "r5.2".alias("dataset")] 
                  SELECT [col("id"), col("date"), col("user_id"), col("pc").alias("pc_id"), col("url"), col("content")]
                    SELECT [col("id"), col("date"), col("user").alias("user_id"), col("pc"), col("url"), col("content")]
                      Csv SCAN [/Users/bipinrimal/Downloads/Thesis_work/data/all_data/r5.2/http.csv]
                      PROJECT */6 COLUMNS
                      ESTIMATED ROWS: 59265156
2025-12-14 23:26:43 - utils - ERROR - 
✗ PIPELINE EXECUTION FAILED: 'union'/'concat' inputs should all have the same schema,got
Schema:
name: id, field: String
name: user_id, field: String
name: pc_id, field: String
name: activity, field: String
name: activity_type, field: String
name: dataset, field: String
name: date, field: Datetime('μs')
name: is_logon, field: Int8
name: is_logoff, field: Int8
name: is_connect, field: Int8
name: is_disconnect, field: Int8
name: url, field: String
name: domain, field: String
name: is_suspicious_domain, field: Int8
name: to, field: String
name: email_size_kb, field: Float64
name: is_large_email, field: Int8
name: has_attachment, field: Int8
name: filename, field: String
name: content, field: String
name: file_extension, field: String
name: is_sensitive_file, field: Int8
name: size, field: Int64
name: attachments, field: Int64
name: cc, field: String
name: bcc, field: String
name: from, field: String
name: file_tree, field: String
name: to_removable_media, field: Boolean
name: from_removable_media, field: Boolean
 and 
Schema:
name: id, field: String
name: user_id, field: String
name: pc_id, field: String
name: activity, field: String
name: activity_type, field: String
name: dataset, field: String
name: date, field: Datetime('μs')
name: is_logon, field: Int8
name: is_logoff, field: Int8
name: is_connect, field: Int8
name: is_disconnect, field: Int8
name: url, field: String
name: domain, field: String
name: is_suspicious_domain, field: Int8
name: to, field: String
name: email_size_kb, field: Float64
name: is_large_email, field: Int8
name: has_attachment, field: Int8
name: filename, field: String
name: content, field: String
name: file_extension, field: String
name: is_sensitive_file, field: Int8
name: size, field: Int64
name: attachments, field: String
name: cc, field: String
name: bcc, field: String
name: from, field: String
name: file_tree, field: String
name: to_removable_media, field: Boolean
name: from_removable_media, field: Boolean


Resolved plan until failure:

	---> FAILED HERE RESOLVING 'join' <---
simple π 30/30 ["id", "user_id", "pc_id", ... 27 other columns]
   WITH_COLUMNS:
   [null.alias("activity"), null.alias("is_logon"), null.alias("is_logoff"), null.alias("is_connect"), null.alias("is_disconnect"), null.alias("to"), null.alias("email_size_kb"), null.alias("is_large_email"), null.alias("has_attachment"), null.alias("filename"), null.alias("file_extension"), null.alias("is_sensitive_file"), null.alias("size"), null.alias("attachments"), null.alias("cc"), null.alias("bcc"), null.alias("from"), null.alias("file_tree"), null.alias("to_removable_media"), null.alias("from_removable_media")] 
     WITH_COLUMNS:
     [col("domain").str.to_lowercase().str.contains(["temp|anonymous|proxy|vpn|leak|hack"]).strict_cast(Int8).alias("is_suspicious_domain")] 
       WITH_COLUMNS:
       [col("url").str.extract(["https?://([^/]+)"]).alias("domain")] 
        SELECT [col("id"), col("user_id"), col("pc_id"), col("url"), col("content"), col("activity_type"), col("dataset"), col("date_parsed").alias("date")]
          SELECT [col("id"), col("user_id"), col("pc_id"), col("url"), col("content"), col("activity_type"), col("dataset"), col("date_parsed")]
             WITH_COLUMNS:
             [col("date_fmt1").coalesce([col("date").str.strptime(["raise"])]).alias("date_parsed")] 
               WITH_COLUMNS:
               [col("date").str.strptime(["raise"]).alias("date_fmt1")] 
                 WITH_COLUMNS:
                 ["http".alias("activity_type"), "r5.2".alias("dataset")] 
                  SELECT [col("id"), col("date"), col("user_id"), col("pc").alias("pc_id"), col("url"), col("content")]
                    SELECT [col("id"), col("date"), col("user").alias("user_id"), col("pc"), col("url"), col("content")]
                      Csv SCAN [/Users/bipinrimal/Downloads/Thesis_work/data/all_data/r5.2/http.csv]
                      PROJECT */6 COLUMNS
                      ESTIMATED ROWS: 59265156
2025-12-14 23:28:10 - utils - INFO - Utility functions loaded successfully
2025-12-14 23:28:10 - utils - INFO - ================================================================================
2025-12-14 23:28:10 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-12-14 23:28:10 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-12-14 23:28:10 - utils - INFO - ================================================================================
2025-12-14 23:28:10 - utils - INFO - 
================================================================================
2025-12-14 23:28:10 - utils - INFO - STARTING FULL PIPELINE EXECUTION
2025-12-14 23:28:10 - utils - INFO - ================================================================================

2025-12-14 23:28:10 - utils - INFO - 
================================================================================
                          STAGE 1: DATA PREPROCESSING                           
================================================================================

2025-12-14 23:28:10 - utils - INFO - ✓ Loaded 180 insider users from ground truth
2025-12-14 23:28:10 - utils - INFO -   Insiders: ['NZL1395', 'KCM0466', 'ZIE0741', 'LBE0376', 'HXL0968', 'DRR0162', 'PPF0435', 'JNR1592', 'ISW0738', 'FSC0601']...
2025-12-14 23:28:10 - utils - INFO -   Total malicious time windows: 180
2025-12-14 23:28:10 - utils - INFO - 
================================================================================
                          DATA PREPROCESSING (POLARS)                           
================================================================================

2025-12-14 23:28:10 - utils - INFO - Scanning dataset: r1
2025-12-14 23:28:10 - utils - ERROR - Error preparing query for /Users/bipinrimal/Downloads/Thesis_work/data/all_data/r1/http.csv: column 'user_id' is duplicate

Resolved plan until failure:

	---> FAILED HERE RESOLVING THIS_NODE <---
Csv SCAN [/Users/bipinrimal/Downloads/Thesis_work/data/all_data/r1/http.csv]
PROJECT */16 COLUMNS
ESTIMATED ROWS: 0
2025-12-14 23:28:10 - utils - INFO - Scanning dataset: r2
2025-12-14 23:28:10 - utils - INFO - Scanning dataset: r3.1
2025-12-14 23:28:10 - utils - INFO - Scanning dataset: r3.2
2025-12-14 23:28:10 - utils - INFO - Scanning dataset: r4.1
2025-12-14 23:28:10 - utils - INFO - Scanning dataset: r4.2
2025-12-14 23:28:10 - utils - INFO - Scanning dataset: r5.1
2025-12-14 23:28:11 - utils - INFO - Scanning dataset: r5.2
2025-12-14 23:28:11 - utils - INFO - Constructing execution graph (Diagonal Concat)...
2025-12-14 23:28:11 - utils - INFO - Loaded Psychometric data: 8997 users
2025-12-14 23:28:11 - utils - INFO - Created insider windows DataFrame with 180 entries
2025-12-14 23:28:11 - utils - INFO - Applying time-window based insider labeling...
2025-12-14 23:28:11 - utils - INFO - Collecting data for time-window labeling (this may take a while)...
2025-12-14 23:33:41 - utils - INFO - Utility functions loaded successfully
2025-12-14 23:33:42 - utils - INFO - ================================================================================
2025-12-14 23:33:42 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-12-14 23:33:42 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-12-14 23:33:42 - utils - INFO - ================================================================================
2025-12-14 23:33:42 - utils - INFO - 
================================================================================
2025-12-14 23:33:42 - utils - INFO - STARTING FULL PIPELINE EXECUTION
2025-12-14 23:33:42 - utils - INFO - ================================================================================

2025-12-14 23:33:42 - utils - INFO - 
================================================================================
                          STAGE 1: DATA PREPROCESSING                           
================================================================================

2025-12-14 23:33:42 - utils - INFO - Processing SUBSET defined in config: ['r1', 'r2', 'r3.1', 'r3.2', 'r4.1']
2025-12-14 23:33:42 - utils - INFO - ✓ Loaded 7 insider users from ground truth
2025-12-14 23:33:42 - utils - INFO -   Insiders: ['RCW0822', 'CCH0959', 'HFC0492', 'CSF0929', 'KTW0365', 'ABB0427', 'JCE0258']
2025-12-14 23:33:42 - utils - INFO -   Total malicious time windows: 7
2025-12-14 23:33:42 - utils - INFO - 
================================================================================
                          DATA PREPROCESSING (POLARS)                           
================================================================================

2025-12-14 23:33:42 - utils - INFO - Scanning dataset: r1
2025-12-14 23:33:42 - utils - INFO - Scanning dataset: r2
2025-12-14 23:33:42 - utils - INFO - Scanning dataset: r3.1
2025-12-14 23:33:42 - utils - INFO - Scanning dataset: r3.2
2025-12-14 23:33:42 - utils - INFO - Scanning dataset: r4.1
2025-12-14 23:33:42 - utils - INFO - Constructing execution graph (Diagonal Concat)...
2025-12-14 23:33:42 - utils - INFO - Loaded Psychometric data: 3999 users
2025-12-14 23:33:42 - utils - INFO - Created insider windows DataFrame with 7 entries
2025-12-14 23:33:42 - utils - INFO - Applying time-window based insider labeling...
2025-12-14 23:33:42 - utils - INFO - Collecting data for time-window labeling (this may take a while)...
2025-12-14 23:36:13 - utils - INFO - ✓ Labeled 20,812 records as insider (0.0202% of 103,242,062 total)
2025-12-14 23:36:13 - utils - INFO - Streaming merged data to /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv...
2025-12-14 23:39:44 - utils - ERROR - Streaming failed: No space left on device (os error 28)
2025-12-14 23:39:47 - utils - INFO - ✓ Stage 1 completed successfully.
2025-12-14 23:39:47 - utils - INFO - 
================================================================================
                          STAGE 2: FEATURE ENGINEERING                          
================================================================================

2025-12-14 23:39:47 - utils - INFO - Starting Feature Engineering Pipeline (Polars Lazy Execution)...
2025-12-14 23:39:47 - utils - INFO - Scanning data from /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv
2025-12-14 23:39:47 - utils - INFO - Constructing execution graph for daily features...
2025-12-14 23:39:47 - utils - INFO - Executing aggregation (Streaming Mode)...
2025-12-14 23:41:17 - utils - INFO - Saved features to: /Users/bipinrimal/Downloads/Thesis_work/data/processed/daily_features.parquet
2025-12-14 23:41:17 - utils - INFO - Creating static features and fitting scaler...
2025-12-14 23:41:17 - utils - INFO - Generated static features for 6999 users
2025-12-14 23:41:17 - utils - INFO - Saved features to: /Users/bipinrimal/Downloads/Thesis_work/data/processed/static_features.csv
2025-12-14 23:41:18 - utils - INFO - Saved static scaler to /Users/bipinrimal/Downloads/Thesis_work/models/static_scaler.pkl
2025-12-14 23:41:18 - utils - INFO - Creating sequences...
2025-12-14 23:41:18 - utils - INFO - Saved features to: /Users/bipinrimal/Downloads/Thesis_work/data/processed/sequence_features.parquet
2025-12-14 23:41:18 - utils - INFO - Processing sequences with length 15...
2025-12-14 23:41:20 - utils - INFO - Generated sequences shape: (2214108, 15, 13)
2025-12-14 23:41:20 - utils - INFO - Generated labels shape: (2214108,)
2025-12-14 23:41:28 - utils - INFO - Saved sequences to /Users/bipinrimal/Downloads/Thesis_work/data/processed/sequences.npy
2025-12-14 23:41:28 - utils - INFO - Saved sequence labels to /Users/bipinrimal/Downloads/Thesis_work/data/processed/sequence_labels.npy
2025-12-14 23:41:28 - utils - INFO - Feature engineering pipeline completed successfully.
2025-12-14 23:41:28 - utils - INFO - ✓ Stage 2 completed: Feature files generated.
2025-12-14 23:41:28 - utils - INFO - 
================================================================================
                            STAGE 3: MODEL TRAINING                             
================================================================================

2025-12-14 23:41:28 - utils - INFO - 
>>> Training Isolation Forest...
2025-12-14 23:41:28 - utils - INFO - 
================================================================================
                 ISOLATION FOREST TRAINING (V2: MULTI-DATASET)                  
================================================================================

2025-12-14 23:41:29 - utils - INFO - Loaded daily features: (2312084, 16)
2025-12-14 23:41:32 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest_model.pkl
2025-12-14 23:41:35 - utils - INFO - Predictions saved to /Users/bipinrimal/Downloads/Thesis_work/results/isolation_forest_predictions.csv
2025-12-14 23:41:35 - utils - INFO - 
============================================================
2025-12-14 23:41:35 - utils - INFO - Isolation Forest Performance Metrics
2025-12-14 23:41:35 - utils - INFO - ============================================================
2025-12-14 23:41:35 - utils - INFO - Accuracy:  0.9103
2025-12-14 23:41:35 - utils - INFO - Precision: 0.0003
2025-12-14 23:41:35 - utils - INFO - Recall:    0.6140
2025-12-14 23:41:35 - utils - INFO - F1-Score:  0.0007
2025-12-14 23:41:35 - utils - INFO - AUC-ROC:   0.8039
2025-12-14 23:41:35 - utils - INFO - ============================================================

2025-12-14 23:41:35 - utils - INFO - ✓ Isolation Forest training completed
2025-12-14 23:41:35 - utils - INFO - 
>>> Training LSTM Autoencoder...
2025-12-14 23:41:35 - utils - INFO - 
================================================================================
                           LSTM AUTOENCODER TRAINING                            
================================================================================

2025-12-14 23:41:36 - utils - INFO - Loaded sequences: (2214108, 15, 13)
2025-12-14 23:41:38 - utils - INFO - Training on 1549792 normal sequences
2025-12-14 23:41:39 - utils - INFO - Model: "functional"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┓
┃ Layer (type)                         ┃ Output Shape                ┃         Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━┩
│ input_layer (InputLayer)             │ (None, 15, 13)              │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ lstm (LSTM)                          │ (None, 15, 32)              │           5,888 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout (Dropout)                    │ (None, 15, 32)              │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ lstm_1 (LSTM)                        │ (None, 16)                  │           3,136 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ repeat_vector (RepeatVector)         │ (None, 15, 16)              │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ lstm_2 (LSTM)                        │ (None, 15, 16)              │           2,112 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout_1 (Dropout)                  │ (None, 15, 16)              │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ lstm_3 (LSTM)                        │ (None, 15, 32)              │           6,272 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ time_distributed (TimeDistributed)   │ (None, 15, 13)              │             429 │
└──────────────────────────────────────┴─────────────────────────────┴─────────────────┘
 Total params: 17,837 (69.68 KB)
 Trainable params: 17,837 (69.68 KB)
 Non-trainable params: 0 (0.00 B)

2025-12-14 23:41:39 - utils - INFO - Starting training for 20 epoch(s)...
2025-12-14 23:42:28 - utils - WARNING - 
Pipeline execution interrupted by user.
2025-12-14 23:42:54 - utils - INFO - Utility functions loaded successfully
2025-12-14 23:42:54 - utils - INFO - ================================================================================
2025-12-14 23:42:54 - utils - INFO - INSIDER THREAT DETECTION SYSTEM
2025-12-14 23:42:54 - utils - INFO - Unsupervised Behavioral Profiling Using Time-Series and Anomaly Detection
2025-12-14 23:42:54 - utils - INFO - ================================================================================
2025-12-14 23:42:54 - utils - INFO - 
================================================================================
2025-12-14 23:42:54 - utils - INFO - STARTING FULL PIPELINE EXECUTION
2025-12-14 23:42:54 - utils - INFO - ================================================================================

2025-12-14 23:42:54 - utils - INFO - 
================================================================================
                          STAGE 1: DATA PREPROCESSING                           
================================================================================

2025-12-14 23:42:54 - utils - INFO - Processing SUBSET defined in config: ['r1', 'r2', 'r3.1', 'r3.2', 'r4.1']
2025-12-14 23:42:54 - utils - INFO - ✓ Loaded 7 insider users from ground truth
2025-12-14 23:42:54 - utils - INFO -   Insiders: ['ABB0427', 'KTW0365', 'JCE0258', 'HFC0492', 'CCH0959', 'RCW0822', 'CSF0929']
2025-12-14 23:42:54 - utils - INFO -   Total malicious time windows: 7
2025-12-14 23:42:54 - utils - INFO - 
================================================================================
                          DATA PREPROCESSING (POLARS)                           
================================================================================

2025-12-14 23:42:54 - utils - INFO - Scanning dataset: r1
2025-12-14 23:42:54 - utils - INFO - Scanning dataset: r2
2025-12-14 23:42:54 - utils - INFO - Scanning dataset: r3.1
2025-12-14 23:42:54 - utils - INFO - Scanning dataset: r3.2
2025-12-14 23:42:54 - utils - INFO - Scanning dataset: r4.1
2025-12-14 23:42:54 - utils - INFO - Constructing execution graph (Diagonal Concat)...
2025-12-14 23:42:54 - utils - INFO - Loaded Psychometric data: 3999 users
2025-12-14 23:42:54 - utils - INFO - Created insider windows DataFrame with 7 entries
2025-12-14 23:42:54 - utils - INFO - Applying time-window based insider labeling...
2025-12-14 23:42:54 - utils - INFO - Collecting data for time-window labeling (this may take a while)...
2025-12-14 23:45:15 - utils - INFO - ✓ Labeled 20,812 records as insider (0.0202% of 103,242,062 total)
2025-12-14 23:45:15 - utils - INFO - Streaming merged data to /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv...
2025-12-14 23:49:55 - utils - INFO - ✓ Preprocessing complete.
2025-12-14 23:49:55 - utils - INFO -   Insider users labeled: ['ABB0427', 'KTW0365', 'JCE0258', 'HFC0492', 'CCH0959']...
2025-12-14 23:50:04 - utils - INFO - ✓ Stage 1 completed successfully.
2025-12-14 23:50:04 - utils - INFO - 
================================================================================
                          STAGE 2: FEATURE ENGINEERING                          
================================================================================

2025-12-14 23:50:04 - utils - INFO - Starting Feature Engineering Pipeline (Polars Lazy Execution)...
2025-12-14 23:50:04 - utils - INFO - Scanning data from /Users/bipinrimal/Downloads/Thesis_work/data/processed/processed_unified_logs.csv
2025-12-14 23:50:04 - utils - INFO - Constructing execution graph for daily features...
2025-12-14 23:50:04 - utils - INFO - Executing aggregation (Streaming Mode)...
2025-12-14 23:52:20 - utils - INFO - Saved features to: /Users/bipinrimal/Downloads/Thesis_work/data/processed/daily_features.parquet
2025-12-14 23:52:20 - utils - INFO - Creating static features and fitting scaler...
2025-12-14 23:52:20 - utils - INFO - Generated static features for 7999 users
2025-12-14 23:52:20 - utils - INFO - Saved features to: /Users/bipinrimal/Downloads/Thesis_work/data/processed/static_features.csv
2025-12-14 23:52:20 - utils - INFO - Saved static scaler to /Users/bipinrimal/Downloads/Thesis_work/models/static_scaler.pkl
2025-12-14 23:52:20 - utils - INFO - Creating sequences...
2025-12-14 23:52:20 - utils - INFO - Saved features to: /Users/bipinrimal/Downloads/Thesis_work/data/processed/sequence_features.parquet
2025-12-14 23:52:20 - utils - INFO - Processing sequences with length 15...
2025-12-14 23:52:23 - utils - INFO - Generated sequences shape: (2542814, 15, 13)
2025-12-14 23:52:23 - utils - INFO - Generated labels shape: (2542814,)
2025-12-14 23:52:27 - utils - INFO - Saved sequences to /Users/bipinrimal/Downloads/Thesis_work/data/processed/sequences.npy
2025-12-14 23:52:27 - utils - INFO - Saved sequence labels to /Users/bipinrimal/Downloads/Thesis_work/data/processed/sequence_labels.npy
2025-12-14 23:52:27 - utils - INFO - Feature engineering pipeline completed successfully.
2025-12-14 23:52:27 - utils - INFO - ✓ Stage 2 completed: Feature files generated.
2025-12-14 23:52:27 - utils - INFO - 
================================================================================
                            STAGE 3: MODEL TRAINING                             
================================================================================

2025-12-14 23:52:27 - utils - INFO - 
>>> Training Isolation Forest...
2025-12-14 23:52:27 - utils - INFO - 
================================================================================
                 ISOLATION FOREST TRAINING (V2: MULTI-DATASET)                  
================================================================================

2025-12-14 23:52:28 - utils - INFO - Loaded daily features: (2654790, 16)
2025-12-14 23:52:31 - utils - INFO - Model saved to /Users/bipinrimal/Downloads/Thesis_work/models/isolation_forest_model.pkl
2025-12-14 23:52:34 - utils - INFO - Predictions saved to /Users/bipinrimal/Downloads/Thesis_work/results/isolation_forest_predictions.csv
2025-12-14 23:52:35 - utils - INFO - 
============================================================
2025-12-14 23:52:35 - utils - INFO - Isolation Forest Performance Metrics
2025-12-14 23:52:35 - utils - INFO - ============================================================
2025-12-14 23:52:35 - utils - INFO - Accuracy:  0.9117
2025-12-14 23:52:35 - utils - INFO - Precision: 0.0003
2025-12-14 23:52:35 - utils - INFO - Recall:    0.3975
2025-12-14 23:52:35 - utils - INFO - F1-Score:  0.0005
2025-12-14 23:52:35 - utils - INFO - AUC-ROC:   0.7833
2025-12-14 23:52:35 - utils - INFO - ============================================================

2025-12-14 23:52:35 - utils - INFO - ✓ Isolation Forest training completed
2025-12-14 23:52:35 - utils - INFO - 
>>> Training LSTM Autoencoder...
2025-12-14 23:52:35 - utils - INFO - 
================================================================================
                           LSTM AUTOENCODER TRAINING                            
================================================================================

2025-12-14 23:52:35 - utils - INFO - Loaded sequences: (2542814, 15, 13)
2025-12-14 23:52:38 - utils - INFO - Training on 1779864 normal sequences
2025-12-14 23:52:38 - utils - INFO - Model: "functional"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┓
┃ Layer (type)                         ┃ Output Shape                ┃         Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━┩
│ input_layer (InputLayer)             │ (None, 15, 13)              │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ lstm (LSTM)                          │ (None, 15, 32)              │           5,888 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout (Dropout)                    │ (None, 15, 32)              │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ lstm_1 (LSTM)                        │ (None, 16)                  │           3,136 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ repeat_vector (RepeatVector)         │ (None, 15, 16)              │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ lstm_2 (LSTM)                        │ (None, 15, 16)              │           2,112 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout_1 (Dropout)                  │ (None, 15, 16)              │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ lstm_3 (LSTM)                        │ (None, 15, 32)              │           6,272 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ time_distributed (TimeDistributed)   │ (None, 15, 13)              │             429 │
└──────────────────────────────────────┴─────────────────────────────┴─────────────────┘
 Total params: 17,837 (69.68 KB)
 Trainable params: 17,837 (69.68 KB)
 Non-trainable params: 0 (0.00 B)

2025-12-14 23:52:38 - utils - INFO - Starting training for 20 epoch(s)...
